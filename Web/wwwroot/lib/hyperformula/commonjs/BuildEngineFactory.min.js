/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/BuildEngineFactory.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";exports.__esModule=!0,exports.BuildEngineFactory=void 0;var _LazilyTransformingAstService=require("./LazilyTransformingAstService"),_CellContentParser=require("./CellContentParser"),_CellValue=require("./CellValue"),_ColumnSearchStrategy=require("./ColumnSearch/ColumnSearchStrategy"),_Config=require("./Config"),_DateTimeHelper=require("./DateTimeHelper"),_CrudOperations=require("./CrudOperations"),_DependencyGraph=require("./DependencyGraph"),_Evaluator=require("./Evaluator"),_GraphBuilder=require("./GraphBuilder"),_i18n=require("./i18n"),_NamedExpressions=require("./NamedExpressions"),_NumberLiteralHelper=require("./NumberLiteralHelper"),_parser=require("./parser"),_Serialization=require("./Serialization"),_statistics=require("./statistics"),_errors=require("./errors"),_Sheet=require("./Sheet"),_FunctionRegistry=require("./interpreter/FunctionRegistry");function _defineProperty(e,r,i){return r in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,i){return r&&_defineProperties(e.prototype,r),i&&_defineProperties(e,i),e}var BuildEngineFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"buildEngine",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.useStats?new _statistics.Statistics:new _statistics.EmptyStatistics;i.start(_statistics.StatType.BUILD_ENGINE_TOTAL);var n=new _NamedExpressions.NamedExpressions,t=new _FunctionRegistry.FunctionRegistry(e),a=new _LazilyTransformingAstService.LazilyTransformingAstService(i),s=_DependencyGraph.DependencyGraph.buildEmpty(a,e,t,n,i),o=(0,_ColumnSearchStrategy.buildColumnSearchStrategy)(s,e,i),l=s.sheetMapping,u=s.addressMapping;for(var p in r)if(Object.prototype.hasOwnProperty.call(r,p)){var c=r[p];(0,_Sheet.validateAsSheet)(c);var d=(0,_Sheet.findBoundaries)(c);if(d.height>e.maxRows||d.width>e.maxColumns)throw new _errors.SheetSizeLimitExceededError;var _=l.addSheet(p);u.autoAddSheet(_,c,d)}var f=new _parser.ParserWithCaching(e,t,l.get),h=new _parser.Unparser(e,(0,_parser.buildLexerConfig)(e),l.fetchDisplayName,n),g=new _DateTimeHelper.DateTimeHelper(e),y=new _NumberLiteralHelper.NumberLiteralHelper(e),C=new _CellContentParser.CellContentParser(e,g,y),m=new _CrudOperations.CrudOperations(e,i,s,o,f,C,a,n);i.measure(_statistics.StatType.GRAPH_BUILD,function(){new _GraphBuilder.GraphBuilder(s,o,f,C,e,i).buildGraph(r)}),a.undoRedo=m.undoRedo,a.parser=f;var S=new _Evaluator.Evaluator(s,o,e,i,g,y,t,n);S.run();var v=new _CellValue.Exporter(e,n),E=new _Serialization.Serialization(s,h,e,v);return i.end(_statistics.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:s,columnSearch:o,parser:f,unparser:h,cellContentParser:C,evaluator:S,lazilyTransformingAstService:a,crudOperations:m,exporter:v,namedExpressions:n,serialization:E,functionRegistry:t}}},{key:"buildFromSheets",value:function(e,r){var i=new _Config.Config(r);return this.buildEngine(i,e)}},{key:"buildFromSheet",value:function(e,r){var i=new _Config.Config(r),n=i.translationPackage.getUITranslation(_i18n.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,_defineProperty({},n,e))}},{key:"buildEmpty",value:function(e){return this.buildEngine(new _Config.Config(e))}},{key:"rebuildWithConfig",value:function(e,r,i){return this.buildEngine(e,r,i)}}]),e}();exports.BuildEngineFactory=BuildEngineFactory;
//# sourceMappingURL=/sm/8be7b7cfbe828b12b4ed73ad8892afc776f09601bd1213823dd7e3f4887736c8.map