/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/CellValue.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";require("core-js/modules/es.function.name"),require("core-js/modules/es.math.log10"),exports.__esModule=!0,exports.Exporter=exports.DetailedCellError=exports.ExportedNamedExpressionChange=exports.ExportedCellChange=void 0;var _Cell=require("./Cell"),_NamedExpressions=require("./NamedExpressions"),_InterpreterValue=require("./interpreter/InterpreterValue");function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}var ExportedCellChange=function(){function e(r,t){_classCallCheck(this,e),this.address=r,this.newValue=t}return _createClass(e,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),e}();exports.ExportedCellChange=ExportedCellChange;var ExportedNamedExpressionChange=function e(r,t){_classCallCheck(this,e),this.name=r,this.newValue=t};exports.ExportedNamedExpressionChange=ExportedNamedExpressionChange;var DetailedCellError=function e(r,t){_classCallCheck(this,e),this.value=t,this.type=r.type,this.message=r.message||""};exports.DetailedCellError=DetailedCellError;var Exporter=function(){function e(r,t){_classCallCheck(this,e),this.config=r,this.namedExpressions=t}return _createClass(e,[{key:"exportChange",value:function(e){if(e.sheet===_NamedExpressions.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var r=this.namedExpressions.namedExpressionInAddress(e.row);if(!r)throw"Missing named expression";return new ExportedNamedExpressionChange(r.displayName,this.exportValue(e.value))}return new ExportedCellChange((0,_Cell.simpleCellAddress)(e.sheet,e.col,e.row),this.exportValue(e.value))}},{key:"exportValue",value:function(e){return e instanceof _InterpreterValue.SimpleRangeValue?this.detailedError(new _Cell.CellError(_Cell.ErrorType.VALUE)):this.config.smartRounding&&"number"==typeof e?this.cellValueRounding(e):e instanceof _Cell.CellError?this.detailedError(e):e===_Cell.EmptyValue?null:e}},{key:"detailedError",value:function(e){return new DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type))}},{key:"cellValueRounding",value:function(e){if(0===e)return e;var r=Math.floor(Math.log10(Math.abs(e))),t=Math.pow(10,this.config.precisionRounding-r);return e<0?-Math.round(-e*t)/t:Math.round(e*t)/t}}]),e}();exports.Exporter=Exporter;
//# sourceMappingURL=/sm/08a76dfe3e40ba923f3131a34fc1d9a1b646685266c4df839986a590e866f660.map