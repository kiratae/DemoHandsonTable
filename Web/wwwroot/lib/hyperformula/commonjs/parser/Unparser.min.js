/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/parser/Unparser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.join"),require("core-js/modules/es.array.map"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.regexp.constructor"),require("core-js/modules/es.regexp.exec"),require("core-js/modules/es.regexp.to-string"),require("core-js/modules/es.string.replace"),exports.__esModule=!0,exports.formatNumber=formatNumber,exports.Unparser=void 0;var _Cell=require("../Cell"),_Ast=require("./Ast"),_binaryOpTokenMap=require("./binaryOpTokenMap"),_LexerConfig=require("./LexerConfig");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}var Unparser=function(){function e(t,s,r,a){_classCallCheck(this,e),this.config=t,this.lexerConfig=s,this.sheetMappingFn=r,this.namedExpressions=a}return _createClass(e,[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var s,r=this;switch(e.type){case _Ast.AstNodeType.EMPTY:return(0,_Ast.imageWithWhitespace)("",e.leadingWhitespace);case _Ast.AstNodeType.NUMBER:return(0,_Ast.imageWithWhitespace)(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case _Ast.AstNodeType.STRING:return(0,_Ast.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case _Ast.AstNodeType.FUNCTION_CALL:var a=e.args.map(function(e){return void 0!==e?r.unparseAst(e,t):""}).join(this.config.functionArgSeparator),i=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+a+(0,_Ast.imageWithWhitespace)(")",e.internalWhitespace);return(0,_Ast.imageWithWhitespace)(i,e.leadingWhitespace);case _Ast.AstNodeType.NAMED_EXPRESSION:var n=null===(s=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===s?void 0:s.displayName;return(0,_Ast.imageWithWhitespace)(n||e.expressionName,e.leadingWhitespace);case _Ast.AstNodeType.CELL_REFERENCE:var c;return c=null!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!"+e.reference.unparse(t):e.reference.unparse(t),(0,_Ast.imageWithWhitespace)(c,e.leadingWhitespace);case _Ast.AstNodeType.COLUMN_RANGE:case _Ast.AstNodeType.ROW_RANGE:case _Ast.AstNodeType.CELL_RANGE:return(0,_Ast.imageWithWhitespace)(this.formatRange(e,t),e.leadingWhitespace);case _Ast.AstNodeType.PLUS_UNARY_OP:var o=this.unparseAst(e.value,t);return(0,_Ast.imageWithWhitespace)("+",e.leadingWhitespace)+o;case _Ast.AstNodeType.MINUS_UNARY_OP:var p=this.unparseAst(e.value,t);return(0,_Ast.imageWithWhitespace)("-",e.leadingWhitespace)+p;case _Ast.AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+(0,_Ast.imageWithWhitespace)("%",e.leadingWhitespace);case _Ast.AstNodeType.ERROR:var u=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:_Cell.ErrorType.ERROR);return(0,_Ast.imageWithWhitespace)(u,e.leadingWhitespace);case _Ast.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,_Ast.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case _Ast.AstNodeType.PARENTHESIS:var h="("+this.unparseAst(e.expression,t)+(0,_Ast.imageWithWhitespace)(")",e.internalWhitespace);return(0,_Ast.imageWithWhitespace)(h,e.leadingWhitespace);default:var l=this.unparseAst(e.left,t),A=this.unparseAst(e.right,t);return l+(0,_Ast.imageWithWhitespace)(_binaryOpTokenMap.binaryOpTokenMap[e.type],e.leadingWhitespace)+A}}},{key:"unparseSheetName",value:function(e){var t=this.sheetMappingFn(e);return new RegExp(_LexerConfig.additionalCharactersAllowedInQuotes).exec(t)?"'".concat(t,"'"):t}},{key:"formatRange",value:function(e,t){var s="",r="";return null!==e.start.sheet&&e.sheetReferenceType!==_Ast.RangeSheetReferenceType.RELATIVE&&(s=this.unparseSheetName(e.start.sheet)+"!"),null!==e.end.sheet&&e.sheetReferenceType===_Ast.RangeSheetReferenceType.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!"),"".concat(s).concat(e.start.unparse(t),":").concat(r).concat(e.end.unparse(t))}}]),e}();function formatNumber(e,t){return e.toString().replace(".",t)}exports.Unparser=Unparser;
//# sourceMappingURL=/sm/8db56ed369add057bec1d8efae541512da099d36679fa15901c6bf11f991eccb.map