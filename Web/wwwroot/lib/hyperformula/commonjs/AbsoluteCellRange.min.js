/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/AbsoluteCellRange.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.number.is-finite"),require("core-js/modules/es.object.get-prototype-of"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.reflect.construct"),require("core-js/modules/es.regexp.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/web.dom-collections.iterator"),exports.__esModule=!0,exports.AbsoluteRowRange=exports.AbsoluteColumnRange=exports.AbsoluteCellRange=exports.WRONG_RANGE_SIZE=exports.DIFFERENT_SHEETS_ERROR=void 0,require("regenerator-runtime/runtime");var _Cell=require("./Cell"),_parser=require("./parser"),_Span=require("./Span");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,s=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(s,arguments,n)}else r=s.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var DIFFERENT_SHEETS_ERROR="AbsoluteCellRange: Start and end are in different sheets";exports.DIFFERENT_SHEETS_ERROR=DIFFERENT_SHEETS_ERROR;var WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";exports.WRONG_RANGE_SIZE=WRONG_RANGE_SIZE;var AbsoluteCellRange=function(){function e(t,r){if(_classCallCheck(this,e),t.sheet!==r.sheet)throw new Error(DIFFERENT_SHEETS_ERROR);this.start=(0,_Cell.simpleCellAddress)(t.sheet,t.col,t.row),this.end=(0,_Cell.simpleCellAddress)(r.sheet,r.col,r.row)}return _createClass(e,[{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}},{key:"addressInRange",value:function(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}},{key:"columnInRange",value:function(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}},{key:"rowInRange",value:function(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(t){if(this.sheet!==t.start.sheet)return null;var r=Math.max(this.start.row,t.start.row),s=Math.min(this.end.row,t.end.row),n=Math.max(this.start.col,t.start.col),o=Math.min(this.end.col,t.end.col);return r>s||n>o?null:new e((0,_Cell.simpleCellAddress)(this.sheet,n,r),(0,_Cell.simpleCellAddress)(this.sheet,o,s))}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(t,r){return e.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,this.start.col+t,this.start.row+r),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof _Span.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"removeRows",value:function(e,t){if(!(e>this.end.row)){if(t<this.start.row){var r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,t){if(!(e>this.end.col)){if(t<this.start.col){var r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(t,r){return e.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,this.start.col,t),this.width(),r)}},{key:"rangeWithSameHeight",value:function(t,r){return e.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,t,this.start.row),r,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],t=0;t<this.height();++t){e[t]=[];for(var r=0;r<this.width();++r){var s=(0,_Cell.simpleCellAddress)(this.sheet,this.start.col+r,this.start.row+t);e[t].push(s)}}return e}},{key:"withStart",value:function(t){return new e(t,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"addresses",value:regeneratorRuntime.mark(function e(t){var r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.start.row;case 1:if(!(r<=this.effectiveEndRow(t))){e.next=12;break}s=this.start.col;case 3:if(!(s<=this.effectiveEndColumn(t))){e.next=9;break}return e.next=6,(0,_Cell.simpleCellAddress)(this.start.sheet,s,r);case 6:s++,e.next=3;break;case 9:r++,e.next=1;break;case 12:case"end":return e.stop()}},e,this)})},{key:"addressesWithDirection",value:regeneratorRuntime.mark(function e(t,r,s){var n,o,i,l,a,u,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=30;break}if(!(r>0)){e.next=16;break}n=this.effectiveEndRow(s);case 3:if(!(n>=this.start.row)){e.next=14;break}o=this.effectiveEndColumn(s);case 5:if(!(o>=this.start.col)){e.next=11;break}return e.next=8,(0,_Cell.simpleCellAddress)(this.start.sheet,o,n);case 8:o-=1,e.next=5;break;case 11:n-=1,e.next=3;break;case 14:e.next=28;break;case 16:i=this.start.row;case 17:if(!(i<=this.effectiveEndRow(s))){e.next=28;break}l=this.effectiveEndColumn(s);case 19:if(!(l>=this.start.col)){e.next=25;break}return e.next=22,(0,_Cell.simpleCellAddress)(this.start.sheet,l,i);case 22:l-=1,e.next=19;break;case 25:i+=1,e.next=17;break;case 28:e.next=57;break;case 30:if(!(r>0)){e.next=45;break}a=this.effectiveEndRow(s);case 32:if(!(a>=this.start.row)){e.next=43;break}u=this.start.col;case 34:if(!(u<=this.effectiveEndColumn(s))){e.next=40;break}return e.next=37,(0,_Cell.simpleCellAddress)(this.start.sheet,u,a);case 37:u+=1,e.next=34;break;case 40:a-=1,e.next=32;break;case 43:e.next=57;break;case 45:c=this.start.row;case 46:if(!(c<=this.effectiveEndRow(s))){e.next=57;break}h=this.start.col;case 48:if(!(h<=this.effectiveEndColumn(s))){e.next=54;break}return e.next=51,(0,_Cell.simpleCellAddress)(this.start.sheet,h,c);case 51:h+=1,e.next=48;break;case 54:c+=1,e.next=46;break;case 57:case"end":return e.stop()}},e,this)})},{key:"getAddress",value:function(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,_Cell.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e||this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}},{key:"sheet",get:function(){return this.start.sheet}}],[{key:"fromAst",value:function(t,r){return t.type===_parser.AstNodeType.CELL_RANGE?e.fromCellRange(t,r):t.type===_parser.AstNodeType.COLUMN_RANGE?AbsoluteColumnRange.fromColumnRange(t,r):AbsoluteRowRange.fromRowRange(t,r)}},{key:"fromCellRange",value:function(t,r){return new e(new _parser.CellAddress(t.start.sheet,t.start.col,t.start.row,t.start.type).toSimpleCellAddress(r),new _parser.CellAddress(t.end.sheet,t.end.col,t.end.row,t.end.type).toSimpleCellAddress(r))}},{key:"spanFrom",value:function(t,r,s){if(!Number.isFinite(r)&&Number.isFinite(s))return new AbsoluteRowRange(t.sheet,t.row,t.row+s-1);if(!Number.isFinite(s)&&Number.isFinite(r))return new AbsoluteColumnRange(t.sheet,t.col,t.col+r-1);if(Number.isFinite(s)&&Number.isFinite(r))return new e(t,(0,_Cell.simpleCellAddress)(t.sheet,t.col+r-1,t.row+s-1));throw new Error(WRONG_RANGE_SIZE)}},{key:"fromCoordinates",value:function(t,r,s,n,o){return new e((0,_Cell.simpleCellAddress)(t,r,s),(0,_Cell.simpleCellAddress)(t,n,o))}},{key:"singleRangeFromCellAddress",value:function(t,r){var s=t.toSimpleCellAddress(r);return new e(s,s)}}]),e}();exports.AbsoluteCellRange=AbsoluteCellRange;var AbsoluteColumnRange=function(e){_inherits(r,AbsoluteCellRange);var t=_createSuper(r);function r(e,s,n){return _classCallCheck(this,r),t.call(this,(0,_Cell.simpleCellAddress)(e,s,0),(0,_Cell.simpleCellAddress)(e,n,Number.POSITIVE_INFINITY))}return _createClass(r,null,[{key:"fromColumnRange",value:function(e,t){var s=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(s.sheet!==n.sheet)throw new Error(DIFFERENT_SHEETS_ERROR);return new r(s.sheet,s.col,n.col)}}]),_createClass(r,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(e){}},{key:"expandByRows",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.col+e,this.end.col+e)}},{key:"removeRows",value:function(e,t){}},{key:"rangeWithSameHeight",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e}},{key:"effectiveEndRow",value:function(e){return e.getSheetHeight(this.sheet)-1}}]),r}();exports.AbsoluteColumnRange=AbsoluteColumnRange;var AbsoluteRowRange=function(e){_inherits(r,AbsoluteCellRange);var t=_createSuper(r);function r(e,s,n){return _classCallCheck(this,r),t.call(this,(0,_Cell.simpleCellAddress)(e,0,s),(0,_Cell.simpleCellAddress)(e,Number.POSITIVE_INFINITY,n))}return _createClass(r,null,[{key:"fromRowRange",value:function(e,t){var s=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(s.sheet!==n.sheet)throw new Error(DIFFERENT_SHEETS_ERROR);return new r(s.sheet,s.row,n.row)}}]),_createClass(r,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(e){}},{key:"expandByColumns",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.row+t,this.end.row+t)}},{key:"removeColumns",value:function(e,t){}},{key:"rangeWithSameWidth",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return e.getSheetWidth(this.sheet)-1}}]),r}();exports.AbsoluteRowRange=AbsoluteRowRange;
//# sourceMappingURL=/sm/6a8fdd4638df6a718ed3af988ce003fee36af46e171f25376b368f810c28e41d.map