/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/CellContentParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";require("core-js/modules/es.array.slice"),require("core-js/modules/es.string.ends-with"),require("core-js/modules/es.string.starts-with"),require("core-js/modules/es.string.trim"),exports.__esModule=!0,exports.isFormula=isFormula,exports.isBoolean=isBoolean,exports.isMatrix=isMatrix,exports.isError=isError,exports.CellContentParser=exports.CellContent=void 0;var CellContent,_Cell=require("./Cell"),_errors=require("./errors"),_ArithmeticHelper=require("./interpreter/ArithmeticHelper");function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function isFormula(e){return e.startsWith("=")}function isBoolean(e){var r=e.toLowerCase();return"true"===r||"false"===r}function isMatrix(e){return"string"==typeof e&&(e.length>1&&e.startsWith("{")&&e.endsWith("}"))}function isError(e,r){var t=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(r,t)}exports.CellContent=CellContent,function(e){e.Number=function e(r){_classCallCheck(this,e),this.value=r,this.value=(0,_ArithmeticHelper.fixNegativeZero)(this.value)};e.String=function e(r){_classCallCheck(this,e),this.value=r};e.Boolean=function e(r){_classCallCheck(this,e),this.value=r};var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=r;e.Formula=function e(r){_classCallCheck(this,e),this.formula=r};var t=function(){function e(r){_classCallCheck(this,e),this.formula=r}return _createClass(e,[{key:"formulaWithBraces",value:function(){return"{"+this.formula+"}"}}]),e}();e.MatrixFormula=t;e.Error=function e(r){_classCallCheck(this,e),this.value=new _Cell.CellError(r)}}(CellContent||(exports.CellContent=CellContent={}));var CellContentParser=function(){function e(r,t,n){_classCallCheck(this,e),this.config=r,this.dateHelper=t,this.numberLiteralsHelper=n}return _createClass(e,[{key:"parse",value:function(e){if(null==e)return CellContent.Empty.getSingletonInstance();if("number"==typeof e)return(0,_ArithmeticHelper.isNumberOverflow)(e)?new CellContent.Error(_Cell.ErrorType.NUM):new CellContent.Number(e);if("boolean"==typeof e)return new CellContent.Boolean(e);if(e instanceof Date)return new CellContent.Number(this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}));if("string"==typeof e){if(isBoolean(e))return new CellContent.Boolean("true"===e.toLowerCase());if(isMatrix(e))return new CellContent.MatrixFormula(e.substr(1,e.length-2));if(isFormula(e))return new CellContent.Formula(e);if(isError(e,this.config.errorMapping))return new CellContent.Error(this.config.errorMapping[e.toUpperCase()]);var r=e.trim();if(this.numberLiteralsHelper.isNumber(r))return new CellContent.Number(this.numberLiteralsHelper.numericStringToNumber(r));var t=this.dateHelper.dateStringToDateNumber(r);return void 0!==t?new CellContent.Number(t):new CellContent.String(e.startsWith("'")?e.slice(1):e)}throw new _errors.UnableToParseError(e)}}]),e}();exports.CellContentParser=CellContentParser;
//# sourceMappingURL=/sm/de89155f1176e8ad81a2a79a8d00a47fd49a5416c2e8898c07728293501c3286.map