/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/commonjs/ClipboardOperations.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";exports.__esModule=!0,exports.ClipboardOperations=exports.ClipboardCellType=void 0,require("regenerator-runtime/runtime");var ClipboardOperationType,ClipboardCellType,_AbsoluteCellRange=require("./AbsoluteCellRange"),_Cell=require("./Cell"),_errors=require("./errors");function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,r,i){return r&&_defineProperties(e.prototype,r),i&&_defineProperties(e,i),e}!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(ClipboardOperationType||(ClipboardOperationType={})),exports.ClipboardCellType=ClipboardCellType,function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(ClipboardCellType||(exports.ClipboardCellType=ClipboardCellType={}));var Clipboard=function(){function e(r,i,t,o,a){_classCallCheck(this,e),this.sourceLeftCorner=r,this.width=i,this.height=t,this.type=o,this.content=a}return _createClass(e,[{key:"getContent",value:regeneratorRuntime.mark(function e(r){var i,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:i=0;case 5:if(!(i<this.height)){e.next=16;break}t=0;case 7:if(!(t<this.width)){e.next=13;break}return e.next=10,[(0,_Cell.simpleCellAddress)(r.sheet,r.col+t,r.row+i),this.content[i][t]];case 10:++t,e.next=7;break;case 13:++i,e.next=5;break;case 16:case"end":return e.stop()}},e,this)})}]),e}(),ClipboardOperations=function(){function e(r,i,t,o,a){_classCallCheck(this,e),this.dependencyGraph=r,this.operations=i,this.parser=t,this.lazilyTransformingAstService=o,this.config=a}return _createClass(e,[{key:"cut",value:function(e,r,i){this.clipboard=new Clipboard(e,r,i,ClipboardOperationType.CUT)}},{key:"copy",value:function(e,r,i){for(var t=[],o=0;o<i;++o){t[o]=[];for(var a=0;a<r;++a){var n=this.operations.getClipboardCell((0,_Cell.simpleCellAddress)(e.sheet,e.col+a,e.row+o));t[o].push(n)}}this.clipboard=new Clipboard(e,r,i,ClipboardOperationType.COPY,t)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if((0,_Cell.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new _errors.InvalidArgumentsError("a valid target address.");var r=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new _errors.SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(r))throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ClipboardOperationType.COPY}}]),e}();exports.ClipboardOperations=ClipboardOperations;
//# sourceMappingURL=/sm/a634bfa844dad507c84045e6872f707736474d304d638ba1a3f1616856f0521e.map