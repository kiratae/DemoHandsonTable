/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 * 
 * HYPERFORMULA is software distributed by HANDSONCODE sp. z o. o.,
 * a Polish corporation, based in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,
 * registered with the National Court Register under number 538651,
 * EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 * 
 * This software is protected by applicable copyright laws, including
 * international treaties, and triple-licensed.
 * 
 * First, if your use involves only such purposes as education, research, study,
 * and personal use, testing and demonstration, you agree to be bound by
 * the terms included in the “non-commercial-license.pdf” file, available
 * in the main directory of this software repository.
 * 
 * Second, commercial purposes dictate more individual approach
 * and the terms of such use are subject to negotiations.
 * 
 * Third, at your option, your use of this Software – either commercial, non-commercial, or both –
 * may be subject to the GNU Affero General Public License
 * in such version as included in the “agpl-3.0.txt” file,
 * available in the main directory of this software repository.
 * 
 * HANDSONCODE PROVIDES THIS SOFTWARE ON AN “AS IS” BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND. IN NO EVENT
 * AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE
 * TO YOU FOR DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL,
 * INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING
 * FROM USE OR INABILITY TO USE THIS SOFTWARE.
 * 
 * Version: 0.1.3
 * Release date: 21/07/2020 (built at 21/07/2020 09:24:53)
 */
(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("chevrotain"),require("gpu.js"));else if(typeof define==="function"&&define.amd)define("HyperFormula",["chevrotain","gpu.js"],factory);else if(typeof exports==="object")exports["HyperFormula"]=factory(require("chevrotain"),require("gpu.js"));else root["HyperFormula"]=factory(root["chevrotain"],root["GPU"])})(typeof self!=="undefined"?self:this,(function(__WEBPACK_EXTERNAL_MODULE__154__,__WEBPACK_EXTERNAL_MODULE__265__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(90);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(100);__webpack_require__(104);exports.__esModule=true;exports.default=void 0;var _Cell=__webpack_require__(106);exports.CellType=_Cell.CellType;exports.CellValueType=_Cell.CellValueType;exports.ErrorType=_Cell.ErrorType;var _CellValue=__webpack_require__(209);exports.DetailedCellError=_CellValue.DetailedCellError;exports.ExportedCellChange=_CellValue.ExportedCellChange;exports.ExportedNamedExpressionChange=_CellValue.ExportedNamedExpressionChange;var _HyperFormula2=__webpack_require__(212);exports.HyperFormula=_HyperFormula2.HyperFormula;var _Config=__webpack_require__(242);var _enGB=_interopRequireDefault(__webpack_require__(273));var _errors=__webpack_require__(183);exports.ConfigValueTooBigError=_errors.ConfigValueTooBigError;exports.ConfigValueTooSmallError=_errors.ConfigValueTooSmallError;exports.EvaluationSuspendedError=_errors.EvaluationSuspendedError;exports.ExpectedOneOfValuesError=_errors.ExpectedOneOfValuesError;exports.ExpectedValueOfTypeError=_errors.ExpectedValueOfTypeError;exports.FunctionPluginValidationError=_errors.FunctionPluginValidationError;exports.InvalidAddressError=_errors.InvalidAddressError;exports.InvalidArgumentsError=_errors.InvalidArgumentsError;exports.LanguageAlreadyRegisteredError=_errors.LanguageAlreadyRegisteredError;exports.LanguageNotRegisteredError=_errors.LanguageNotRegisteredError;exports.MatrixFormulasNotSupportedError=_errors.MatrixFormulasNotSupportedError;exports.MissingTranslationError=_errors.MissingTranslationError;exports.NamedExpressionDoesNotExistError=_errors.NamedExpressionDoesNotExistError;exports.NamedExpressionNameIsAlreadyTakenError=_errors.NamedExpressionNameIsAlreadyTakenError;exports.NamedExpressionNameIsInvalidError=_errors.NamedExpressionNameIsInvalidError;exports.NoOperationToRedoError=_errors.NoOperationToRedoError;exports.NoOperationToUndoError=_errors.NoOperationToUndoError;exports.NoRelativeAddressesAllowedError=_errors.NoRelativeAddressesAllowedError;exports.NoSheetWithIdError=_errors.NoSheetWithIdError;exports.NoSheetWithNameError=_errors.NoSheetWithNameError;exports.NotAFormulaError=_errors.NotAFormulaError;exports.NothingToPasteError=_errors.NothingToPasteError;exports.ProtectedFunctionTranslationError=_errors.ProtectedFunctionTranslationError;exports.SheetNameAlreadyTakenError=_errors.SheetNameAlreadyTakenError;exports.SheetSizeLimitExceededError=_errors.SheetSizeLimitExceededError;exports.SourceLocationHasMatrixError=_errors.SourceLocationHasMatrixError;exports.TargetLocationHasMatrixError=_errors.TargetLocationHasMatrixError;exports.UnableToParseError=_errors.UnableToParseError;var plugins=_interopRequireWildcard(__webpack_require__(274));var _interpreter=__webpack_require__(311);exports.FunctionPlugin=_interpreter.FunctionPlugin;function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var HyperFormulaNS=function(_HyperFormula){_inherits(HyperFormulaNS,_HyperFormula);var _super=_createSuper(HyperFormulaNS);function HyperFormulaNS(){_classCallCheck(this,HyperFormulaNS);return _super.apply(this,arguments)}return HyperFormulaNS}(_HyperFormula2.HyperFormula);HyperFormulaNS.HyperFormula=_HyperFormula2.HyperFormula;HyperFormulaNS.ErrorType=_Cell.ErrorType;HyperFormulaNS.CellType=_Cell.CellType;HyperFormulaNS.CellValueType=_Cell.CellValueType;HyperFormulaNS.DetailedCellError=_CellValue.DetailedCellError;HyperFormulaNS.ExportedCellChange=_CellValue.ExportedCellChange;HyperFormulaNS.ExportedNamedExpressionChange=_CellValue.ExportedNamedExpressionChange;HyperFormulaNS.ConfigValueTooBigError=_errors.ConfigValueTooBigError;HyperFormulaNS.ConfigValueTooSmallError=_errors.ConfigValueTooSmallError;HyperFormulaNS.EvaluationSuspendedError=_errors.EvaluationSuspendedError;HyperFormulaNS.ExpectedOneOfValuesError=_errors.ExpectedOneOfValuesError;HyperFormulaNS.ExpectedValueOfTypeError=_errors.ExpectedValueOfTypeError;HyperFormulaNS.FunctionPlugin=_interpreter.FunctionPlugin;HyperFormulaNS.FunctionPluginValidationError=_errors.FunctionPluginValidationError;HyperFormulaNS.InvalidAddressError=_errors.InvalidAddressError;HyperFormulaNS.InvalidArgumentsError=_errors.InvalidArgumentsError;HyperFormulaNS.LanguageNotRegisteredError=_errors.LanguageNotRegisteredError;HyperFormulaNS.LanguageAlreadyRegisteredError=_errors.LanguageAlreadyRegisteredError;HyperFormulaNS.MatrixFormulasNotSupportedError=_errors.MatrixFormulasNotSupportedError;HyperFormulaNS.MissingTranslationError=_errors.MissingTranslationError;HyperFormulaNS.NamedExpressionDoesNotExistError=_errors.NamedExpressionDoesNotExistError;HyperFormulaNS.NamedExpressionNameIsAlreadyTakenError=_errors.NamedExpressionNameIsAlreadyTakenError;HyperFormulaNS.NamedExpressionNameIsInvalidError=_errors.NamedExpressionNameIsInvalidError;HyperFormulaNS.NoOperationToRedoError=_errors.NoOperationToRedoError;HyperFormulaNS.NoOperationToUndoError=_errors.NoOperationToUndoError;HyperFormulaNS.NoRelativeAddressesAllowedError=_errors.NoRelativeAddressesAllowedError;HyperFormulaNS.NoSheetWithIdError=_errors.NoSheetWithIdError;HyperFormulaNS.NoSheetWithNameError=_errors.NoSheetWithNameError;HyperFormulaNS.NotAFormulaError=_errors.NotAFormulaError;HyperFormulaNS.NothingToPasteError=_errors.NothingToPasteError;HyperFormulaNS.ProtectedFunctionTranslationError=_errors.ProtectedFunctionTranslationError;HyperFormulaNS.SheetNameAlreadyTakenError=_errors.SheetNameAlreadyTakenError;HyperFormulaNS.SheetSizeLimitExceededError=_errors.SheetSizeLimitExceededError;HyperFormulaNS.SourceLocationHasMatrixError=_errors.SourceLocationHasMatrixError;HyperFormulaNS.TargetLocationHasMatrixError=_errors.TargetLocationHasMatrixError;HyperFormulaNS.UnableToParseError=_errors.UnableToParseError;var defaultLanguage=_Config.Config.defaultConfig.language;_HyperFormula2.HyperFormula.registerLanguage(defaultLanguage,_enGB.default);_HyperFormula2.HyperFormula.languages[_enGB.default.langCode]=_enGB.default;var _iterator=_createForOfIteratorHelper(Object.getOwnPropertyNames(plugins)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var pluginName=_step.value;if(!pluginName.startsWith("_")){_HyperFormula2.HyperFormula.registerFunctionPlugin(plugins[pluginName])}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _default=HyperFormulaNS;exports.default=_default},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var global=__webpack_require__(3);var getBuiltIn=__webpack_require__(35);var IS_PURE=__webpack_require__(30);var DESCRIPTORS=__webpack_require__(6);var NATIVE_SYMBOL=__webpack_require__(46);var USE_SYMBOL_AS_UID=__webpack_require__(47);var fails=__webpack_require__(7);var has=__webpack_require__(16);var isArray=__webpack_require__(48);var isObject=__webpack_require__(15);var anObject=__webpack_require__(21);var toObject=__webpack_require__(49);var toIndexedObject=__webpack_require__(10);var toPrimitive=__webpack_require__(14);var createPropertyDescriptor=__webpack_require__(9);var nativeObjectCreate=__webpack_require__(50);var objectKeys=__webpack_require__(52);var getOwnPropertyNamesModule=__webpack_require__(37);var getOwnPropertyNamesExternal=__webpack_require__(54);var getOwnPropertySymbolsModule=__webpack_require__(44);var getOwnPropertyDescriptorModule=__webpack_require__(5);var definePropertyModule=__webpack_require__(20);var propertyIsEnumerableModule=__webpack_require__(8);var createNonEnumerableProperty=__webpack_require__(19);var redefine=__webpack_require__(22);var shared=__webpack_require__(29);var sharedKey=__webpack_require__(28);var hiddenKeys=__webpack_require__(32);var uid=__webpack_require__(31);var wellKnownSymbol=__webpack_require__(55);var wrappedWellKnownSymbolModule=__webpack_require__(56);var defineWellKnownSymbol=__webpack_require__(57);var setToStringTag=__webpack_require__(58);var InternalStateModule=__webpack_require__(26);var $forEach=__webpack_require__(59).forEach;var HIDDEN=sharedKey("hidden");var SYMBOL="Symbol";var PROTOTYPE="prototype";var TO_PRIMITIVE=wellKnownSymbol("toPrimitive");var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(SYMBOL);var ObjectPrototype=Object[PROTOTYPE];var $Symbol=global.Symbol;var $stringify=getBuiltIn("JSON","stringify");var nativeGetOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f;var nativeDefineProperty=definePropertyModule.f;var nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f;var nativePropertyIsEnumerable=propertyIsEnumerableModule.f;var AllSymbols=shared("symbols");var ObjectPrototypeSymbols=shared("op-symbols");var StringToSymbolRegistry=shared("string-to-symbol-registry");var SymbolToStringRegistry=shared("symbol-to-string-registry");var WellKnownSymbolsStore=shared("wks");var QObject=global.QObject;var USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild;var setSymbolDescriptor=DESCRIPTORS&&fails((function(){return nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a!=7}))?function(O,P,Attributes){var ObjectPrototypeDescriptor=nativeGetOwnPropertyDescriptor(ObjectPrototype,P);if(ObjectPrototypeDescriptor)delete ObjectPrototype[P];nativeDefineProperty(O,P,Attributes);if(ObjectPrototypeDescriptor&&O!==ObjectPrototype){nativeDefineProperty(ObjectPrototype,P,ObjectPrototypeDescriptor)}}:nativeDefineProperty;var wrap=function(tag,description){var symbol=AllSymbols[tag]=nativeObjectCreate($Symbol[PROTOTYPE]);setInternalState(symbol,{type:SYMBOL,tag:tag,description:description});if(!DESCRIPTORS)symbol.description=description;return symbol};var isSymbol=USE_SYMBOL_AS_UID?function(it){return typeof it=="symbol"}:function(it){return Object(it)instanceof $Symbol};var $defineProperty=function defineProperty(O,P,Attributes){if(O===ObjectPrototype)$defineProperty(ObjectPrototypeSymbols,P,Attributes);anObject(O);var key=toPrimitive(P,true);anObject(Attributes);if(has(AllSymbols,key)){if(!Attributes.enumerable){if(!has(O,HIDDEN))nativeDefineProperty(O,HIDDEN,createPropertyDescriptor(1,{}));O[HIDDEN][key]=true}else{if(has(O,HIDDEN)&&O[HIDDEN][key])O[HIDDEN][key]=false;Attributes=nativeObjectCreate(Attributes,{enumerable:createPropertyDescriptor(0,false)})}return setSymbolDescriptor(O,key,Attributes)}return nativeDefineProperty(O,key,Attributes)};var $defineProperties=function defineProperties(O,Properties){anObject(O);var properties=toIndexedObject(Properties);var keys=objectKeys(properties).concat($getOwnPropertySymbols(properties));$forEach(keys,(function(key){if(!DESCRIPTORS||$propertyIsEnumerable.call(properties,key))$defineProperty(O,key,properties[key])}));return O};var $create=function create(O,Properties){return Properties===undefined?nativeObjectCreate(O):$defineProperties(nativeObjectCreate(O),Properties)};var $propertyIsEnumerable=function propertyIsEnumerable(V){var P=toPrimitive(V,true);var enumerable=nativePropertyIsEnumerable.call(this,P);if(this===ObjectPrototype&&has(AllSymbols,P)&&!has(ObjectPrototypeSymbols,P))return false;return enumerable||!has(this,P)||!has(AllSymbols,P)||has(this,HIDDEN)&&this[HIDDEN][P]?enumerable:true};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(O,P){var it=toIndexedObject(O);var key=toPrimitive(P,true);if(it===ObjectPrototype&&has(AllSymbols,key)&&!has(ObjectPrototypeSymbols,key))return;var descriptor=nativeGetOwnPropertyDescriptor(it,key);if(descriptor&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key])){descriptor.enumerable=true}return descriptor};var $getOwnPropertyNames=function getOwnPropertyNames(O){var names=nativeGetOwnPropertyNames(toIndexedObject(O));var result=[];$forEach(names,(function(key){if(!has(AllSymbols,key)&&!has(hiddenKeys,key))result.push(key)}));return result};var $getOwnPropertySymbols=function getOwnPropertySymbols(O){var IS_OBJECT_PROTOTYPE=O===ObjectPrototype;var names=nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE?ObjectPrototypeSymbols:toIndexedObject(O));var result=[];$forEach(names,(function(key){if(has(AllSymbols,key)&&(!IS_OBJECT_PROTOTYPE||has(ObjectPrototype,key))){result.push(AllSymbols[key])}}));return result};if(!NATIVE_SYMBOL){$Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor");var description=!arguments.length||arguments[0]===undefined?undefined:String(arguments[0]);var tag=uid(description);var setter=function(value){if(this===ObjectPrototype)setter.call(ObjectPrototypeSymbols,value);if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDescriptor(this,tag,createPropertyDescriptor(1,value))};if(DESCRIPTORS&&USE_SETTER)setSymbolDescriptor(ObjectPrototype,tag,{configurable:true,set:setter});return wrap(tag,description)};redefine($Symbol[PROTOTYPE],"toString",(function toString(){return getInternalState(this).tag}));redefine($Symbol,"withoutSetter",(function(description){return wrap(uid(description),description)}));propertyIsEnumerableModule.f=$propertyIsEnumerable;definePropertyModule.f=$defineProperty;getOwnPropertyDescriptorModule.f=$getOwnPropertyDescriptor;getOwnPropertyNamesModule.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames;getOwnPropertySymbolsModule.f=$getOwnPropertySymbols;wrappedWellKnownSymbolModule.f=function(name){return wrap(wellKnownSymbol(name),name)};if(DESCRIPTORS){nativeDefineProperty($Symbol[PROTOTYPE],"description",{configurable:true,get:function description(){return getInternalState(this).description}});if(!IS_PURE){redefine(ObjectPrototype,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:true})}}}$({global:true,wrap:true,forced:!NATIVE_SYMBOL,sham:!NATIVE_SYMBOL},{Symbol:$Symbol});$forEach(objectKeys(WellKnownSymbolsStore),(function(name){defineWellKnownSymbol(name)}));$({target:SYMBOL,stat:true,forced:!NATIVE_SYMBOL},{for:function(key){var string=String(key);if(has(StringToSymbolRegistry,string))return StringToSymbolRegistry[string];var symbol=$Symbol(string);StringToSymbolRegistry[string]=symbol;SymbolToStringRegistry[symbol]=string;return symbol},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol");if(has(SymbolToStringRegistry,sym))return SymbolToStringRegistry[sym]},useSetter:function(){USE_SETTER=true},useSimple:function(){USE_SETTER=false}});$({target:"Object",stat:true,forced:!NATIVE_SYMBOL,sham:!DESCRIPTORS},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor});$({target:"Object",stat:true,forced:!NATIVE_SYMBOL},{getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$({target:"Object",stat:true,forced:fails((function(){getOwnPropertySymbolsModule.f(1)}))},{getOwnPropertySymbols:function getOwnPropertySymbols(it){return getOwnPropertySymbolsModule.f(toObject(it))}});if($stringify){var FORCED_JSON_STRINGIFY=!NATIVE_SYMBOL||fails((function(){var symbol=$Symbol();return $stringify([symbol])!="[null]"||$stringify({a:symbol})!="{}"||$stringify(Object(symbol))!="{}"}));$({target:"JSON",stat:true,forced:FORCED_JSON_STRINGIFY},{stringify:function stringify(it,replacer,space){var args=[it];var index=1;var $replacer;while(arguments.length>index)args.push(arguments[index++]);$replacer=replacer;if(!isObject(replacer)&&it===undefined||isSymbol(it))return;if(!isArray(replacer))replacer=function(key,value){if(typeof $replacer=="function")value=$replacer.call(this,key,value);if(!isSymbol(value))return value};args[1]=replacer;return $stringify.apply(null,args)}})}if(!$Symbol[PROTOTYPE][TO_PRIMITIVE]){createNonEnumerableProperty($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf)}setToStringTag($Symbol,SYMBOL);hiddenKeys[HIDDEN]=true},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var getOwnPropertyDescriptor=__webpack_require__(5).f;var createNonEnumerableProperty=__webpack_require__(19);var redefine=__webpack_require__(22);var setGlobal=__webpack_require__(23);var copyConstructorProperties=__webpack_require__(33);var isForced=__webpack_require__(45);module.exports=function(options,source){var TARGET=options.target;var GLOBAL=options.global;var STATIC=options.stat;var FORCED,target,key,targetProperty,sourceProperty,descriptor;if(GLOBAL){target=global}else if(STATIC){target=global[TARGET]||setGlobal(TARGET,{})}else{target=(global[TARGET]||{}).prototype}if(target)for(key in source){sourceProperty=source[key];if(options.noTargetGet){descriptor=getOwnPropertyDescriptor(target,key);targetProperty=descriptor&&descriptor.value}else targetProperty=target[key];FORCED=isForced(GLOBAL?key:TARGET+(STATIC?".":"#")+key,options.forced);if(!FORCED&&targetProperty!==undefined){if(typeof sourceProperty===typeof targetProperty)continue;copyConstructorProperties(sourceProperty,targetProperty)}if(options.sham||targetProperty&&targetProperty.sham){createNonEnumerableProperty(sourceProperty,"sham",true)}redefine(target,key,sourceProperty,options)}}},function(module,exports,__webpack_require__){(function(global){var check=function(it){return it&&it.Math==Math&&it};module.exports=check(typeof globalThis=="object"&&globalThis)||check(typeof window=="object"&&window)||check(typeof self=="object"&&self)||check(typeof global=="object"&&global)||Function("return this")()}).call(this,__webpack_require__(4))},function(module,exports){var g;g=function(){return this}();try{g=g||new Function("return this")()}catch(e){if(typeof window==="object")g=window}module.exports=g},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var propertyIsEnumerableModule=__webpack_require__(8);var createPropertyDescriptor=__webpack_require__(9);var toIndexedObject=__webpack_require__(10);var toPrimitive=__webpack_require__(14);var has=__webpack_require__(16);var IE8_DOM_DEFINE=__webpack_require__(17);var nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?nativeGetOwnPropertyDescriptor:function getOwnPropertyDescriptor(O,P){O=toIndexedObject(O);P=toPrimitive(P,true);if(IE8_DOM_DEFINE)try{return nativeGetOwnPropertyDescriptor(O,P)}catch(error){}if(has(O,P))return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O,P),O[P])}},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);module.exports=!fails((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}))},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(error){return true}}},function(module,exports,__webpack_require__){"use strict";var nativePropertyIsEnumerable={}.propertyIsEnumerable;var getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;var NASHORN_BUG=getOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1);exports.f=NASHORN_BUG?function propertyIsEnumerable(V){var descriptor=getOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable}:nativePropertyIsEnumerable},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},function(module,exports,__webpack_require__){var IndexedObject=__webpack_require__(11);var requireObjectCoercible=__webpack_require__(13);module.exports=function(it){return IndexedObject(requireObjectCoercible(it))}},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);var classof=__webpack_require__(12);var split="".split;module.exports=fails((function(){return!Object("z").propertyIsEnumerable(0)}))?function(it){return classof(it)=="String"?split.call(it,""):Object(it)}:Object},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on "+it);return it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);module.exports=function(input,PREFERRED_STRING){if(!isObject(input))return input;var fn,val;if(PREFERRED_STRING&&typeof(fn=input.toString)=="function"&&!isObject(val=fn.call(input)))return val;if(typeof(fn=input.valueOf)=="function"&&!isObject(val=fn.call(input)))return val;if(!PREFERRED_STRING&&typeof(fn=input.toString)=="function"&&!isObject(val=fn.call(input)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var fails=__webpack_require__(7);var createElement=__webpack_require__(18);module.exports=!DESCRIPTORS&&!fails((function(){return Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a!=7}))},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var isObject=__webpack_require__(15);var document=global.document;var EXISTS=isObject(document)&&isObject(document.createElement);module.exports=function(it){return EXISTS?document.createElement(it):{}}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var definePropertyModule=__webpack_require__(20);var createPropertyDescriptor=__webpack_require__(9);module.exports=DESCRIPTORS?function(object,key,value){return definePropertyModule.f(object,key,createPropertyDescriptor(1,value))}:function(object,key,value){object[key]=value;return object}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var IE8_DOM_DEFINE=__webpack_require__(17);var anObject=__webpack_require__(21);var toPrimitive=__webpack_require__(14);var nativeDefineProperty=Object.defineProperty;exports.f=DESCRIPTORS?nativeDefineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return nativeDefineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported");if("value"in Attributes)O[P]=Attributes.value;return O}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);module.exports=function(it){if(!isObject(it)){throw TypeError(String(it)+" is not an object")}return it}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var createNonEnumerableProperty=__webpack_require__(19);var has=__webpack_require__(16);var setGlobal=__webpack_require__(23);var inspectSource=__webpack_require__(24);var InternalStateModule=__webpack_require__(26);var getInternalState=InternalStateModule.get;var enforceInternalState=InternalStateModule.enforce;var TEMPLATE=String(String).split("String");(module.exports=function(O,key,value,options){var unsafe=options?!!options.unsafe:false;var simple=options?!!options.enumerable:false;var noTargetGet=options?!!options.noTargetGet:false;if(typeof value=="function"){if(typeof key=="string"&&!has(value,"name"))createNonEnumerableProperty(value,"name",key);enforceInternalState(value).source=TEMPLATE.join(typeof key=="string"?key:"")}if(O===global){if(simple)O[key]=value;else setGlobal(key,value);return}else if(!unsafe){delete O[key]}else if(!noTargetGet&&O[key]){simple=true}if(simple)O[key]=value;else createNonEnumerableProperty(O,key,value)})(Function.prototype,"toString",(function toString(){return typeof this=="function"&&getInternalState(this).source||inspectSource(this)}))},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var createNonEnumerableProperty=__webpack_require__(19);module.exports=function(key,value){try{createNonEnumerableProperty(global,key,value)}catch(error){global[key]=value}return value}},function(module,exports,__webpack_require__){var store=__webpack_require__(25);var functionToString=Function.toString;if(typeof store.inspectSource!="function"){store.inspectSource=function(it){return functionToString.call(it)}}module.exports=store.inspectSource},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var setGlobal=__webpack_require__(23);var SHARED="__core-js_shared__";var store=global[SHARED]||setGlobal(SHARED,{});module.exports=store},function(module,exports,__webpack_require__){var NATIVE_WEAK_MAP=__webpack_require__(27);var global=__webpack_require__(3);var isObject=__webpack_require__(15);var createNonEnumerableProperty=__webpack_require__(19);var objectHas=__webpack_require__(16);var sharedKey=__webpack_require__(28);var hiddenKeys=__webpack_require__(32);var WeakMap=global.WeakMap;var set,get,has;var enforce=function(it){return has(it)?get(it):set(it,{})};var getterFor=function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE){throw TypeError("Incompatible receiver, "+TYPE+" required")}return state}};if(NATIVE_WEAK_MAP){var store=new WeakMap;var wmget=store.get;var wmhas=store.has;var wmset=store.set;set=function(it,metadata){wmset.call(store,it,metadata);return metadata};get=function(it){return wmget.call(store,it)||{}};has=function(it){return wmhas.call(store,it)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=true;set=function(it,metadata){createNonEnumerableProperty(it,STATE,metadata);return metadata};get=function(it){return objectHas(it,STATE)?it[STATE]:{}};has=function(it){return objectHas(it,STATE)}}module.exports={set:set,get:get,has:has,enforce:enforce,getterFor:getterFor}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var inspectSource=__webpack_require__(24);var WeakMap=global.WeakMap;module.exports=typeof WeakMap==="function"&&/native code/.test(inspectSource(WeakMap))},function(module,exports,__webpack_require__){var shared=__webpack_require__(29);var uid=__webpack_require__(31);var keys=shared("keys");module.exports=function(key){return keys[key]||(keys[key]=uid(key))}},function(module,exports,__webpack_require__){var IS_PURE=__webpack_require__(30);var store=__webpack_require__(25);(module.exports=function(key,value){return store[key]||(store[key]=value!==undefined?value:{})})("versions",[]).push({version:"3.6.5",mode:IS_PURE?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(module,exports){module.exports=false},function(module,exports){var id=0;var postfix=Math.random();module.exports=function(key){return"Symbol("+String(key===undefined?"":key)+")_"+(++id+postfix).toString(36)}},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var has=__webpack_require__(16);var ownKeys=__webpack_require__(34);var getOwnPropertyDescriptorModule=__webpack_require__(5);var definePropertyModule=__webpack_require__(20);module.exports=function(target,source){var keys=ownKeys(source);var defineProperty=definePropertyModule.f;var getOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f;for(var i=0;i<keys.length;i++){var key=keys[i];if(!has(target,key))defineProperty(target,key,getOwnPropertyDescriptor(source,key))}}},function(module,exports,__webpack_require__){var getBuiltIn=__webpack_require__(35);var getOwnPropertyNamesModule=__webpack_require__(37);var getOwnPropertySymbolsModule=__webpack_require__(44);var anObject=__webpack_require__(21);module.exports=getBuiltIn("Reflect","ownKeys")||function ownKeys(it){var keys=getOwnPropertyNamesModule.f(anObject(it));var getOwnPropertySymbols=getOwnPropertySymbolsModule.f;return getOwnPropertySymbols?keys.concat(getOwnPropertySymbols(it)):keys}},function(module,exports,__webpack_require__){var path=__webpack_require__(36);var global=__webpack_require__(3);var aFunction=function(variable){return typeof variable=="function"?variable:undefined};module.exports=function(namespace,method){return arguments.length<2?aFunction(path[namespace])||aFunction(global[namespace]):path[namespace]&&path[namespace][method]||global[namespace]&&global[namespace][method]}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);module.exports=global},function(module,exports,__webpack_require__){var internalObjectKeys=__webpack_require__(38);var enumBugKeys=__webpack_require__(43);var hiddenKeys=enumBugKeys.concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return internalObjectKeys(O,hiddenKeys)}},function(module,exports,__webpack_require__){var has=__webpack_require__(16);var toIndexedObject=__webpack_require__(10);var indexOf=__webpack_require__(39).indexOf;var hiddenKeys=__webpack_require__(32);module.exports=function(object,names){var O=toIndexedObject(object);var i=0;var result=[];var key;for(key in O)!has(hiddenKeys,key)&&has(O,key)&&result.push(key);while(names.length>i)if(has(O,key=names[i++])){~indexOf(result,key)||result.push(key)}return result}},function(module,exports,__webpack_require__){var toIndexedObject=__webpack_require__(10);var toLength=__webpack_require__(40);var toAbsoluteIndex=__webpack_require__(42);var createMethod=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIndexedObject($this);var length=toLength(O.length);var index=toAbsoluteIndex(fromIndex,length);var value;if(IS_INCLUDES&&el!=el)while(length>index){value=O[index++];if(value!=value)return true}else for(;length>index;index++){if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0}return!IS_INCLUDES&&-1}};module.exports={includes:createMethod(true),indexOf:createMethod(false)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(41);var min=Math.min;module.exports=function(argument){return argument>0?min(toInteger(argument),9007199254740991):0}},function(module,exports){var ceil=Math.ceil;var floor=Math.floor;module.exports=function(argument){return isNaN(argument=+argument)?0:(argument>0?floor:ceil)(argument)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(41);var max=Math.max;var min=Math.min;module.exports=function(index,length){var integer=toInteger(index);return integer<0?max(integer+length,0):min(integer,length)}},function(module,exports){module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);var replacement=/#|\.prototype\./;var isForced=function(feature,detection){var value=data[normalize(feature)];return value==POLYFILL?true:value==NATIVE?false:typeof detection=="function"?fails(detection):!!detection};var normalize=isForced.normalize=function(string){return String(string).replace(replacement,".").toLowerCase()};var data=isForced.data={};var NATIVE=isForced.NATIVE="N";var POLYFILL=isForced.POLYFILL="P";module.exports=isForced},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);module.exports=!!Object.getOwnPropertySymbols&&!fails((function(){return!String(Symbol())}))},function(module,exports,__webpack_require__){var NATIVE_SYMBOL=__webpack_require__(46);module.exports=NATIVE_SYMBOL&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(module,exports,__webpack_require__){var classof=__webpack_require__(12);module.exports=Array.isArray||function isArray(arg){return classof(arg)=="Array"}},function(module,exports,__webpack_require__){var requireObjectCoercible=__webpack_require__(13);module.exports=function(argument){return Object(requireObjectCoercible(argument))}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(21);var defineProperties=__webpack_require__(51);var enumBugKeys=__webpack_require__(43);var hiddenKeys=__webpack_require__(32);var html=__webpack_require__(53);var documentCreateElement=__webpack_require__(18);var sharedKey=__webpack_require__(28);var GT=">";var LT="<";var PROTOTYPE="prototype";var SCRIPT="script";var IE_PROTO=sharedKey("IE_PROTO");var EmptyConstructor=function(){};var scriptTag=function(content){return LT+SCRIPT+GT+content+LT+"/"+SCRIPT+GT};var NullProtoObjectViaActiveX=function(activeXDocument){activeXDocument.write(scriptTag(""));activeXDocument.close();var temp=activeXDocument.parentWindow.Object;activeXDocument=null;return temp};var NullProtoObjectViaIFrame=function(){var iframe=documentCreateElement("iframe");var JS="java"+SCRIPT+":";var iframeDocument;iframe.style.display="none";html.appendChild(iframe);iframe.src=String(JS);iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(scriptTag("document.F=Object"));iframeDocument.close();return iframeDocument.F};var activeXDocument;var NullProtoObject=function(){try{activeXDocument=document.domain&&new ActiveXObject("htmlfile")}catch(error){}NullProtoObject=activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame();var length=enumBugKeys.length;while(length--)delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];return NullProtoObject()};hiddenKeys[IE_PROTO]=true;module.exports=Object.create||function create(O,Properties){var result;if(O!==null){EmptyConstructor[PROTOTYPE]=anObject(O);result=new EmptyConstructor;EmptyConstructor[PROTOTYPE]=null;result[IE_PROTO]=O}else result=NullProtoObject();return Properties===undefined?result:defineProperties(result,Properties)}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var definePropertyModule=__webpack_require__(20);var anObject=__webpack_require__(21);var objectKeys=__webpack_require__(52);module.exports=DESCRIPTORS?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=objectKeys(Properties);var length=keys.length;var index=0;var key;while(length>index)definePropertyModule.f(O,key=keys[index++],Properties[key]);return O}},function(module,exports,__webpack_require__){var internalObjectKeys=__webpack_require__(38);var enumBugKeys=__webpack_require__(43);module.exports=Object.keys||function keys(O){return internalObjectKeys(O,enumBugKeys)}},function(module,exports,__webpack_require__){var getBuiltIn=__webpack_require__(35);module.exports=getBuiltIn("document","documentElement")},function(module,exports,__webpack_require__){var toIndexedObject=__webpack_require__(10);var nativeGetOwnPropertyNames=__webpack_require__(37).f;var toString={}.toString;var windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return nativeGetOwnPropertyNames(it)}catch(error){return windowNames.slice()}};module.exports.f=function getOwnPropertyNames(it){return windowNames&&toString.call(it)=="[object Window]"?getWindowNames(it):nativeGetOwnPropertyNames(toIndexedObject(it))}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var shared=__webpack_require__(29);var has=__webpack_require__(16);var uid=__webpack_require__(31);var NATIVE_SYMBOL=__webpack_require__(46);var USE_SYMBOL_AS_UID=__webpack_require__(47);var WellKnownSymbolsStore=shared("wks");var Symbol=global.Symbol;var createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol:Symbol&&Symbol.withoutSetter||uid;module.exports=function(name){if(!has(WellKnownSymbolsStore,name)){if(NATIVE_SYMBOL&&has(Symbol,name))WellKnownSymbolsStore[name]=Symbol[name];else WellKnownSymbolsStore[name]=createWellKnownSymbol("Symbol."+name)}return WellKnownSymbolsStore[name]}},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);exports.f=wellKnownSymbol},function(module,exports,__webpack_require__){var path=__webpack_require__(36);var has=__webpack_require__(16);var wrappedWellKnownSymbolModule=__webpack_require__(56);var defineProperty=__webpack_require__(20).f;module.exports=function(NAME){var Symbol=path.Symbol||(path.Symbol={});if(!has(Symbol,NAME))defineProperty(Symbol,NAME,{value:wrappedWellKnownSymbolModule.f(NAME)})}},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(20).f;var has=__webpack_require__(16);var wellKnownSymbol=__webpack_require__(55);var TO_STRING_TAG=wellKnownSymbol("toStringTag");module.exports=function(it,TAG,STATIC){if(it&&!has(it=STATIC?it:it.prototype,TO_STRING_TAG)){defineProperty(it,TO_STRING_TAG,{configurable:true,value:TAG})}}},function(module,exports,__webpack_require__){var bind=__webpack_require__(60);var IndexedObject=__webpack_require__(11);var toObject=__webpack_require__(49);var toLength=__webpack_require__(40);var arraySpeciesCreate=__webpack_require__(62);var push=[].push;var createMethod=function(TYPE){var IS_MAP=TYPE==1;var IS_FILTER=TYPE==2;var IS_SOME=TYPE==3;var IS_EVERY=TYPE==4;var IS_FIND_INDEX=TYPE==6;var NO_HOLES=TYPE==5||IS_FIND_INDEX;return function($this,callbackfn,that,specificCreate){var O=toObject($this);var self=IndexedObject(O);var boundFunction=bind(callbackfn,that,3);var length=toLength(self.length);var index=0;var create=specificCreate||arraySpeciesCreate;var target=IS_MAP?create($this,length):IS_FILTER?create($this,0):undefined;var value,result;for(;length>index;index++)if(NO_HOLES||index in self){value=self[index];result=boundFunction(value,index,O);if(TYPE){if(IS_MAP)target[index]=result;else if(result)switch(TYPE){case 3:return true;case 5:return value;case 6:return index;case 2:push.call(target,value)}else if(IS_EVERY)return false}}return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:target}};module.exports={forEach:createMethod(0),map:createMethod(1),filter:createMethod(2),some:createMethod(3),every:createMethod(4),find:createMethod(5),findIndex:createMethod(6)}},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(61);module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 0:return function(){return fn.call(that)};case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports){module.exports=function(it){if(typeof it!="function"){throw TypeError(String(it)+" is not a function")}return it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);var isArray=__webpack_require__(48);var wellKnownSymbol=__webpack_require__(55);var SPECIES=wellKnownSymbol("species");module.exports=function(originalArray,length){var C;if(isArray(originalArray)){C=originalArray.constructor;if(typeof C=="function"&&(C===Array||isArray(C.prototype)))C=undefined;else if(isObject(C)){C=C[SPECIES];if(C===null)C=undefined}}return new(C===undefined?Array:C)(length===0?0:length)}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var DESCRIPTORS=__webpack_require__(6);var global=__webpack_require__(3);var has=__webpack_require__(16);var isObject=__webpack_require__(15);var defineProperty=__webpack_require__(20).f;var copyConstructorProperties=__webpack_require__(33);var NativeSymbol=global.Symbol;if(DESCRIPTORS&&typeof NativeSymbol=="function"&&(!("description"in NativeSymbol.prototype)||NativeSymbol().description!==undefined)){var EmptyStringDescriptionStore={};var SymbolWrapper=function Symbol(){var description=arguments.length<1||arguments[0]===undefined?undefined:String(arguments[0]);var result=this instanceof SymbolWrapper?new NativeSymbol(description):description===undefined?NativeSymbol():NativeSymbol(description);if(description==="")EmptyStringDescriptionStore[result]=true;return result};copyConstructorProperties(SymbolWrapper,NativeSymbol);var symbolPrototype=SymbolWrapper.prototype=NativeSymbol.prototype;symbolPrototype.constructor=SymbolWrapper;var symbolToString=symbolPrototype.toString;var native=String(NativeSymbol("test"))=="Symbol(test)";var regexp=/^Symbol\((.*)\)[^)]+$/;defineProperty(symbolPrototype,"description",{configurable:true,get:function description(){var symbol=isObject(this)?this.valueOf():this;var string=symbolToString.call(symbol);if(has(EmptyStringDescriptionStore,symbol))return"";var desc=native?string.slice(7,-1):string.replace(regexp,"$1");return desc===""?undefined:desc}});$({global:true,forced:true},{Symbol:SymbolWrapper})}},function(module,exports,__webpack_require__){var defineWellKnownSymbol=__webpack_require__(57);defineWellKnownSymbol("iterator")},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var from=__webpack_require__(66);var checkCorrectnessOfIteration=__webpack_require__(74);var INCORRECT_ITERATION=!checkCorrectnessOfIteration((function(iterable){Array.from(iterable)}));$({target:"Array",stat:true,forced:INCORRECT_ITERATION},{from:from})},function(module,exports,__webpack_require__){"use strict";var bind=__webpack_require__(60);var toObject=__webpack_require__(49);var callWithSafeIterationClosing=__webpack_require__(67);var isArrayIteratorMethod=__webpack_require__(68);var toLength=__webpack_require__(40);var createProperty=__webpack_require__(70);var getIteratorMethod=__webpack_require__(71);module.exports=function from(arrayLike){var O=toObject(arrayLike);var C=typeof this=="function"?this:Array;var argumentsLength=arguments.length;var mapfn=argumentsLength>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iteratorMethod=getIteratorMethod(O);var index=0;var length,result,step,iterator,next,value;if(mapping)mapfn=bind(mapfn,argumentsLength>2?arguments[2]:undefined,2);if(iteratorMethod!=undefined&&!(C==Array&&isArrayIteratorMethod(iteratorMethod))){iterator=iteratorMethod.call(O);next=iterator.next;result=new C;for(;!(step=next.call(iterator)).done;index++){value=mapping?callWithSafeIterationClosing(iterator,mapfn,[step.value,index],true):step.value;createProperty(result,index,value)}}else{length=toLength(O.length);result=new C(length);for(;length>index;index++){value=mapping?mapfn(O[index],index):O[index];createProperty(result,index,value)}}result.length=index;return result}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(21);module.exports=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value)}catch(error){var returnMethod=iterator["return"];if(returnMethod!==undefined)anObject(returnMethod.call(iterator));throw error}}},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);var Iterators=__webpack_require__(69);var ITERATOR=wellKnownSymbol("iterator");var ArrayPrototype=Array.prototype;module.exports=function(it){return it!==undefined&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){"use strict";var toPrimitive=__webpack_require__(14);var definePropertyModule=__webpack_require__(20);var createPropertyDescriptor=__webpack_require__(9);module.exports=function(object,key,value){var propertyKey=toPrimitive(key);if(propertyKey in object)definePropertyModule.f(object,propertyKey,createPropertyDescriptor(0,value));else object[propertyKey]=value}},function(module,exports,__webpack_require__){var classof=__webpack_require__(72);var Iterators=__webpack_require__(69);var wellKnownSymbol=__webpack_require__(55);var ITERATOR=wellKnownSymbol("iterator");module.exports=function(it){if(it!=undefined)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports,__webpack_require__){var TO_STRING_TAG_SUPPORT=__webpack_require__(73);var classofRaw=__webpack_require__(12);var wellKnownSymbol=__webpack_require__(55);var TO_STRING_TAG=wellKnownSymbol("toStringTag");var CORRECT_ARGUMENTS=classofRaw(function(){return arguments}())=="Arguments";var tryGet=function(it,key){try{return it[key]}catch(error){}};module.exports=TO_STRING_TAG_SUPPORT?classofRaw:function(it){var O,tag,result;return it===undefined?"Undefined":it===null?"Null":typeof(tag=tryGet(O=Object(it),TO_STRING_TAG))=="string"?tag:CORRECT_ARGUMENTS?classofRaw(O):(result=classofRaw(O))=="Object"&&typeof O.callee=="function"?"Arguments":result}},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);var TO_STRING_TAG=wellKnownSymbol("toStringTag");var test={};test[TO_STRING_TAG]="z";module.exports=String(test)==="[object z]"},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);var ITERATOR=wellKnownSymbol("iterator");var SAFE_CLOSING=false;try{var called=0;var iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=true}};iteratorWithReturn[ITERATOR]=function(){return this};Array.from(iteratorWithReturn,(function(){throw 2}))}catch(error){}module.exports=function(exec,SKIP_CLOSING){if(!SKIP_CLOSING&&!SAFE_CLOSING)return false;var ITERATION_SUPPORT=false;try{var object={};object[ITERATOR]=function(){return{next:function(){return{done:ITERATION_SUPPORT=true}}}};exec(object)}catch(error){}return ITERATION_SUPPORT}},function(module,exports,__webpack_require__){"use strict";var toIndexedObject=__webpack_require__(10);var addToUnscopables=__webpack_require__(76);var Iterators=__webpack_require__(69);var InternalStateModule=__webpack_require__(26);var defineIterator=__webpack_require__(77);var ARRAY_ITERATOR="Array Iterator";var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(ARRAY_ITERATOR);module.exports=defineIterator(Array,"Array",(function(iterated,kind){setInternalState(this,{type:ARRAY_ITERATOR,target:toIndexedObject(iterated),index:0,kind:kind})}),(function(){var state=getInternalState(this);var target=state.target;var kind=state.kind;var index=state.index++;if(!target||index>=target.length){state.target=undefined;return{value:undefined,done:true}}if(kind=="keys")return{value:index,done:false};if(kind=="values")return{value:target[index],done:false};return{value:[index,target[index]],done:false}}),"values");Iterators.Arguments=Iterators.Array;addToUnscopables("keys");addToUnscopables("values");addToUnscopables("entries")},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);var create=__webpack_require__(50);var definePropertyModule=__webpack_require__(20);var UNSCOPABLES=wellKnownSymbol("unscopables");var ArrayPrototype=Array.prototype;if(ArrayPrototype[UNSCOPABLES]==undefined){definePropertyModule.f(ArrayPrototype,UNSCOPABLES,{configurable:true,value:create(null)})}module.exports=function(key){ArrayPrototype[UNSCOPABLES][key]=true}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var createIteratorConstructor=__webpack_require__(78);var getPrototypeOf=__webpack_require__(80);var setPrototypeOf=__webpack_require__(82);var setToStringTag=__webpack_require__(58);var createNonEnumerableProperty=__webpack_require__(19);var redefine=__webpack_require__(22);var wellKnownSymbol=__webpack_require__(55);var IS_PURE=__webpack_require__(30);var Iterators=__webpack_require__(69);var IteratorsCore=__webpack_require__(79);var IteratorPrototype=IteratorsCore.IteratorPrototype;var BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS;var ITERATOR=wellKnownSymbol("iterator");var KEYS="keys";var VALUES="values";var ENTRIES="entries";var returnThis=function(){return this};module.exports=function(Iterable,NAME,IteratorConstructor,next,DEFAULT,IS_SET,FORCED){createIteratorConstructor(IteratorConstructor,NAME,next);var getIterationMethod=function(KIND){if(KIND===DEFAULT&&defaultIterator)return defaultIterator;if(!BUGGY_SAFARI_ITERATORS&&KIND in IterablePrototype)return IterablePrototype[KIND];switch(KIND){case KEYS:return function keys(){return new IteratorConstructor(this,KIND)};case VALUES:return function values(){return new IteratorConstructor(this,KIND)};case ENTRIES:return function entries(){return new IteratorConstructor(this,KIND)}}return function(){return new IteratorConstructor(this)}};var TO_STRING_TAG=NAME+" Iterator";var INCORRECT_VALUES_NAME=false;var IterablePrototype=Iterable.prototype;var nativeIterator=IterablePrototype[ITERATOR]||IterablePrototype["@@iterator"]||DEFAULT&&IterablePrototype[DEFAULT];var defaultIterator=!BUGGY_SAFARI_ITERATORS&&nativeIterator||getIterationMethod(DEFAULT);var anyNativeIterator=NAME=="Array"?IterablePrototype.entries||nativeIterator:nativeIterator;var CurrentIteratorPrototype,methods,KEY;if(anyNativeIterator){CurrentIteratorPrototype=getPrototypeOf(anyNativeIterator.call(new Iterable));if(IteratorPrototype!==Object.prototype&&CurrentIteratorPrototype.next){if(!IS_PURE&&getPrototypeOf(CurrentIteratorPrototype)!==IteratorPrototype){if(setPrototypeOf){setPrototypeOf(CurrentIteratorPrototype,IteratorPrototype)}else if(typeof CurrentIteratorPrototype[ITERATOR]!="function"){createNonEnumerableProperty(CurrentIteratorPrototype,ITERATOR,returnThis)}}setToStringTag(CurrentIteratorPrototype,TO_STRING_TAG,true,true);if(IS_PURE)Iterators[TO_STRING_TAG]=returnThis}}if(DEFAULT==VALUES&&nativeIterator&&nativeIterator.name!==VALUES){INCORRECT_VALUES_NAME=true;defaultIterator=function values(){return nativeIterator.call(this)}}if((!IS_PURE||FORCED)&&IterablePrototype[ITERATOR]!==defaultIterator){createNonEnumerableProperty(IterablePrototype,ITERATOR,defaultIterator)}Iterators[NAME]=defaultIterator;if(DEFAULT){methods={values:getIterationMethod(VALUES),keys:IS_SET?defaultIterator:getIterationMethod(KEYS),entries:getIterationMethod(ENTRIES)};if(FORCED)for(KEY in methods){if(BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME||!(KEY in IterablePrototype)){redefine(IterablePrototype,KEY,methods[KEY])}}else $({target:NAME,proto:true,forced:BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME},methods)}return methods}},function(module,exports,__webpack_require__){"use strict";var IteratorPrototype=__webpack_require__(79).IteratorPrototype;var create=__webpack_require__(50);var createPropertyDescriptor=__webpack_require__(9);var setToStringTag=__webpack_require__(58);var Iterators=__webpack_require__(69);var returnThis=function(){return this};module.exports=function(IteratorConstructor,NAME,next){var TO_STRING_TAG=NAME+" Iterator";IteratorConstructor.prototype=create(IteratorPrototype,{next:createPropertyDescriptor(1,next)});setToStringTag(IteratorConstructor,TO_STRING_TAG,false,true);Iterators[TO_STRING_TAG]=returnThis;return IteratorConstructor}},function(module,exports,__webpack_require__){"use strict";var getPrototypeOf=__webpack_require__(80);var createNonEnumerableProperty=__webpack_require__(19);var has=__webpack_require__(16);var wellKnownSymbol=__webpack_require__(55);var IS_PURE=__webpack_require__(30);var ITERATOR=wellKnownSymbol("iterator");var BUGGY_SAFARI_ITERATORS=false;var returnThis=function(){return this};var IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;if([].keys){arrayIterator=[].keys();if(!("next"in arrayIterator))BUGGY_SAFARI_ITERATORS=true;else{PrototypeOfArrayIteratorPrototype=getPrototypeOf(getPrototypeOf(arrayIterator));if(PrototypeOfArrayIteratorPrototype!==Object.prototype)IteratorPrototype=PrototypeOfArrayIteratorPrototype}}if(IteratorPrototype==undefined)IteratorPrototype={};if(!IS_PURE&&!has(IteratorPrototype,ITERATOR)){createNonEnumerableProperty(IteratorPrototype,ITERATOR,returnThis)}module.exports={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS}},function(module,exports,__webpack_require__){var has=__webpack_require__(16);var toObject=__webpack_require__(49);var sharedKey=__webpack_require__(28);var CORRECT_PROTOTYPE_GETTER=__webpack_require__(81);var IE_PROTO=sharedKey("IE_PROTO");var ObjectPrototype=Object.prototype;module.exports=CORRECT_PROTOTYPE_GETTER?Object.getPrototypeOf:function(O){O=toObject(O);if(has(O,IE_PROTO))return O[IE_PROTO];if(typeof O.constructor=="function"&&O instanceof O.constructor){return O.constructor.prototype}return O instanceof Object?ObjectPrototype:null}},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);module.exports=!fails((function(){function F(){}F.prototype.constructor=null;return Object.getPrototypeOf(new F)!==F.prototype}))},function(module,exports,__webpack_require__){var anObject=__webpack_require__(21);var aPossiblePrototype=__webpack_require__(83);module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var CORRECT_SETTER=false;var test={};var setter;try{setter=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;setter.call(test,[]);CORRECT_SETTER=test instanceof Array}catch(error){}return function setPrototypeOf(O,proto){anObject(O);aPossiblePrototype(proto);if(CORRECT_SETTER)setter.call(O,proto);else O.__proto__=proto;return O}}():undefined)},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);module.exports=function(it){if(!isObject(it)&&it!==null){throw TypeError("Can't set "+String(it)+" as a prototype")}return it}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var isObject=__webpack_require__(15);var isArray=__webpack_require__(48);var toAbsoluteIndex=__webpack_require__(42);var toLength=__webpack_require__(40);var toIndexedObject=__webpack_require__(10);var createProperty=__webpack_require__(70);var wellKnownSymbol=__webpack_require__(55);var arrayMethodHasSpeciesSupport=__webpack_require__(85);var arrayMethodUsesToLength=__webpack_require__(88);var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("slice");var USES_TO_LENGTH=arrayMethodUsesToLength("slice",{ACCESSORS:true,0:0,1:2});var SPECIES=wellKnownSymbol("species");var nativeSlice=[].slice;var max=Math.max;$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{slice:function slice(start,end){var O=toIndexedObject(this);var length=toLength(O.length);var k=toAbsoluteIndex(start,length);var fin=toAbsoluteIndex(end===undefined?length:end,length);var Constructor,result,n;if(isArray(O)){Constructor=O.constructor;if(typeof Constructor=="function"&&(Constructor===Array||isArray(Constructor.prototype))){Constructor=undefined}else if(isObject(Constructor)){Constructor=Constructor[SPECIES];if(Constructor===null)Constructor=undefined}if(Constructor===Array||Constructor===undefined){return nativeSlice.call(O,k,fin)}}result=new(Constructor===undefined?Array:Constructor)(max(fin-k,0));for(n=0;k<fin;k++,n++)if(k in O)createProperty(result,n,O[k]);result.length=n;return result}})},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);var wellKnownSymbol=__webpack_require__(55);var V8_VERSION=__webpack_require__(86);var SPECIES=wellKnownSymbol("species");module.exports=function(METHOD_NAME){return V8_VERSION>=51||!fails((function(){var array=[];var constructor=array.constructor={};constructor[SPECIES]=function(){return{foo:1}};return array[METHOD_NAME](Boolean).foo!==1}))}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var userAgent=__webpack_require__(87);var process=global.process;var versions=process&&process.versions;var v8=versions&&versions.v8;var match,version;if(v8){match=v8.split(".");version=match[0]+match[1]}else if(userAgent){match=userAgent.match(/Edge\/(\d+)/);if(!match||match[1]>=74){match=userAgent.match(/Chrome\/(\d+)/);if(match)version=match[1]}}module.exports=version&&+version},function(module,exports,__webpack_require__){var getBuiltIn=__webpack_require__(35);module.exports=getBuiltIn("navigator","userAgent")||""},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var fails=__webpack_require__(7);var has=__webpack_require__(16);var defineProperty=Object.defineProperty;var cache={};var thrower=function(it){throw it};module.exports=function(METHOD_NAME,options){if(has(cache,METHOD_NAME))return cache[METHOD_NAME];if(!options)options={};var method=[][METHOD_NAME];var ACCESSORS=has(options,"ACCESSORS")?options.ACCESSORS:false;var argument0=has(options,0)?options[0]:thrower;var argument1=has(options,1)?options[1]:undefined;return cache[METHOD_NAME]=!!method&&!fails((function(){if(ACCESSORS&&!DESCRIPTORS)return true;var O={length:-1};if(ACCESSORS)defineProperty(O,1,{enumerable:true,get:thrower});else O[1]=1;method.call(O,argument0,argument1)}))}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var defineProperty=__webpack_require__(20).f;var FunctionPrototype=Function.prototype;var FunctionPrototypeToString=FunctionPrototype.toString;var nameRE=/^\s*function ([^ (]*)/;var NAME="name";if(DESCRIPTORS&&!(NAME in FunctionPrototype)){defineProperty(FunctionPrototype,NAME,{configurable:true,get:function(){try{return FunctionPrototypeToString.call(this).match(nameRE)[1]}catch(error){return""}}})}},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var fails=__webpack_require__(7);var nativeGetOwnPropertyNames=__webpack_require__(54).f;var FAILS_ON_PRIMITIVES=fails((function(){return!Object.getOwnPropertyNames(1)}));$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES},{getOwnPropertyNames:nativeGetOwnPropertyNames})},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var fails=__webpack_require__(7);var toObject=__webpack_require__(49);var nativeGetPrototypeOf=__webpack_require__(80);var CORRECT_PROTOTYPE_GETTER=__webpack_require__(81);var FAILS_ON_PRIMITIVES=fails((function(){nativeGetPrototypeOf(1)}));$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES,sham:!CORRECT_PROTOTYPE_GETTER},{getPrototypeOf:function getPrototypeOf(it){return nativeGetPrototypeOf(toObject(it))}})},function(module,exports,__webpack_require__){var TO_STRING_TAG_SUPPORT=__webpack_require__(73);var redefine=__webpack_require__(22);var toString=__webpack_require__(93);if(!TO_STRING_TAG_SUPPORT){redefine(Object.prototype,"toString",toString,{unsafe:true})}},function(module,exports,__webpack_require__){"use strict";var TO_STRING_TAG_SUPPORT=__webpack_require__(73);var classof=__webpack_require__(72);module.exports=TO_STRING_TAG_SUPPORT?{}.toString:function toString(){return"[object "+classof(this)+"]"}},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var getBuiltIn=__webpack_require__(35);var aFunction=__webpack_require__(61);var anObject=__webpack_require__(21);var isObject=__webpack_require__(15);var create=__webpack_require__(50);var bind=__webpack_require__(95);var fails=__webpack_require__(7);var nativeConstruct=getBuiltIn("Reflect","construct");var NEW_TARGET_BUG=fails((function(){function F(){}return!(nativeConstruct((function(){}),[],F)instanceof F)}));var ARGS_BUG=!fails((function(){nativeConstruct((function(){}))}));var FORCED=NEW_TARGET_BUG||ARGS_BUG;$({target:"Reflect",stat:true,forced:FORCED,sham:FORCED},{construct:function construct(Target,args){aFunction(Target);anObject(args);var newTarget=arguments.length<3?Target:aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(Target,args,newTarget);if(Target==newTarget){switch(args.length){case 0:return new Target;case 1:return new Target(args[0]);case 2:return new Target(args[0],args[1]);case 3:return new Target(args[0],args[1],args[2]);case 4:return new Target(args[0],args[1],args[2],args[3])}var $args=[null];$args.push.apply($args,args);return new(bind.apply(Target,$args))}var proto=newTarget.prototype;var instance=create(isObject(proto)?proto:Object.prototype);var result=Function.apply.call(Target,instance,args);return isObject(result)?result:instance}})},function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(61);var isObject=__webpack_require__(15);var slice=[].slice;var factories={};var construct=function(C,argsLength,args){if(!(argsLength in factories)){for(var list=[],i=0;i<argsLength;i++)list[i]="a["+i+"]";factories[argsLength]=Function("C,a","return new C("+list.join(",")+")")}return factories[argsLength](C,args)};module.exports=Function.bind||function bind(that){var fn=aFunction(this);var partArgs=slice.call(arguments,1);var boundFunction=function bound(){var args=partArgs.concat(slice.call(arguments));return this instanceof boundFunction?construct(fn,args.length,args):fn.apply(that,args)};if(isObject(fn.prototype))boundFunction.prototype=fn.prototype;return boundFunction}},function(module,exports,__webpack_require__){"use strict";var redefine=__webpack_require__(22);var anObject=__webpack_require__(21);var fails=__webpack_require__(7);var flags=__webpack_require__(97);var TO_STRING="toString";var RegExpPrototype=RegExp.prototype;var nativeToString=RegExpPrototype[TO_STRING];var NOT_GENERIC=fails((function(){return nativeToString.call({source:"a",flags:"b"})!="/a/b"}));var INCORRECT_NAME=nativeToString.name!=TO_STRING;if(NOT_GENERIC||INCORRECT_NAME){redefine(RegExp.prototype,TO_STRING,(function toString(){var R=anObject(this);var p=String(R.source);var rf=R.flags;var f=String(rf===undefined&&R instanceof RegExp&&!("flags"in RegExpPrototype)?flags.call(R):rf);return"/"+p+"/"+f}),{unsafe:true})}},function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(21);module.exports=function(){var that=anObject(this);var result="";if(that.global)result+="g";if(that.ignoreCase)result+="i";if(that.multiline)result+="m";if(that.dotAll)result+="s";if(that.unicode)result+="u";if(that.sticky)result+="y";return result}},function(module,exports,__webpack_require__){"use strict";var charAt=__webpack_require__(99).charAt;var InternalStateModule=__webpack_require__(26);var defineIterator=__webpack_require__(77);var STRING_ITERATOR="String Iterator";var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(STRING_ITERATOR);defineIterator(String,"String",(function(iterated){setInternalState(this,{type:STRING_ITERATOR,string:String(iterated),index:0})}),(function next(){var state=getInternalState(this);var string=state.string;var index=state.index;var point;if(index>=string.length)return{value:undefined,done:true};point=charAt(string,index);state.index+=point.length;return{value:point,done:false}}))},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(41);var requireObjectCoercible=__webpack_require__(13);var createMethod=function(CONVERT_TO_STRING){return function($this,pos){var S=String(requireObjectCoercible($this));var position=toInteger(pos);var size=S.length;var first,second;if(position<0||position>=size)return CONVERT_TO_STRING?"":undefined;first=S.charCodeAt(position);return first<55296||first>56319||position+1===size||(second=S.charCodeAt(position+1))<56320||second>57343?CONVERT_TO_STRING?S.charAt(position):first:CONVERT_TO_STRING?S.slice(position,position+2):(first-55296<<10)+(second-56320)+65536}};module.exports={codeAt:createMethod(false),charAt:createMethod(true)}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var getOwnPropertyDescriptor=__webpack_require__(5).f;var toLength=__webpack_require__(40);var notARegExp=__webpack_require__(101);var requireObjectCoercible=__webpack_require__(13);var correctIsRegExpLogic=__webpack_require__(103);var IS_PURE=__webpack_require__(30);var nativeStartsWith="".startsWith;var min=Math.min;var CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("startsWith");var MDN_POLYFILL_BUG=!IS_PURE&&!CORRECT_IS_REGEXP_LOGIC&&!!function(){var descriptor=getOwnPropertyDescriptor(String.prototype,"startsWith");return descriptor&&!descriptor.writable}();$({target:"String",proto:true,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function startsWith(searchString){var that=String(requireObjectCoercible(this));notARegExp(searchString);var index=toLength(min(arguments.length>1?arguments[1]:undefined,that.length));var search=String(searchString);return nativeStartsWith?nativeStartsWith.call(that,search,index):that.slice(index,index+search.length)===search}})},function(module,exports,__webpack_require__){var isRegExp=__webpack_require__(102);module.exports=function(it){if(isRegExp(it)){throw TypeError("The method doesn't accept regular expressions")}return it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);var classof=__webpack_require__(12);var wellKnownSymbol=__webpack_require__(55);var MATCH=wellKnownSymbol("match");module.exports=function(it){var isRegExp;return isObject(it)&&((isRegExp=it[MATCH])!==undefined?!!isRegExp:classof(it)=="RegExp")}},function(module,exports,__webpack_require__){var wellKnownSymbol=__webpack_require__(55);var MATCH=wellKnownSymbol("match");module.exports=function(METHOD_NAME){var regexp=/./;try{"/./"[METHOD_NAME](regexp)}catch(e){try{regexp[MATCH]=false;return"/./"[METHOD_NAME](regexp)}catch(f){}}return false}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var DOMIterables=__webpack_require__(105);var ArrayIteratorMethods=__webpack_require__(75);var createNonEnumerableProperty=__webpack_require__(19);var wellKnownSymbol=__webpack_require__(55);var ITERATOR=wellKnownSymbol("iterator");var TO_STRING_TAG=wellKnownSymbol("toStringTag");var ArrayValues=ArrayIteratorMethods.values;for(var COLLECTION_NAME in DOMIterables){var Collection=global[COLLECTION_NAME];var CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR]!==ArrayValues)try{createNonEnumerableProperty(CollectionPrototype,ITERATOR,ArrayValues)}catch(error){CollectionPrototype[ITERATOR]=ArrayValues}if(!CollectionPrototype[TO_STRING_TAG]){createNonEnumerableProperty(CollectionPrototype,TO_STRING_TAG,COLLECTION_NAME)}if(DOMIterables[COLLECTION_NAME])for(var METHOD_NAME in ArrayIteratorMethods){if(CollectionPrototype[METHOD_NAME]!==ArrayIteratorMethods[METHOD_NAME])try{createNonEnumerableProperty(CollectionPrototype,METHOD_NAME,ArrayIteratorMethods[METHOD_NAME])}catch(error){CollectionPrototype[METHOD_NAME]=ArrayIteratorMethods[METHOD_NAME]}}}}},function(module,exports){module.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.absoluteSheetReference=exports.movedSimpleCellAddress=exports.invalidSimpleCellAddress=exports.simpleCellAddress=exports.simpleColumnAddress=exports.simpleRowAddress=exports.CellError=exports.getCellValueType=exports.CellValueTypeOrd=exports.CellValueType=exports.getCellType=exports.CellType=exports.EmptyValue=exports.ErrorType=void 0;var _DependencyGraph=__webpack_require__(107);var _InterpreterValue=__webpack_require__(203);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var ErrorType;exports.ErrorType=ErrorType;(function(ErrorType){ErrorType["DIV_BY_ZERO"]="DIV_BY_ZERO";ErrorType["NAME"]="NAME";ErrorType["VALUE"]="VALUE";ErrorType["NUM"]="NUM";ErrorType["NA"]="NA";ErrorType["CYCLE"]="CYCLE";ErrorType["REF"]="REF";ErrorType["ERROR"]="ERROR"})(ErrorType||(exports.ErrorType=ErrorType={}));var EmptyValue=Symbol("Empty value");exports.EmptyValue=EmptyValue;var CellType;exports.CellType=CellType;(function(CellType){CellType["FORMULA"]="FORMULA";CellType["VALUE"]="VALUE";CellType["MATRIX"]="MATRIX";CellType["EMPTY"]="EMPTY"})(CellType||(exports.CellType=CellType={}));var getCellType=function getCellType(vertex){if(vertex instanceof _DependencyGraph.FormulaCellVertex||vertex instanceof _DependencyGraph.ParsingErrorVertex){return CellType.FORMULA}if(vertex instanceof _DependencyGraph.ValueCellVertex||vertex instanceof _DependencyGraph.MatrixVertex&&vertex.isNumeric()){return CellType.VALUE}if(vertex instanceof _DependencyGraph.MatrixVertex&&vertex.isFormula()){return CellType.MATRIX}return CellType.EMPTY};exports.getCellType=getCellType;var CellValueType;exports.CellValueType=CellValueType;(function(CellValueType){CellValueType["EMPTY"]="EMPTY";CellValueType["NUMBER"]="NUMBER";CellValueType["STRING"]="STRING";CellValueType["BOOLEAN"]="BOOLEAN";CellValueType["ERROR"]="ERROR"})(CellValueType||(exports.CellValueType=CellValueType={}));var CellValueTypeOrd=function CellValueTypeOrd(arg){switch(arg){case CellValueType.EMPTY:return 0;case CellValueType.NUMBER:return 1;case CellValueType.STRING:return 2;case CellValueType.BOOLEAN:return 3;case CellValueType.ERROR:return 4}};exports.CellValueTypeOrd=CellValueTypeOrd;var getCellValueType=function getCellValueType(cellValue){if(cellValue===EmptyValue){return CellValueType.EMPTY}if(cellValue instanceof CellError||cellValue instanceof _InterpreterValue.SimpleRangeValue){return CellValueType.ERROR}switch(_typeof(cellValue)){case"string":return CellValueType.STRING;case"number":return CellValueType.NUMBER;case"boolean":return CellValueType.BOOLEAN}throw new Error("Cell value not computed")};exports.getCellValueType=getCellValueType;var CellError=function(){function CellError(type,message){_classCallCheck(this,CellError);this.type=type;this.message=message}_createClass(CellError,null,[{key:"parsingError",value:function parsingError(){return new CellError(ErrorType.ERROR,"Parsing error")}}]);return CellError}();exports.CellError=CellError;var simpleRowAddress=function simpleRowAddress(sheet,row){return{sheet:sheet,row:row}};exports.simpleRowAddress=simpleRowAddress;var simpleColumnAddress=function simpleColumnAddress(sheet,col){return{sheet:sheet,col:col}};exports.simpleColumnAddress=simpleColumnAddress;var simpleCellAddress=function simpleCellAddress(sheet,col,row){return{sheet:sheet,col:col,row:row}};exports.simpleCellAddress=simpleCellAddress;var invalidSimpleCellAddress=function invalidSimpleCellAddress(address){return address.col<0||address.row<0};exports.invalidSimpleCellAddress=invalidSimpleCellAddress;var movedSimpleCellAddress=function movedSimpleCellAddress(address,toSheet,toRight,toBottom){return simpleCellAddress(toSheet,address.col+toRight,address.row+toBottom)};exports.movedSimpleCellAddress=movedSimpleCellAddress;var absoluteSheetReference=function absoluteSheetReference(address,baseAddress){return address.sheet===null?baseAddress.sheet:address.sheet};exports.absoluteSheetReference=absoluteSheetReference},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.DenseStrategy=exports.SparseStrategy=exports.RangeVertex=exports.ParsingErrorVertex=exports.ValueCellVertex=exports.EmptyCellVertex=exports.FormulaCellVertex=exports.MatrixVertex=exports.MatrixMapping=exports.SheetMapping=exports.RangeMapping=exports.Graph=exports.AddressMapping=exports.DependencyGraph=void 0;var _DependencyGraph=__webpack_require__(108);exports.DependencyGraph=_DependencyGraph.DependencyGraph;var _AddressMapping=__webpack_require__(180);exports.AddressMapping=_AddressMapping.AddressMapping;var _Graph=__webpack_require__(192);exports.Graph=_Graph.Graph;var _RangeMapping=__webpack_require__(195);exports.RangeMapping=_RangeMapping.RangeMapping;var _SheetMapping=__webpack_require__(197);exports.SheetMapping=_SheetMapping.SheetMapping;var _MatrixMapping=__webpack_require__(194);exports.MatrixMapping=_MatrixMapping.MatrixMapping;var _MatrixVertex=__webpack_require__(188);exports.MatrixVertex=_MatrixVertex.MatrixVertex;var _FormulaCellVertex=__webpack_require__(187);exports.FormulaCellVertex=_FormulaCellVertex.FormulaCellVertex;var _EmptyCellVertex=__webpack_require__(204);exports.EmptyCellVertex=_EmptyCellVertex.EmptyCellVertex;var _ValueCellVertex=__webpack_require__(205);exports.ValueCellVertex=_ValueCellVertex.ValueCellVertex;var _ParsingErrorVertex=__webpack_require__(206);exports.ParsingErrorVertex=_ParsingErrorVertex.ParsingErrorVertex;var _RangeVertex=__webpack_require__(191);exports.RangeVertex=_RangeVertex.RangeVertex;var _SparseStrategy=__webpack_require__(207);exports.SparseStrategy=_SparseStrategy.SparseStrategy;var _DenseStrategy=__webpack_require__(208);exports.DenseStrategy=_DenseStrategy.DenseStrategy},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(114);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.DependencyGraph=void 0;__webpack_require__(125);var _assert=_interopRequireDefault(__webpack_require__(126));var _AbsoluteCellRange=__webpack_require__(132);var _absolutizeDependencies=__webpack_require__(175);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _Span=__webpack_require__(174);var _statistics=__webpack_require__(176);var _2=__webpack_require__(107);var _AddressMapping=__webpack_require__(180);var _collectAddressesDependentToMatrix=__webpack_require__(185);var _Graph=__webpack_require__(192);var _MatrixMapping=__webpack_require__(194);var _RangeMapping=__webpack_require__(195);var _SheetMapping=__webpack_require__(197);var _InterpreterValue=__webpack_require__(203);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var DependencyGraph=function(){function DependencyGraph(addressMapping,rangeMapping,sheetMapping,matrixMapping,stats,lazilyTransformingAstService,functionRegistry,namedExpressions){var _this=this;_classCallCheck(this,DependencyGraph);this.addressMapping=addressMapping;this.rangeMapping=rangeMapping;this.sheetMapping=sheetMapping;this.matrixMapping=matrixMapping;this.stats=stats;this.lazilyTransformingAstService=lazilyTransformingAstService;this.functionRegistry=functionRegistry;this.namedExpressions=namedExpressions;this.dependencyQuery=function(vertex){var formula;var address;if(vertex instanceof _2.FormulaCellVertex){address=vertex.getAddress(_this.lazilyTransformingAstService);formula=vertex.getFormula(_this.lazilyTransformingAstService)}else if(vertex instanceof _2.MatrixVertex&&vertex.isFormula()){address=vertex.getAddress();formula=vertex.getFormula()}else if(vertex instanceof _2.RangeVertex){var allDeps=new Set;var _this$rangeMapping$fi=_this.rangeMapping.findSmallerRange(vertex.range),smallerRangeVertex=_this$rangeMapping$fi.smallerRangeVertex,restRange=_this$rangeMapping$fi.restRange;var range;if(smallerRangeVertex!==null&&_this.graph.adjacentNodes(smallerRangeVertex).has(vertex)){range=restRange;allDeps.add(smallerRangeVertex)}else{range=vertex.range}var _iterator=_createForOfIteratorHelper(range.addresses(_this)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _address=_step.value;var cell=_this.addressMapping.getCell(_address);if(cell instanceof _2.EmptyCellVertex){cell.address=_address}if(cell!==null){allDeps.add(cell)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return allDeps}else{return null}var deps=(0,_parser.collectDependencies)(formula,_this.functionRegistry);var absoluteDeps=(0,_absolutizeDependencies.absolutizeDependencies)(deps,address);return new Set(absoluteDeps.map((function(dep){if(dep instanceof _AbsoluteCellRange.AbsoluteCellRange){return _this.rangeMapping.fetchRange(dep.start,dep.end)}else if(dep instanceof _parser.NamedExpressionDependency){var namedExpression=_this.namedExpressions.namedExpressionOrPlaceholder(dep.name,address.sheet);return _this.addressMapping.fetchCell(namedExpression.address)}else{return _this.addressMapping.fetchCell(dep)}})))};this.graph=new _Graph.Graph(this.dependencyQuery)}_createClass(DependencyGraph,[{key:"setFormulaToCell",value:function setFormulaToCell(address,ast,dependencies,hasVolatileFunction,hasStructuralChangeFunction){var vertex=this.addressMapping.getCell(address);this.ensureThatVertexIsNonMatrixCellVertex(vertex);var newVertex=new _2.FormulaCellVertex(ast,address,this.lazilyTransformingAstService.version());this.exchangeOrAddGraphNode(vertex,newVertex);this.addressMapping.setCell(address,newVertex);this.processCellDependencies(dependencies,newVertex);this.graph.markNodeAsSpecialRecentlyChanged(newVertex);if(hasVolatileFunction){this.markAsVolatile(newVertex)}if(hasStructuralChangeFunction){this.markAsDependentOnStructureChange(newVertex)}this.correctInfiniteRangesDependency(address)}},{key:"setParsingErrorToCell",value:function setParsingErrorToCell(address,errorVertex){var vertex=this.addressMapping.getCell(address);this.ensureThatVertexIsNonMatrixCellVertex(vertex);this.exchangeOrAddGraphNode(vertex,errorVertex);this.addressMapping.setCell(address,errorVertex);this.graph.markNodeAsSpecialRecentlyChanged(errorVertex);this.correctInfiniteRangesDependency(address)}},{key:"setValueToCell",value:function setValueToCell(address,newValue){var vertex=this.addressMapping.getCell(address);this.ensureThatVertexIsNonMatrixCellVertex(vertex);if(vertex instanceof _2.ValueCellVertex){var oldValue=vertex.getCellValue();if(oldValue!==newValue){vertex.setCellValue(newValue);this.graph.markNodeAsSpecialRecentlyChanged(vertex)}}else{var newVertex=new _2.ValueCellVertex(newValue);this.exchangeOrAddGraphNode(vertex,newVertex);this.addressMapping.setCell(address,newVertex);this.graph.markNodeAsSpecialRecentlyChanged(newVertex)}this.correctInfiniteRangesDependency(address)}},{key:"setCellEmpty",value:function setCellEmpty(address){var vertex=this.addressMapping.getCell(address);if(vertex===null){return}this.ensureThatVertexIsNonMatrixCellVertex(vertex);if(this.graph.adjacentNodes(vertex).size>0){var emptyVertex=new _2.EmptyCellVertex(address);this.exchangeGraphNode(vertex,emptyVertex);if(this.graph.adjacentNodesCount(emptyVertex)===0){this.removeVertex(emptyVertex);this.addressMapping.removeCell(address)}else{this.graph.markNodeAsSpecialRecentlyChanged(emptyVertex);this.addressMapping.setCell(address,emptyVertex)}}else{this.removeVertex(vertex);this.addressMapping.removeCell(address)}}},{key:"ensureThatVertexIsNonMatrixCellVertex",value:function ensureThatVertexIsNonMatrixCellVertex(vertex){_assert.default.ok(!(vertex instanceof _2.MatrixVertex),"Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function verticesToRecompute(){return new Set([].concat(_toConsumableArray(this.graph.specialNodesRecentlyChanged),_toConsumableArray(this.volatileVertices())))}},{key:"processCellDependencies",value:function processCellDependencies(cellDependencies,endVertex){var _this2=this;cellDependencies.forEach((function(dep){if(dep instanceof _AbsoluteCellRange.AbsoluteCellRange){var range=dep;var rangeVertex=_this2.getRange(range.start,range.end);if(rangeVertex===undefined){rangeVertex=new _2.RangeVertex(range);_this2.rangeMapping.setRange(rangeVertex)}_this2.graph.addNode(rangeVertex);if(!range.isFinite()){_this2.graph.markNodeAsInfiniteRange(rangeVertex)}var _this2$rangeMapping$f=_this2.rangeMapping.findSmallerRange(range),smallerRangeVertex=_this2$rangeMapping$f.smallerRangeVertex,restRange=_this2$rangeMapping$f.restRange;if(smallerRangeVertex){_this2.graph.addEdge(smallerRangeVertex,rangeVertex);if(rangeVertex.bruteForce){rangeVertex.bruteForce=false;var _iterator2=_createForOfIteratorHelper(range.addresses(_this2)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var cellFromRange=_step2.value;_this2.graph.removeEdge(_this2.fetchCell(cellFromRange),rangeVertex)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}else{rangeVertex.bruteForce=true}var matrix=_this2.matrixMapping.getMatrix(restRange);if(matrix!==undefined){_this2.graph.addEdge(matrix,rangeVertex)}else{var _iterator3=_createForOfIteratorHelper(restRange.addresses(_this2)),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _cellFromRange=_step3.value;_this2.graph.addEdge(_this2.fetchCellOrCreateEmpty(_cellFromRange),rangeVertex)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}_this2.graph.addEdge(rangeVertex,endVertex);if(range.isFinite()){_this2.correctInfiniteRangesDependenciesByRangeVertex(rangeVertex)}}else if(dep instanceof _parser.NamedExpressionDependency){var sheetOfVertex=endVertex.getAddress(_this2.lazilyTransformingAstService).sheet;var namedExpressionVertex=_this2.fetchNamedExpressionVertex(dep.name,sheetOfVertex);_this2.graph.addEdge(namedExpressionVertex,endVertex)}else{_this2.graph.addEdge(_this2.fetchCellOrCreateEmpty(dep),endVertex)}}))}},{key:"fetchNamedExpressionVertex",value:function fetchNamedExpressionVertex(expressionName,sheetId){var namedExpression=this.namedExpressions.namedExpressionOrPlaceholder(expressionName,sheetId);return this.fetchCellOrCreateEmpty(namedExpression.address)}},{key:"exchangeNode",value:function exchangeNode(addressFrom,addressTo){var vertexFrom=this.fetchCellOrCreateEmpty(addressFrom);var vertexTo=this.fetchCellOrCreateEmpty(addressTo);this.addressMapping.removeCell(addressFrom);this.exchangeGraphNode(vertexFrom,vertexTo)}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function correctInfiniteRangesDependenciesByRangeVertex(vertex){var _iterator4=_createForOfIteratorHelper(this.graph.infiniteRanges),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var range=_step4.value;var infiniteRangeVertex=range;var intersection=vertex.range.intersectionWith(infiniteRangeVertex.range);if(intersection===null){continue}var _iterator5=_createForOfIteratorHelper(intersection.addresses(this)),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var address=_step5.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(address),range)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"correctInfiniteRangesDependency",value:function correctInfiniteRangesDependency(address){var vertex=null;var _iterator6=_createForOfIteratorHelper(this.graph.infiniteRanges),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var range=_step6.value;var infiniteRangeVertex=range;if(infiniteRangeVertex.range.addressInRange(address)){vertex=vertex||this.fetchCellOrCreateEmpty(address);this.graph.addEdge(vertex,infiniteRangeVertex)}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}},{key:"fetchCellOrCreateEmpty",value:function fetchCellOrCreateEmpty(address){var vertex=this.addressMapping.getCell(address);if(!vertex){vertex=new _2.EmptyCellVertex(address);this.graph.addNode(vertex);this.addressMapping.setCell(address,vertex)}return vertex}},{key:"removeRows",value:function removeRows(removedRows){var _this3=this;if(this.matrixMapping.isFormulaMatrixInRows(removedRows)){throw Error("It is not possible to remove row with matrix")}this.stats.measure(_statistics.StatType.ADJUSTING_GRAPH,(function(){var _iterator7=_createForOfIteratorHelper(_this3.addressMapping.verticesFromRowsSpan(removedRows)),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var vertex=_step7.value;var _iterator8=_createForOfIteratorHelper(_this3.graph.adjacentNodes(vertex)),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var adjacentNode=_step8.value;_this3.graph.markNodeAsSpecialRecentlyChanged(adjacentNode)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}if(vertex instanceof _2.MatrixVertex){continue}_this3.removeVertex(vertex)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}));this.stats.measure(_statistics.StatType.ADJUSTING_MATRIX_MAPPING,(function(){_this3.truncateMatricesAfterRemovingRows(removedRows)}));this.stats.measure(_statistics.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){_this3.addressMapping.removeRows(removedRows)}));this.stats.measure(_statistics.StatType.ADJUSTING_RANGES,(function(){_this3.truncateRanges(removedRows,(function(address){return address.row}))}));this.addStructuralNodesToChangeSet()}},{key:"removeSheet",value:function removeSheet(removedSheetId){var _this4=this;var matrices=new Set;var _iterator9=_createForOfIteratorHelper(this.addressMapping.sheetEntries(removedSheetId)),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _step9$value=_slicedToArray(_step9.value,2),adr=_step9$value[0],vertex=_step9$value[1];if(vertex instanceof _2.MatrixVertex){if(matrices.has(vertex)){continue}else{matrices.add(vertex)}}var _iterator12=_createForOfIteratorHelper(this.graph.adjacentNodes(vertex)),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var adjacentNode=_step12.value;this.graph.markNodeAsSpecialRecentlyChanged(adjacentNode)}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}this.removeVertex(vertex);this.addressMapping.removeCell(adr)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}this.stats.measure(_statistics.StatType.ADJUSTING_MATRIX_MAPPING,(function(){var _iterator10=_createForOfIteratorHelper(matrices.values()),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var matrix=_step10.value;_this4.matrixMapping.removeMatrix(matrix.getRange())}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}));this.stats.measure(_statistics.StatType.ADJUSTING_RANGES,(function(){var rangesToRemove=_this4.rangeMapping.removeRangesInSheet(removedSheetId);var _iterator11=_createForOfIteratorHelper(rangesToRemove),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var range=_step11.value;_this4.removeVertex(range)}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}_this4.stats.measure(_statistics.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){_this4.addressMapping.removeSheet(removedSheetId)}))}));this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function clearSheet(sheetId){var matrices=new Set;var _iterator13=_createForOfIteratorHelper(this.addressMapping.sheetEntries(sheetId)),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var _step13$value=_slicedToArray(_step13.value,2),address=_step13$value[0],vertex=_step13$value[1];if(vertex instanceof _2.MatrixVertex){matrices.add(vertex)}else{this.setCellEmpty(address)}}}catch(err){_iterator13.e(err)}finally{_iterator13.f()}var _iterator14=_createForOfIteratorHelper(matrices.values()),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var matrix=_step14.value;this.setMatrixEmpty(matrix)}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function removeColumns(removedColumns){var _this5=this;if(this.matrixMapping.isFormulaMatrixInColumns(removedColumns)){throw Error("It is not possible to remove column within matrix")}this.stats.measure(_statistics.StatType.ADJUSTING_GRAPH,(function(){var _iterator15=_createForOfIteratorHelper(_this5.addressMapping.verticesFromColumnsSpan(removedColumns)),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var vertex=_step15.value;var _iterator16=_createForOfIteratorHelper(_this5.graph.adjacentNodes(vertex)),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var adjacentNode=_step16.value;_this5.graph.markNodeAsSpecialRecentlyChanged(adjacentNode)}}catch(err){_iterator16.e(err)}finally{_iterator16.f()}if(vertex instanceof _2.MatrixVertex){continue}_this5.removeVertex(vertex)}}catch(err){_iterator15.e(err)}finally{_iterator15.f()}}));this.stats.measure(_statistics.StatType.ADJUSTING_MATRIX_MAPPING,(function(){_this5.truncateMatricesAfterRemovingColumns(removedColumns)}));this.stats.measure(_statistics.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){_this5.addressMapping.removeColumns(removedColumns)}));this.stats.measure(_statistics.StatType.ADJUSTING_RANGES,(function(){_this5.truncateRanges(removedColumns,(function(address){return address.col}))}));this.addStructuralNodesToChangeSet()}},{key:"addRows",value:function addRows(addedRows){var _this6=this;this.stats.measure(_statistics.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){_this6.addressMapping.addRows(addedRows.sheet,addedRows.rowStart,addedRows.numberOfRows)}));this.stats.measure(_statistics.StatType.ADJUSTING_MATRIX_MAPPING,(function(){_this6.expandMatricesAfterAddingRows(addedRows.sheet,addedRows.rowStart,addedRows.numberOfRows)}));this.stats.measure(_statistics.StatType.ADJUSTING_RANGES,(function(){_this6.rangeMapping.moveAllRangesInSheetAfterRowByRows(addedRows.sheet,addedRows.rowStart,addedRows.numberOfRows);_this6.fixRangesWhenAddingRows(addedRows.sheet,addedRows.rowStart,addedRows.numberOfRows)}));var _iterator17=_createForOfIteratorHelper(this.addressMapping.verticesFromRowsSpan(addedRows)),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var vertex=_step17.value;this.graph.markNodeAsSpecialRecentlyChanged(vertex)}}catch(err){_iterator17.e(err)}finally{_iterator17.f()}this.addStructuralNodesToChangeSet()}},{key:"addColumns",value:function addColumns(addedColumns){var _this7=this;this.stats.measure(_statistics.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){_this7.addressMapping.addColumns(addedColumns.sheet,addedColumns.columnStart,addedColumns.numberOfColumns)}));this.stats.measure(_statistics.StatType.ADJUSTING_MATRIX_MAPPING,(function(){_this7.expandMatricesAfterAddingColumns(addedColumns.sheet,addedColumns.columnStart,addedColumns.numberOfColumns)}));this.stats.measure(_statistics.StatType.ADJUSTING_RANGES,(function(){_this7.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(addedColumns.sheet,addedColumns.columnStart,addedColumns.numberOfColumns);_this7.fixRangesWhenAddingColumns(addedColumns.sheet,addedColumns.columnStart,addedColumns.numberOfColumns)}));var _iterator18=_createForOfIteratorHelper(this.addressMapping.verticesFromColumnsSpan(addedColumns)),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var vertex=_step18.value;this.graph.markNodeAsSpecialRecentlyChanged(vertex)}}catch(err){_iterator18.e(err)}finally{_iterator18.f()}this.addStructuralNodesToChangeSet()}},{key:"ensureNoMatrixInRange",value:function ensureNoMatrixInRange(range){if(this.matrixMapping.isFormulaMatrixInRange(range)){throw Error("It is not possible to move / replace cells with matrix")}}},{key:"moveCells",value:function moveCells(sourceRange,toRight,toBottom,toSheet){var _iterator19=_createForOfIteratorHelper(sourceRange.addressesWithDirection(toRight,toBottom,this)),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var sourceAddress=_step19.value;var targetAddress=(0,_Cell.simpleCellAddress)(toSheet,sourceAddress.col+toRight,sourceAddress.row+toBottom);var sourceVertex=this.addressMapping.getCell(sourceAddress);var targetVertex=this.addressMapping.getCell(targetAddress);this.addressMapping.removeCell(sourceAddress);if(sourceVertex!==null){this.graph.markNodeAsSpecialRecentlyChanged(sourceVertex);this.addressMapping.setCell(targetAddress,sourceVertex);var emptyVertex=null;var _iterator21=_createForOfIteratorHelper(this.graph.adjacentNodes(sourceVertex)),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var adjacentNode=_step21.value;if(adjacentNode instanceof _2.RangeVertex&&!sourceRange.containsRange(adjacentNode.range)){emptyVertex=emptyVertex||this.fetchCellOrCreateEmpty(sourceAddress);this.graph.addEdge(emptyVertex,adjacentNode);this.graph.removeEdge(sourceVertex,adjacentNode)}}}catch(err){_iterator21.e(err)}finally{_iterator21.f()}if(emptyVertex){this.graph.markNodeAsSpecialRecentlyChanged(emptyVertex);this.addressMapping.setCell(sourceAddress,emptyVertex)}}if(targetVertex!==null){if(sourceVertex===null){this.addressMapping.removeCell(targetAddress)}var _iterator22=_createForOfIteratorHelper(this.graph.adjacentNodes(targetVertex)),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var _adjacentNode=_step22.value;if(_adjacentNode!==sourceVertex){sourceVertex=sourceVertex||this.fetchCellOrCreateEmpty(targetAddress);this.graph.addEdge(sourceVertex,_adjacentNode);this.graph.markNodeAsSpecialRecentlyChanged(sourceVertex)}}}catch(err){_iterator22.e(err)}finally{_iterator22.f()}this.removeVertex(targetVertex)}}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}var _iterator20=_createForOfIteratorHelper(this.rangeMapping.rangeVerticesContainedInRange(sourceRange)),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var rangeVertex=_step20.value;var _iterator23=_createForOfIteratorHelper(this.graph.adjacentNodes(rangeVertex)),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var _adjacentNode2=_step23.value;if(_adjacentNode2 instanceof _2.RangeVertex&&!sourceRange.containsRange(_adjacentNode2.range)){this.graph.removeEdge(rangeVertex,_adjacentNode2);var _iterator24=_createForOfIteratorHelper(rangeVertex.range.addresses(this)),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var address=_step24.value;var newEmptyVertex=this.fetchCellOrCreateEmpty(address);this.graph.addEdge(newEmptyVertex,_adjacentNode2);this.addressMapping.setCell(address,newEmptyVertex);this.graph.markNodeAsSpecialRecentlyChanged(newEmptyVertex)}}catch(err){_iterator24.e(err)}finally{_iterator24.f()}}}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}this.rangeMapping.moveRangesInsideSourceRange(sourceRange,toRight,toBottom,toSheet)}},{key:"disableNumericMatrices",value:function disableNumericMatrices(){var _iterator25=_createForOfIteratorHelper(this.matrixMapping.numericMatrices()),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var _step25$value=_slicedToArray(_step25.value,2),_=_step25$value[0],matrixVertex=_step25$value[1];this.breakNumericMatrix(matrixVertex)}}catch(err){_iterator25.e(err)}finally{_iterator25.f()}}},{key:"breakNumericMatricesInRange",value:function breakNumericMatricesInRange(range){var _iterator26=_createForOfIteratorHelper(this.matrixMapping.numericMatricesInRange(range)),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _step26$value=_slicedToArray(_step26.value,2),_=_step26$value[0],matrix=_step26$value[1];this.breakNumericMatrix(matrix)}}catch(err){_iterator26.e(err)}finally{_iterator26.f()}}},{key:"breakNumericMatrix",value:function breakNumericMatrix(matrixVertex){var matrixRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(matrixVertex.getAddress(),matrixVertex.width,matrixVertex.height);var adjacentNodes=this.graph.adjacentNodes(matrixVertex);var _iterator27=_createForOfIteratorHelper(matrixRange.addresses(this)),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var address=_step27.value;var value=this.getCellValue(address);var valueVertex=new _2.ValueCellVertex(value);this.addVertex(address,valueVertex)}}catch(err){_iterator27.e(err)}finally{_iterator27.f()}var _iterator28=_createForOfIteratorHelper(adjacentNodes.values()),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var adjacentNode=_step28.value;var nodeDependencies=(0,_collectAddressesDependentToMatrix.collectAddressesDependentToMatrix)(this.functionRegistry,adjacentNode,matrixVertex,this.lazilyTransformingAstService,this);var _iterator29=_createForOfIteratorHelper(nodeDependencies),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _address2=_step29.value;var vertex=this.fetchCell(_address2);this.graph.addEdge(vertex,adjacentNode)}}catch(err){_iterator29.e(err)}finally{_iterator29.f()}}}catch(err){_iterator28.e(err)}finally{_iterator28.f()}this.removeVertex(matrixVertex);this.matrixMapping.removeMatrix(matrixVertex.getRange())}},{key:"setMatrixEmpty",value:function setMatrixEmpty(matrixVertex){var matrixRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(matrixVertex.getAddress(),matrixVertex.width,matrixVertex.height);var adjacentNodes=this.graph.adjacentNodes(matrixVertex);var _iterator30=_createForOfIteratorHelper(matrixRange.addresses(this)),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var address=_step30.value;this.addressMapping.removeCell(address)}}catch(err){_iterator30.e(err)}finally{_iterator30.f()}var _iterator31=_createForOfIteratorHelper(adjacentNodes.values()),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var adjacentNode=_step31.value;var nodeDependencies=(0,_collectAddressesDependentToMatrix.collectAddressesDependentToMatrix)(this.functionRegistry,adjacentNode,matrixVertex,this.lazilyTransformingAstService,this);var _iterator32=_createForOfIteratorHelper(nodeDependencies),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _address3=_step32.value;var vertex=this.fetchCellOrCreateEmpty(_address3);this.graph.addEdge(vertex,adjacentNode)}}catch(err){_iterator32.e(err)}finally{_iterator32.f()}if(nodeDependencies.length>0){this.graph.markNodeAsSpecialRecentlyChanged(adjacentNode)}}}catch(err){_iterator31.e(err)}finally{_iterator31.f()}this.removeVertex(matrixVertex);this.matrixMapping.removeMatrix(matrixVertex.getRange())}},{key:"addVertex",value:function addVertex(address,vertex){this.graph.addNode(vertex);this.setVertexAddress(address,vertex)}},{key:"addMatrixVertex",value:function addMatrixVertex(address,vertex){this.graph.addNode(vertex);this.setAddressMappingForMatrixVertex(vertex,address)}},{key:"addNewMatrixVertex",value:function addNewMatrixVertex(matrixVertex){var range=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(matrixVertex.getAddress(),matrixVertex.width,matrixVertex.height);var _iterator33=_createForOfIteratorHelper(this.verticesFromRange(range)),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var vertex=_step33.value;if(vertex instanceof _2.MatrixVertex){throw Error("You cannot modify only part of an array")}}}catch(err){_iterator33.e(err)}finally{_iterator33.f()}this.setMatrix(range,matrixVertex);var _iterator34=_createForOfIteratorHelper(this.entriesFromRange(range)),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var _step34$value=_slicedToArray(_step34.value,2),address=_step34$value[0],_vertex=_step34$value[1];if(_vertex){this.exchangeGraphNode(_vertex,matrixVertex)}this.setVertexAddress(address,matrixVertex)}}catch(err){_iterator34.e(err)}finally{_iterator34.f()}}},{key:"matrixFormulaNodes",value:regeneratorRuntime.mark((function matrixFormulaNodes(){var _iterator35,_step35,vertex;return regeneratorRuntime.wrap((function matrixFormulaNodes$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator35=_createForOfIteratorHelper(this.graph.nodes);_context.prev=1;_iterator35.s();case 3:if((_step35=_iterator35.n()).done){_context.next=10;break}vertex=_step35.value;if(!(vertex instanceof _2.MatrixVertex&&vertex.isFormula())){_context.next=8;break}_context.next=8;return vertex;case 8:_context.next=3;break;case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](1);_iterator35.e(_context.t0);case 15:_context.prev=15;_iterator35.f();return _context.finish(15);case 18:case"end":return _context.stop()}}}),matrixFormulaNodes,this,[[1,12,15,18]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function entriesFromRowsSpan(rowsSpan){return regeneratorRuntime.wrap((function entriesFromRowsSpan$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.delegateYield(this.addressMapping.entriesFromRowsSpan(rowsSpan),"t0",1);case 1:case"end":return _context2.stop()}}}),entriesFromRowsSpan,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function entriesFromColumnsSpan(columnsSpan){return regeneratorRuntime.wrap((function entriesFromColumnsSpan$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.delegateYield(this.addressMapping.entriesFromColumnsSpan(columnsSpan),"t0",1);case 1:case"end":return _context3.stop()}}}),entriesFromColumnsSpan,this)}))},{key:"existsVertex",value:function existsVertex(address){return this.addressMapping.has(address)}},{key:"fetchCell",value:function fetchCell(address){return this.addressMapping.fetchCell(address)}},{key:"getCell",value:function getCell(address){return this.addressMapping.getCell(address)}},{key:"getCellValue",value:function getCellValue(address){return this.addressMapping.getCellValue(address)}},{key:"getScalarValue",value:function getScalarValue(address){var value=this.addressMapping.getCellValue(address);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return value}},{key:"setVertexAddress",value:function setVertexAddress(address,vertex){this.addressMapping.setCell(address,vertex)}},{key:"existsEdge",value:function existsEdge(fromNode,toNode){return this.graph.existsEdge(fromNode,toNode)}},{key:"getSheetId",value:function getSheetId(sheetName){return this.sheetMapping.fetch(sheetName)}},{key:"getSheetName",value:function getSheetName(sheetId){return this.sheetMapping.fetchDisplayName(sheetId)}},{key:"getSheetHeight",value:function getSheetHeight(sheet){return this.addressMapping.getHeight(sheet)}},{key:"getSheetWidth",value:function getSheetWidth(sheet){return this.addressMapping.getWidth(sheet)}},{key:"getMatrix",value:function getMatrix(range){return this.matrixMapping.getMatrix(range)}},{key:"setMatrix",value:function setMatrix(range,vertex){this.matrixMapping.setMatrix(range,vertex)}},{key:"getRange",value:function getRange(start,end){return this.rangeMapping.getRange(start,end)}},{key:"topSortWithScc",value:function topSortWithScc(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function markAsVolatile(vertex){this.graph.markNodeAsSpecial(vertex)}},{key:"markAsDependentOnStructureChange",value:function markAsDependentOnStructureChange(vertex){this.graph.markNodeAsChangingWithStructure(vertex)}},{key:"forceApplyPostponedTransformations",value:function forceApplyPostponedTransformations(){var _iterator36=_createForOfIteratorHelper(this.graph.nodes.values()),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var vertex=_step36.value;if(vertex instanceof _2.FormulaCellVertex){vertex.ensureRecentData(this.lazilyTransformingAstService)}}}catch(err){_iterator36.e(err)}finally{_iterator36.f()}}},{key:"volatileVertices",value:function volatileVertices(){return this.graph.specialNodes}},{key:"destroy",value:function destroy(){this.graph.destroy();this.addressMapping.destroy();this.rangeMapping.destroy();this.sheetMapping.destroy();this.matrixMapping.destroy()}},{key:"verticesFromRange",value:regeneratorRuntime.mark((function verticesFromRange(range){var _iterator37,_step37,address,vertex;return regeneratorRuntime.wrap((function verticesFromRange$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_iterator37=_createForOfIteratorHelper(range.addresses(this));_context4.prev=1;_iterator37.s();case 3:if((_step37=_iterator37.n()).done){_context4.next=11;break}address=_step37.value;vertex=this.getCell(address);if(!vertex){_context4.next=9;break}_context4.next=9;return vertex;case 9:_context4.next=3;break;case 11:_context4.next=16;break;case 13:_context4.prev=13;_context4.t0=_context4["catch"](1);_iterator37.e(_context4.t0);case 16:_context4.prev=16;_iterator37.f();return _context4.finish(16);case 19:case"end":return _context4.stop()}}}),verticesFromRange,this,[[1,13,16,19]])}))},{key:"valuesFromRange",value:regeneratorRuntime.mark((function valuesFromRange(range){var _iterator38,_step38,address,value;return regeneratorRuntime.wrap((function valuesFromRange$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_iterator38=_createForOfIteratorHelper(range.addresses(this));_context5.prev=1;_iterator38.s();case 3:if((_step38=_iterator38.n()).done){_context5.next=11;break}address=_step38.value;value=this.getScalarValue(address);if(!(value!==_Cell.EmptyValue)){_context5.next=9;break}_context5.next=9;return[value,address];case 9:_context5.next=3;break;case 11:_context5.next=16;break;case 13:_context5.prev=13;_context5.t0=_context5["catch"](1);_iterator38.e(_context5.t0);case 16:_context5.prev=16;_iterator38.f();return _context5.finish(16);case 19:case"end":return _context5.stop()}}}),valuesFromRange,this,[[1,13,16,19]])}))},{key:"entriesFromRange",value:regeneratorRuntime.mark((function entriesFromRange(range){var _iterator39,_step39,address;return regeneratorRuntime.wrap((function entriesFromRange$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_iterator39=_createForOfIteratorHelper(range.addresses(this));_context6.prev=1;_iterator39.s();case 3:if((_step39=_iterator39.n()).done){_context6.next=9;break}address=_step39.value;_context6.next=7;return[address,this.getCell(address)];case 7:_context6.next=3;break;case 9:_context6.next=14;break;case 11:_context6.prev=11;_context6.t0=_context6["catch"](1);_iterator39.e(_context6.t0);case 14:_context6.prev=14;_iterator39.f();return _context6.finish(14);case 17:case"end":return _context6.stop()}}}),entriesFromRange,this,[[1,11,14,17]])}))},{key:"exchangeGraphNode",value:function exchangeGraphNode(oldNode,newNode){var _this8=this;this.graph.addNode(newNode);var adjNodesStored=this.graph.adjacentNodes(oldNode);this.removeVertex(oldNode);adjNodesStored.forEach((function(adjacentNode){if(_this8.graph.hasNode(adjacentNode)){_this8.graph.addEdge(newNode,adjacentNode)}}))}},{key:"exchangeOrAddGraphNode",value:function exchangeOrAddGraphNode(oldNode,newNode){if(oldNode){this.exchangeGraphNode(oldNode,newNode)}else{this.graph.addNode(newNode)}}},{key:"addStructuralNodesToChangeSet",value:function addStructuralNodesToChangeSet(){var _iterator40=_createForOfIteratorHelper(this.graph.specialNodesStructuralChanges),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var vertex=_step40.value;this.graph.markNodeAsSpecialRecentlyChanged(vertex)}}catch(err){_iterator40.e(err)}finally{_iterator40.f()}}},{key:"fixRangesWhenAddingRows",value:function fixRangesWhenAddingRows(sheet,row,numberOfRows){var originalValues=Array.from(this.rangeMapping.rangesInSheet(sheet));for(var _i2=0,_originalValues=originalValues;_i2<_originalValues.length;_i2++){var rangeVertex=_originalValues[_i2];if(rangeVertex.range.includesRow(row+numberOfRows)){if(rangeVertex.bruteForce){var addedSubrangeInThatRange=rangeVertex.range.rangeWithSameWidth(row,numberOfRows);var _iterator41=_createForOfIteratorHelper(addedSubrangeInThatRange.addresses(this)),_step41;try{for(_iterator41.s();!(_step41=_iterator41.n()).done;){var address=_step41.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(address),rangeVertex)}}catch(err){_iterator41.e(err)}finally{_iterator41.f()}}else{var currentRangeVertex=rangeVertex;var find=this.rangeMapping.findSmallerRange(currentRangeVertex.range);if(find.smallerRangeVertex!==null){continue}while(find.smallerRangeVertex===null){var newRangeVertex=new _2.RangeVertex(_AbsoluteCellRange.AbsoluteCellRange.spanFrom(currentRangeVertex.range.start,currentRangeVertex.range.width(),currentRangeVertex.range.height()-1));this.rangeMapping.setRange(newRangeVertex);this.graph.addNode(newRangeVertex);var restRange=new _AbsoluteCellRange.AbsoluteCellRange((0,_Cell.simpleCellAddress)(currentRangeVertex.range.start.sheet,currentRangeVertex.range.start.col,currentRangeVertex.range.end.row),currentRangeVertex.range.end);this.addAllFromRange(restRange,currentRangeVertex);this.graph.addEdge(newRangeVertex,currentRangeVertex);currentRangeVertex=newRangeVertex;find=this.rangeMapping.findSmallerRange(currentRangeVertex.range)}this.graph.addEdge(find.smallerRangeVertex,currentRangeVertex);this.addAllFromRange(find.restRange,currentRangeVertex);this.graph.removeEdge(find.smallerRangeVertex,rangeVertex)}}}}},{key:"addAllFromRange",value:function addAllFromRange(range,vertex){var _iterator42=_createForOfIteratorHelper(range.addresses(this)),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var address=_step42.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(address),vertex)}}catch(err){_iterator42.e(err)}finally{_iterator42.f()}}},{key:"fixRangesWhenAddingColumns",value:function fixRangesWhenAddingColumns(sheet,column,numberOfColumns){var _iterator43=_createForOfIteratorHelper(this.rangeMapping.rangesInSheet(sheet)),_step43;try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var rangeVertex=_step43.value;if(rangeVertex.range.includesColumn(column+numberOfColumns)){var subrange=void 0;if(rangeVertex.bruteForce){subrange=rangeVertex.range.rangeWithSameHeight(column,numberOfColumns)}else{subrange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(sheet,column,rangeVertex.range.end.row),numberOfColumns,1)}var _iterator44=_createForOfIteratorHelper(subrange.addresses(this)),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var address=_step44.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(address),rangeVertex)}}catch(err){_iterator44.e(err)}finally{_iterator44.f()}}}}catch(err){_iterator43.e(err)}finally{_iterator43.f()}}},{key:"setAddressMappingForMatrixVertex",value:function setAddressMappingForMatrixVertex(vertex,formulaAddress){this.setVertexAddress(formulaAddress,vertex);if(!(vertex instanceof _2.MatrixVertex)){return}var range=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(formulaAddress,vertex.width,vertex.height);this.setMatrix(range,vertex);var _iterator45=_createForOfIteratorHelper(range.addresses(this)),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var address=_step45.value;this.setVertexAddress(address,vertex)}}catch(err){_iterator45.e(err)}finally{_iterator45.f()}}},{key:"truncateMatricesAfterRemovingRows",value:function truncateMatricesAfterRemovingRows(removedRows){var _this9=this;var verticesToRemove=this.matrixMapping.truncateMatricesByRows(removedRows);verticesToRemove.forEach((function(vertex){_this9.removeVertex(vertex)}))}},{key:"truncateRanges",value:function truncateRanges(span,coordinate){var _this$rangeMapping$tr=this.rangeMapping.truncateRanges(span,coordinate),verticesToRemove=_this$rangeMapping$tr.verticesToRemove,verticesToMerge=_this$rangeMapping$tr.verticesToMerge;var _iterator46=_createForOfIteratorHelper(verticesToMerge),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var _step46$value=_slicedToArray(_step46.value,2),existingVertex=_step46$value[0],mergedVertex=_step46$value[1];this.mergeRangeVertices(existingVertex,mergedVertex)}}catch(err){_iterator46.e(err)}finally{_iterator46.f()}var _iterator47=_createForOfIteratorHelper(verticesToRemove),_step47;try{for(_iterator47.s();!(_step47=_iterator47.n()).done;){var rangeVertex=_step47.value;this.removeVertexAndCleanupDependencies(rangeVertex)}}catch(err){_iterator47.e(err)}finally{_iterator47.f()}}},{key:"truncateMatricesAfterRemovingColumns",value:function truncateMatricesAfterRemovingColumns(removedColumns){var _this10=this;var verticesToRemove=this.matrixMapping.truncateMatricesByColumns(removedColumns);verticesToRemove.forEach((function(vertex){_this10.removeVertex(vertex)}))}},{key:"expandMatricesAfterAddingRows",value:function expandMatricesAfterAddingRows(sheet,rowStart,numberOfRows){var _iterator48=_createForOfIteratorHelper(this.matrixMapping.numericMatricesInRows(_Span.RowsSpan.fromRowStartAndEnd(sheet,rowStart,rowStart))),_step48;try{for(_iterator48.s();!(_step48=_iterator48.n()).done;){var _step48$value=_slicedToArray(_step48.value,2),matrix=_step48$value[1];matrix.addRows(sheet,rowStart,numberOfRows);var addedRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(sheet,matrix.getAddress().col,rowStart),matrix.width,numberOfRows);var _iterator49=_createForOfIteratorHelper(addedRange.addresses(this)),_step49;try{for(_iterator49.s();!(_step49=_iterator49.n()).done;){var address=_step49.value;this.addressMapping.setCell(address,matrix)}}catch(err){_iterator49.e(err)}finally{_iterator49.f()}}}catch(err){_iterator48.e(err)}finally{_iterator48.f()}}},{key:"expandMatricesAfterAddingColumns",value:function expandMatricesAfterAddingColumns(sheet,columnStart,numberOfColumns){var _iterator50=_createForOfIteratorHelper(this.matrixMapping.numericMatricesInColumns(_Span.ColumnsSpan.fromColumnStartAndEnd(sheet,columnStart,columnStart))),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var _step50$value=_slicedToArray(_step50.value,2),matrix=_step50$value[1];matrix.addColumns(sheet,columnStart,numberOfColumns);var addedRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(sheet,columnStart,matrix.getAddress().row),numberOfColumns,matrix.height);var _iterator51=_createForOfIteratorHelper(addedRange.addresses(this)),_step51;try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var address=_step51.value;this.addressMapping.setCell(address,matrix)}}catch(err){_iterator51.e(err)}finally{_iterator51.f()}}}catch(err){_iterator50.e(err)}finally{_iterator50.f()}}},{key:"removeVertex",value:function removeVertex(vertex){this.removeVertexAndCleanupDependencies(vertex);if(vertex instanceof _2.RangeVertex){this.rangeMapping.removeRange(vertex)}}},{key:"mergeRangeVertices",value:function mergeRangeVertices(existingVertex,newVertex){var _this11=this;var adjNodesStored=this.graph.adjacentNodes(newVertex);this.removeVertexAndCleanupDependencies(newVertex);this.graph.softRemoveEdge(existingVertex,newVertex);adjNodesStored.forEach((function(adjacentNode){if(_this11.graph.hasNode(adjacentNode)){_this11.graph.addEdge(existingVertex,adjacentNode)}}))}},{key:"removeVertexAndCleanupDependencies",value:function removeVertexAndCleanupDependencies(vertex){var dependencies=this.graph.removeNode(vertex);while(dependencies.size>0){var _vertex2=dependencies.values().next().value;dependencies.delete(_vertex2);if(this.graph.hasNode(_vertex2)&&this.graph.adjacentNodesCount(_vertex2)===0){if(_vertex2 instanceof _2.RangeVertex||_vertex2 instanceof _2.EmptyCellVertex){this.graph.removeNode(_vertex2).forEach((function(candidate){return dependencies.add(candidate)}))}if(_vertex2 instanceof _2.RangeVertex){this.rangeMapping.removeRange(_vertex2)}else if(_vertex2 instanceof _2.EmptyCellVertex){this.addressMapping.removeCell(_vertex2.address)}}}}}],[{key:"buildEmpty",value:function buildEmpty(lazilyTransformingAstService,config,functionRegistry,namedExpressions,stats){var addressMapping=new _AddressMapping.AddressMapping(config.chooseAddressMappingPolicy);var rangeMapping=new _RangeMapping.RangeMapping;return new DependencyGraph(addressMapping,rangeMapping,new _SheetMapping.SheetMapping(config.translationPackage),new _MatrixMapping.MatrixMapping,stats,lazilyTransformingAstService,functionRegistry,namedExpressions)}}]);return DependencyGraph}();exports.DependencyGraph=DependencyGraph},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var fails=__webpack_require__(7);var isArray=__webpack_require__(48);var isObject=__webpack_require__(15);var toObject=__webpack_require__(49);var toLength=__webpack_require__(40);var createProperty=__webpack_require__(70);var arraySpeciesCreate=__webpack_require__(62);var arrayMethodHasSpeciesSupport=__webpack_require__(85);var wellKnownSymbol=__webpack_require__(55);var V8_VERSION=__webpack_require__(86);var IS_CONCAT_SPREADABLE=wellKnownSymbol("isConcatSpreadable");var MAX_SAFE_INTEGER=9007199254740991;var MAXIMUM_ALLOWED_INDEX_EXCEEDED="Maximum allowed index exceeded";var IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION>=51||!fails((function(){var array=[];array[IS_CONCAT_SPREADABLE]=false;return array.concat()[0]!==array}));var SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("concat");var isConcatSpreadable=function(O){if(!isObject(O))return false;var spreadable=O[IS_CONCAT_SPREADABLE];return spreadable!==undefined?!!spreadable:isArray(O)};var FORCED=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;$({target:"Array",proto:true,forced:FORCED},{concat:function concat(arg){var O=toObject(this);var A=arraySpeciesCreate(O,0);var n=0;var i,k,length,len,E;for(i=-1,length=arguments.length;i<length;i++){E=i===-1?O:arguments[i];if(isConcatSpreadable(E)){len=toLength(E.length);if(n+len>MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);for(k=0;k<len;k++,n++)if(k in E)createProperty(A,n,E[k])}else{if(n>=MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);createProperty(A,n++,E)}}A.length=n;return A}})},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var forEach=__webpack_require__(111);$({target:"Array",proto:true,forced:[].forEach!=forEach},{forEach:forEach})},function(module,exports,__webpack_require__){"use strict";var $forEach=__webpack_require__(59).forEach;var arrayMethodIsStrict=__webpack_require__(112);var arrayMethodUsesToLength=__webpack_require__(88);var STRICT_METHOD=arrayMethodIsStrict("forEach");var USES_TO_LENGTH=arrayMethodUsesToLength("forEach");module.exports=!STRICT_METHOD||!USES_TO_LENGTH?function forEach(callbackfn){return $forEach(this,callbackfn,arguments.length>1?arguments[1]:undefined)}:[].forEach},function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(7);module.exports=function(METHOD_NAME,argument){var method=[][METHOD_NAME];return!!method&&fails((function(){method.call(null,argument||function(){throw 1},1)}))}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $map=__webpack_require__(59).map;var arrayMethodHasSpeciesSupport=__webpack_require__(85);var arrayMethodUsesToLength=__webpack_require__(88);var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("map");var USES_TO_LENGTH=arrayMethodUsesToLength("map");$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{map:function map(callbackfn){return $map(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";var collection=__webpack_require__(115);var collectionStrong=__webpack_require__(121);module.exports=collection("Set",(function(init){return function Set(){return init(this,arguments.length?arguments[0]:undefined)}}),collectionStrong)},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var global=__webpack_require__(3);var isForced=__webpack_require__(45);var redefine=__webpack_require__(22);var InternalMetadataModule=__webpack_require__(116);var iterate=__webpack_require__(118);var anInstance=__webpack_require__(119);var isObject=__webpack_require__(15);var fails=__webpack_require__(7);var checkCorrectnessOfIteration=__webpack_require__(74);var setToStringTag=__webpack_require__(58);var inheritIfRequired=__webpack_require__(120);module.exports=function(CONSTRUCTOR_NAME,wrapper,common){var IS_MAP=CONSTRUCTOR_NAME.indexOf("Map")!==-1;var IS_WEAK=CONSTRUCTOR_NAME.indexOf("Weak")!==-1;var ADDER=IS_MAP?"set":"add";var NativeConstructor=global[CONSTRUCTOR_NAME];var NativePrototype=NativeConstructor&&NativeConstructor.prototype;var Constructor=NativeConstructor;var exported={};var fixMethod=function(KEY){var nativeMethod=NativePrototype[KEY];redefine(NativePrototype,KEY,KEY=="add"?function add(value){nativeMethod.call(this,value===0?0:value);return this}:KEY=="delete"?function(key){return IS_WEAK&&!isObject(key)?false:nativeMethod.call(this,key===0?0:key)}:KEY=="get"?function get(key){return IS_WEAK&&!isObject(key)?undefined:nativeMethod.call(this,key===0?0:key)}:KEY=="has"?function has(key){return IS_WEAK&&!isObject(key)?false:nativeMethod.call(this,key===0?0:key)}:function set(key,value){nativeMethod.call(this,key===0?0:key,value);return this})};if(isForced(CONSTRUCTOR_NAME,typeof NativeConstructor!="function"||!(IS_WEAK||NativePrototype.forEach&&!fails((function(){(new NativeConstructor).entries().next()}))))){Constructor=common.getConstructor(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER);InternalMetadataModule.REQUIRED=true}else if(isForced(CONSTRUCTOR_NAME,true)){var instance=new Constructor;var HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance;var THROWS_ON_PRIMITIVES=fails((function(){instance.has(1)}));var ACCEPT_ITERABLES=checkCorrectnessOfIteration((function(iterable){new NativeConstructor(iterable)}));var BUGGY_ZERO=!IS_WEAK&&fails((function(){var $instance=new NativeConstructor;var index=5;while(index--)$instance[ADDER](index,index);return!$instance.has(-0)}));if(!ACCEPT_ITERABLES){Constructor=wrapper((function(dummy,iterable){anInstance(dummy,Constructor,CONSTRUCTOR_NAME);var that=inheritIfRequired(new NativeConstructor,dummy,Constructor);if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP);return that}));Constructor.prototype=NativePrototype;NativePrototype.constructor=Constructor}if(THROWS_ON_PRIMITIVES||BUGGY_ZERO){fixMethod("delete");fixMethod("has");IS_MAP&&fixMethod("get")}if(BUGGY_ZERO||HASNT_CHAINING)fixMethod(ADDER);if(IS_WEAK&&NativePrototype.clear)delete NativePrototype.clear}exported[CONSTRUCTOR_NAME]=Constructor;$({global:true,forced:Constructor!=NativeConstructor},exported);setToStringTag(Constructor,CONSTRUCTOR_NAME);if(!IS_WEAK)common.setStrong(Constructor,CONSTRUCTOR_NAME,IS_MAP);return Constructor}},function(module,exports,__webpack_require__){var hiddenKeys=__webpack_require__(32);var isObject=__webpack_require__(15);var has=__webpack_require__(16);var defineProperty=__webpack_require__(20).f;var uid=__webpack_require__(31);var FREEZING=__webpack_require__(117);var METADATA=uid("meta");var id=0;var isExtensible=Object.isExtensible||function(){return true};var setMetadata=function(it){defineProperty(it,METADATA,{value:{objectID:"O"+ ++id,weakData:{}}})};var fastKey=function(it,create){if(!isObject(it))return typeof it=="symbol"?it:(typeof it=="string"?"S":"P")+it;if(!has(it,METADATA)){if(!isExtensible(it))return"F";if(!create)return"E";setMetadata(it)}return it[METADATA].objectID};var getWeakData=function(it,create){if(!has(it,METADATA)){if(!isExtensible(it))return true;if(!create)return false;setMetadata(it)}return it[METADATA].weakData};var onFreeze=function(it){if(FREEZING&&meta.REQUIRED&&isExtensible(it)&&!has(it,METADATA))setMetadata(it);return it};var meta=module.exports={REQUIRED:false,fastKey:fastKey,getWeakData:getWeakData,onFreeze:onFreeze};hiddenKeys[METADATA]=true},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);module.exports=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(module,exports,__webpack_require__){var anObject=__webpack_require__(21);var isArrayIteratorMethod=__webpack_require__(68);var toLength=__webpack_require__(40);var bind=__webpack_require__(60);var getIteratorMethod=__webpack_require__(71);var callWithSafeIterationClosing=__webpack_require__(67);var Result=function(stopped,result){this.stopped=stopped;this.result=result};var iterate=module.exports=function(iterable,fn,that,AS_ENTRIES,IS_ITERATOR){var boundFunction=bind(fn,that,AS_ENTRIES?2:1);var iterator,iterFn,index,length,result,next,step;if(IS_ITERATOR){iterator=iterable}else{iterFn=getIteratorMethod(iterable);if(typeof iterFn!="function")throw TypeError("Target is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=toLength(iterable.length);length>index;index++){result=AS_ENTRIES?boundFunction(anObject(step=iterable[index])[0],step[1]):boundFunction(iterable[index]);if(result&&result instanceof Result)return result}return new Result(false)}iterator=iterFn.call(iterable)}next=iterator.next;while(!(step=next.call(iterator)).done){result=callWithSafeIterationClosing(iterator,boundFunction,step.value,AS_ENTRIES);if(typeof result=="object"&&result&&result instanceof Result)return result}return new Result(false)};iterate.stop=function(result){return new Result(true,result)}},function(module,exports){module.exports=function(it,Constructor,name){if(!(it instanceof Constructor)){throw TypeError("Incorrect "+(name?name+" ":"")+"invocation")}return it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);var setPrototypeOf=__webpack_require__(82);module.exports=function($this,dummy,Wrapper){var NewTarget,NewTargetPrototype;if(setPrototypeOf&&typeof(NewTarget=dummy.constructor)=="function"&&NewTarget!==Wrapper&&isObject(NewTargetPrototype=NewTarget.prototype)&&NewTargetPrototype!==Wrapper.prototype)setPrototypeOf($this,NewTargetPrototype);return $this}},function(module,exports,__webpack_require__){"use strict";var defineProperty=__webpack_require__(20).f;var create=__webpack_require__(50);var redefineAll=__webpack_require__(122);var bind=__webpack_require__(60);var anInstance=__webpack_require__(119);var iterate=__webpack_require__(118);var defineIterator=__webpack_require__(77);var setSpecies=__webpack_require__(123);var DESCRIPTORS=__webpack_require__(6);var fastKey=__webpack_require__(116).fastKey;var InternalStateModule=__webpack_require__(26);var setInternalState=InternalStateModule.set;var internalStateGetterFor=InternalStateModule.getterFor;module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var C=wrapper((function(that,iterable){anInstance(that,C,CONSTRUCTOR_NAME);setInternalState(that,{type:CONSTRUCTOR_NAME,index:create(null),first:undefined,last:undefined,size:0});if(!DESCRIPTORS)that.size=0;if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP)}));var getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME);var define=function(that,key,value){var state=getInternalState(that);var entry=getEntry(that,key);var previous,index;if(entry){entry.value=value}else{state.last=entry={index:index=fastKey(key,true),key:key,value:value,previous:previous=state.last,next:undefined,removed:false};if(!state.first)state.first=entry;if(previous)previous.next=entry;if(DESCRIPTORS)state.size++;else that.size++;if(index!=="F")state.index[index]=entry}return that};var getEntry=function(that,key){var state=getInternalState(that);var index=fastKey(key);var entry;if(index!=="F")return state.index[index];for(entry=state.first;entry;entry=entry.next){if(entry.key==key)return entry}};redefineAll(C.prototype,{clear:function clear(){var that=this;var state=getInternalState(that);var data=state.index;var entry=state.first;while(entry){entry.removed=true;if(entry.previous)entry.previous=entry.previous.next=undefined;delete data[entry.index];entry=entry.next}state.first=state.last=undefined;if(DESCRIPTORS)state.size=0;else that.size=0},delete:function(key){var that=this;var state=getInternalState(that);var entry=getEntry(that,key);if(entry){var next=entry.next;var prev=entry.previous;delete state.index[entry.index];entry.removed=true;if(prev)prev.next=next;if(next)next.previous=prev;if(state.first==entry)state.first=next;if(state.last==entry)state.last=prev;if(DESCRIPTORS)state.size--;else that.size--}return!!entry},forEach:function forEach(callbackfn){var state=getInternalState(this);var boundFunction=bind(callbackfn,arguments.length>1?arguments[1]:undefined,3);var entry;while(entry=entry?entry.next:state.first){boundFunction(entry.value,entry.key,this);while(entry&&entry.removed)entry=entry.previous}},has:function has(key){return!!getEntry(this,key)}});redefineAll(C.prototype,IS_MAP?{get:function get(key){var entry=getEntry(this,key);return entry&&entry.value},set:function set(key,value){return define(this,key===0?0:key,value)}}:{add:function add(value){return define(this,value=value===0?0:value,value)}});if(DESCRIPTORS)defineProperty(C.prototype,"size",{get:function(){return getInternalState(this).size}});return C},setStrong:function(C,CONSTRUCTOR_NAME,IS_MAP){var ITERATOR_NAME=CONSTRUCTOR_NAME+" Iterator";var getInternalCollectionState=internalStateGetterFor(CONSTRUCTOR_NAME);var getInternalIteratorState=internalStateGetterFor(ITERATOR_NAME);defineIterator(C,CONSTRUCTOR_NAME,(function(iterated,kind){setInternalState(this,{type:ITERATOR_NAME,target:iterated,state:getInternalCollectionState(iterated),kind:kind,last:undefined})}),(function(){var state=getInternalIteratorState(this);var kind=state.kind;var entry=state.last;while(entry&&entry.removed)entry=entry.previous;if(!state.target||!(state.last=entry=entry?entry.next:state.state.first)){state.target=undefined;return{value:undefined,done:true}}if(kind=="keys")return{value:entry.key,done:false};if(kind=="values")return{value:entry.value,done:false};return{value:[entry.key,entry.value],done:false}}),IS_MAP?"entries":"values",!IS_MAP,true);setSpecies(CONSTRUCTOR_NAME)}}},function(module,exports,__webpack_require__){var redefine=__webpack_require__(22);module.exports=function(target,src,options){for(var key in src)redefine(target,key,src[key],options);return target}},function(module,exports,__webpack_require__){"use strict";var getBuiltIn=__webpack_require__(35);var definePropertyModule=__webpack_require__(20);var wellKnownSymbol=__webpack_require__(55);var DESCRIPTORS=__webpack_require__(6);var SPECIES=wellKnownSymbol("species");module.exports=function(CONSTRUCTOR_NAME){var Constructor=getBuiltIn(CONSTRUCTOR_NAME);var defineProperty=definePropertyModule.f;if(DESCRIPTORS&&Constructor&&!Constructor[SPECIES]){defineProperty(Constructor,SPECIES,{configurable:true,get:function(){return this}})}}},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var DOMIterables=__webpack_require__(105);var forEach=__webpack_require__(111);var createNonEnumerableProperty=__webpack_require__(19);for(var COLLECTION_NAME in DOMIterables){var Collection=global[COLLECTION_NAME];var CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype&&CollectionPrototype.forEach!==forEach)try{createNonEnumerableProperty(CollectionPrototype,"forEach",forEach)}catch(error){CollectionPrototype.forEach=forEach}}},function(module,exports,__webpack_require__){var runtime=function(exports){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}exports.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){prototype[method]=function(arg){return this._invoke(method,arg)}}))}exports.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};exports.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction"}}genFun.prototype=Object.create(Gp);return genFun};exports.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg)}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)}))}return PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped;resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};exports.AsyncIterator=AsyncIterator;exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){if(PromiseImpl===void 0)PromiseImpl=Promise;var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if(method==="throw"){throw arg}return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next"){context.sent=context._sent=context.arg}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return"){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator["return"]){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}exports.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}exports.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined}return ContinueSentinel}};return exports}(true?module.exports:undefined);try{regeneratorRuntime=runtime}catch(accidentalStrictMode){Function("r","regeneratorRuntime = r")(runtime)}},function(module,exports,__webpack_require__){"use strict";(function(global){var objectAssign=__webpack_require__(127);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function compare(a,b){if(a===b){return 0}var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y){return-1}if(y<x){return 1}return 0}function isBuffer(b){if(global.Buffer&&typeof global.Buffer.isBuffer==="function"){return global.Buffer.isBuffer(b)}return!!(b!=null&&b._isBuffer)}var util=__webpack_require__(128);var hasOwn=Object.prototype.hasOwnProperty;var pSlice=Array.prototype.slice;var functionsHaveNames=function(){return function foo(){}.name==="foo"}();function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){if(isBuffer(arrbuf)){return false}if(typeof global.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(arrbuf)}if(!arrbuf){return false}if(arrbuf instanceof DataView){return true}if(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer){return true}return false}var assert=module.exports=ok;var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(!util.isFunction(func)){return}if(functionsHaveNames){return func.name}var str=func.toString();var match=str.match(regex);return match&&match[1]}assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;if(options.message){this.message=options.message;this.generatedMessage=false}else{this.message=getMessage(this);this.generatedMessage=true}var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}else{var err=new Error;if(err.stack){var out=err.stack;var fn_name=getName(stackStartFunction);var idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}};util.inherits(assert.AssertionError,Error);function truncate(s,n){if(typeof s==="string"){return s.length<n?s:s.slice(0,n)}else{return s}}function inspect(something){if(functionsHaveNames||!util.isFunction(something)){return util.inspect(something)}var rawname=getName(something);var name=rawname?": "+rawname:"";return"[Function"+name+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}assert.fail=fail;function ok(value,message){if(!value)fail(value,true,message,"==",assert.ok)}assert.ok=ok;assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected,false)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){if(!_deepEqual(actual,expected,true)){fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)}};function _deepEqual(actual,expected,strict,memos){if(actual===expected){return true}else if(isBuffer(actual)&&isBuffer(expected)){return compare(actual,expected)===0}else if(util.isDate(actual)&&util.isDate(expected)){return actual.getTime()===expected.getTime()}else if(util.isRegExp(actual)&&util.isRegExp(expected)){return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase}else if((actual===null||typeof actual!=="object")&&(expected===null||typeof expected!=="object")){return strict?actual===expected:actual==expected}else if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array)){return compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer))===0}else if(isBuffer(actual)!==isBuffer(expected)){return false}else{memos=memos||{actual:[],expected:[]};var actualIndex=memos.actual.indexOf(actual);if(actualIndex!==-1){if(actualIndex===memos.expected.indexOf(expected)){return true}}memos.actual.push(actual);memos.expected.push(expected);return objEquiv(actual,expected,strict,memos)}}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b,strict,actualVisitedObjects){if(a===null||a===undefined||b===null||b===undefined)return false;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return false;var aIsArgs=isArguments(a);var bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return false;if(aIsArgs){a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b,strict)}var ka=objectKeys(a);var kb=objectKeys(b);var key,i;if(ka.length!==kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!==kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return false}return true}assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected,false)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.notDeepStrictEqual=notDeepStrictEqual;function notDeepStrictEqual(actual,expected,message){if(_deepEqual(actual,expected,true)){fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}}assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return false}if(Object.prototype.toString.call(expected)=="[object RegExp]"){return expected.test(actual)}try{if(actual instanceof expected){return true}}catch(e){}if(Error.isPrototypeOf(expected)){return false}return expected.call({},actual)===true}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if(typeof block!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof expected==="string"){message=expected;expected=null}actual=_tryBlock(block);message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:".");if(shouldThrow&&!actual){fail(actual,expected,"Missing expected exception"+message)}var userProvidedMessage=typeof message==="string";var isUnwantedException=!shouldThrow&&util.isError(actual);var isUnexpectedException=!shouldThrow&&actual&&!expected;if(isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException){fail(actual,expected,"Got unwanted exception"+message)}if(shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual){throw actual}}assert.throws=function(block,error,message){_throws(true,block,error,message)};assert.doesNotThrow=function(block,error,message){_throws(false,block,error,message)};assert.ifError=function(err){if(err)throw err};function strict(value,message){if(!value)fail(value,true,message,"==",strict)}assert.strict=objectAssign(strict,assert,{equal:assert.strictEqual,deepEqual:assert.deepStrictEqual,notEqual:assert.notStrictEqual,notDeepEqual:assert.notDeepStrictEqual});assert.strict.strict=assert.strict;var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){if(hasOwn.call(obj,key))keys.push(key)}return keys}}).call(this,__webpack_require__(4))},function(module,exports,__webpack_require__){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map((function(n){return test2[n]}));if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach((function(letter){test3[letter]=letter}));if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},function(module,exports,__webpack_require__){(function(process){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function getOwnPropertyDescriptors(obj){var keys=Object.keys(obj);var descriptors={};for(var i=0;i<keys.length;i++){descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i])}return descriptors};var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,(function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}));for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(typeof process!=="undefined"&&process.noDeprecation===true){return fn}if(typeof process==="undefined"){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach((function(val,idx){hash[val]=true}));return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}))}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach((function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}}));return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2)}else{str="\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce((function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=__webpack_require__(130);function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=__webpack_require__(131);exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var kCustomPromisifiedSymbol=typeof Symbol!=="undefined"?Symbol("util.promisify.custom"):undefined;exports.promisify=function promisify(original){if(typeof original!=="function")throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn=original[kCustomPromisifiedSymbol];if(typeof fn!=="function"){throw new TypeError('The "util.promisify.custom" argument must be of type Function')}Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return fn}function fn(){var promiseResolve,promiseReject;var promise=new Promise((function(resolve,reject){promiseResolve=resolve;promiseReject=reject}));var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}args.push((function(err,value){if(err){promiseReject(err)}else{promiseResolve(value)}}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}Object.setPrototypeOf(fn,Object.getPrototypeOf(original));if(kCustomPromisifiedSymbol)Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return Object.defineProperties(fn,getOwnPropertyDescriptors(original))};exports.promisify.custom=kCustomPromisifiedSymbol;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason;reason=newReason}return cb(reason)}function callbackify(original){if(typeof original!=="function"){throw new TypeError('The "original" argument must be of type Function')}function callbackified(){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}var maybeCb=args.pop();if(typeof maybeCb!=="function"){throw new TypeError("The last argument must be of type Function")}var self=this;var cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb,null,ret)}),(function(rej){process.nextTick(callbackifyOnRejected,rej,cb)}))}Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original));Object.defineProperties(callbackified,getOwnPropertyDescriptors(original));return callbackified}exports.callbackify=callbackify}).call(this,__webpack_require__(129))},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},function(module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},function(module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(75);__webpack_require__(133);__webpack_require__(136);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.AbsoluteRowRange=exports.AbsoluteColumnRange=exports.AbsoluteCellRange=exports.WRONG_RANGE_SIZE=exports.DIFFERENT_SHEETS_ERROR=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _Span=__webpack_require__(174);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var DIFFERENT_SHEETS_ERROR="AbsoluteCellRange: Start and end are in different sheets";exports.DIFFERENT_SHEETS_ERROR=DIFFERENT_SHEETS_ERROR;var WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";exports.WRONG_RANGE_SIZE=WRONG_RANGE_SIZE;var AbsoluteCellRange=function(){function AbsoluteCellRange(start,end){_classCallCheck(this,AbsoluteCellRange);if(start.sheet!==end.sheet){throw new Error(DIFFERENT_SHEETS_ERROR)}this.start=(0,_Cell.simpleCellAddress)(start.sheet,start.col,start.row);this.end=(0,_Cell.simpleCellAddress)(end.sheet,end.col,end.row)}_createClass(AbsoluteCellRange,[{key:"isFinite",value:function isFinite(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function doesOverlap(other){if(this.start.sheet!=other.start.sheet){return false}if(this.end.row<other.start.row||this.start.row>other.end.row){return false}if(this.end.col<other.start.col||this.start.col>other.end.col){return false}return true}},{key:"addressInRange",value:function addressInRange(address){if(this.sheet!==address.sheet){return false}if(this.start.row<=address.row&&this.end.row>=address.row&&this.start.col<=address.col&&this.end.col>=address.col){return true}return false}},{key:"columnInRange",value:function columnInRange(address){if(this.sheet!==address.sheet){return false}return this.start.col<=address.col&&this.end.col>=address.col}},{key:"rowInRange",value:function rowInRange(address){if(this.sheet!==address.sheet){return false}return this.start.row<=address.row&&this.end.row>=address.row}},{key:"containsRange",value:function containsRange(range){return this.addressInRange(range.start)&&this.addressInRange(range.end)}},{key:"intersectionWith",value:function intersectionWith(other){if(this.sheet!==other.start.sheet){return null}var startRow=Math.max(this.start.row,other.start.row);var endRow=Math.min(this.end.row,other.end.row);var startCol=Math.max(this.start.col,other.start.col);var endCol=Math.min(this.end.col,other.end.col);if(startRow>endRow||startCol>endCol){return null}return new AbsoluteCellRange((0,_Cell.simpleCellAddress)(this.sheet,startCol,startRow),(0,_Cell.simpleCellAddress)(this.sheet,endCol,endRow))}},{key:"includesRow",value:function includesRow(row){return this.start.row<row&&this.end.row>=row}},{key:"includesColumn",value:function includesColumn(column){return this.start.col<column&&this.end.col>=column}},{key:"shiftByRows",value:function shiftByRows(numberOfRows){this.start.row+=numberOfRows;this.end.row+=numberOfRows}},{key:"expandByRows",value:function expandByRows(numberOfRows){this.end.row+=numberOfRows}},{key:"shiftByColumns",value:function shiftByColumns(numberOfColumns){this.start.col+=numberOfColumns;this.end.col+=numberOfColumns}},{key:"shifted",value:function shifted(byCols,byRows){return AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,this.start.col+byCols,this.start.row+byRows),this.width(),this.height())}},{key:"expandByColumns",value:function expandByColumns(numberOfColumns){this.end.col+=numberOfColumns}},{key:"moveToSheet",value:function moveToSheet(toSheet){this.start.sheet=toSheet;this.end.sheet=toSheet}},{key:"removeSpan",value:function removeSpan(span){if(span instanceof _Span.RowsSpan){this.removeRows(span.start,span.end)}else{this.removeColumns(span.start,span.end)}}},{key:"removeRows",value:function removeRows(rowStart,rowEnd){if(rowStart>this.end.row){return}if(rowEnd<this.start.row){var numberOfRows=rowEnd-rowStart+1;return this.shiftByRows(-numberOfRows)}if(rowStart<=this.start.row){this.start.row=rowStart}this.end.row-=Math.min(rowEnd,this.end.row)-rowStart+1}},{key:"removeColumns",value:function removeColumns(columnStart,columnEnd){if(columnStart>this.end.col){return}if(columnEnd<this.start.col){var numberOfColumns=columnEnd-columnStart+1;return this.shiftByColumns(-numberOfColumns)}if(columnStart<=this.start.col){this.start.col=columnStart}this.end.col-=Math.min(columnEnd,this.end.col)-columnStart+1}},{key:"shouldBeRemoved",value:function shouldBeRemoved(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function rangeWithSameWidth(startRow,numberOfRows){return AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,this.start.col,startRow),this.width(),numberOfRows)}},{key:"rangeWithSameHeight",value:function rangeWithSameHeight(startColumn,numberOfColumns){return AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(this.sheet,startColumn,this.start.row),numberOfColumns,this.height())}},{key:"toString",value:function toString(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function width(){return this.end.col-this.start.col+1}},{key:"height",value:function height(){return this.end.row-this.start.row+1}},{key:"size",value:function size(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function arrayOfAddressesInRange(){var result=[];for(var y=0;y<this.height();++y){result[y]=[];for(var x=0;x<this.width();++x){var value=(0,_Cell.simpleCellAddress)(this.sheet,this.start.col+x,this.start.row+y);result[y].push(value)}}return result}},{key:"withStart",value:function withStart(newStart){return new AbsoluteCellRange(newStart,this.end)}},{key:"sameDimensionsAs",value:function sameDimensionsAs(other){return this.width()===other.width()&&this.height()===other.height()}},{key:"addresses",value:regeneratorRuntime.mark((function addresses(dependencyGraph){var currentRow,currentColumn;return regeneratorRuntime.wrap((function addresses$(_context){while(1){switch(_context.prev=_context.next){case 0:currentRow=this.start.row;case 1:if(!(currentRow<=this.effectiveEndRow(dependencyGraph))){_context.next=12;break}currentColumn=this.start.col;case 3:if(!(currentColumn<=this.effectiveEndColumn(dependencyGraph))){_context.next=9;break}_context.next=6;return(0,_Cell.simpleCellAddress)(this.start.sheet,currentColumn,currentRow);case 6:currentColumn++;_context.next=3;break;case 9:currentRow++;_context.next=1;break;case 12:case"end":return _context.stop()}}}),addresses,this)}))},{key:"addressesWithDirection",value:regeneratorRuntime.mark((function addressesWithDirection(right,bottom,dependencyGraph){var currentRow,currentColumn,_currentRow,_currentColumn,_currentRow2,_currentColumn2,_currentRow3,_currentColumn3;return regeneratorRuntime.wrap((function addressesWithDirection$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(right>0)){_context2.next=30;break}if(!(bottom>0)){_context2.next=16;break}currentRow=this.effectiveEndRow(dependencyGraph);case 3:if(!(currentRow>=this.start.row)){_context2.next=14;break}currentColumn=this.effectiveEndColumn(dependencyGraph);case 5:if(!(currentColumn>=this.start.col)){_context2.next=11;break}_context2.next=8;return(0,_Cell.simpleCellAddress)(this.start.sheet,currentColumn,currentRow);case 8:currentColumn-=1;_context2.next=5;break;case 11:currentRow-=1;_context2.next=3;break;case 14:_context2.next=28;break;case 16:_currentRow=this.start.row;case 17:if(!(_currentRow<=this.effectiveEndRow(dependencyGraph))){_context2.next=28;break}_currentColumn=this.effectiveEndColumn(dependencyGraph);case 19:if(!(_currentColumn>=this.start.col)){_context2.next=25;break}_context2.next=22;return(0,_Cell.simpleCellAddress)(this.start.sheet,_currentColumn,_currentRow);case 22:_currentColumn-=1;_context2.next=19;break;case 25:_currentRow+=1;_context2.next=17;break;case 28:_context2.next=57;break;case 30:if(!(bottom>0)){_context2.next=45;break}_currentRow2=this.effectiveEndRow(dependencyGraph);case 32:if(!(_currentRow2>=this.start.row)){_context2.next=43;break}_currentColumn2=this.start.col;case 34:if(!(_currentColumn2<=this.effectiveEndColumn(dependencyGraph))){_context2.next=40;break}_context2.next=37;return(0,_Cell.simpleCellAddress)(this.start.sheet,_currentColumn2,_currentRow2);case 37:_currentColumn2+=1;_context2.next=34;break;case 40:_currentRow2-=1;_context2.next=32;break;case 43:_context2.next=57;break;case 45:_currentRow3=this.start.row;case 46:if(!(_currentRow3<=this.effectiveEndRow(dependencyGraph))){_context2.next=57;break}_currentColumn3=this.start.col;case 48:if(!(_currentColumn3<=this.effectiveEndColumn(dependencyGraph))){_context2.next=54;break}_context2.next=51;return(0,_Cell.simpleCellAddress)(this.start.sheet,_currentColumn3,_currentRow3);case 51:_currentColumn3+=1;_context2.next=48;break;case 54:_currentRow3+=1;_context2.next=46;break;case 57:case"end":return _context2.stop()}}}),addressesWithDirection,this)}))},{key:"getAddress",value:function getAddress(col,row){if(col<0||row<0||row>this.height()-1||col>this.width()-1){throw Error("Index out of bound")}return(0,_Cell.simpleCellAddress)(this.start.sheet,this.start.col+col,this.start.row+row)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(maxColumns,maxRows){return this.end.col>=maxColumns||this.end.row>=maxRows}},{key:"effectiveEndColumn",value:function effectiveEndColumn(_dependencyGraph){return this.end.col}},{key:"effectiveEndRow",value:function effectiveEndRow(_dependencyGraph){return this.end.row}},{key:"sheet",get:function get(){return this.start.sheet}}],[{key:"fromAst",value:function fromAst(ast,baseAddress){if(ast.type===_parser.AstNodeType.CELL_RANGE){return AbsoluteCellRange.fromCellRange(ast,baseAddress)}else if(ast.type===_parser.AstNodeType.COLUMN_RANGE){return AbsoluteColumnRange.fromColumnRange(ast,baseAddress)}else{return AbsoluteRowRange.fromRowRange(ast,baseAddress)}}},{key:"fromCellRange",value:function fromCellRange(x,baseAddress){return new AbsoluteCellRange(new _parser.CellAddress(x.start.sheet,x.start.col,x.start.row,x.start.type).toSimpleCellAddress(baseAddress),new _parser.CellAddress(x.end.sheet,x.end.col,x.end.row,x.end.type).toSimpleCellAddress(baseAddress))}},{key:"spanFrom",value:function spanFrom(topLeftCorner,width,height){if(!Number.isFinite(width)&&Number.isFinite(height)){return new AbsoluteRowRange(topLeftCorner.sheet,topLeftCorner.row,topLeftCorner.row+height-1)}else if(!Number.isFinite(height)&&Number.isFinite(width)){return new AbsoluteColumnRange(topLeftCorner.sheet,topLeftCorner.col,topLeftCorner.col+width-1)}else if(Number.isFinite(height)&&Number.isFinite(width)){return new AbsoluteCellRange(topLeftCorner,(0,_Cell.simpleCellAddress)(topLeftCorner.sheet,topLeftCorner.col+width-1,topLeftCorner.row+height-1))}throw new Error(WRONG_RANGE_SIZE)}},{key:"fromCoordinates",value:function fromCoordinates(sheet,x1,y1,x2,y2){return new AbsoluteCellRange((0,_Cell.simpleCellAddress)(sheet,x1,y1),(0,_Cell.simpleCellAddress)(sheet,x2,y2))}},{key:"singleRangeFromCellAddress",value:function singleRangeFromCellAddress(cellAddress,baseAddress){var simpleCellAddress=cellAddress.toSimpleCellAddress(baseAddress);return new AbsoluteCellRange(simpleCellAddress,simpleCellAddress)}}]);return AbsoluteCellRange}();exports.AbsoluteCellRange=AbsoluteCellRange;var AbsoluteColumnRange=function(_AbsoluteCellRange){_inherits(AbsoluteColumnRange,_AbsoluteCellRange);var _super=_createSuper(AbsoluteColumnRange);_createClass(AbsoluteColumnRange,null,[{key:"fromColumnRange",value:function fromColumnRange(x,baseAddress){var start=x.start.toSimpleColumnAddress(baseAddress);var end=x.end.toSimpleColumnAddress(baseAddress);if(start.sheet!==end.sheet){throw new Error(DIFFERENT_SHEETS_ERROR)}return new AbsoluteColumnRange(start.sheet,start.col,end.col)}}]);function AbsoluteColumnRange(sheet,columnStart,columnEnd){_classCallCheck(this,AbsoluteColumnRange);return _super.call(this,(0,_Cell.simpleCellAddress)(sheet,columnStart,0),(0,_Cell.simpleCellAddress)(sheet,columnEnd,Number.POSITIVE_INFINITY))}_createClass(AbsoluteColumnRange,[{key:"shouldBeRemoved",value:function shouldBeRemoved(){return this.width()<=0}},{key:"shiftByRows",value:function shiftByRows(_numberOfRows){return}},{key:"expandByRows",value:function expandByRows(_numberOfRows){return}},{key:"shifted",value:function shifted(byCols,_byRows){return new AbsoluteColumnRange(this.sheet,this.start.col+byCols,this.end.col+byCols)}},{key:"removeRows",value:function removeRows(_rowStart,_rowEnd){return}},{key:"rangeWithSameHeight",value:function rangeWithSameHeight(startColumn,numberOfColumns){return new AbsoluteColumnRange(this.sheet,startColumn,startColumn+numberOfColumns-1)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(maxColumns,_maxRows){return this.end.col>=maxColumns}},{key:"effectiveEndRow",value:function effectiveEndRow(dependencyGraph){return dependencyGraph.getSheetHeight(this.sheet)-1}}]);return AbsoluteColumnRange}(AbsoluteCellRange);exports.AbsoluteColumnRange=AbsoluteColumnRange;var AbsoluteRowRange=function(_AbsoluteCellRange2){_inherits(AbsoluteRowRange,_AbsoluteCellRange2);var _super2=_createSuper(AbsoluteRowRange);_createClass(AbsoluteRowRange,null,[{key:"fromRowRange",value:function fromRowRange(x,baseAddress){var start=x.start.toSimpleRowAddress(baseAddress);var end=x.end.toSimpleRowAddress(baseAddress);if(start.sheet!==end.sheet){throw new Error(DIFFERENT_SHEETS_ERROR)}return new AbsoluteRowRange(start.sheet,start.row,end.row)}}]);function AbsoluteRowRange(sheet,rowStart,rowEnd){_classCallCheck(this,AbsoluteRowRange);return _super2.call(this,(0,_Cell.simpleCellAddress)(sheet,0,rowStart),(0,_Cell.simpleCellAddress)(sheet,Number.POSITIVE_INFINITY,rowEnd))}_createClass(AbsoluteRowRange,[{key:"shouldBeRemoved",value:function shouldBeRemoved(){return this.height()<=0}},{key:"shiftByColumns",value:function shiftByColumns(_numberOfColumns){return}},{key:"expandByColumns",value:function expandByColumns(_numberOfColumns){return}},{key:"shifted",value:function shifted(byCols,byRows){return new AbsoluteRowRange(this.sheet,this.start.row+byRows,this.end.row+byRows)}},{key:"removeColumns",value:function removeColumns(_columnStart,_columnEnd){return}},{key:"rangeWithSameWidth",value:function rangeWithSameWidth(startRow,numberOfRows){return new AbsoluteRowRange(this.sheet,startRow,startRow+numberOfRows-1)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(_maxColumns,maxRows){return this.end.row>=maxRows}},{key:"effectiveEndColumn",value:function effectiveEndColumn(dependencyGraph){return dependencyGraph.getSheetWidth(this.sheet)-1}}]);return AbsoluteRowRange}(AbsoluteCellRange);exports.AbsoluteRowRange=AbsoluteRowRange},function(module,exports,__webpack_require__){"use strict";var DESCRIPTORS=__webpack_require__(6);var global=__webpack_require__(3);var isForced=__webpack_require__(45);var redefine=__webpack_require__(22);var has=__webpack_require__(16);var classof=__webpack_require__(12);var inheritIfRequired=__webpack_require__(120);var toPrimitive=__webpack_require__(14);var fails=__webpack_require__(7);var create=__webpack_require__(50);var getOwnPropertyNames=__webpack_require__(37).f;var getOwnPropertyDescriptor=__webpack_require__(5).f;var defineProperty=__webpack_require__(20).f;var trim=__webpack_require__(134).trim;var NUMBER="Number";var NativeNumber=global[NUMBER];var NumberPrototype=NativeNumber.prototype;var BROKEN_CLASSOF=classof(create(NumberPrototype))==NUMBER;var toNumber=function(argument){var it=toPrimitive(argument,false);var first,third,radix,maxCode,digits,length,index,code;if(typeof it=="string"&&it.length>2){it=trim(it);first=it.charCodeAt(0);if(first===43||first===45){third=it.charCodeAt(2);if(third===88||third===120)return NaN}else if(first===48){switch(it.charCodeAt(1)){case 66:case 98:radix=2;maxCode=49;break;case 79:case 111:radix=8;maxCode=55;break;default:return+it}digits=it.slice(2);length=digits.length;for(index=0;index<length;index++){code=digits.charCodeAt(index);if(code<48||code>maxCode)return NaN}return parseInt(digits,radix)}}return+it};if(isForced(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1"))){var NumberWrapper=function Number(value){var it=arguments.length<1?0:value;var dummy=this;return dummy instanceof NumberWrapper&&(BROKEN_CLASSOF?fails((function(){NumberPrototype.valueOf.call(dummy)})):classof(dummy)!=NUMBER)?inheritIfRequired(new NativeNumber(toNumber(it)),dummy,NumberWrapper):toNumber(it)};for(var keys=DESCRIPTORS?getOwnPropertyNames(NativeNumber):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),j=0,key;keys.length>j;j++){if(has(NativeNumber,key=keys[j])&&!has(NumberWrapper,key)){defineProperty(NumberWrapper,key,getOwnPropertyDescriptor(NativeNumber,key))}}NumberWrapper.prototype=NumberPrototype;NumberPrototype.constructor=NumberWrapper;redefine(global,NUMBER,NumberWrapper)}},function(module,exports,__webpack_require__){var requireObjectCoercible=__webpack_require__(13);var whitespaces=__webpack_require__(135);var whitespace="["+whitespaces+"]";var ltrim=RegExp("^"+whitespace+whitespace+"*");var rtrim=RegExp(whitespace+whitespace+"*$");var createMethod=function(TYPE){return function($this){var string=String(requireObjectCoercible($this));if(TYPE&1)string=string.replace(ltrim,"");if(TYPE&2)string=string.replace(rtrim,"");return string}};module.exports={start:createMethod(1),end:createMethod(2),trim:createMethod(3)}},function(module,exports){module.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var numberIsFinite=__webpack_require__(137);$({target:"Number",stat:true},{isFinite:numberIsFinite})},function(module,exports,__webpack_require__){var global=__webpack_require__(3);var globalIsFinite=global.isFinite;module.exports=Number.isFinite||function isFinite(it){return typeof it=="number"&&globalIsFinite(it)}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.NamedExpressionDependency=exports.RowRangeDependency=exports.ColumnRangeDependency=exports.CellRangeDependency=exports.AddressDependency=exports.Unparser=exports.buildCellErrorAst=exports.buildParsingErrorAst=exports.buildCellRangeAst=exports.buildProcedureAst=exports.ParsingErrorType=exports.AstNodeType=exports.FormulaLexer=exports.buildLexerConfig=exports.collectDependencies=exports.ParserWithCaching=exports.CellAddress=exports.simpleCellAddressToString=exports.simpleCellAddressFromString=exports.cellAddressFromString=void 0;var _addressRepresentationConverters=__webpack_require__(139);exports.cellAddressFromString=_addressRepresentationConverters.cellAddressFromString;exports.simpleCellAddressFromString=_addressRepresentationConverters.simpleCellAddressFromString;exports.simpleCellAddressToString=_addressRepresentationConverters.simpleCellAddressToString;var _CellAddress=__webpack_require__(151);exports.CellAddress=_CellAddress.CellAddress;var _ParserWithCaching=__webpack_require__(156);exports.ParserWithCaching=_ParserWithCaching.ParserWithCaching;var _collectDependencies=__webpack_require__(172);exports.collectDependencies=_collectDependencies.collectDependencies;var _LexerConfig=__webpack_require__(153);exports.buildLexerConfig=_LexerConfig.buildLexerConfig;var _FormulaParser=__webpack_require__(165);exports.FormulaLexer=_FormulaParser.FormulaLexer;var _Ast=__webpack_require__(160);exports.AstNodeType=_Ast.AstNodeType;exports.ParsingErrorType=_Ast.ParsingErrorType;exports.buildProcedureAst=_Ast.buildProcedureAst;exports.buildCellRangeAst=_Ast.buildCellRangeAst;exports.buildParsingErrorAst=_Ast.buildParsingErrorAst;exports.buildCellErrorAst=_Ast.buildCellErrorAst;var _Unparser=__webpack_require__(171);exports.Unparser=_Unparser.Unparser;var _RelativeDependency=__webpack_require__(173);exports.AddressDependency=_RelativeDependency.AddressDependency;exports.CellRangeDependency=_RelativeDependency.CellRangeDependency;exports.ColumnRangeDependency=_RelativeDependency.ColumnRangeDependency;exports.RowRangeDependency=_RelativeDependency.RowRangeDependency;exports.NamedExpressionDependency=_RelativeDependency.NamedExpressionDependency},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);__webpack_require__(140);__webpack_require__(133);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(146);exports.__esModule=true;exports.columnIndexToLabel=columnIndexToLabel;exports.simpleCellAddressToString=exports.simpleCellAddressFromString=exports.rowAddressFromString=exports.columnAddressFromString=exports.cellAddressFromString=void 0;var _Cell=__webpack_require__(106);var _CellAddress=__webpack_require__(151);var _ColumnAddress=__webpack_require__(152);var _LexerConfig=__webpack_require__(153);var _RowAddress=__webpack_require__(155);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var addressRegex=new RegExp("^((([A-Za-z0-9_À-ʯ]+)|'([A-Za-z0-9".concat(_LexerConfig.additionalCharactersAllowedInQuotes,"_À-ʯ]+)')!)?(\\$?)([A-Za-z]+)(\\$?)([0-9]+)$"));var columnRegex=new RegExp("^((([A-Za-z0-9_À-ʯ]+)|'([A-Za-z0-9".concat(_LexerConfig.additionalCharactersAllowedInQuotes,"_À-ʯ]+)')!)?(\\$?)([A-Za-z]+)"));var rowRegex=new RegExp("^((([A-Za-z0-9_À-ʯ]+)|'([A-Za-z0-9".concat(_LexerConfig.additionalCharactersAllowedInQuotes,"_À-ʯ]+)')!)?(\\$?)([0-9]+)"));var cellAddressFromString=function cellAddressFromString(sheetMapping,stringAddress,baseAddress){var result=addressRegex.exec(stringAddress);var col=columnLabelToIndex(result[6]);var maybeSheetName=result[3]||result[4];var sheet=null;if(maybeSheetName){sheet=sheetMapping(maybeSheetName);if(sheet===undefined){return undefined}}var row=Number(result[8])-1;if(result[5]==="$"&&result[7]==="$"){return _CellAddress.CellAddress.absolute(sheet,col,row)}else if(result[5]==="$"){return _CellAddress.CellAddress.absoluteCol(sheet,col,row-baseAddress.row)}else if(result[7]==="$"){return _CellAddress.CellAddress.absoluteRow(sheet,col-baseAddress.col,row)}else{return _CellAddress.CellAddress.relative(sheet,col-baseAddress.col,row-baseAddress.row)}};exports.cellAddressFromString=cellAddressFromString;var columnAddressFromString=function columnAddressFromString(sheetMapping,stringAddress,baseAddress){var result=columnRegex.exec(stringAddress);var sheet=extractSheetNumber(result,sheetMapping);if(sheet===undefined){return undefined}var col=columnLabelToIndex(result[6]);if(result[5]==="$"){return _ColumnAddress.ColumnAddress.absolute(sheet,col)}else{return _ColumnAddress.ColumnAddress.relative(sheet,col-baseAddress.col)}};exports.columnAddressFromString=columnAddressFromString;var rowAddressFromString=function rowAddressFromString(sheetMapping,stringAddress,baseAddress){var result=rowRegex.exec(stringAddress);var sheet=extractSheetNumber(result,sheetMapping);if(sheet===undefined){return undefined}var row=Number(result[6])-1;if(result[5]==="$"){return _RowAddress.RowAddress.absolute(sheet,row)}else{return _RowAddress.RowAddress.relative(sheet,row-baseAddress.row)}};exports.rowAddressFromString=rowAddressFromString;var simpleCellAddressFromString=function simpleCellAddressFromString(sheetMapping,stringAddress,sheetContext){var result=addressRegex.exec(stringAddress);var col=columnLabelToIndex(result[6]);var maybeSheetName=result[3]||result[4];var sheet;if(maybeSheetName){sheet=sheetMapping(maybeSheetName)}else{sheet=sheetContext}if(sheet===undefined){return undefined}var row=Number(result[8])-1;return(0,_Cell.simpleCellAddress)(sheet,col,row)};exports.simpleCellAddressFromString=simpleCellAddressFromString;var simpleCellAddressToString=function simpleCellAddressToString(sheetIndexMapping,address,sheetIndex){var column=columnIndexToLabel(address.col);var sheetName=sheetIndexMapping(address.sheet);if(sheetName===undefined){return undefined}if(sheetIndex!==address.sheet){return"".concat(sheetName,"!").concat(column).concat(address.row+1)}else{return"".concat(column).concat(address.row+1)}};exports.simpleCellAddressToString=simpleCellAddressToString;function columnLabelToIndex(columnStringRepresentation){if(columnStringRepresentation.length===1){return columnStringRepresentation.toUpperCase().charCodeAt(0)-65}else{return columnStringRepresentation.split("").reduce((function(currentColumn,nextLetter){return currentColumn*26+(nextLetter.toUpperCase().charCodeAt(0)-64)}),0)-1}}function columnIndexToLabel(column){var result="";while(column>=0){result=String.fromCharCode(column%26+97)+result;column=Math.floor(column/26)-1}return result.toUpperCase()}function extractSheetNumber(regexResult,sheetMapping){var maybeSheetName=regexResult[3]||regexResult[4];var sheet=null;if(maybeSheetName){sheet=sheetMapping(maybeSheetName);if(sheet===undefined){return undefined}}return sheet}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $reduce=__webpack_require__(141).left;var arrayMethodIsStrict=__webpack_require__(112);var arrayMethodUsesToLength=__webpack_require__(88);var STRICT_METHOD=arrayMethodIsStrict("reduce");var USES_TO_LENGTH=arrayMethodUsesToLength("reduce",{1:0});$({target:"Array",proto:true,forced:!STRICT_METHOD||!USES_TO_LENGTH},{reduce:function reduce(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(61);var toObject=__webpack_require__(49);var IndexedObject=__webpack_require__(11);var toLength=__webpack_require__(40);var createMethod=function(IS_RIGHT){return function(that,callbackfn,argumentsLength,memo){aFunction(callbackfn);var O=toObject(that);var self=IndexedObject(O);var length=toLength(O.length);var index=IS_RIGHT?length-1:0;var i=IS_RIGHT?-1:1;if(argumentsLength<2)while(true){if(index in self){memo=self[index];index+=i;break}index+=i;if(IS_RIGHT?index<0:length<=index){throw TypeError("Reduce of empty array with no initial value")}}for(;IS_RIGHT?index>=0:length>index;index+=i)if(index in self){memo=callbackfn(memo,self[index],index,O)}return memo}};module.exports={left:createMethod(false),right:createMethod(true)}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var global=__webpack_require__(3);var isForced=__webpack_require__(45);var inheritIfRequired=__webpack_require__(120);var defineProperty=__webpack_require__(20).f;var getOwnPropertyNames=__webpack_require__(37).f;var isRegExp=__webpack_require__(102);var getFlags=__webpack_require__(97);var stickyHelpers=__webpack_require__(143);var redefine=__webpack_require__(22);var fails=__webpack_require__(7);var setInternalState=__webpack_require__(26).set;var setSpecies=__webpack_require__(123);var wellKnownSymbol=__webpack_require__(55);var MATCH=wellKnownSymbol("match");var NativeRegExp=global.RegExp;var RegExpPrototype=NativeRegExp.prototype;var re1=/a/g;var re2=/a/g;var CORRECT_NEW=new NativeRegExp(re1)!==re1;var UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y;var FORCED=DESCRIPTORS&&isForced("RegExp",!CORRECT_NEW||UNSUPPORTED_Y||fails((function(){re2[MATCH]=false;return NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||NativeRegExp(re1,"i")!="/a/i"})));if(FORCED){var RegExpWrapper=function RegExp(pattern,flags){var thisIsRegExp=this instanceof RegExpWrapper;var patternIsRegExp=isRegExp(pattern);var flagsAreUndefined=flags===undefined;var sticky;if(!thisIsRegExp&&patternIsRegExp&&pattern.constructor===RegExpWrapper&&flagsAreUndefined){return pattern}if(CORRECT_NEW){if(patternIsRegExp&&!flagsAreUndefined)pattern=pattern.source}else if(pattern instanceof RegExpWrapper){if(flagsAreUndefined)flags=getFlags.call(pattern);pattern=pattern.source}if(UNSUPPORTED_Y){sticky=!!flags&&flags.indexOf("y")>-1;if(sticky)flags=flags.replace(/y/g,"")}var result=inheritIfRequired(CORRECT_NEW?new NativeRegExp(pattern,flags):NativeRegExp(pattern,flags),thisIsRegExp?this:RegExpPrototype,RegExpWrapper);if(UNSUPPORTED_Y&&sticky)setInternalState(result,{sticky:sticky});return result};var proxy=function(key){key in RegExpWrapper||defineProperty(RegExpWrapper,key,{configurable:true,get:function(){return NativeRegExp[key]},set:function(it){NativeRegExp[key]=it}})};var keys=getOwnPropertyNames(NativeRegExp);var index=0;while(keys.length>index)proxy(keys[index++]);RegExpPrototype.constructor=RegExpWrapper;RegExpWrapper.prototype=RegExpPrototype;redefine(global,"RegExp",RegExpWrapper)}setSpecies("RegExp")},function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(7);function RE(s,f){return RegExp(s,f)}exports.UNSUPPORTED_Y=fails((function(){var re=RE("a","y");re.lastIndex=2;return re.exec("abcd")!=null}));exports.BROKEN_CARET=fails((function(){var re=RE("^r","gy");re.lastIndex=2;return re.exec("str")!=null}))},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var exec=__webpack_require__(145);$({target:"RegExp",proto:true,forced:/./.exec!==exec},{exec:exec})},function(module,exports,__webpack_require__){"use strict";var regexpFlags=__webpack_require__(97);var stickyHelpers=__webpack_require__(143);var nativeExec=RegExp.prototype.exec;var nativeReplace=String.prototype.replace;var patchedExec=nativeExec;var UPDATES_LAST_INDEX_WRONG=function(){var re1=/a/;var re2=/b*/g;nativeExec.call(re1,"a");nativeExec.call(re2,"a");return re1.lastIndex!==0||re2.lastIndex!==0}();var UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y||stickyHelpers.BROKEN_CARET;var NPCG_INCLUDED=/()??/.exec("")[1]!==undefined;var PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y;if(PATCH){patchedExec=function exec(str){var re=this;var lastIndex,reCopy,match,i;var sticky=UNSUPPORTED_Y&&re.sticky;var flags=regexpFlags.call(re);var source=re.source;var charsAdded=0;var strCopy=str;if(sticky){flags=flags.replace("y","");if(flags.indexOf("g")===-1){flags+="g"}strCopy=String(str).slice(re.lastIndex);if(re.lastIndex>0&&(!re.multiline||re.multiline&&str[re.lastIndex-1]!=="\n")){source="(?: "+source+")";strCopy=" "+strCopy;charsAdded++}reCopy=new RegExp("^(?:"+source+")",flags)}if(NPCG_INCLUDED){reCopy=new RegExp("^"+source+"$(?!\\s)",flags)}if(UPDATES_LAST_INDEX_WRONG)lastIndex=re.lastIndex;match=nativeExec.call(sticky?reCopy:re,strCopy);if(sticky){if(match){match.input=match.input.slice(charsAdded);match[0]=match[0].slice(charsAdded);match.index=re.lastIndex;re.lastIndex+=match[0].length}else re.lastIndex=0}else if(UPDATES_LAST_INDEX_WRONG&&match){re.lastIndex=re.global?match.index+match[0].length:lastIndex}if(NPCG_INCLUDED&&match&&match.length>1){nativeReplace.call(match[0],reCopy,(function(){for(i=1;i<arguments.length-2;i++){if(arguments[i]===undefined)match[i]=undefined}}))}return match}}module.exports=patchedExec},function(module,exports,__webpack_require__){"use strict";var fixRegExpWellKnownSymbolLogic=__webpack_require__(147);var isRegExp=__webpack_require__(102);var anObject=__webpack_require__(21);var requireObjectCoercible=__webpack_require__(13);var speciesConstructor=__webpack_require__(148);var advanceStringIndex=__webpack_require__(149);var toLength=__webpack_require__(40);var callRegExpExec=__webpack_require__(150);var regexpExec=__webpack_require__(145);var fails=__webpack_require__(7);var arrayPush=[].push;var min=Math.min;var MAX_UINT32=4294967295;var SUPPORTS_Y=!fails((function(){return!RegExp(MAX_UINT32,"y")}));fixRegExpWellKnownSymbolLogic("split",2,(function(SPLIT,nativeSplit,maybeCallNative){var internalSplit;if("abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length){internalSplit=function(separator,limit){var string=String(requireObjectCoercible(this));var lim=limit===undefined?MAX_UINT32:limit>>>0;if(lim===0)return[];if(separator===undefined)return[string];if(!isRegExp(separator)){return nativeSplit.call(string,separator,lim)}var output=[];var flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":"");var lastLastIndex=0;var separatorCopy=new RegExp(separator.source,flags+"g");var match,lastIndex,lastLength;while(match=regexpExec.call(separatorCopy,string)){lastIndex=separatorCopy.lastIndex;if(lastIndex>lastLastIndex){output.push(string.slice(lastLastIndex,match.index));if(match.length>1&&match.index<string.length)arrayPush.apply(output,match.slice(1));lastLength=match[0].length;lastLastIndex=lastIndex;if(output.length>=lim)break}if(separatorCopy.lastIndex===match.index)separatorCopy.lastIndex++}if(lastLastIndex===string.length){if(lastLength||!separatorCopy.test(""))output.push("")}else output.push(string.slice(lastLastIndex));return output.length>lim?output.slice(0,lim):output}}else if("0".split(undefined,0).length){internalSplit=function(separator,limit){return separator===undefined&&limit===0?[]:nativeSplit.call(this,separator,limit)}}else internalSplit=nativeSplit;return[function split(separator,limit){var O=requireObjectCoercible(this);var splitter=separator==undefined?undefined:separator[SPLIT];return splitter!==undefined?splitter.call(separator,O,limit):internalSplit.call(String(O),separator,limit)},function(regexp,limit){var res=maybeCallNative(internalSplit,regexp,this,limit,internalSplit!==nativeSplit);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var C=speciesConstructor(rx,RegExp);var unicodeMatching=rx.unicode;var flags=(rx.ignoreCase?"i":"")+(rx.multiline?"m":"")+(rx.unicode?"u":"")+(SUPPORTS_Y?"y":"g");var splitter=new C(SUPPORTS_Y?rx:"^(?:"+rx.source+")",flags);var lim=limit===undefined?MAX_UINT32:limit>>>0;if(lim===0)return[];if(S.length===0)return callRegExpExec(splitter,S)===null?[S]:[];var p=0;var q=0;var A=[];while(q<S.length){splitter.lastIndex=SUPPORTS_Y?q:0;var z=callRegExpExec(splitter,SUPPORTS_Y?S:S.slice(q));var e;if(z===null||(e=min(toLength(splitter.lastIndex+(SUPPORTS_Y?0:q)),S.length))===p){q=advanceStringIndex(S,q,unicodeMatching)}else{A.push(S.slice(p,q));if(A.length===lim)return A;for(var i=1;i<=z.length-1;i++){A.push(z[i]);if(A.length===lim)return A}q=p=e}}A.push(S.slice(p));return A}]}),!SUPPORTS_Y)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(144);var redefine=__webpack_require__(22);var fails=__webpack_require__(7);var wellKnownSymbol=__webpack_require__(55);var regexpExec=__webpack_require__(145);var createNonEnumerableProperty=__webpack_require__(19);var SPECIES=wellKnownSymbol("species");var REPLACE_SUPPORTS_NAMED_GROUPS=!fails((function(){var re=/./;re.exec=function(){var result=[];result.groups={a:"7"};return result};return"".replace(re,"$<a>")!=="7"}));var REPLACE_KEEPS_$0=function(){return"a".replace(/./,"$0")==="$0"}();var REPLACE=wellKnownSymbol("replace");var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=function(){if(/./[REPLACE]){return/./[REPLACE]("a","$0")===""}return false}();var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails((function(){var re=/(?:)/;var originalExec=re.exec;re.exec=function(){return originalExec.apply(this,arguments)};var result="ab".split(re);return result.length!==2||result[0]!=="a"||result[1]!=="b"}));module.exports=function(KEY,length,exec,sham){var SYMBOL=wellKnownSymbol(KEY);var DELEGATES_TO_SYMBOL=!fails((function(){var O={};O[SYMBOL]=function(){return 7};return""[KEY](O)!=7}));var DELEGATES_TO_EXEC=DELEGATES_TO_SYMBOL&&!fails((function(){var execCalled=false;var re=/a/;if(KEY==="split"){re={};re.constructor={};re.constructor[SPECIES]=function(){return re};re.flags="";re[SYMBOL]=/./[SYMBOL]}re.exec=function(){execCalled=true;return null};re[SYMBOL]("");return!execCalled}));if(!DELEGATES_TO_SYMBOL||!DELEGATES_TO_EXEC||KEY==="replace"&&!(REPLACE_SUPPORTS_NAMED_GROUPS&&REPLACE_KEEPS_$0&&!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE)||KEY==="split"&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var nativeRegExpMethod=/./[SYMBOL];var methods=exec(SYMBOL,""[KEY],(function(nativeMethod,regexp,str,arg2,forceStringMethod){if(regexp.exec===regexpExec){if(DELEGATES_TO_SYMBOL&&!forceStringMethod){return{done:true,value:nativeRegExpMethod.call(regexp,str,arg2)}}return{done:true,value:nativeMethod.call(str,regexp,arg2)}}return{done:false}}),{REPLACE_KEEPS_$0:REPLACE_KEEPS_$0,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE});var stringMethod=methods[0];var regexMethod=methods[1];redefine(String.prototype,KEY,stringMethod);redefine(RegExp.prototype,SYMBOL,length==2?function(string,arg){return regexMethod.call(string,this,arg)}:function(string){return regexMethod.call(string,this)})}if(sham)createNonEnumerableProperty(RegExp.prototype[SYMBOL],"sham",true)}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(21);var aFunction=__webpack_require__(61);var wellKnownSymbol=__webpack_require__(55);var SPECIES=wellKnownSymbol("species");module.exports=function(O,defaultConstructor){var C=anObject(O).constructor;var S;return C===undefined||(S=anObject(C)[SPECIES])==undefined?defaultConstructor:aFunction(S)}},function(module,exports,__webpack_require__){"use strict";var charAt=__webpack_require__(99).charAt;module.exports=function(S,index,unicode){return index+(unicode?charAt(S,index).length:1)}},function(module,exports,__webpack_require__){var classof=__webpack_require__(12);var regexpExec=__webpack_require__(145);module.exports=function(R,S){var exec=R.exec;if(typeof exec==="function"){var result=exec.call(R,S);if(typeof result!=="object"){throw TypeError("RegExp exec method returned something other than an Object or null")}return result}if(classof(R)!=="RegExp"){throw TypeError("RegExp#exec called on incompatible receiver")}return regexpExec.call(R,S)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);exports.__esModule=true;exports.CellAddress=exports.CellReferenceType=void 0;var _Cell=__webpack_require__(106);var _addressRepresentationConverters=__webpack_require__(139);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CellReferenceType;exports.CellReferenceType=CellReferenceType;(function(CellReferenceType){CellReferenceType["CELL_REFERENCE_RELATIVE"]="CELL_REFERENCE";CellReferenceType["CELL_REFERENCE_ABSOLUTE"]="CELL_REFERENCE_ABSOLUTE";CellReferenceType["CELL_REFERENCE_ABSOLUTE_COL"]="CELL_REFERENCE_ABSOLUTE_COL";CellReferenceType["CELL_REFERENCE_ABSOLUTE_ROW"]="CELL_REFERENCE_ABSOLUTE_ROW"})(CellReferenceType||(exports.CellReferenceType=CellReferenceType={}));var CellAddress=function(){function CellAddress(sheet,col,row,type){_classCallCheck(this,CellAddress);this.sheet=sheet;this.col=col;this.row=row;this.type=type}_createClass(CellAddress,[{key:"toSimpleCellAddress",value:function toSimpleCellAddress(baseAddress){var sheet=(0,_Cell.absoluteSheetReference)(this,baseAddress);if(this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE){return(0,_Cell.simpleCellAddress)(sheet,this.col,this.row)}else if(this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW){return(0,_Cell.simpleCellAddress)(sheet,baseAddress.col+this.col,this.row)}else if(this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL){return(0,_Cell.simpleCellAddress)(sheet,this.col,baseAddress.row+this.row)}else{return(0,_Cell.simpleCellAddress)(sheet,baseAddress.col+this.col,baseAddress.row+this.row)}}},{key:"toSimpleColumnAddress",value:function toSimpleColumnAddress(baseAddress){var sheet=(0,_Cell.absoluteSheetReference)(this,baseAddress);var column=this.col;if(this.isColumnRelative()){column+=baseAddress.col}return(0,_Cell.simpleColumnAddress)(sheet,column)}},{key:"toSimpleRowAddress",value:function toSimpleRowAddress(baseAddress){var sheet=(0,_Cell.absoluteSheetReference)(this,baseAddress);var row=this.row;if(this.isRowRelative()){row+=baseAddress.row}return(0,_Cell.simpleRowAddress)(sheet,row)}},{key:"isRowAbsolute",value:function isRowAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function isColumnAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function isColumnRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function isRowRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function isAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE&&this.sheet!==null}},{key:"shiftedByRows",value:function shiftedByRows(numberOfRows){return new CellAddress(this.sheet,this.col,this.row+numberOfRows,this.type)}},{key:"shiftedByColumns",value:function shiftedByColumns(numberOfColumns){return new CellAddress(this.sheet,this.col+numberOfColumns,this.row,this.type)}},{key:"moved",value:function moved(toSheet,toRight,toBottom){var newSheet=this.sheet===null?null:toSheet;return new CellAddress(newSheet,this.col+toRight,this.row+toBottom,this.type)}},{key:"withAbsoluteSheet",value:function withAbsoluteSheet(sheet){return new CellAddress(sheet,this.col,this.row,this.type)}},{key:"shiftRelativeDimensions",value:function shiftRelativeDimensions(toRight,toBottom){var col=this.isColumnAbsolute()?this.col:this.col+toRight;var row=this.isRowAbsolute()?this.row:this.row+toBottom;return new CellAddress(this.sheet,col,row,this.type)}},{key:"shiftAbsoluteDimensions",value:function shiftAbsoluteDimensions(toRight,toBottom){var col=this.isColumnRelative()?this.col:this.col+toRight;var row=this.isRowRelative()?this.row:this.row+toBottom;return new CellAddress(this.sheet,col,row,this.type)}},{key:"hash",value:function hash(withSheet){var sheetPart=withSheet&&this.sheet!==null?"#".concat(this.sheet):"";switch(this.type){case CellReferenceType.CELL_REFERENCE_RELATIVE:{return"".concat(sheetPart,"#").concat(this.row,"R").concat(this.col)}case CellReferenceType.CELL_REFERENCE_ABSOLUTE:{return"".concat(sheetPart,"#").concat(this.row,"A").concat(this.col)}case CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL:{return"".concat(sheetPart,"#").concat(this.row,"AC").concat(this.col)}case CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW:{return"".concat(sheetPart,"#").concat(this.row,"AR").concat(this.col)}}}},{key:"unparse",value:function unparse(baseAddress){var simpleAddress=this.toSimpleCellAddress(baseAddress);var column=(0,_addressRepresentationConverters.columnIndexToLabel)(simpleAddress.col);var rowDollar=this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";var colDollar=this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(colDollar).concat(column).concat(rowDollar).concat(simpleAddress.row+1)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(maxColumns,maxRows){return this.row>=maxRows||this.col>=maxColumns}}],[{key:"relative",value:function relative(sheet,col,row){return new CellAddress(sheet,col,row,CellReferenceType.CELL_REFERENCE_RELATIVE)}},{key:"absolute",value:function absolute(sheet,col,row){return new CellAddress(sheet,col,row,CellReferenceType.CELL_REFERENCE_ABSOLUTE)}},{key:"absoluteCol",value:function absoluteCol(sheet,col,row){return new CellAddress(sheet,col,row,CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL)}},{key:"absoluteRow",value:function absoluteRow(sheet,col,row){return new CellAddress(sheet,col,row,CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW)}}]);return CellAddress}();exports.CellAddress=CellAddress},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);exports.__esModule=true;exports.ColumnAddress=exports.ReferenceType=void 0;var _Cell=__webpack_require__(106);var _addressRepresentationConverters=__webpack_require__(139);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ReferenceType;exports.ReferenceType=ReferenceType;(function(ReferenceType){ReferenceType["RELATIVE"]="RELATIVE";ReferenceType["ABSOLUTE"]="ABSOLUTE"})(ReferenceType||(exports.ReferenceType=ReferenceType={}));var ColumnAddress=function(){function ColumnAddress(sheet,col,type){_classCallCheck(this,ColumnAddress);this.sheet=sheet;this.col=col;this.type=type}_createClass(ColumnAddress,[{key:"isColumnAbsolute",value:function isColumnAbsolute(){return this.type===ReferenceType.ABSOLUTE}},{key:"isColumnRelative",value:function isColumnRelative(){return this.type===ReferenceType.RELATIVE}},{key:"isAbsolute",value:function isAbsolute(){return this.type===ReferenceType.ABSOLUTE&&this.sheet!==null}},{key:"moved",value:function moved(toSheet,toRight,_toBottom){var newSheet=this.sheet===null?null:toSheet;return new ColumnAddress(newSheet,this.col+toRight,this.type)}},{key:"shiftedByColumns",value:function shiftedByColumns(numberOfColumns){return new ColumnAddress(this.sheet,this.col+numberOfColumns,this.type)}},{key:"toSimpleColumnAddress",value:function toSimpleColumnAddress(baseAddress){var sheet=(0,_Cell.absoluteSheetReference)(this,baseAddress);var column=this.col;if(this.isColumnRelative()){column=baseAddress.col+this.col}return(0,_Cell.simpleColumnAddress)(sheet,column)}},{key:"shiftRelativeDimensions",value:function shiftRelativeDimensions(toRight,_toBottom){var col=this.isColumnRelative()?this.col+toRight:this.col;return new ColumnAddress(this.sheet,col,this.type)}},{key:"shiftAbsoluteDimensions",value:function shiftAbsoluteDimensions(toRight,_toBottom){var col=this.isColumnAbsolute()?this.col+toRight:this.col;return new ColumnAddress(this.sheet,col,this.type)}},{key:"withAbsoluteSheet",value:function withAbsoluteSheet(sheet){return new ColumnAddress(sheet,this.col,this.type)}},{key:"hash",value:function hash(withSheet){var sheetPart=withSheet&&this.sheet!==null?"#".concat(this.sheet):"";switch(this.type){case ReferenceType.RELATIVE:{return"".concat(sheetPart,"#COLR").concat(this.col)}case ReferenceType.ABSOLUTE:{return"".concat(sheetPart,"#COLA").concat(this.col)}}}},{key:"unparse",value:function unparse(baseAddress){var simpleAddress=this.toSimpleColumnAddress(baseAddress);var column=(0,_addressRepresentationConverters.columnIndexToLabel)(simpleAddress.col);var dollar=this.type===ReferenceType.ABSOLUTE?"$":"";return"".concat(dollar).concat(column)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(maxColumns){return this.col>=maxColumns}}],[{key:"absolute",value:function absolute(sheet,column){return new ColumnAddress(sheet,column,ReferenceType.ABSOLUTE)}},{key:"relative",value:function relative(sheet,column){return new ColumnAddress(sheet,column,ReferenceType.RELATIVE)}}]);return ColumnAddress}();exports.ColumnAddress=ColumnAddress},function(module,exports,__webpack_require__){"use strict";__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);exports.__esModule=true;exports.buildLexerConfig=exports.WhiteSpace=exports.ErrorLiteral=exports.StringLiteral=exports.NamedExpression=exports.ProcedureName=exports.RParen=exports.LParen=exports.RangeSeparator=exports.RowRange=exports.ColumnRange=exports.CellReference=exports.sheetNameRegexp=exports.additionalCharactersAllowedInQuotes=exports.ConcatenateOp=exports.LessThanOrEqualOp=exports.GreaterThanOrEqualOp=exports.LessThanOp=exports.GreaterThanOp=exports.NotEqualOp=exports.EqualsOp=exports.BooleanOp=exports.PercentOp=exports.PowerOp=exports.DivOp=exports.TimesOp=exports.MultiplicationOp=exports.MinusOp=exports.PlusOp=exports.AdditionOp=void 0;var _chevrotain=__webpack_require__(154);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var AdditionOp=(0,_chevrotain.createToken)({name:"AdditionOp",pattern:_chevrotain.Lexer.NA});exports.AdditionOp=AdditionOp;var PlusOp=(0,_chevrotain.createToken)({name:"PlusOp",pattern:/\+/,categories:AdditionOp});exports.PlusOp=PlusOp;var MinusOp=(0,_chevrotain.createToken)({name:"MinusOp",pattern:/-/,categories:AdditionOp});exports.MinusOp=MinusOp;var MultiplicationOp=(0,_chevrotain.createToken)({name:"MultiplicationOp",pattern:_chevrotain.Lexer.NA});exports.MultiplicationOp=MultiplicationOp;var TimesOp=(0,_chevrotain.createToken)({name:"TimesOp",pattern:/\*/,categories:MultiplicationOp});exports.TimesOp=TimesOp;var DivOp=(0,_chevrotain.createToken)({name:"DivOp",pattern:/\//,categories:MultiplicationOp});exports.DivOp=DivOp;var PowerOp=(0,_chevrotain.createToken)({name:"PowerOp",pattern:/\^/});exports.PowerOp=PowerOp;var PercentOp=(0,_chevrotain.createToken)({name:"PercentOp",pattern:/%/});exports.PercentOp=PercentOp;var BooleanOp=(0,_chevrotain.createToken)({name:"BooleanOp",pattern:_chevrotain.Lexer.NA});exports.BooleanOp=BooleanOp;var EqualsOp=(0,_chevrotain.createToken)({name:"EqualsOp",pattern:/=/,categories:BooleanOp});exports.EqualsOp=EqualsOp;var NotEqualOp=(0,_chevrotain.createToken)({name:"NotEqualOp",pattern:/<>/,categories:BooleanOp});exports.NotEqualOp=NotEqualOp;var GreaterThanOp=(0,_chevrotain.createToken)({name:"GreaterThanOp",pattern:/>/,categories:BooleanOp});exports.GreaterThanOp=GreaterThanOp;var LessThanOp=(0,_chevrotain.createToken)({name:"LessThanOp",pattern:/</,categories:BooleanOp});exports.LessThanOp=LessThanOp;var GreaterThanOrEqualOp=(0,_chevrotain.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:BooleanOp});exports.GreaterThanOrEqualOp=GreaterThanOrEqualOp;var LessThanOrEqualOp=(0,_chevrotain.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:BooleanOp});exports.LessThanOrEqualOp=LessThanOrEqualOp;var ConcatenateOp=(0,_chevrotain.createToken)({name:"ConcatenateOp",pattern:/&/});exports.ConcatenateOp=ConcatenateOp;var additionalCharactersAllowedInQuotes=" ";exports.additionalCharactersAllowedInQuotes=additionalCharactersAllowedInQuotes;var sheetNameRegexp="([A-Za-z0-9_À-ʯ]+|'[A-Za-z0-9".concat(additionalCharactersAllowedInQuotes,"_À-ʯ]+')!");exports.sheetNameRegexp=sheetNameRegexp;var CellReference=(0,_chevrotain.createToken)({name:"CellReference",pattern:new RegExp("(".concat(sheetNameRegexp,")?\\$?[A-Za-z]+\\$?[0-9]+"))});exports.CellReference=CellReference;var ColumnRange=(0,_chevrotain.createToken)({name:"ColumnRange",pattern:new RegExp("(".concat(sheetNameRegexp,")?\\$?[A-Za-z]+:(").concat(sheetNameRegexp,")?\\$?[A-Za-z]+"))});exports.ColumnRange=ColumnRange;var RowRange=(0,_chevrotain.createToken)({name:"RowRange",pattern:new RegExp("(".concat(sheetNameRegexp,")?\\$?[0-9]+:(").concat(sheetNameRegexp,")?\\$?[0-9]+"))});exports.RowRange=RowRange;var RangeSeparator=(0,_chevrotain.createToken)({name:"RangeSeparator",pattern:/:/});exports.RangeSeparator=RangeSeparator;var LParen=(0,_chevrotain.createToken)({name:"LParen",pattern:/\(/});exports.LParen=LParen;var RParen=(0,_chevrotain.createToken)({name:"RParen",pattern:/\)/});exports.RParen=RParen;var ProcedureName=(0,_chevrotain.createToken)({name:"ProcedureName",pattern:/(\.?[0-9A-Za-z\u00C0-\u02AF]+)+\(/});exports.ProcedureName=ProcedureName;var NamedExpression=(0,_chevrotain.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][0-9\.A-Za-z_\u00C0-\u02AF_]+/});exports.NamedExpression=NamedExpression;var StringLiteral=(0,_chevrotain.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/});exports.StringLiteral=StringLiteral;var ErrorLiteral=(0,_chevrotain.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/});exports.ErrorLiteral=ErrorLiteral;var WhiteSpace=(0,_chevrotain.createToken)({name:"WhiteSpace",pattern:/[ \t\n\r]+/});exports.WhiteSpace=WhiteSpace;var buildLexerConfig=function buildLexerConfig(config){var offsetProcedureNameLiteral=config.translationPackage.getFunctionTranslation("OFFSET");var errorMapping=config.errorMapping;var functionMapping=config.translationPackage.buildFunctionMapping();var ArgSeparator=(0,_chevrotain.createToken)({name:"ArgSeparator",pattern:config.functionArgSeparator});var NumberLiteral=(0,_chevrotain.createToken)({name:"NumberLiteral",pattern:new RegExp("[\\d]*[".concat(config.decimalSeparator,"]?[\\d]+"))});var OffsetProcedureName=(0,_chevrotain.createToken)({name:"OffsetProcedureName",pattern:new RegExp(offsetProcedureNameLiteral,"i")});var allTokens=[WhiteSpace,PlusOp,MinusOp,TimesOp,DivOp,PowerOp,EqualsOp,NotEqualOp,PercentOp,GreaterThanOrEqualOp,LessThanOrEqualOp,GreaterThanOp,LessThanOp,LParen,RParen,OffsetProcedureName,ProcedureName,RangeSeparator,ArgSeparator,ColumnRange,RowRange,NumberLiteral,StringLiteral,ErrorLiteral,ConcatenateOp,BooleanOp,AdditionOp,MultiplicationOp,CellReference,NamedExpression];return{ArgSeparator:ArgSeparator,NumberLiteral:NumberLiteral,OffsetProcedureName:OffsetProcedureName,allTokens:allTokens,errorMapping:errorMapping,functionMapping:functionMapping,decimalSeparator:config.decimalSeparator,maxColumns:config.maxColumns,maxRows:config.maxRows}};exports.buildLexerConfig=buildLexerConfig},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE__154__},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);exports.__esModule=true;exports.RowAddress=void 0;var _Cell=__webpack_require__(106);var _ColumnAddress=__webpack_require__(152);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var RowAddress=function(){function RowAddress(sheet,row,type){_classCallCheck(this,RowAddress);this.sheet=sheet;this.row=row;this.type=type}_createClass(RowAddress,[{key:"isRowAbsolute",value:function isRowAbsolute(){return this.type===_ColumnAddress.ReferenceType.ABSOLUTE}},{key:"isRowRelative",value:function isRowRelative(){return this.type===_ColumnAddress.ReferenceType.RELATIVE}},{key:"isAbsolute",value:function isAbsolute(){return this.type===_ColumnAddress.ReferenceType.ABSOLUTE&&this.sheet!==null}},{key:"moved",value:function moved(toSheet,toRight,toBottom){var newSheet=this.sheet===null?null:toSheet;return new RowAddress(newSheet,this.row+toBottom,this.type)}},{key:"shiftedByRows",value:function shiftedByRows(numberOfColumns){return new RowAddress(this.sheet,this.row+numberOfColumns,this.type)}},{key:"toSimpleRowAddress",value:function toSimpleRowAddress(baseAddress){var sheet=(0,_Cell.absoluteSheetReference)(this,baseAddress);var row=this.row;if(this.isRowRelative()){row=baseAddress.row+this.row}return(0,_Cell.simpleRowAddress)(sheet,row)}},{key:"shiftRelativeDimensions",value:function shiftRelativeDimensions(toRight,toBottom){var row=this.isRowRelative()?this.row+toBottom:this.row;return new RowAddress(this.sheet,row,this.type)}},{key:"shiftAbsoluteDimensions",value:function shiftAbsoluteDimensions(toRight,toBottom){var row=this.isRowAbsolute()?this.row+toBottom:this.row;return new RowAddress(this.sheet,row,this.type)}},{key:"withAbsoluteSheet",value:function withAbsoluteSheet(sheet){return new RowAddress(sheet,this.row,this.type)}},{key:"hash",value:function hash(withSheet){var sheetPart=withSheet&&this.sheet!==null?"#".concat(this.sheet):"";switch(this.type){case _ColumnAddress.ReferenceType.RELATIVE:{return"".concat(sheetPart,"#ROWR").concat(this.row)}case _ColumnAddress.ReferenceType.ABSOLUTE:{return"".concat(sheetPart,"#ROWA").concat(this.row)}}}},{key:"unparse",value:function unparse(baseAddress){var simpleAddress=this.toSimpleRowAddress(baseAddress);var dollar=this.type===_ColumnAddress.ReferenceType.ABSOLUTE?"$":"";return"".concat(dollar).concat(simpleAddress.row+1)}},{key:"exceedsSheetSizeLimits",value:function exceedsSheetSizeLimits(maxRows){return this.row>=maxRows}}],[{key:"absolute",value:function absolute(sheet,row){return new RowAddress(sheet,row,_ColumnAddress.ReferenceType.ABSOLUTE)}},{key:"relative",value:function relative(sheet,row){return new RowAddress(sheet,row,_ColumnAddress.ReferenceType.RELATIVE)}}]);return RowAddress}();exports.RowAddress=RowAddress},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(157);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(158);__webpack_require__(92);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(146);__webpack_require__(104);exports.__esModule=true;exports.bindWhitespacesToTokens=bindWhitespacesToTokens;exports.ParserWithCaching=void 0;var _chevrotain=__webpack_require__(154);var _Cell=__webpack_require__(106);var _=__webpack_require__(138);var _addressRepresentationConverters=__webpack_require__(139);var _Ast=__webpack_require__(160);var _binaryOpTokenMap=__webpack_require__(161);var _Cache=__webpack_require__(162);var _FormulaParser=__webpack_require__(165);var _LexerConfig=__webpack_require__(153);var _Unparser=__webpack_require__(171);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ParserWithCaching=function(){function ParserWithCaching(config,functionRegistry,sheetMapping){_classCallCheck(this,ParserWithCaching);this.config=config;this.functionRegistry=functionRegistry;this.sheetMapping=sheetMapping;this.statsCacheUsed=0;this.lexerConfig=(0,_LexerConfig.buildLexerConfig)(config);this.lexer=new _FormulaParser.FormulaLexer(this.lexerConfig);this.formulaParser=new _FormulaParser.FormulaParser(this.lexerConfig,this.sheetMapping);this.cache=new _Cache.Cache(this.functionRegistry)}_createClass(ParserWithCaching,[{key:"parse",value:function parse(text,formulaAddress){var lexerResult=this.lexer.tokenizeFormula(text);if(lexerResult.errors.length>0){var errors=lexerResult.errors.map((function(e){return{type:_Ast.ParsingErrorType.LexingError,message:e.message}}));return{ast:(0,_.buildParsingErrorAst)(),errors:errors,hasVolatileFunction:false,hasStructuralChangeFunction:false,dependencies:[]}}var hash=this.computeHashFromTokens(lexerResult.tokens,formulaAddress);var cacheResult=this.cache.get(hash);if(cacheResult){++this.statsCacheUsed}else{var processedTokens=bindWhitespacesToTokens(lexerResult.tokens);var parsingResult=this.formulaParser.parseFromTokens(processedTokens,formulaAddress);if(parsingResult.errors.length>0){return Object.assign(Object.assign({},parsingResult),{hasVolatileFunction:false,hasStructuralChangeFunction:false,dependencies:[]})}else{cacheResult=this.cache.set(hash,parsingResult.ast)}}var _cacheResult=cacheResult,ast=_cacheResult.ast,hasVolatileFunction=_cacheResult.hasVolatileFunction,hasStructuralChangeFunction=_cacheResult.hasStructuralChangeFunction,relativeDependencies=_cacheResult.relativeDependencies;return{ast:ast,errors:[],hasVolatileFunction:hasVolatileFunction,hasStructuralChangeFunction:hasStructuralChangeFunction,dependencies:relativeDependencies}}},{key:"fetchCachedResultForAst",value:function fetchCachedResultForAst(ast){var hash=this.computeHashFromAst(ast);return this.fetchCachedResult(hash)}},{key:"fetchCachedResult",value:function fetchCachedResult(hash){var cacheResult=this.cache.get(hash);if(cacheResult===null){throw new Error("There is no AST with such key in the cache")}else{var ast=cacheResult.ast,hasVolatileFunction=cacheResult.hasVolatileFunction,hasStructuralChangeFunction=cacheResult.hasStructuralChangeFunction,relativeDependencies=cacheResult.relativeDependencies;return{ast:ast,errors:[],hasVolatileFunction:hasVolatileFunction,hasStructuralChangeFunction:hasStructuralChangeFunction,dependencies:relativeDependencies}}}},{key:"computeHashFromTokens",value:function computeHashFromTokens(tokens,baseAddress){var _a;var hash="";var idx=0;while(idx<tokens.length){var token=tokens[idx];if((0,_chevrotain.tokenMatcher)(token,_LexerConfig.CellReference)){var cellAddress=(0,_addressRepresentationConverters.cellAddressFromString)(this.sheetMapping,token.image,baseAddress);if(cellAddress===undefined){hash=hash.concat(token.image)}else{hash=hash.concat(cellAddress.hash(true))}}else if((0,_chevrotain.tokenMatcher)(token,_LexerConfig.ProcedureName)){var procedureName=token.image.toUpperCase().slice(0,-1);var canonicalProcedureName=(_a=this.lexerConfig.functionMapping[procedureName])!==null&&_a!==void 0?_a:procedureName;hash=hash.concat(canonicalProcedureName,"(")}else if((0,_chevrotain.tokenMatcher)(token,_LexerConfig.ColumnRange)){var _token$image$split=token.image.split(":"),_token$image$split2=_slicedToArray(_token$image$split,2),start=_token$image$split2[0],end=_token$image$split2[1];var startAddress=(0,_addressRepresentationConverters.columnAddressFromString)(this.sheetMapping,start,baseAddress);var endAddress=(0,_addressRepresentationConverters.columnAddressFromString)(this.sheetMapping,end,baseAddress);if(startAddress===undefined||endAddress===undefined){hash=hash.concat("!REF")}else{hash=hash.concat(startAddress.hash(true),":",endAddress.hash(true))}}else if((0,_chevrotain.tokenMatcher)(token,_LexerConfig.RowRange)){var _token$image$split3=token.image.split(":"),_token$image$split4=_slicedToArray(_token$image$split3,2),_start=_token$image$split4[0],_end=_token$image$split4[1];var _startAddress=(0,_addressRepresentationConverters.rowAddressFromString)(this.sheetMapping,_start,baseAddress);var _endAddress=(0,_addressRepresentationConverters.rowAddressFromString)(this.sheetMapping,_end,baseAddress);if(_startAddress===undefined||_endAddress===undefined){hash=hash.concat("!REF")}else{hash=hash.concat(_startAddress.hash(true),":",_endAddress.hash(true))}}else{hash=hash.concat(token.image)}idx++}return hash}},{key:"rememberNewAst",value:function rememberNewAst(ast){var hash=this.computeHashFromAst(ast);return this.cache.maybeSetAndThenGet(hash,ast)}},{key:"computeHashFromAst",value:function computeHashFromAst(ast){return"="+this.computeHashOfAstNode(ast)}},{key:"destroy",value:function destroy(){this.cache.destroy()}},{key:"computeHashOfAstNode",value:function computeHashOfAstNode(ast){var _this=this;switch(ast.type){case _.AstNodeType.EMPTY:{return ast.leadingWhitespace||""}case _.AstNodeType.NUMBER:{return(0,_Ast.imageWithWhitespace)((0,_Unparser.formatNumber)(ast.value,this.config.decimalSeparator),ast.leadingWhitespace)}case _.AstNodeType.STRING:{return(0,_Ast.imageWithWhitespace)('"'+ast.value+'"',ast.leadingWhitespace)}case _.AstNodeType.NAMED_EXPRESSION:{return(0,_Ast.imageWithWhitespace)(ast.expressionName,ast.leadingWhitespace)}case _.AstNodeType.FUNCTION_CALL:{var args=ast.args.map((function(arg){return _this.computeHashOfAstNode(arg)})).join(this.config.functionArgSeparator);var rightPart=ast.procedureName+"("+args+(0,_Ast.imageWithWhitespace)(")",ast.internalWhitespace);return(0,_Ast.imageWithWhitespace)(rightPart,ast.leadingWhitespace)}case _.AstNodeType.CELL_REFERENCE:{return(0,_Ast.imageWithWhitespace)(ast.reference.hash(true),ast.leadingWhitespace)}case _.AstNodeType.COLUMN_RANGE:case _.AstNodeType.ROW_RANGE:case _.AstNodeType.CELL_RANGE:{var start=ast.start.hash(ast.sheetReferenceType!==_Ast.RangeSheetReferenceType.RELATIVE);var end=ast.end.hash(ast.sheetReferenceType===_Ast.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,_Ast.imageWithWhitespace)(start+":"+end,ast.leadingWhitespace)}case _.AstNodeType.MINUS_UNARY_OP:{return(0,_Ast.imageWithWhitespace)("-"+this.computeHashOfAstNode(ast.value),ast.leadingWhitespace)}case _.AstNodeType.PLUS_UNARY_OP:{return(0,_Ast.imageWithWhitespace)("+"+this.computeHashOfAstNode(ast.value),ast.leadingWhitespace)}case _.AstNodeType.PERCENT_OP:{return this.computeHashOfAstNode(ast.value)+(0,_Ast.imageWithWhitespace)("%",ast.leadingWhitespace)}case _.AstNodeType.ERROR:{var image=this.config.translationPackage.getErrorTranslation(ast.error?ast.error.type:_Cell.ErrorType.ERROR);return(0,_Ast.imageWithWhitespace)(image,ast.leadingWhitespace)}case _.AstNodeType.ERROR_WITH_RAW_INPUT:{return(0,_Ast.imageWithWhitespace)(ast.rawInput,ast.leadingWhitespace)}case _.AstNodeType.PARENTHESIS:{var expression=this.computeHashOfAstNode(ast.expression);var _rightPart="("+expression+(0,_Ast.imageWithWhitespace)(")",ast.internalWhitespace);return(0,_Ast.imageWithWhitespace)(_rightPart,ast.leadingWhitespace)}default:{return this.computeHashOfAstNode(ast.left)+(0,_Ast.imageWithWhitespace)(_binaryOpTokenMap.binaryOpTokenMap[ast.type],ast.leadingWhitespace)+this.computeHashOfAstNode(ast.right)}}}}]);return ParserWithCaching}();exports.ParserWithCaching=ParserWithCaching;function bindWhitespacesToTokens(tokens){var processedTokens=[];var first=tokens[0];if(!(0,_chevrotain.tokenMatcher)(first,_LexerConfig.WhiteSpace)){processedTokens.push(first)}for(var i=1;i<tokens.length;++i){var current=tokens[i];if((0,_chevrotain.tokenMatcher)(current,_LexerConfig.WhiteSpace)){continue}var previous=tokens[i-1];if((0,_chevrotain.tokenMatcher)(previous,_LexerConfig.WhiteSpace)){current.leadingWhitespace=previous}processedTokens.push(current)}return processedTokens}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var IndexedObject=__webpack_require__(11);var toIndexedObject=__webpack_require__(10);var arrayMethodIsStrict=__webpack_require__(112);var nativeJoin=[].join;var ES3_STRINGS=IndexedObject!=Object;var STRICT_METHOD=arrayMethodIsStrict("join",",");$({target:"Array",proto:true,forced:ES3_STRINGS||!STRICT_METHOD},{join:function join(separator){return nativeJoin.call(toIndexedObject(this),separator===undefined?",":separator)}})},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var assign=__webpack_require__(159);$({target:"Object",stat:true,forced:Object.assign!==assign},{assign:assign})},function(module,exports,__webpack_require__){"use strict";var DESCRIPTORS=__webpack_require__(6);var fails=__webpack_require__(7);var objectKeys=__webpack_require__(52);var getOwnPropertySymbolsModule=__webpack_require__(44);var propertyIsEnumerableModule=__webpack_require__(8);var toObject=__webpack_require__(49);var IndexedObject=__webpack_require__(11);var nativeAssign=Object.assign;var defineProperty=Object.defineProperty;module.exports=!nativeAssign||fails((function(){if(DESCRIPTORS&&nativeAssign({b:1},nativeAssign(defineProperty({},"a",{enumerable:true,get:function(){defineProperty(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var A={};var B={};var symbol=Symbol();var alphabet="abcdefghijklmnopqrst";A[symbol]=7;alphabet.split("").forEach((function(chr){B[chr]=chr}));return nativeAssign({},A)[symbol]!=7||objectKeys(nativeAssign({},B)).join("")!=alphabet}))?function assign(target,source){var T=toObject(target);var argumentsLength=arguments.length;var index=1;var getOwnPropertySymbols=getOwnPropertySymbolsModule.f;var propertyIsEnumerable=propertyIsEnumerableModule.f;while(argumentsLength>index){var S=IndexedObject(arguments[index++]);var keys=getOwnPropertySymbols?objectKeys(S).concat(getOwnPropertySymbols(S)):objectKeys(S);var length=keys.length;var j=0;var key;while(length>j){key=keys[j++];if(!DESCRIPTORS||propertyIsEnumerable.call(S,key))T[key]=S[key]}}return T}:nativeAssign},function(module,exports,__webpack_require__){"use strict";__webpack_require__(84);exports.__esModule=true;exports.imageWithWhitespace=imageWithWhitespace;exports.buildParsingErrorAst=exports.buildErrorWithRawInputAst=exports.buildCellErrorAst=exports.buildParenthesisAst=exports.buildNamedExpressionAst=exports.buildProcedureAst=exports.buildPercentOpAst=exports.buildPlusUnaryOpAst=exports.buildMinusUnaryOpAst=exports.buildPowerOpAst=exports.buildDivOpAst=exports.buildTimesOpAst=exports.buildMinusOpAst=exports.buildPlusOpAst=exports.buildLessThanOrEqualOpAst=exports.buildGreaterThanOrEqualOpAst=exports.buildLessThanOpAst=exports.buildGreaterThanOpAst=exports.buildNotEqualOpAst=exports.buildEqualsOpAst=exports.buildConcatenateOpAst=exports.buildRowRangeAst=exports.buildColumnRangeAst=exports.buildCellRangeAst=exports.buildCellReferenceAst=exports.buildStringAst=exports.buildNumberAst=exports.buildEmptyArgAst=exports.RangeSheetReferenceType=exports.AstNodeType=exports.ParsingErrorType=exports.parsingError=void 0;var _Cell=__webpack_require__(106);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var parsingError=function parsingError(type,message){return{type:type,message:message}};exports.parsingError=parsingError;var ParsingErrorType;exports.ParsingErrorType=ParsingErrorType;(function(ParsingErrorType){ParsingErrorType["LexingError"]="LexingError";ParsingErrorType["ParserError"]="ParsingError";ParsingErrorType["StaticOffsetError"]="StaticOffsetError";ParsingErrorType["StaticOffsetOutOfRangeError"]="StaticOffsetOutOfRangeError";ParsingErrorType["RangeOffsetNotAllowed"]="RangeOffsetNotAllowed"})(ParsingErrorType||(exports.ParsingErrorType=ParsingErrorType={}));var AstNodeType;exports.AstNodeType=AstNodeType;(function(AstNodeType){AstNodeType["EMPTY"]="EMPTY";AstNodeType["NUMBER"]="NUMBER";AstNodeType["STRING"]="STRING";AstNodeType["MINUS_UNARY_OP"]="MINUS_UNARY_OP";AstNodeType["PLUS_UNARY_OP"]="PLUS_UNARY_OP";AstNodeType["PERCENT_OP"]="PERCENT_OP";AstNodeType["CONCATENATE_OP"]="CONCATENATE_OP";AstNodeType["EQUALS_OP"]="EQUALS_OP";AstNodeType["NOT_EQUAL_OP"]="NOT_EQUAL_OP";AstNodeType["GREATER_THAN_OP"]="GREATER_THAN_OP";AstNodeType["LESS_THAN_OP"]="LESS_THAN_OP";AstNodeType["GREATER_THAN_OR_EQUAL_OP"]="GREATER_THAN_OR_EQUAL_OP";AstNodeType["LESS_THAN_OR_EQUAL_OP"]="LESS_THAN_OR_EQUAL_OP";AstNodeType["PLUS_OP"]="PLUS_OP";AstNodeType["MINUS_OP"]="MINUS_OP";AstNodeType["TIMES_OP"]="TIMES_OP";AstNodeType["DIV_OP"]="DIV_OP";AstNodeType["POWER_OP"]="POWER_OP";AstNodeType["FUNCTION_CALL"]="FUNCTION_CALL";AstNodeType["NAMED_EXPRESSION"]="NAMED_EXPRESSION";AstNodeType["PARENTHESIS"]="PARENTHESES";AstNodeType["CELL_REFERENCE"]="CELL_REFERENCE";AstNodeType["CELL_RANGE"]="CELL_RANGE";AstNodeType["COLUMN_RANGE"]="COLUMN_RANGE";AstNodeType["ROW_RANGE"]="ROW_RANGE";AstNodeType["ERROR"]="ERROR";AstNodeType["ERROR_WITH_RAW_INPUT"]="ERROR_WITH_RAW_INPUT"})(AstNodeType||(exports.AstNodeType=AstNodeType={}));var RangeSheetReferenceType;exports.RangeSheetReferenceType=RangeSheetReferenceType;(function(RangeSheetReferenceType){RangeSheetReferenceType[RangeSheetReferenceType["RELATIVE"]=0]="RELATIVE";RangeSheetReferenceType[RangeSheetReferenceType["START_ABSOLUTE"]=1]="START_ABSOLUTE";RangeSheetReferenceType[RangeSheetReferenceType["BOTH_ABSOLUTE"]=2]="BOTH_ABSOLUTE"})(RangeSheetReferenceType||(exports.RangeSheetReferenceType=RangeSheetReferenceType={}));var buildEmptyArgAst=function buildEmptyArgAst(leadingWhitespace){return{type:AstNodeType.EMPTY,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildEmptyArgAst=buildEmptyArgAst;var buildNumberAst=function buildNumberAst(value,leadingWhitespace){return{type:AstNodeType.NUMBER,value:value,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildNumberAst=buildNumberAst;var buildStringAst=function buildStringAst(token){var _a;return{type:AstNodeType.STRING,value:token.image.slice(1,-1),leadingWhitespace:(_a=token.leadingWhitespace)===null||_a===void 0?void 0:_a.image}};exports.buildStringAst=buildStringAst;var buildCellReferenceAst=function buildCellReferenceAst(reference,leadingWhitespace){return{type:AstNodeType.CELL_REFERENCE,reference:reference,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildCellReferenceAst=buildCellReferenceAst;var buildCellRangeAst=function buildCellRangeAst(start,end,sheetReferenceType,leadingWhitespace){assertRangeConsistency(start,end,sheetReferenceType);return{type:AstNodeType.CELL_RANGE,start:start,end:end,sheetReferenceType:sheetReferenceType,leadingWhitespace:leadingWhitespace}};exports.buildCellRangeAst=buildCellRangeAst;var buildColumnRangeAst=function buildColumnRangeAst(start,end,sheetReferenceType,leadingWhitespace){assertRangeConsistency(start,end,sheetReferenceType);return{type:AstNodeType.COLUMN_RANGE,start:start,end:end,sheetReferenceType:sheetReferenceType,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildColumnRangeAst=buildColumnRangeAst;var buildRowRangeAst=function buildRowRangeAst(start,end,sheetReferenceType,leadingWhitespace){assertRangeConsistency(start,end,sheetReferenceType);return{type:AstNodeType.ROW_RANGE,start:start,end:end,sheetReferenceType:sheetReferenceType,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildRowRangeAst=buildRowRangeAst;var buildConcatenateOpAst=function buildConcatenateOpAst(left,right,leadingWhitespace){return{type:AstNodeType.CONCATENATE_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildConcatenateOpAst=buildConcatenateOpAst;var buildEqualsOpAst=function buildEqualsOpAst(left,right,leadingWhitespace){return{type:AstNodeType.EQUALS_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildEqualsOpAst=buildEqualsOpAst;var buildNotEqualOpAst=function buildNotEqualOpAst(left,right,leadingWhitespace){return{type:AstNodeType.NOT_EQUAL_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildNotEqualOpAst=buildNotEqualOpAst;var buildGreaterThanOpAst=function buildGreaterThanOpAst(left,right,leadingWhitespace){return{type:AstNodeType.GREATER_THAN_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildGreaterThanOpAst=buildGreaterThanOpAst;var buildLessThanOpAst=function buildLessThanOpAst(left,right,leadingWhitespace){return{type:AstNodeType.LESS_THAN_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildLessThanOpAst=buildLessThanOpAst;var buildGreaterThanOrEqualOpAst=function buildGreaterThanOrEqualOpAst(left,right,leadingWhitespace){return{type:AstNodeType.GREATER_THAN_OR_EQUAL_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildGreaterThanOrEqualOpAst=buildGreaterThanOrEqualOpAst;var buildLessThanOrEqualOpAst=function buildLessThanOrEqualOpAst(left,right,leadingWhitespace){return{type:AstNodeType.LESS_THAN_OR_EQUAL_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildLessThanOrEqualOpAst=buildLessThanOrEqualOpAst;var buildPlusOpAst=function buildPlusOpAst(left,right,leadingWhitespace){return{type:AstNodeType.PLUS_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildPlusOpAst=buildPlusOpAst;var buildMinusOpAst=function buildMinusOpAst(left,right,leadingWhitespace){return{type:AstNodeType.MINUS_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildMinusOpAst=buildMinusOpAst;var buildTimesOpAst=function buildTimesOpAst(left,right,leadingWhitespace){return{type:AstNodeType.TIMES_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildTimesOpAst=buildTimesOpAst;var buildDivOpAst=function buildDivOpAst(left,right,leadingWhitespace){return{type:AstNodeType.DIV_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildDivOpAst=buildDivOpAst;var buildPowerOpAst=function buildPowerOpAst(left,right,leadingWhitespace){return{type:AstNodeType.POWER_OP,left:left,right:right,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildPowerOpAst=buildPowerOpAst;var buildMinusUnaryOpAst=function buildMinusUnaryOpAst(value,leadingWhitespace){return{type:AstNodeType.MINUS_UNARY_OP,value:value,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildMinusUnaryOpAst=buildMinusUnaryOpAst;var buildPlusUnaryOpAst=function buildPlusUnaryOpAst(value,leadingWhitespace){return{type:AstNodeType.PLUS_UNARY_OP,value:value,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildPlusUnaryOpAst=buildPlusUnaryOpAst;var buildPercentOpAst=function buildPercentOpAst(value,leadingWhitespace){return{type:AstNodeType.PERCENT_OP,value:value,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildPercentOpAst=buildPercentOpAst;var buildProcedureAst=function buildProcedureAst(procedureName,args,leadingWhitespace,internalWhitespace){return{type:AstNodeType.FUNCTION_CALL,procedureName:procedureName,args:args,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image,internalWhitespace:internalWhitespace===null||internalWhitespace===void 0?void 0:internalWhitespace.image}};exports.buildProcedureAst=buildProcedureAst;var buildNamedExpressionAst=function buildNamedExpressionAst(expressionName,leadingWhitespace){return{type:AstNodeType.NAMED_EXPRESSION,expressionName:expressionName,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildNamedExpressionAst=buildNamedExpressionAst;var buildParenthesisAst=function buildParenthesisAst(expression,leadingWhitespace,internalWhitespace){return{type:AstNodeType.PARENTHESIS,expression:expression,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image,internalWhitespace:internalWhitespace===null||internalWhitespace===void 0?void 0:internalWhitespace.image}};exports.buildParenthesisAst=buildParenthesisAst;var buildCellErrorAst=function buildCellErrorAst(error,leadingWhitespace){return{type:AstNodeType.ERROR,error:error,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildCellErrorAst=buildCellErrorAst;var buildErrorWithRawInputAst=function buildErrorWithRawInputAst(rawInput,error,leadingWhitespace){return{type:AstNodeType.ERROR_WITH_RAW_INPUT,error:error,rawInput:rawInput,leadingWhitespace:leadingWhitespace===null||leadingWhitespace===void 0?void 0:leadingWhitespace.image}};exports.buildErrorWithRawInputAst=buildErrorWithRawInputAst;var buildParsingErrorAst=function buildParsingErrorAst(){return{type:AstNodeType.ERROR,error:_Cell.CellError.parsingError()}};exports.buildParsingErrorAst=buildParsingErrorAst;function assertRangeConsistency(start,end,sheetReferenceType){if(start.sheet!==null&&end.sheet===null||start.sheet===null&&end.sheet!==null){throw new Error("Start address inconsistent with end address")}if(start.sheet===null&&sheetReferenceType!==RangeSheetReferenceType.RELATIVE||start.sheet!==null&&sheetReferenceType===RangeSheetReferenceType.RELATIVE){throw new Error("Sheet address inconsistent with sheet reference type")}}function imageWithWhitespace(image,leadingWhitespace){return(leadingWhitespace!==null&&leadingWhitespace!==void 0?leadingWhitespace:"")+image}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.binaryOpTokenMap=void 0;var _Ast=__webpack_require__(160);var _binaryOpTokenMap;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var binaryOpTokenMap=(_binaryOpTokenMap={},_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.PLUS_OP,"+"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.MINUS_OP,"-"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.TIMES_OP,"*"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.DIV_OP,"/"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.CONCATENATE_OP,"&"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.POWER_OP,"^"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.EQUALS_OP,"="),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.NOT_EQUAL_OP,"<>"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.GREATER_THAN_OP,">"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.GREATER_THAN_OR_EQUAL_OP,">="),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.LESS_THAN_OP,"<"),_defineProperty(_binaryOpTokenMap,_Ast.AstNodeType.LESS_THAN_OR_EQUAL_OP,"<="),_binaryOpTokenMap);exports.binaryOpTokenMap=binaryOpTokenMap},function(module,exports,__webpack_require__){"use strict";__webpack_require__(75);__webpack_require__(163);__webpack_require__(164);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.doesContainFunctions=exports.Cache=void 0;var _=__webpack_require__(138);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var buildCacheEntry=function buildCacheEntry(ast,relativeDependencies,hasVolatileFunction,hasStructuralChangeFunction){return{ast:ast,relativeDependencies:relativeDependencies,hasVolatileFunction:hasVolatileFunction,hasStructuralChangeFunction:hasStructuralChangeFunction}};var Cache=function(){function Cache(functionRegistry){_classCallCheck(this,Cache);this.functionRegistry=functionRegistry;this.cache=new Map}_createClass(Cache,[{key:"set",value:function set(hash,ast){var astRelativeDependencies=(0,_.collectDependencies)(ast,this.functionRegistry);var cacheEntry=buildCacheEntry(ast,astRelativeDependencies,doesContainFunctions(ast,this.functionRegistry.isFunctionVolatile),doesContainFunctions(ast,this.functionRegistry.isFunctionDependentOnSheetStructureChange));this.cache.set(hash,cacheEntry);return cacheEntry}},{key:"get",value:function get(hash){return this.cache.get(hash)||null}},{key:"maybeSetAndThenGet",value:function maybeSetAndThenGet(hash,ast){var entryFromCache=this.cache.get(hash);if(entryFromCache){return entryFromCache.ast}else{this.set(hash,ast);return ast}}},{key:"destroy",value:function destroy(){this.cache.clear()}}]);return Cache}();exports.Cache=Cache;var doesContainFunctions=function doesContainFunctions(ast,functionCriterion){switch(ast.type){case _.AstNodeType.EMPTY:case _.AstNodeType.NUMBER:case _.AstNodeType.STRING:case _.AstNodeType.ERROR:case _.AstNodeType.ERROR_WITH_RAW_INPUT:case _.AstNodeType.CELL_REFERENCE:case _.AstNodeType.CELL_RANGE:case _.AstNodeType.COLUMN_RANGE:case _.AstNodeType.ROW_RANGE:case _.AstNodeType.NAMED_EXPRESSION:return false;case _.AstNodeType.PERCENT_OP:case _.AstNodeType.PLUS_UNARY_OP:case _.AstNodeType.MINUS_UNARY_OP:{return doesContainFunctions(ast.value,functionCriterion)}case _.AstNodeType.CONCATENATE_OP:case _.AstNodeType.EQUALS_OP:case _.AstNodeType.NOT_EQUAL_OP:case _.AstNodeType.LESS_THAN_OP:case _.AstNodeType.GREATER_THAN_OP:case _.AstNodeType.LESS_THAN_OR_EQUAL_OP:case _.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case _.AstNodeType.MINUS_OP:case _.AstNodeType.PLUS_OP:case _.AstNodeType.TIMES_OP:case _.AstNodeType.DIV_OP:case _.AstNodeType.POWER_OP:return doesContainFunctions(ast.left,functionCriterion)||doesContainFunctions(ast.right,functionCriterion);case _.AstNodeType.PARENTHESIS:return doesContainFunctions(ast.expression,functionCriterion);case _.AstNodeType.FUNCTION_CALL:{if(functionCriterion(ast.procedureName)){return true}return ast.args.some((function(arg){return doesContainFunctions(arg,functionCriterion)}))}}};exports.doesContainFunctions=doesContainFunctions},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $some=__webpack_require__(59).some;var arrayMethodIsStrict=__webpack_require__(112);var arrayMethodUsesToLength=__webpack_require__(88);var STRICT_METHOD=arrayMethodIsStrict("some");var USES_TO_LENGTH=arrayMethodUsesToLength("some");$({target:"Array",proto:true,forced:!STRICT_METHOD||!USES_TO_LENGTH},{some:function some(callbackfn){return $some(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";var collection=__webpack_require__(115);var collectionStrong=__webpack_require__(121);module.exports=collection("Map",(function(init){return function Map(){return init(this,arguments.length?arguments[0]:undefined)}}),collectionStrong)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(133);__webpack_require__(166);__webpack_require__(168);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(169);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(170);__webpack_require__(146);__webpack_require__(104);exports.__esModule=true;exports.FormulaLexer=exports.FormulaParser=void 0;var _chevrotain=__webpack_require__(154);var _Cell=__webpack_require__(106);var _addressRepresentationConverters=__webpack_require__(139);var _Ast=__webpack_require__(160);var _CellAddress=__webpack_require__(151);var _LexerConfig=__webpack_require__(153);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var FormulaParser=function(_EmbeddedActionsParse){_inherits(FormulaParser,_EmbeddedActionsParse);var _super=_createSuper(FormulaParser);function FormulaParser(lexerConfig,sheetMapping){var _this;_classCallCheck(this,FormulaParser);_this=_super.call(this,lexerConfig.allTokens,{outputCst:false,maxLookahead:7});_this.formula=_this.RULE("formula",(function(){_this.CONSUME(_LexerConfig.EqualsOp);return _this.SUBRULE(_this.booleanExpression)}));_this.booleanExpression=_this.RULE("booleanExpression",(function(){var lhs=_this.SUBRULE(_this.concatenateExpression);_this.MANY((function(){var op=_this.CONSUME(_LexerConfig.BooleanOp);var rhs=_this.SUBRULE2(_this.concatenateExpression);if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.EqualsOp)){lhs=(0,_Ast.buildEqualsOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.NotEqualOp)){lhs=(0,_Ast.buildNotEqualOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.GreaterThanOp)){lhs=(0,_Ast.buildGreaterThanOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.LessThanOp)){lhs=(0,_Ast.buildLessThanOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.GreaterThanOrEqualOp)){lhs=(0,_Ast.buildGreaterThanOrEqualOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.LessThanOrEqualOp)){lhs=(0,_Ast.buildLessThanOrEqualOpAst)(lhs,rhs,op.leadingWhitespace)}else{_this.ACTION((function(){throw Error("Operator not supported")}))}}));return lhs}));_this.booleanExpressionOrEmpty=_this.RULE("booleanExpressionOrEmpty",(function(){return _this.OR([{ALT:function ALT(){return _this.SUBRULE(_this.booleanExpression)}},{ALT:(0,_chevrotain.EMPTY_ALT)((0,_Ast.buildEmptyArgAst)())}])}));_this.concatenateExpression=_this.RULE("concatenateExpression",(function(){var lhs=_this.SUBRULE(_this.additionExpression);_this.MANY((function(){var op=_this.CONSUME(_LexerConfig.ConcatenateOp);var rhs=_this.SUBRULE2(_this.additionExpression);lhs=(0,_Ast.buildConcatenateOpAst)(lhs,rhs,op.leadingWhitespace)}));return lhs}));_this.additionExpression=_this.RULE("additionExpression",(function(){var lhs=_this.SUBRULE(_this.multiplicationExpression);_this.MANY((function(){var op=_this.CONSUME(_LexerConfig.AdditionOp);var rhs=_this.SUBRULE2(_this.multiplicationExpression);if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.PlusOp)){lhs=(0,_Ast.buildPlusOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.MinusOp)){lhs=(0,_Ast.buildMinusOpAst)(lhs,rhs,op.leadingWhitespace)}else{_this.ACTION((function(){throw Error("Operator not supported")}))}}));return lhs}));_this.multiplicationExpression=_this.RULE("multiplicationExpression",(function(){var lhs=_this.SUBRULE(_this.powerExpression);_this.MANY((function(){var op=_this.CONSUME(_LexerConfig.MultiplicationOp);var rhs=_this.SUBRULE2(_this.powerExpression);if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.TimesOp)){lhs=(0,_Ast.buildTimesOpAst)(lhs,rhs,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.DivOp)){lhs=(0,_Ast.buildDivOpAst)(lhs,rhs,op.leadingWhitespace)}else{_this.ACTION((function(){throw Error("Operator not supported")}))}}));return lhs}));_this.powerExpression=_this.RULE("powerExpression",(function(){var lhs=_this.SUBRULE(_this.atomicExpression);_this.MANY((function(){var op=_this.CONSUME(_LexerConfig.PowerOp);var rhs=_this.SUBRULE2(_this.atomicExpression);if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.PowerOp)){lhs=(0,_Ast.buildPowerOpAst)(lhs,rhs,op.leadingWhitespace)}else{_this.ACTION((function(){throw Error("Operator not supported")}))}}));return lhs}));_this.atomicExpression=_this.RULE("atomicExpression",(function(){return _this.OR([{ALT:function ALT(){var op=_this.CONSUME(_LexerConfig.AdditionOp);var value=_this.SUBRULE(_this.atomicExpression);if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.PlusOp)){return(0,_Ast.buildPlusUnaryOpAst)(value,op.leadingWhitespace)}else if((0,_chevrotain.tokenMatcher)(op,_LexerConfig.MinusOp)){return(0,_Ast.buildMinusUnaryOpAst)(value,op.leadingWhitespace)}else{_this.customParsingError=(0,_Ast.parsingError)(_Ast.ParsingErrorType.ParserError,"Mismatched token type");return _this.customParsingError}}},{ALT:function ALT(){return _this.SUBRULE2(_this.rightUnaryOpAtomicExpression)}}])}));_this.rightUnaryOpAtomicExpression=_this.RULE("rightUnaryOpAtomicExpression",(function(){var positiveAtomicExpression=_this.SUBRULE(_this.positiveAtomicExpression);var percentage=_this.OPTION((function(){return _this.CONSUME(_LexerConfig.PercentOp)}));if(percentage){return(0,_Ast.buildPercentOpAst)(positiveAtomicExpression,percentage.leadingWhitespace)}return positiveAtomicExpression}));_this.positiveAtomicExpression=_this.RULE("positiveAtomicExpression",(function(){return _this.OR(_this.atomicExpCache||(_this.atomicExpCache=[{ALT:function ALT(){return _this.SUBRULE(_this.parenthesisExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.cellRangeExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.columnRangeExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.rowRangeExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.offsetExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.cellReference)}},{ALT:function ALT(){return _this.SUBRULE(_this.procedureExpression)}},{ALT:function ALT(){return _this.SUBRULE(_this.namedExpressionExpression)}},{ALT:function ALT(){var number=_this.CONSUME(_this.lexerConfig.NumberLiteral);return(0,_Ast.buildNumberAst)(_this.numericStringToNumber(number.image),number.leadingWhitespace)}},{ALT:function ALT(){var str=_this.CONSUME(_LexerConfig.StringLiteral);return(0,_Ast.buildStringAst)(str)}},{ALT:function ALT(){var token=_this.CONSUME(_LexerConfig.ErrorLiteral);var errString=token.image.toUpperCase();var errorType=_this.lexerConfig.errorMapping[errString];if(errorType){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(errorType),token.leadingWhitespace)}else{return _this.parsingError(_Ast.ParsingErrorType.ParserError,"Unknown error literal")}}}]))}));_this.procedureExpression=_this.RULE("procedureExpression",(function(){var _a;var procedureNameToken=_this.CONSUME(_LexerConfig.ProcedureName);var procedureName=procedureNameToken.image.toUpperCase().slice(0,-1);var canonicalProcedureName=(_a=_this.lexerConfig.functionMapping[procedureName])!==null&&_a!==void 0?_a:procedureName;var args=[];var argument=_this.SUBRULE(_this.booleanExpressionOrEmpty);_this.MANY((function(){var _a;var separator=_this.CONSUME(_this.lexerConfig.ArgSeparator);if(argument.type===_Ast.AstNodeType.EMPTY){argument.leadingWhitespace=(_a=separator.leadingWhitespace)===null||_a===void 0?void 0:_a.image}args.push(argument);argument=_this.SUBRULE2(_this.booleanExpressionOrEmpty)}));args.push(argument);if(args.length===1&&args[0].type===_Ast.AstNodeType.EMPTY){args.length=0}var rParenToken=_this.CONSUME(_LexerConfig.RParen);return(0,_Ast.buildProcedureAst)(canonicalProcedureName,args,procedureNameToken.leadingWhitespace,rParenToken.leadingWhitespace)}));_this.namedExpressionExpression=_this.RULE("namedExpressionExpression",(function(){var name=_this.CONSUME(_LexerConfig.NamedExpression);return(0,_Ast.buildNamedExpressionAst)(name.image,name.leadingWhitespace)}));_this.offsetExpression=_this.RULE("offsetExpression",(function(){var offsetProcedure=_this.SUBRULE(_this.offsetProcedureExpression);var end;_this.OPTION((function(){_this.CONSUME(_LexerConfig.RangeSeparator);if(offsetProcedure.type===_Ast.AstNodeType.CELL_RANGE){end=_this.parsingError(_Ast.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}else{end=_this.SUBRULE(_this.endOfRangeWithOffsetStartExpression,{ARGS:[offsetProcedure]})}}));if(end!==undefined){return end}return offsetProcedure}));_this.offsetProcedureExpression=_this.RULE("offsetProcedureExpression",(function(){var args=[];_this.CONSUME(_this.lexerConfig.OffsetProcedureName);_this.CONSUME(_LexerConfig.LParen);_this.MANY_SEP({SEP:_this.lexerConfig.ArgSeparator,DEF:function DEF(){args.push(_this.SUBRULE(_this.booleanExpression))}});_this.CONSUME(_LexerConfig.RParen);return _this.handleOffsetHeuristic(args)}));_this.cellRangeExpression=_this.RULE("cellRangeExpression",(function(){var start=_this.CONSUME(_LexerConfig.CellReference);_this.CONSUME2(_LexerConfig.RangeSeparator);return _this.SUBRULE(_this.endOfRangeExpression,{ARGS:[start]})}));_this.columnRangeExpression=_this.RULE("columnRangeExpression",(function(){var range=_this.CONSUME(_LexerConfig.ColumnRange);var _range$image$split=range.image.split(":"),_range$image$split2=_slicedToArray(_range$image$split,2),startImage=_range$image$split2[0],endImage=_range$image$split2[1];var start=_this.ACTION((function(){return(0,_addressRepresentationConverters.columnAddressFromString)(_this.sheetMapping,startImage,_this.formulaAddress)}));var end=_this.ACTION((function(){return(0,_addressRepresentationConverters.columnAddressFromString)(_this.sheetMapping,endImage,_this.formulaAddress)}));if(start===undefined||end===undefined){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}if(start.exceedsSheetSizeLimits(_this.lexerConfig.maxColumns)||end.exceedsSheetSizeLimits(_this.lexerConfig.maxColumns)){return(0,_Ast.buildErrorWithRawInputAst)(range.image,new _Cell.CellError(_Cell.ErrorType.NAME),range.leadingWhitespace)}if(start.sheet===null&&end.sheet!==null){return _this.parsingError(_Ast.ParsingErrorType.ParserError,"Malformed range expression")}var sheetReferenceType=_this.rangeSheetReferenceType(start.sheet,end.sheet);if(start.sheet!==null&&end.sheet===null){end=end.withAbsoluteSheet(start.sheet)}return(0,_Ast.buildColumnRangeAst)(start,end,sheetReferenceType,range.leadingWhitespace)}));_this.rowRangeExpression=_this.RULE("rowRangeExpression",(function(){var range=_this.CONSUME(_LexerConfig.RowRange);var _range$image$split3=range.image.split(":"),_range$image$split4=_slicedToArray(_range$image$split3,2),startImage=_range$image$split4[0],endImage=_range$image$split4[1];var start=_this.ACTION((function(){return(0,_addressRepresentationConverters.rowAddressFromString)(_this.sheetMapping,startImage,_this.formulaAddress)}));var end=_this.ACTION((function(){return(0,_addressRepresentationConverters.rowAddressFromString)(_this.sheetMapping,endImage,_this.formulaAddress)}));if(start===undefined||end===undefined){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}if(start.exceedsSheetSizeLimits(_this.lexerConfig.maxRows)||end.exceedsSheetSizeLimits(_this.lexerConfig.maxRows)){return(0,_Ast.buildErrorWithRawInputAst)(range.image,new _Cell.CellError(_Cell.ErrorType.NAME),range.leadingWhitespace)}if(start.sheet===null&&end.sheet!==null){return _this.parsingError(_Ast.ParsingErrorType.ParserError,"Malformed range expression")}var sheetReferenceType=_this.rangeSheetReferenceType(start.sheet,end.sheet);if(start.sheet!==null&&end.sheet===null){end=end.withAbsoluteSheet(start.sheet)}return(0,_Ast.buildRowRangeAst)(start,end,sheetReferenceType,range.leadingWhitespace)}));_this.cellReference=_this.RULE("cellReference",(function(){var cell=_this.CONSUME(_LexerConfig.CellReference);var address=_this.ACTION((function(){return(0,_addressRepresentationConverters.cellAddressFromString)(_this.sheetMapping,cell.image,_this.formulaAddress)}));if(address===undefined){return(0,_Ast.buildErrorWithRawInputAst)(cell.image,new _Cell.CellError(_Cell.ErrorType.REF),cell.leadingWhitespace)}else if(address.exceedsSheetSizeLimits(_this.lexerConfig.maxColumns,_this.lexerConfig.maxRows)){return(0,_Ast.buildErrorWithRawInputAst)(cell.image,new _Cell.CellError(_Cell.ErrorType.NAME),cell.leadingWhitespace)}else{return(0,_Ast.buildCellReferenceAst)(address,cell.leadingWhitespace)}}));_this.endOfRangeExpression=_this.RULE("endOfRangeExpression",(function(start){return _this.OR([{ALT:function ALT(){return _this.SUBRULE(_this.endRangeReference,{ARGS:[start]})}},{ALT:function ALT(){var _a;var offsetProcedure=_this.SUBRULE(_this.offsetProcedureExpression);var startAddress=_this.ACTION((function(){return(0,_addressRepresentationConverters.cellAddressFromString)(_this.sheetMapping,start.image,_this.formulaAddress)}));if(startAddress===undefined){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}if(offsetProcedure.type===_Ast.AstNodeType.CELL_REFERENCE){var end=offsetProcedure.reference;var sheetReferenceType=_Ast.RangeSheetReferenceType.RELATIVE;if(startAddress.sheet!==null){sheetReferenceType=_Ast.RangeSheetReferenceType.START_ABSOLUTE;end=end.withAbsoluteSheet(startAddress.sheet)}return(0,_Ast.buildCellRangeAst)(startAddress,end,sheetReferenceType,(_a=start.leadingWhitespace)===null||_a===void 0?void 0:_a.image)}else{return _this.parsingError(_Ast.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}}])}));_this.endOfRangeWithOffsetStartExpression=_this.RULE("endOfRangeWithOffsetStartExpression",(function(start){return _this.OR([{ALT:function ALT(){return _this.SUBRULE(_this.endRangeWithOffsetStartReference,{ARGS:[start]})}},{ALT:function ALT(){var offsetProcedure=_this.SUBRULE(_this.offsetProcedureExpression);if(offsetProcedure.type===_Ast.AstNodeType.CELL_REFERENCE){var end=offsetProcedure.reference;var sheetReferenceType=_Ast.RangeSheetReferenceType.RELATIVE;if(start.reference.sheet!==null){sheetReferenceType=_Ast.RangeSheetReferenceType.START_ABSOLUTE;end=end.withAbsoluteSheet(start.reference.sheet)}return(0,_Ast.buildCellRangeAst)(start.reference,end,sheetReferenceType,start.leadingWhitespace)}else{return _this.parsingError(_Ast.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}}])}));_this.endRangeReference=_this.RULE("endRangeReference",(function(start){var _a;var end=_this.CONSUME(_LexerConfig.CellReference);var startAddress=_this.ACTION((function(){return(0,_addressRepresentationConverters.cellAddressFromString)(_this.sheetMapping,start.image,_this.formulaAddress)}));var endAddress=_this.ACTION((function(){return(0,_addressRepresentationConverters.cellAddressFromString)(_this.sheetMapping,end.image,_this.formulaAddress)}));if(startAddress===undefined||endAddress===undefined){return _this.ACTION((function(){return(0,_Ast.buildErrorWithRawInputAst)("".concat(start.image,":").concat(end.image),new _Cell.CellError(_Cell.ErrorType.REF),start.leadingWhitespace)}))}else if(startAddress.exceedsSheetSizeLimits(_this.lexerConfig.maxColumns,_this.lexerConfig.maxRows)||endAddress.exceedsSheetSizeLimits(_this.lexerConfig.maxColumns,_this.lexerConfig.maxRows)){return _this.ACTION((function(){return(0,_Ast.buildErrorWithRawInputAst)("".concat(start.image,":").concat(end.image),new _Cell.CellError(_Cell.ErrorType.NAME),start.leadingWhitespace)}))}return _this.buildCellRange(startAddress,endAddress,(_a=start.leadingWhitespace)===null||_a===void 0?void 0:_a.image)}));_this.endRangeWithOffsetStartReference=_this.RULE("endRangeWithOffsetStartReference",(function(start){var end=_this.CONSUME(_LexerConfig.CellReference);var endAddress=_this.ACTION((function(){return(0,_addressRepresentationConverters.cellAddressFromString)(_this.sheetMapping,end.image,_this.formulaAddress)}));if(endAddress===undefined){return _this.ACTION((function(){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}))}return _this.buildCellRange(start.reference,endAddress,start.leadingWhitespace)}));_this.parenthesisExpression=_this.RULE("parenthesisExpression",(function(){var lParenToken=_this.CONSUME(_LexerConfig.LParen);var expression=_this.SUBRULE(_this.booleanExpression);var rParenToken=_this.CONSUME(_LexerConfig.RParen);return(0,_Ast.buildParenthesisAst)(expression,lParenToken.leadingWhitespace,rParenToken.leadingWhitespace)}));_this.numericStringToNumber=function(input){var normalized=input.replace(_this.lexerConfig.decimalSeparator,".");return Number(normalized)};_this.lexerConfig=lexerConfig;_this.sheetMapping=sheetMapping;_this.formulaAddress=(0,_Cell.simpleCellAddress)(0,0,0);_this.performSelfAnalysis();return _this}_createClass(FormulaParser,[{key:"parseFromTokens",value:function parseFromTokens(tokens,formulaAddress){this.input=tokens;var ast=this.formulaWithContext(formulaAddress);var errors=[];if(this.customParsingError){errors.push(this.customParsingError)}errors=errors.concat(this.errors.map((function(e){return{type:_Ast.ParsingErrorType.ParserError,message:e.message}})));if(errors.length>0){ast=(0,_Ast.buildParsingErrorAst)()}return{ast:ast,errors:errors}}},{key:"formulaWithContext",value:function formulaWithContext(address){this.formulaAddress=address;return this.formula()}},{key:"reset",value:function reset(){_get(_getPrototypeOf(FormulaParser.prototype),"reset",this).call(this);this.customParsingError=undefined}},{key:"buildCellRange",value:function buildCellRange(startAddress,endAddress,leadingWhitespace){if(startAddress.sheet===null&&endAddress.sheet!==null){return this.parsingError(_Ast.ParsingErrorType.ParserError,"Malformed range expression")}var sheetReferenceType=this.rangeSheetReferenceType(startAddress.sheet,endAddress.sheet);if(startAddress.sheet!==null&&endAddress.sheet===null){endAddress=endAddress.withAbsoluteSheet(startAddress.sheet)}return(0,_Ast.buildCellRangeAst)(startAddress,endAddress,sheetReferenceType,leadingWhitespace)}},{key:"handleOffsetHeuristic",value:function handleOffsetHeuristic(args){var cellArg=args[0];if(cellArg.type!==_Ast.AstNodeType.CELL_REFERENCE){return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference")}var rowsArg=args[1];var rowShift;if(rowsArg.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(rowsArg.value)){rowShift=rowsArg.value}else if(rowsArg.type===_Ast.AstNodeType.PLUS_UNARY_OP&&rowsArg.value.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(rowsArg.value.value)){rowShift=rowsArg.value.value}else if(rowsArg.type===_Ast.AstNodeType.MINUS_UNARY_OP&&rowsArg.value.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(rowsArg.value.value)){rowShift=-rowsArg.value.value}else{return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number")}var columnsArg=args[2];var colShift;if(columnsArg.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(columnsArg.value)){colShift=columnsArg.value}else if(columnsArg.type===_Ast.AstNodeType.PLUS_UNARY_OP&&columnsArg.value.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(columnsArg.value.value)){colShift=columnsArg.value.value}else if(columnsArg.type===_Ast.AstNodeType.MINUS_UNARY_OP&&columnsArg.value.type===_Ast.AstNodeType.NUMBER&&Number.isInteger(columnsArg.value.value)){colShift=-columnsArg.value.value}else{return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number")}var heightArg=args[3];var height;if(heightArg===undefined){height=1}else if(heightArg.type===_Ast.AstNodeType.NUMBER){height=heightArg.value;if(height<1){return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number")}else if(!Number.isInteger(height)){return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}}else{return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number")}var widthArg=args[4];var width;if(widthArg===undefined){width=1}else if(widthArg.type===_Ast.AstNodeType.NUMBER){width=widthArg.value;if(width<1){return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number")}else if(!Number.isInteger(width)){return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}}else{return this.parsingError(_Ast.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number")}var topLeftCorner=new _CellAddress.CellAddress(null,cellArg.reference.col+colShift,cellArg.reference.row+rowShift,cellArg.reference.type);var absoluteCol=topLeftCorner.col;var absoluteRow=topLeftCorner.row;if(cellArg.reference.type===_CellAddress.CellReferenceType.CELL_REFERENCE_RELATIVE||cellArg.reference.type===_CellAddress.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL){absoluteRow=absoluteRow+this.formulaAddress.row}if(cellArg.reference.type===_CellAddress.CellReferenceType.CELL_REFERENCE_RELATIVE||cellArg.reference.type===_CellAddress.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW){absoluteCol=absoluteCol+this.formulaAddress.col}if(absoluteCol<0||absoluteRow<0){return(0,_Ast.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF,"Resulting reference is out of the sheet"))}if(width===1&&height===1){return(0,_Ast.buildCellReferenceAst)(topLeftCorner)}else{var bottomRightCorner=new _CellAddress.CellAddress(null,topLeftCorner.col+width-1,topLeftCorner.row+height-1,topLeftCorner.type);return(0,_Ast.buildCellRangeAst)(topLeftCorner,bottomRightCorner,_Ast.RangeSheetReferenceType.RELATIVE)}}},{key:"parsingError",value:function parsingError(type,message){this.customParsingError=(0,_Ast.parsingError)(type,message);return(0,_Ast.buildParsingErrorAst)()}},{key:"rangeSheetReferenceType",value:function rangeSheetReferenceType(start,end){if(start===null){return _Ast.RangeSheetReferenceType.RELATIVE}else if(end===null){return _Ast.RangeSheetReferenceType.START_ABSOLUTE}else{return _Ast.RangeSheetReferenceType.BOTH_ABSOLUTE}}}]);return FormulaParser}(_chevrotain.EmbeddedActionsParser);exports.FormulaParser=FormulaParser;var FormulaLexer=function(){function FormulaLexer(lexerConfig){_classCallCheck(this,FormulaLexer);this.lexerConfig=lexerConfig;this.lexer=new _chevrotain.Lexer(lexerConfig.allTokens,{ensureOptimizations:true})}_createClass(FormulaLexer,[{key:"tokenizeFormula",value:function tokenizeFormula(text){var lexingResult=this.lexer.tokenize(text);var tokens=lexingResult.tokens;tokens=this.trimTrailingWhitespaces(tokens);tokens=this.skipWhitespacesInsideRanges(tokens);tokens=this.skipWhitespacesBeforeArgSeparators(tokens);lexingResult.tokens=tokens;return lexingResult}},{key:"skipWhitespacesInsideRanges",value:function skipWhitespacesInsideRanges(tokens){return this.filterTokensByNeighbors(tokens,(function(previous,current,next){return((0,_chevrotain.tokenMatcher)(previous,_LexerConfig.CellReference)||(0,_chevrotain.tokenMatcher)(previous,_LexerConfig.RangeSeparator))&&(0,_chevrotain.tokenMatcher)(current,_LexerConfig.WhiteSpace)&&((0,_chevrotain.tokenMatcher)(next,_LexerConfig.CellReference)||(0,_chevrotain.tokenMatcher)(next,_LexerConfig.RangeSeparator))}))}},{key:"skipWhitespacesBeforeArgSeparators",value:function skipWhitespacesBeforeArgSeparators(tokens){var _this2=this;return this.filterTokensByNeighbors(tokens,(function(previous,current,next){return!(0,_chevrotain.tokenMatcher)(previous,_this2.lexerConfig.ArgSeparator)&&(0,_chevrotain.tokenMatcher)(current,_LexerConfig.WhiteSpace)&&(0,_chevrotain.tokenMatcher)(next,_this2.lexerConfig.ArgSeparator)}))}},{key:"filterTokensByNeighbors",value:function filterTokensByNeighbors(tokens,shouldBeSkipped){if(tokens.length<3){return tokens}var i=0;var filteredTokens=[tokens[i++]];while(i<tokens.length-1){if(!shouldBeSkipped(tokens[i-1],tokens[i],tokens[i+1])){filteredTokens.push(tokens[i])}++i}filteredTokens.push(tokens[i]);return filteredTokens}},{key:"trimTrailingWhitespaces",value:function trimTrailingWhitespaces(tokens){if(tokens.length>0&&(0,_chevrotain.tokenMatcher)(tokens[tokens.length-1],_LexerConfig.WhiteSpace)){tokens.pop()}return tokens}}]);return FormulaLexer}();exports.FormulaLexer=FormulaLexer},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var isInteger=__webpack_require__(167);$({target:"Number",stat:true},{isInteger:isInteger})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(15);var floor=Math.floor;module.exports=function isInteger(it){return!isObject(it)&&isFinite(it)&&floor(it)===it}},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var fails=__webpack_require__(7);var toIndexedObject=__webpack_require__(10);var nativeGetOwnPropertyDescriptor=__webpack_require__(5).f;var DESCRIPTORS=__webpack_require__(6);var FAILS_ON_PRIMITIVES=fails((function(){nativeGetOwnPropertyDescriptor(1)}));var FORCED=!DESCRIPTORS||FAILS_ON_PRIMITIVES;$({target:"Object",stat:true,forced:FORCED,sham:!DESCRIPTORS},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(it,key){return nativeGetOwnPropertyDescriptor(toIndexedObject(it),key)}})},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var isObject=__webpack_require__(15);var anObject=__webpack_require__(21);var has=__webpack_require__(16);var getOwnPropertyDescriptorModule=__webpack_require__(5);var getPrototypeOf=__webpack_require__(80);function get(target,propertyKey){var receiver=arguments.length<3?target:arguments[2];var descriptor,prototype;if(anObject(target)===receiver)return target[propertyKey];if(descriptor=getOwnPropertyDescriptorModule.f(target,propertyKey))return has(descriptor,"value")?descriptor.value:descriptor.get===undefined?undefined:descriptor.get.call(receiver);if(isObject(prototype=getPrototypeOf(target)))return get(prototype,propertyKey,receiver)}$({target:"Reflect",stat:true},{get:get})},function(module,exports,__webpack_require__){"use strict";var fixRegExpWellKnownSymbolLogic=__webpack_require__(147);var anObject=__webpack_require__(21);var toObject=__webpack_require__(49);var toLength=__webpack_require__(40);var toInteger=__webpack_require__(41);var requireObjectCoercible=__webpack_require__(13);var advanceStringIndex=__webpack_require__(149);var regExpExec=__webpack_require__(150);var max=Math.max;var min=Math.min;var floor=Math.floor;var SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d\d?|<[^>]*>)/g;var SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d\d?)/g;var maybeToString=function(it){return it===undefined?it:String(it)};fixRegExpWellKnownSymbolLogic("replace",2,(function(REPLACE,nativeReplace,maybeCallNative,reason){var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=reason.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;var REPLACE_KEEPS_$0=reason.REPLACE_KEEPS_$0;var UNSAFE_SUBSTITUTE=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE?"$":"$0";return[function replace(searchValue,replaceValue){var O=requireObjectCoercible(this);var replacer=searchValue==undefined?undefined:searchValue[REPLACE];return replacer!==undefined?replacer.call(searchValue,O,replaceValue):nativeReplace.call(String(O),searchValue,replaceValue)},function(regexp,replaceValue){if(!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE&&REPLACE_KEEPS_$0||typeof replaceValue==="string"&&replaceValue.indexOf(UNSAFE_SUBSTITUTE)===-1){var res=maybeCallNative(nativeReplace,regexp,this,replaceValue);if(res.done)return res.value}var rx=anObject(regexp);var S=String(this);var functionalReplace=typeof replaceValue==="function";if(!functionalReplace)replaceValue=String(replaceValue);var global=rx.global;if(global){var fullUnicode=rx.unicode;rx.lastIndex=0}var results=[];while(true){var result=regExpExec(rx,S);if(result===null)break;results.push(result);if(!global)break;var matchStr=String(result[0]);if(matchStr==="")rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode)}var accumulatedResult="";var nextSourcePosition=0;for(var i=0;i<results.length;i++){result=results[i];var matched=String(result[0]);var position=max(min(toInteger(result.index),S.length),0);var captures=[];for(var j=1;j<result.length;j++)captures.push(maybeToString(result[j]));var namedCaptures=result.groups;if(functionalReplace){var replacerArgs=[matched].concat(captures,position,S);if(namedCaptures!==undefined)replacerArgs.push(namedCaptures);var replacement=String(replaceValue.apply(undefined,replacerArgs))}else{replacement=getSubstitution(matched,S,position,captures,namedCaptures,replaceValue)}if(position>=nextSourcePosition){accumulatedResult+=S.slice(nextSourcePosition,position)+replacement;nextSourcePosition=position+matched.length}}return accumulatedResult+S.slice(nextSourcePosition)}];function getSubstitution(matched,str,position,captures,namedCaptures,replacement){var tailPos=position+matched.length;var m=captures.length;var symbols=SUBSTITUTION_SYMBOLS_NO_NAMED;if(namedCaptures!==undefined){namedCaptures=toObject(namedCaptures);symbols=SUBSTITUTION_SYMBOLS}return nativeReplace.call(replacement,symbols,(function(match,ch){var capture;switch(ch.charAt(0)){case"$":return"$";case"&":return matched;case"`":return str.slice(0,position);case"'":return str.slice(tailPos);case"<":capture=namedCaptures[ch.slice(1,-1)];break;default:var n=+ch;if(n===0)return match;if(n>m){var f=floor(n/10);if(f===0)return match;if(f<=m)return captures[f-1]===undefined?ch.charAt(1):captures[f-1]+ch.charAt(1);return match}capture=captures[n-1]}return capture===undefined?"":capture}))}}))},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);__webpack_require__(157);__webpack_require__(113);__webpack_require__(92);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(170);exports.__esModule=true;exports.formatNumber=formatNumber;exports.Unparser=void 0;var _Cell=__webpack_require__(106);var _Ast=__webpack_require__(160);var _binaryOpTokenMap=__webpack_require__(161);var _LexerConfig=__webpack_require__(153);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Unparser=function(){function Unparser(config,lexerConfig,sheetMappingFn,namedExpressions){_classCallCheck(this,Unparser);this.config=config;this.lexerConfig=lexerConfig;this.sheetMappingFn=sheetMappingFn;this.namedExpressions=namedExpressions}_createClass(Unparser,[{key:"unparse",value:function unparse(ast,address){return"="+this.unparseAst(ast,address)}},{key:"unparseAst",value:function unparseAst(ast,address){var _this=this;var _a;switch(ast.type){case _Ast.AstNodeType.EMPTY:{return(0,_Ast.imageWithWhitespace)("",ast.leadingWhitespace)}case _Ast.AstNodeType.NUMBER:{return(0,_Ast.imageWithWhitespace)(formatNumber(ast.value,this.config.decimalSeparator),ast.leadingWhitespace)}case _Ast.AstNodeType.STRING:{return(0,_Ast.imageWithWhitespace)('"'+ast.value+'"',ast.leadingWhitespace)}case _Ast.AstNodeType.FUNCTION_CALL:{var args=ast.args.map((function(arg){return arg!==undefined?_this.unparseAst(arg,address):""})).join(this.config.functionArgSeparator);var procedureName=this.config.translationPackage.isFunctionTranslated(ast.procedureName)?this.config.translationPackage.getFunctionTranslation(ast.procedureName):ast.procedureName;var rightPart=procedureName+"("+args+(0,_Ast.imageWithWhitespace)(")",ast.internalWhitespace);return(0,_Ast.imageWithWhitespace)(rightPart,ast.leadingWhitespace)}case _Ast.AstNodeType.NAMED_EXPRESSION:{var originalNamedExpressionName=(_a=this.namedExpressions.nearestNamedExpression(ast.expressionName,address.sheet))===null||_a===void 0?void 0:_a.displayName;return(0,_Ast.imageWithWhitespace)(originalNamedExpressionName||ast.expressionName,ast.leadingWhitespace)}case _Ast.AstNodeType.CELL_REFERENCE:{var image;if(ast.reference.sheet!==null){image=this.unparseSheetName(ast.reference.sheet)+"!"+ast.reference.unparse(address)}else{image=ast.reference.unparse(address)}return(0,_Ast.imageWithWhitespace)(image,ast.leadingWhitespace)}case _Ast.AstNodeType.COLUMN_RANGE:case _Ast.AstNodeType.ROW_RANGE:case _Ast.AstNodeType.CELL_RANGE:{return(0,_Ast.imageWithWhitespace)(this.formatRange(ast,address),ast.leadingWhitespace)}case _Ast.AstNodeType.PLUS_UNARY_OP:{var unparsedExpr=this.unparseAst(ast.value,address);return(0,_Ast.imageWithWhitespace)("+",ast.leadingWhitespace)+unparsedExpr}case _Ast.AstNodeType.MINUS_UNARY_OP:{var _unparsedExpr=this.unparseAst(ast.value,address);return(0,_Ast.imageWithWhitespace)("-",ast.leadingWhitespace)+_unparsedExpr}case _Ast.AstNodeType.PERCENT_OP:{return this.unparseAst(ast.value,address)+(0,_Ast.imageWithWhitespace)("%",ast.leadingWhitespace)}case _Ast.AstNodeType.ERROR:{var _image=this.config.translationPackage.getErrorTranslation(ast.error?ast.error.type:_Cell.ErrorType.ERROR);return(0,_Ast.imageWithWhitespace)(_image,ast.leadingWhitespace)}case _Ast.AstNodeType.ERROR_WITH_RAW_INPUT:{return(0,_Ast.imageWithWhitespace)(ast.rawInput,ast.leadingWhitespace)}case _Ast.AstNodeType.PARENTHESIS:{var expression=this.unparseAst(ast.expression,address);var _rightPart="("+expression+(0,_Ast.imageWithWhitespace)(")",ast.internalWhitespace);return(0,_Ast.imageWithWhitespace)(_rightPart,ast.leadingWhitespace)}default:{var left=this.unparseAst(ast.left,address);var right=this.unparseAst(ast.right,address);return left+(0,_Ast.imageWithWhitespace)(_binaryOpTokenMap.binaryOpTokenMap[ast.type],ast.leadingWhitespace)+right}}}},{key:"unparseSheetName",value:function unparseSheetName(sheetId){var sheet=this.sheetMappingFn(sheetId);if(new RegExp(_LexerConfig.additionalCharactersAllowedInQuotes).exec(sheet)){return"'".concat(sheet,"'")}else{return sheet}}},{key:"formatRange",value:function formatRange(ast,baseAddress){var startSheeet="";var endSheet="";if(ast.start.sheet!==null&&ast.sheetReferenceType!==_Ast.RangeSheetReferenceType.RELATIVE){startSheeet=this.unparseSheetName(ast.start.sheet)+"!"}if(ast.end.sheet!==null&&ast.sheetReferenceType===_Ast.RangeSheetReferenceType.BOTH_ABSOLUTE){endSheet=this.unparseSheetName(ast.end.sheet)+"!"}return"".concat(startSheeet).concat(ast.start.unparse(baseAddress),":").concat(endSheet).concat(ast.end.unparse(baseAddress))}}]);return Unparser}();exports.Unparser=Unparser;function formatNumber(number,decimalSeparator){var numericString=number.toString();return numericString.replace(".",decimalSeparator)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(110);__webpack_require__(124);exports.__esModule=true;exports.collectDependencies=void 0;var _=__webpack_require__(138);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var collectDependenciesFn=function collectDependenciesFn(ast,functionRegistry,dependenciesSet){switch(ast.type){case _.AstNodeType.EMPTY:case _.AstNodeType.NUMBER:case _.AstNodeType.STRING:case _.AstNodeType.ERROR:return;case _.AstNodeType.NAMED_EXPRESSION:{dependenciesSet.push(new _.NamedExpressionDependency(ast.expressionName));return}case _.AstNodeType.CELL_REFERENCE:{dependenciesSet.push(new _.AddressDependency(ast.reference));return}case _.AstNodeType.CELL_RANGE:{if(ast.start.sheet===ast.end.sheet){dependenciesSet.push(new _.CellRangeDependency(ast.start,ast.end))}return}case _.AstNodeType.COLUMN_RANGE:{if(ast.start.sheet===ast.end.sheet){dependenciesSet.push(new _.ColumnRangeDependency(ast.start,ast.end))}return}case _.AstNodeType.ROW_RANGE:{if(ast.start.sheet===ast.end.sheet){dependenciesSet.push(new _.RowRangeDependency(ast.start,ast.end))}return}case _.AstNodeType.PERCENT_OP:case _.AstNodeType.PLUS_UNARY_OP:case _.AstNodeType.MINUS_UNARY_OP:{collectDependenciesFn(ast.value,functionRegistry,dependenciesSet);return}case _.AstNodeType.CONCATENATE_OP:case _.AstNodeType.EQUALS_OP:case _.AstNodeType.NOT_EQUAL_OP:case _.AstNodeType.LESS_THAN_OP:case _.AstNodeType.GREATER_THAN_OP:case _.AstNodeType.LESS_THAN_OR_EQUAL_OP:case _.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case _.AstNodeType.MINUS_OP:case _.AstNodeType.PLUS_OP:case _.AstNodeType.TIMES_OP:case _.AstNodeType.DIV_OP:case _.AstNodeType.POWER_OP:collectDependenciesFn(ast.left,functionRegistry,dependenciesSet);collectDependenciesFn(ast.right,functionRegistry,dependenciesSet);return;case _.AstNodeType.PARENTHESIS:collectDependenciesFn(ast.expression,functionRegistry,dependenciesSet);return;case _.AstNodeType.FUNCTION_CALL:if(!functionRegistry.doesFunctionNeedArgumentToBeComputed(ast.procedureName)){ast.args.forEach((function(argAst){return collectDependenciesFn(argAst,functionRegistry,dependenciesSet)}))}return}};var collectDependencies=function collectDependencies(ast,functionRegistry){var result=new Array;collectDependenciesFn(ast,functionRegistry,result);return result};exports.collectDependencies=collectDependencies},function(module,exports,__webpack_require__){"use strict";__webpack_require__(89);exports.__esModule=true;exports.NamedExpressionDependency=exports.RowRangeDependency=exports.ColumnRangeDependency=exports.CellRangeDependency=exports.AddressDependency=void 0;var _AbsoluteCellRange=__webpack_require__(132);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var AddressDependency=function(){function AddressDependency(dependency){_classCallCheck(this,AddressDependency);this.dependency=dependency}_createClass(AddressDependency,[{key:"absolutize",value:function absolutize(baseAddress){return this.dependency.toSimpleCellAddress(baseAddress)}}]);return AddressDependency}();exports.AddressDependency=AddressDependency;var CellRangeDependency=function(){function CellRangeDependency(start,end){_classCallCheck(this,CellRangeDependency);this.start=start;this.end=end}_createClass(CellRangeDependency,[{key:"absolutize",value:function absolutize(baseAddress){return new _AbsoluteCellRange.AbsoluteCellRange(this.start.toSimpleCellAddress(baseAddress),this.end.toSimpleCellAddress(baseAddress))}}]);return CellRangeDependency}();exports.CellRangeDependency=CellRangeDependency;var ColumnRangeDependency=function(){function ColumnRangeDependency(start,end){_classCallCheck(this,ColumnRangeDependency);this.start=start;this.end=end}_createClass(ColumnRangeDependency,[{key:"absolutize",value:function absolutize(baseAddress){var start=this.start.toSimpleColumnAddress(baseAddress);var end=this.end.toSimpleColumnAddress(baseAddress);return new _AbsoluteCellRange.AbsoluteColumnRange(start.sheet,start.col,end.col)}}]);return ColumnRangeDependency}();exports.ColumnRangeDependency=ColumnRangeDependency;var RowRangeDependency=function(){function RowRangeDependency(start,end){_classCallCheck(this,RowRangeDependency);this.start=start;this.end=end}_createClass(RowRangeDependency,[{key:"absolutize",value:function absolutize(baseAddress){var start=this.start.toSimpleRowAddress(baseAddress);var end=this.end.toSimpleRowAddress(baseAddress);return new _AbsoluteCellRange.AbsoluteRowRange(start.sheet,start.row,end.row)}}]);return RowRangeDependency}();exports.RowRangeDependency=RowRangeDependency;var NamedExpressionDependency=function(){function NamedExpressionDependency(name){_classCallCheck(this,NamedExpressionDependency);this.name=name}_createClass(NamedExpressionDependency,[{key:"absolutize",value:function absolutize(_baseAddress){return this}}]);return NamedExpressionDependency}();exports.NamedExpressionDependency=NamedExpressionDependency},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.ColumnsSpan=exports.RowsSpan=void 0;__webpack_require__(125);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var RowsSpan=function(){function RowsSpan(sheet,rowStart,rowEnd){_classCallCheck(this,RowsSpan);this.sheet=sheet;this.rowStart=rowStart;this.rowEnd=rowEnd;if(rowStart<0){throw Error("Starting row cant be less than 0")}if(rowEnd<rowStart){throw Error("Row span cant end before start")}}_createClass(RowsSpan,[{key:"rows",value:regeneratorRuntime.mark((function rows(){var col;return regeneratorRuntime.wrap((function rows$(_context){while(1){switch(_context.prev=_context.next){case 0:col=this.rowStart;case 1:if(!(col<=this.rowEnd)){_context.next=7;break}_context.next=4;return col;case 4:++col;_context.next=1;break;case 7:case"end":return _context.stop()}}}),rows,this)}))},{key:"intersect",value:function intersect(otherSpan){if(this.sheet!==otherSpan.sheet){throw Error("Can't intersect spans from different sheets")}var start=Math.max(this.rowStart,otherSpan.rowStart);var end=Math.min(this.rowEnd,otherSpan.rowEnd);if(start>end){return null}return new RowsSpan(this.sheet,start,end)}},{key:"firstRow",value:function firstRow(){return new RowsSpan(this.sheet,this.rowStart,this.rowStart)}},{key:"numberOfRows",get:function get(){return this.rowEnd-this.rowStart+1}},{key:"start",get:function get(){return this.rowStart}},{key:"end",get:function get(){return this.rowEnd}}],[{key:"fromNumberOfRows",value:function fromNumberOfRows(sheet,rowStart,numberOfRows){return new RowsSpan(sheet,rowStart,rowStart+numberOfRows-1)}},{key:"fromRowStartAndEnd",value:function fromRowStartAndEnd(sheet,rowStart,rowEnd){return new RowsSpan(sheet,rowStart,rowEnd)}}]);return RowsSpan}();exports.RowsSpan=RowsSpan;var ColumnsSpan=function(){function ColumnsSpan(sheet,columnStart,columnEnd){_classCallCheck(this,ColumnsSpan);this.sheet=sheet;this.columnStart=columnStart;this.columnEnd=columnEnd;if(columnStart<0){throw Error("Starting column cant be less than 0")}if(columnEnd<columnStart){throw Error("Column span cant end before start")}}_createClass(ColumnsSpan,[{key:"columns",value:regeneratorRuntime.mark((function columns(){var col;return regeneratorRuntime.wrap((function columns$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:col=this.columnStart;case 1:if(!(col<=this.columnEnd)){_context2.next=7;break}_context2.next=4;return col;case 4:++col;_context2.next=1;break;case 7:case"end":return _context2.stop()}}}),columns,this)}))},{key:"intersect",value:function intersect(otherSpan){if(this.sheet!==otherSpan.sheet){throw Error("Can't intersect spans from different sheets")}var start=Math.max(this.columnStart,otherSpan.columnStart);var end=Math.min(this.columnEnd,otherSpan.columnEnd);if(start>end){return null}return new ColumnsSpan(this.sheet,start,end)}},{key:"firstColumn",value:function firstColumn(){return new ColumnsSpan(this.sheet,this.columnStart,this.columnStart)}},{key:"numberOfColumns",get:function get(){return this.columnEnd-this.columnStart+1}},{key:"start",get:function get(){return this.columnStart}},{key:"end",get:function get(){return this.columnEnd}}],[{key:"fromNumberOfColumns",value:function fromNumberOfColumns(sheet,columnStart,numberOfColumns){return new ColumnsSpan(sheet,columnStart,columnStart+numberOfColumns-1)}},{key:"fromColumnStartAndEnd",value:function fromColumnStartAndEnd(sheet,columnStart,columnEnd){return new ColumnsSpan(sheet,columnStart,columnEnd)}}]);return ColumnsSpan}();exports.ColumnsSpan=ColumnsSpan},function(module,exports,__webpack_require__){"use strict";__webpack_require__(113);exports.__esModule=true;exports.absolutizeDependencies=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var absolutizeDependencies=function absolutizeDependencies(deps,baseAddress){return deps.map((function(dep){return dep.absolutize(baseAddress)}))};exports.absolutizeDependencies=absolutizeDependencies},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.StatType=exports.Statistics=exports.EmptyStatistics=void 0;var _EmptyStatistics=__webpack_require__(177);exports.EmptyStatistics=_EmptyStatistics.EmptyStatistics;var _Statistics=__webpack_require__(178);exports.Statistics=_Statistics.Statistics;var _StatType=__webpack_require__(179);exports.StatType=_StatType.StatType},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.EmptyStatistics=void 0;var _Statistics2=__webpack_require__(178);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var EmptyStatistics=function(_Statistics){_inherits(EmptyStatistics,_Statistics);var _super=_createSuper(EmptyStatistics);function EmptyStatistics(){_classCallCheck(this,EmptyStatistics);return _super.apply(this,arguments)}_createClass(EmptyStatistics,[{key:"incrementCriterionFunctionFullCacheUsed",value:function incrementCriterionFunctionFullCacheUsed(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function incrementCriterionFunctionPartialCacheUsed(){}},{key:"start",value:function start(_name){}},{key:"end",value:function end(_name){}}]);return EmptyStatistics}(_Statistics2.Statistics);exports.EmptyStatistics=EmptyStatistics},function(module,exports,__webpack_require__){"use strict";__webpack_require__(75);__webpack_require__(164);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.Statistics=void 0;var _StatType=__webpack_require__(179);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Statistics=function(){function Statistics(){_classCallCheck(this,Statistics);this.stats=new Map([[_StatType.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[_StatType.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]);this.startTimes=new Map}_createClass(Statistics,[{key:"incrementCriterionFunctionFullCacheUsed",value:function incrementCriterionFunctionFullCacheUsed(){var newValue=(this.stats.get(_StatType.StatType.CRITERION_FUNCTION_FULL_CACHE_USED)||0)+1;this.stats.set(_StatType.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,newValue)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function incrementCriterionFunctionPartialCacheUsed(){var newValue=(this.stats.get(_StatType.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED)||0)+1;this.stats.set(_StatType.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,newValue)}},{key:"reset",value:function reset(){this.stats.clear();this.startTimes.clear();this.stats.set(_StatType.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0);this.stats.set(_StatType.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function start(name){if(this.startTimes.get(name)){throw Error("Statistics ".concat(name," already started"))}else{this.startTimes.set(name,Date.now())}}},{key:"end",value:function end(name){var now=Date.now();var startTime=this.startTimes.get(name);if(startTime){var values=this.stats.get(name)||0;values+=now-startTime;this.stats.set(name,values);this.startTimes.delete(name)}else{throw Error("Statistics ".concat(name," not started"))}}},{key:"measure",value:function measure(name,func){this.start(name);var result=func();this.end(name);return result}},{key:"snapshot",value:function snapshot(){return new Map(this.stats)}},{key:"destroy",value:function destroy(){this.stats.clear();this.startTimes.clear()}}]);return Statistics}();exports.Statistics=Statistics},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.StatType=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var StatType;exports.StatType=StatType;(function(StatType){StatType["BUILD_ENGINE_TOTAL"]="BUILD_ENGINE_TOTAL";StatType["PARSER"]="PARSER";StatType["GRAPH_BUILD"]="GRAPH_BUILD";StatType["TOP_SORT"]="TOP_SORT";StatType["MATRIX_DETECTION"]="MATRIX_DETECTION";StatType["BUILD_COLUMN_INDEX"]="BUILD_COLUMN_INDEX";StatType["EVALUATION"]="EVALUATION";StatType["VLOOKUP"]="VLOOKUP";StatType["TRANSFORM_ASTS"]="TRANSFORM_ASTS";StatType["TRANSFORM_ASTS_POSTPONED"]="TRANSFORM_ASTS_POSTPONED";StatType["ADJUSTING_ADDRESS_MAPPING"]="ADJUSTING_ADDRESS_MAPPING";StatType["ADJUSTING_MATRIX_MAPPING"]="ADJUSTING_MATRIX_MAPPING";StatType["ADJUSTING_RANGES"]="ADJUSTING_RANGES";StatType["ADJUSTING_GRAPH"]="ADJUSTING_GRAPH";StatType["CRITERION_FUNCTION_FULL_CACHE_USED"]="CRITERION_FUNCTION_FULL_CACHE_USED";StatType["CRITERION_FUNCTION_PARTIAL_CACHE_USED"]="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(StatType||(exports.StatType=StatType={}))},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(181);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.AddressMapping=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);var _index=__webpack_require__(107);var _errors=__webpack_require__(183);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var AddressMapping=function(){function AddressMapping(policy){_classCallCheck(this,AddressMapping);this.policy=policy;this.mapping=new Map}_createClass(AddressMapping,[{key:"getCell",value:function getCell(address){var sheetMapping=this.mapping.get(address.sheet);if(!sheetMapping){throw new _errors.NoSheetWithIdError(address.sheet)}return sheetMapping.getCell(address)}},{key:"fetchCell",value:function fetchCell(address){var sheetMapping=this.mapping.get(address.sheet);if(!sheetMapping){throw new _errors.NoSheetWithIdError(address.sheet)}var vertex=sheetMapping.getCell(address);if(!vertex){throw Error("Vertex for address missing in AddressMapping")}return vertex}},{key:"strategyFor",value:function strategyFor(sheetId){var strategy=this.mapping.get(sheetId);if(!strategy){throw new _errors.NoSheetWithIdError(sheetId)}return strategy}},{key:"addSheet",value:function addSheet(sheetId,strategy){if(this.mapping.has(sheetId)){throw Error("Sheet already added")}this.mapping.set(sheetId,strategy)}},{key:"autoAddSheet",value:function autoAddSheet(sheetId,sheet,sheetBoundaries){var height=sheetBoundaries.height,width=sheetBoundaries.width,fill=sheetBoundaries.fill;var strategyConstructor=this.policy.call(fill);this.addSheet(sheetId,new strategyConstructor(width,height))}},{key:"getCellValue",value:function getCellValue(address){var vertex=this.getCell(address);if(vertex===null){return _Cell.EmptyValue}else if(vertex instanceof _index.MatrixVertex){return vertex.getMatrixCellValue(address)}else{return vertex.getCellValue()}}},{key:"setCell",value:function setCell(address,newVertex){var sheetMapping=this.mapping.get(address.sheet);if(!sheetMapping){throw Error("Sheet not initialized")}sheetMapping.setCell(address,newVertex)}},{key:"removeCell",value:function removeCell(address){var sheetMapping=this.mapping.get(address.sheet);if(!sheetMapping){throw Error("Sheet not initialized")}sheetMapping.removeCell(address)}},{key:"has",value:function has(address){var sheetMapping=this.mapping.get(address.sheet);if(!sheetMapping){return false}return sheetMapping.has(address)}},{key:"getHeight",value:function getHeight(sheetId){var sheetMapping=this.mapping.get(sheetId);if(!sheetMapping){throw new _errors.NoSheetWithIdError(sheetId)}return sheetMapping.getHeight()}},{key:"getWidth",value:function getWidth(sheetId){var sheetMapping=this.mapping.get(sheetId);if(!sheetMapping){throw new _errors.NoSheetWithIdError(sheetId)}return sheetMapping.getWidth()}},{key:"addRows",value:function addRows(sheet,row,numberOfRows){var sheetMapping=this.mapping.get(sheet);if(!sheetMapping){throw Error("Sheet does not exist")}sheetMapping.addRows(row,numberOfRows)}},{key:"removeRows",value:function removeRows(removedRows){var sheetMapping=this.mapping.get(removedRows.sheet);if(!sheetMapping){throw Error("Sheet does not exist")}sheetMapping.removeRows(removedRows)}},{key:"removeSheet",value:function removeSheet(sheetId){this.mapping.delete(sheetId)}},{key:"addColumns",value:function addColumns(sheet,column,numberOfColumns){var sheetMapping=this.mapping.get(sheet);if(!sheetMapping){throw Error("Sheet does not exist")}sheetMapping.addColumns(column,numberOfColumns)}},{key:"removeColumns",value:function removeColumns(removedColumns){var sheetMapping=this.mapping.get(removedColumns.sheet);if(!sheetMapping){throw Error("Sheet does not exist")}sheetMapping.removeColumns(removedColumns)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function verticesFromRowsSpan(rowsSpan){return regeneratorRuntime.wrap((function verticesFromRowsSpan$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.delegateYield(this.mapping.get(rowsSpan.sheet).verticesFromRowsSpan(rowsSpan),"t0",1);case 1:case"end":return _context.stop()}}}),verticesFromRowsSpan,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function verticesFromColumnsSpan(columnsSpan){return regeneratorRuntime.wrap((function verticesFromColumnsSpan$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.delegateYield(this.mapping.get(columnsSpan.sheet).verticesFromColumnsSpan(columnsSpan),"t0",1);case 1:case"end":return _context2.stop()}}}),verticesFromColumnsSpan,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function entriesFromRowsSpan(rowsSpan){return regeneratorRuntime.wrap((function entriesFromRowsSpan$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.delegateYield(this.mapping.get(rowsSpan.sheet).entriesFromRowsSpan(rowsSpan),"t0",1);case 1:case"end":return _context3.stop()}}}),entriesFromRowsSpan,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function entriesFromColumnsSpan(columnsSpan){return regeneratorRuntime.wrap((function entriesFromColumnsSpan$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.delegateYield(this.mapping.get(columnsSpan.sheet).entriesFromColumnsSpan(columnsSpan),"t0",1);case 1:case"end":return _context4.stop()}}}),entriesFromColumnsSpan,this)}))},{key:"entries",value:regeneratorRuntime.mark((function entries(){var _iterator,_step,_step$value,sheet,mapping;return regeneratorRuntime.wrap((function entries$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_iterator=_createForOfIteratorHelper(this.mapping.entries());_context5.prev=1;_iterator.s();case 3:if((_step=_iterator.n()).done){_context5.next=8;break}_step$value=_slicedToArray(_step.value,2),sheet=_step$value[0],mapping=_step$value[1];return _context5.delegateYield(mapping.getEntries(sheet),"t0",6);case 6:_context5.next=3;break;case 8:_context5.next=13;break;case 10:_context5.prev=10;_context5.t1=_context5["catch"](1);_iterator.e(_context5.t1);case 13:_context5.prev=13;_iterator.f();return _context5.finish(13);case 16:case"end":return _context5.stop()}}}),entries,this,[[1,10,13,16]])}))},{key:"sheetEntries",value:regeneratorRuntime.mark((function sheetEntries(sheet){var sheetMapping;return regeneratorRuntime.wrap((function sheetEntries$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sheetMapping=this.mapping.get(sheet);if(!sheetMapping){_context6.next=5;break}return _context6.delegateYield(sheetMapping.getEntries(sheet),"t0",3);case 3:_context6.next=6;break;case 5:throw new Error("Sheet does not exists");case 6:case"end":return _context6.stop()}}}),sheetEntries,this)}))},{key:"destroy",value:function destroy(){this.mapping.clear()}}]);return AddressMapping}();exports.AddressMapping=AddressMapping},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var fill=__webpack_require__(182);var addToUnscopables=__webpack_require__(76);$({target:"Array",proto:true},{fill:fill});addToUnscopables("fill")},function(module,exports,__webpack_require__){"use strict";var toObject=__webpack_require__(49);var toAbsoluteIndex=__webpack_require__(42);var toLength=__webpack_require__(40);module.exports=function fill(value){var O=toObject(this);var length=toLength(O.length);var argumentsLength=arguments.length;var index=toAbsoluteIndex(argumentsLength>1?arguments[1]:undefined,length);var end=argumentsLength>2?arguments[2]:undefined;var endPos=end===undefined?length:toAbsoluteIndex(end,length);while(endPos>index)O[index++]=value;return O}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(184);__webpack_require__(75);__webpack_require__(164);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.NoRelativeAddressesAllowedError=exports.MatrixFormulasNotSupportedError=exports.TargetLocationHasMatrixError=exports.SourceLocationHasMatrixError=exports.ProtectedFunctionError=exports.FunctionPluginValidationError=exports.LanguageAlreadyRegisteredError=exports.LanguageNotRegisteredError=exports.ProtectedFunctionTranslationError=exports.MissingTranslationError=exports.EvaluationSuspendedError=exports.ExpectedOneOfValuesError=exports.ConfigValueTooBigError=exports.ConfigValueTooSmallError=exports.ExpectedValueOfTypeError=exports.UnableToParseError=exports.NothingToPasteError=exports.NoOperationToRedoError=exports.NoOperationToUndoError=exports.NamedExpressionDoesNotExistError=exports.NamedExpressionNameIsInvalidError=exports.NamedExpressionNameIsAlreadyTakenError=exports.InvalidArgumentsError=exports.InvalidAddressError=exports.NotAFormulaError=exports.SheetSizeLimitExceededError=exports.SheetNameAlreadyTakenError=exports.NoSheetWithNameError=exports.NoSheetWithIdError=void 0;function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var NoSheetWithIdError=function(_Error){_inherits(NoSheetWithIdError,_Error);var _super=_createSuper(NoSheetWithIdError);function NoSheetWithIdError(sheetId){_classCallCheck(this,NoSheetWithIdError);return _super.call(this,"There's no sheet with id = ".concat(sheetId))}return NoSheetWithIdError}(_wrapNativeSuper(Error));exports.NoSheetWithIdError=NoSheetWithIdError;var NoSheetWithNameError=function(_Error2){_inherits(NoSheetWithNameError,_Error2);var _super2=_createSuper(NoSheetWithNameError);function NoSheetWithNameError(sheetName){_classCallCheck(this,NoSheetWithNameError);return _super2.call(this,"There's no sheet with name '".concat(sheetName,"'"))}return NoSheetWithNameError}(_wrapNativeSuper(Error));exports.NoSheetWithNameError=NoSheetWithNameError;var SheetNameAlreadyTakenError=function(_Error3){_inherits(SheetNameAlreadyTakenError,_Error3);var _super3=_createSuper(SheetNameAlreadyTakenError);function SheetNameAlreadyTakenError(sheetName){_classCallCheck(this,SheetNameAlreadyTakenError);return _super3.call(this,"Sheet with name ".concat(sheetName," already exists"))}return SheetNameAlreadyTakenError}(_wrapNativeSuper(Error));exports.SheetNameAlreadyTakenError=SheetNameAlreadyTakenError;var SheetSizeLimitExceededError=function(_Error4){_inherits(SheetSizeLimitExceededError,_Error4);var _super4=_createSuper(SheetSizeLimitExceededError);function SheetSizeLimitExceededError(){_classCallCheck(this,SheetSizeLimitExceededError);return _super4.call(this,"Sheet size limit exceeded")}return SheetSizeLimitExceededError}(_wrapNativeSuper(Error));exports.SheetSizeLimitExceededError=SheetSizeLimitExceededError;var NotAFormulaError=function(_Error5){_inherits(NotAFormulaError,_Error5);var _super5=_createSuper(NotAFormulaError);function NotAFormulaError(){_classCallCheck(this,NotAFormulaError);return _super5.call(this,"This is not a formula")}return NotAFormulaError}(_wrapNativeSuper(Error));exports.NotAFormulaError=NotAFormulaError;var InvalidAddressError=function(_Error6){_inherits(InvalidAddressError,_Error6);var _super6=_createSuper(InvalidAddressError);function InvalidAddressError(address){_classCallCheck(this,InvalidAddressError);return _super6.call(this,"Address (row = ".concat(address.row,", col = ").concat(address.col,") is invalid"))}return InvalidAddressError}(_wrapNativeSuper(Error));exports.InvalidAddressError=InvalidAddressError;var InvalidArgumentsError=function(_Error7){_inherits(InvalidArgumentsError,_Error7);var _super7=_createSuper(InvalidArgumentsError);function InvalidArgumentsError(expectedArguments){_classCallCheck(this,InvalidArgumentsError);return _super7.call(this,"Invalid arguments, expected ".concat(expectedArguments))}return InvalidArgumentsError}(_wrapNativeSuper(Error));exports.InvalidArgumentsError=InvalidArgumentsError;var NamedExpressionNameIsAlreadyTakenError=function(_Error8){_inherits(NamedExpressionNameIsAlreadyTakenError,_Error8);var _super8=_createSuper(NamedExpressionNameIsAlreadyTakenError);function NamedExpressionNameIsAlreadyTakenError(expressionName){_classCallCheck(this,NamedExpressionNameIsAlreadyTakenError);return _super8.call(this,"Name of Named Expression '".concat(expressionName,"' is already present"))}return NamedExpressionNameIsAlreadyTakenError}(_wrapNativeSuper(Error));exports.NamedExpressionNameIsAlreadyTakenError=NamedExpressionNameIsAlreadyTakenError;var NamedExpressionNameIsInvalidError=function(_Error9){_inherits(NamedExpressionNameIsInvalidError,_Error9);var _super9=_createSuper(NamedExpressionNameIsInvalidError);function NamedExpressionNameIsInvalidError(expressionName){_classCallCheck(this,NamedExpressionNameIsInvalidError);return _super9.call(this,"Name of Named Expression '".concat(expressionName,"' is invalid"))}return NamedExpressionNameIsInvalidError}(_wrapNativeSuper(Error));exports.NamedExpressionNameIsInvalidError=NamedExpressionNameIsInvalidError;var NamedExpressionDoesNotExistError=function(_Error10){_inherits(NamedExpressionDoesNotExistError,_Error10);var _super10=_createSuper(NamedExpressionDoesNotExistError);function NamedExpressionDoesNotExistError(expressionName){_classCallCheck(this,NamedExpressionDoesNotExistError);return _super10.call(this,"Named Expression '".concat(expressionName,"' does not exist"))}return NamedExpressionDoesNotExistError}(_wrapNativeSuper(Error));exports.NamedExpressionDoesNotExistError=NamedExpressionDoesNotExistError;var NoOperationToUndoError=function(_Error11){_inherits(NoOperationToUndoError,_Error11);var _super11=_createSuper(NoOperationToUndoError);function NoOperationToUndoError(){_classCallCheck(this,NoOperationToUndoError);return _super11.call(this,"There is no operation to undo")}return NoOperationToUndoError}(_wrapNativeSuper(Error));exports.NoOperationToUndoError=NoOperationToUndoError;var NoOperationToRedoError=function(_Error12){_inherits(NoOperationToRedoError,_Error12);var _super12=_createSuper(NoOperationToRedoError);function NoOperationToRedoError(){_classCallCheck(this,NoOperationToRedoError);return _super12.call(this,"There is no operation to redo")}return NoOperationToRedoError}(_wrapNativeSuper(Error));exports.NoOperationToRedoError=NoOperationToRedoError;var NothingToPasteError=function(_Error13){_inherits(NothingToPasteError,_Error13);var _super13=_createSuper(NothingToPasteError);function NothingToPasteError(){_classCallCheck(this,NothingToPasteError);return _super13.call(this,"There is nothing to paste")}return NothingToPasteError}(_wrapNativeSuper(Error));exports.NothingToPasteError=NothingToPasteError;function replacer(key,val){switch(_typeof(val)){case"function":case"symbol":return val.toString();case"bigint":return"BigInt("+val.toString()+")";default:{if(val instanceof RegExp){return"RegExp("+val.toString()+")"}else{return val}}}}var UnableToParseError=function(_Error14){_inherits(UnableToParseError,_Error14);var _super14=_createSuper(UnableToParseError);function UnableToParseError(value){_classCallCheck(this,UnableToParseError);return _super14.call(this,"Unable to parse value: ".concat(JSON.stringify(value,replacer,4)))}return UnableToParseError}(_wrapNativeSuper(Error));exports.UnableToParseError=UnableToParseError;var ExpectedValueOfTypeError=function(_Error15){_inherits(ExpectedValueOfTypeError,_Error15);var _super15=_createSuper(ExpectedValueOfTypeError);function ExpectedValueOfTypeError(expectedType,paramName){_classCallCheck(this,ExpectedValueOfTypeError);return _super15.call(this,"Expected value of type: ".concat(expectedType," for config parameter: ").concat(paramName))}return ExpectedValueOfTypeError}(_wrapNativeSuper(Error));exports.ExpectedValueOfTypeError=ExpectedValueOfTypeError;var ConfigValueTooSmallError=function(_Error16){_inherits(ConfigValueTooSmallError,_Error16);var _super16=_createSuper(ConfigValueTooSmallError);function ConfigValueTooSmallError(paramName,minimum){_classCallCheck(this,ConfigValueTooSmallError);return _super16.call(this,"Config parameter ".concat(paramName," should be at least ").concat(minimum))}return ConfigValueTooSmallError}(_wrapNativeSuper(Error));exports.ConfigValueTooSmallError=ConfigValueTooSmallError;var ConfigValueTooBigError=function(_Error17){_inherits(ConfigValueTooBigError,_Error17);var _super17=_createSuper(ConfigValueTooBigError);function ConfigValueTooBigError(paramName,maximum){_classCallCheck(this,ConfigValueTooBigError);return _super17.call(this,"Config parameter ".concat(paramName," should be at most ").concat(maximum))}return ConfigValueTooBigError}(_wrapNativeSuper(Error));exports.ConfigValueTooBigError=ConfigValueTooBigError;var ExpectedOneOfValuesError=function(_Error18){_inherits(ExpectedOneOfValuesError,_Error18);var _super18=_createSuper(ExpectedOneOfValuesError);function ExpectedOneOfValuesError(values,paramName){_classCallCheck(this,ExpectedOneOfValuesError);return _super18.call(this,"Expected one of ".concat(values," for config parameter: ").concat(paramName))}return ExpectedOneOfValuesError}(_wrapNativeSuper(Error));exports.ExpectedOneOfValuesError=ExpectedOneOfValuesError;var EvaluationSuspendedError=function(_Error19){_inherits(EvaluationSuspendedError,_Error19);var _super19=_createSuper(EvaluationSuspendedError);function EvaluationSuspendedError(){_classCallCheck(this,EvaluationSuspendedError);return _super19.call(this,"Computations are suspended")}return EvaluationSuspendedError}(_wrapNativeSuper(Error));exports.EvaluationSuspendedError=EvaluationSuspendedError;var MissingTranslationError=function(_Error20){_inherits(MissingTranslationError,_Error20);var _super20=_createSuper(MissingTranslationError);function MissingTranslationError(key){_classCallCheck(this,MissingTranslationError);return _super20.call(this,"Translation for ".concat(key," is missing in the translation package you're using."))}return MissingTranslationError}(_wrapNativeSuper(Error));exports.MissingTranslationError=MissingTranslationError;var ProtectedFunctionTranslationError=function(_Error21){_inherits(ProtectedFunctionTranslationError,_Error21);var _super21=_createSuper(ProtectedFunctionTranslationError);function ProtectedFunctionTranslationError(key){_classCallCheck(this,ProtectedFunctionTranslationError);return _super21.call(this,"Cannot register translation for function with id: ".concat(key))}return ProtectedFunctionTranslationError}(_wrapNativeSuper(Error));exports.ProtectedFunctionTranslationError=ProtectedFunctionTranslationError;var LanguageNotRegisteredError=function(_Error22){_inherits(LanguageNotRegisteredError,_Error22);var _super22=_createSuper(LanguageNotRegisteredError);function LanguageNotRegisteredError(){_classCallCheck(this,LanguageNotRegisteredError);return _super22.call(this,"Language not registered.")}return LanguageNotRegisteredError}(_wrapNativeSuper(Error));exports.LanguageNotRegisteredError=LanguageNotRegisteredError;var LanguageAlreadyRegisteredError=function(_Error23){_inherits(LanguageAlreadyRegisteredError,_Error23);var _super23=_createSuper(LanguageAlreadyRegisteredError);function LanguageAlreadyRegisteredError(){_classCallCheck(this,LanguageAlreadyRegisteredError);return _super23.call(this,"Language already registered.")}return LanguageAlreadyRegisteredError}(_wrapNativeSuper(Error));exports.LanguageAlreadyRegisteredError=LanguageAlreadyRegisteredError;var FunctionPluginValidationError=function(_Error24){_inherits(FunctionPluginValidationError,_Error24);var _super24=_createSuper(FunctionPluginValidationError);function FunctionPluginValidationError(){_classCallCheck(this,FunctionPluginValidationError);return _super24.apply(this,arguments)}_createClass(FunctionPluginValidationError,null,[{key:"functionNotDeclaredInPlugin",value:function functionNotDeclaredInPlugin(functionId,pluginName){return new FunctionPluginValidationError("Function with id ".concat(functionId," not declared in plugin ").concat(pluginName))}},{key:"functionMethodNotFound",value:function functionMethodNotFound(functionName,pluginName){return new FunctionPluginValidationError("Function method ".concat(functionName," not found in plugin ").concat(pluginName))}}]);return FunctionPluginValidationError}(_wrapNativeSuper(Error));exports.FunctionPluginValidationError=FunctionPluginValidationError;var ProtectedFunctionError=function(_Error25){_inherits(ProtectedFunctionError,_Error25);var _super25=_createSuper(ProtectedFunctionError);function ProtectedFunctionError(){_classCallCheck(this,ProtectedFunctionError);return _super25.apply(this,arguments)}_createClass(ProtectedFunctionError,null,[{key:"cannotRegisterFunctionWithId",value:function cannotRegisterFunctionWithId(functionId){return new ProtectedFunctionError("Cannot register function with id ".concat(functionId))}},{key:"cannotUnregisterFunctionWithId",value:function cannotUnregisterFunctionWithId(functionId){return new ProtectedFunctionError("Cannot unregister function with id ".concat(functionId))}},{key:"cannotUnregisterProtectedPlugin",value:function cannotUnregisterProtectedPlugin(){return new ProtectedFunctionError("Cannot unregister protected plugin")}}]);return ProtectedFunctionError}(_wrapNativeSuper(Error));exports.ProtectedFunctionError=ProtectedFunctionError;var SourceLocationHasMatrixError=function(_Error26){_inherits(SourceLocationHasMatrixError,_Error26);var _super26=_createSuper(SourceLocationHasMatrixError);function SourceLocationHasMatrixError(){_classCallCheck(this,SourceLocationHasMatrixError);return _super26.call(this,"Cannot perform this operation, source location has a matrix inside.")}return SourceLocationHasMatrixError}(_wrapNativeSuper(Error));exports.SourceLocationHasMatrixError=SourceLocationHasMatrixError;var TargetLocationHasMatrixError=function(_Error27){_inherits(TargetLocationHasMatrixError,_Error27);var _super27=_createSuper(TargetLocationHasMatrixError);function TargetLocationHasMatrixError(){_classCallCheck(this,TargetLocationHasMatrixError);return _super27.call(this,"Cannot perform this operation, target location has a matrix inside.")}return TargetLocationHasMatrixError}(_wrapNativeSuper(Error));exports.TargetLocationHasMatrixError=TargetLocationHasMatrixError;var MatrixFormulasNotSupportedError=function(_Error28){_inherits(MatrixFormulasNotSupportedError,_Error28);var _super28=_createSuper(MatrixFormulasNotSupportedError);function MatrixFormulasNotSupportedError(){_classCallCheck(this,MatrixFormulasNotSupportedError);return _super28.call(this,"Matrix formulas are not supported in named expressions.")}return MatrixFormulasNotSupportedError}(_wrapNativeSuper(Error));exports.MatrixFormulasNotSupportedError=MatrixFormulasNotSupportedError;var NoRelativeAddressesAllowedError=function(_Error29){_inherits(NoRelativeAddressesAllowedError,_Error29);var _super29=_createSuper(NoRelativeAddressesAllowedError);function NoRelativeAddressesAllowedError(){_classCallCheck(this,NoRelativeAddressesAllowedError);return _super29.call(this,"Relative addresses not allowed in named expressions.")}return NoRelativeAddressesAllowedError}(_wrapNativeSuper(Error));exports.NoRelativeAddressesAllowedError=NoRelativeAddressesAllowedError},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $indexOf=__webpack_require__(39).indexOf;var arrayMethodIsStrict=__webpack_require__(112);var arrayMethodUsesToLength=__webpack_require__(88);var nativeIndexOf=[].indexOf;var NEGATIVE_ZERO=!!nativeIndexOf&&1/[1].indexOf(1,-0)<0;var STRICT_METHOD=arrayMethodIsStrict("indexOf");var USES_TO_LENGTH=arrayMethodUsesToLength("indexOf",{ACCESSORS:true,1:0});$({target:"Array",proto:true,forced:NEGATIVE_ZERO||!STRICT_METHOD||!USES_TO_LENGTH},{indexOf:function indexOf(searchElement){return NEGATIVE_ZERO?nativeIndexOf.apply(this,arguments)||0:$indexOf(this,searchElement,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(186);__webpack_require__(65);__webpack_require__(113);__webpack_require__(98);exports.__esModule=true;exports.collectAddressesDependentToMatrix=void 0;var _parser=__webpack_require__(138);var _FormulaCellVertex=__webpack_require__(187);var _MatrixVertex=__webpack_require__(188);var _RangeVertex=__webpack_require__(191);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var collectAddressesDependentToMatrix=function collectAddressesDependentToMatrix(funcitonRegistry,vertex,matrix,lazilyTransformingAstService,dependencyGraph){var range=matrix.getRange();if(vertex instanceof _RangeVertex.RangeVertex){var intersection=vertex.range.intersectionWith(range);if(intersection!==null){return Array.from(intersection.addresses(dependencyGraph))}else{return[]}}var formula;var address;if(vertex instanceof _FormulaCellVertex.FormulaCellVertex){formula=vertex.getFormula(lazilyTransformingAstService);address=vertex.getAddress(lazilyTransformingAstService)}else if(vertex instanceof _MatrixVertex.MatrixVertex&&vertex.isFormula()){formula=vertex.getFormula();address=vertex.getAddress()}else{return[]}return(0,_parser.collectDependencies)(formula,funcitonRegistry).filter((function(d){return d instanceof _parser.AddressDependency})).map((function(d){return d.dependency.toSimpleCellAddress(address)})).filter((function(d){return range.addressInRange(d)}))};exports.collectAddressesDependentToMatrix=collectAddressesDependentToMatrix},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $filter=__webpack_require__(59).filter;var arrayMethodHasSpeciesSupport=__webpack_require__(85);var arrayMethodUsesToLength=__webpack_require__(88);var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("filter");var USES_TO_LENGTH=arrayMethodUsesToLength("filter");$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{filter:function filter(callbackfn){return $filter(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.FormulaCellVertex=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var FormulaCellVertex=function(){function FormulaCellVertex(formula,cellAddress,version){_classCallCheck(this,FormulaCellVertex);this.formula=formula;this.cellAddress=cellAddress;this.version=version;this.formula=formula;this.cellAddress=cellAddress;this.cachedCellValue=null}_createClass(FormulaCellVertex,[{key:"getFormula",value:function getFormula(updatingService){this.ensureRecentData(updatingService);return this.formula}},{key:"ensureRecentData",value:function ensureRecentData(updatingService){if(this.version!=updatingService.version()){var _updatingService$appl=updatingService.applyTransformations(this.formula,this.address,this.version),_updatingService$appl2=_slicedToArray(_updatingService$appl,3),newAst=_updatingService$appl2[0],newAddress=_updatingService$appl2[1],newVersion=_updatingService$appl2[2];this.formula=newAst;this.cellAddress=newAddress;this.version=newVersion}}},{key:"getAddress",value:function getAddress(updatingService){this.ensureRecentData(updatingService);return this.cellAddress}},{key:"setCellValue",value:function setCellValue(cellValue){this.cachedCellValue=cellValue}},{key:"getCellValue",value:function getCellValue(){if(this.cachedCellValue!==null){return this.cachedCellValue}else{throw Error("Value of the formula cell is not computed.")}}},{key:"isComputed",value:function isComputed(){return this.cachedCellValue!==null}},{key:"address",get:function get(){return this.cellAddress}}]);return FormulaCellVertex}();exports.FormulaCellVertex=FormulaCellVertex},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.MatrixVertex=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Matrix=__webpack_require__(189);var _Span=__webpack_require__(174);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var MatrixVertex=function(){function MatrixVertex(cellAddress,width,height,formula){_classCallCheck(this,MatrixVertex);this.cellAddress=cellAddress;this.formula=formula||null;this.matrix=new _Matrix.NotComputedMatrix(new _Matrix.MatrixSize(width,height))}_createClass(MatrixVertex,[{key:"setCellValue",value:function setCellValue(matrix){this.matrix=matrix}},{key:"setErrorValue",value:function setErrorValue(error){this.matrix=new _Matrix.ErroredMatrix(error,this.matrix.size)}},{key:"getCellValue",value:function getCellValue(){if(this.matrix instanceof _Matrix.NotComputedMatrix){throw Error("Matrix not computed yet.")}return this.matrix}},{key:"getMatrixCellValue",value:function getMatrixCellValue(address){var col=address.col-this.cellAddress.col;var row=address.row-this.cellAddress.row;return this.matrix.get(col,row)}},{key:"setMatrixCellValue",value:function setMatrixCellValue(address,value){var col=address.col-this.cellAddress.col;var row=address.row-this.cellAddress.row;if(this.matrix instanceof _Matrix.Matrix){this.matrix.set(col,row,value)}}},{key:"getRange",value:function getRange(){return _AbsoluteCellRange.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getAddress",value:function getAddress(){return this.cellAddress}},{key:"setAddress",value:function setAddress(address){this.cellAddress=address}},{key:"getFormula",value:function getFormula(){return this.formula}},{key:"setFormula",value:function setFormula(newFormula){this.formula=newFormula}},{key:"isFormula",value:function isFormula(){return this.formula!==null}},{key:"isNumeric",value:function isNumeric(){return this.formula===null}},{key:"spansThroughSheetRows",value:function spansThroughSheetRows(sheet,startRow){var endRow=arguments.length>2&&arguments[2]!==undefined?arguments[2]:startRow;return this.cellAddress.sheet===sheet&&this.cellAddress.row<=endRow&&startRow<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function spansThroughSheetColumn(sheet,col){var columnEnd=arguments.length>2&&arguments[2]!==undefined?arguments[2]:col;return this.cellAddress.sheet===sheet&&this.cellAddress.col<=columnEnd&&col<this.cellAddress.col+this.width}},{key:"addRows",value:function addRows(sheet,row,numberOfRows){if(this.matrix instanceof _Matrix.Matrix){this.matrix.addRows(row-this.getAddress().row,numberOfRows)}}},{key:"addColumns",value:function addColumns(sheet,column,numberOfColumns){if(this.matrix instanceof _Matrix.Matrix){this.matrix.addColumns(column-this.getAddress().col,numberOfColumns)}}},{key:"removeRows",value:function removeRows(removedRows){if(this.matrix instanceof _Matrix.Matrix){var removedRowsFromMatrix=this.rowsFromMatrix().intersect(removedRows);this.matrix.removeRows(removedRowsFromMatrix.rowStart-this.getAddress().row,removedRowsFromMatrix.rowEnd-this.getAddress().row)}}},{key:"removeColumns",value:function removeColumns(removedColumns){if(this.matrix instanceof _Matrix.Matrix){var removedColumnsFromMatrix=this.columnsFromMatrix().intersect(removedColumns);this.matrix.removeColumns(removedColumnsFromMatrix.columnStart-this.getAddress().col,removedColumnsFromMatrix.columnEnd-this.getAddress().col)}}},{key:"isComputed",value:function isComputed(){return!(this.matrix instanceof _Matrix.NotComputedMatrix)}},{key:"columnsFromMatrix",value:function columnsFromMatrix(){return _Span.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromMatrix",value:function rowsFromMatrix(){return _Span.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"width",get:function get(){return this.matrix.width()}},{key:"height",get:function get(){return this.matrix.height()}},{key:"sheet",get:function get(){return this.cellAddress.sheet}}],[{key:"fromRange",value:function fromRange(range,formula){return new MatrixVertex(range.start,range.width(),range.height(),formula)}}]);return MatrixVertex}();exports.MatrixVertex=MatrixVertex},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(181);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(190);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.matrixSizeForTranspose=matrixSizeForTranspose;exports.matrixSizeForMultiplication=matrixSizeForMultiplication;exports.matrixSizeForPoolFunction=matrixSizeForPoolFunction;exports.checkMatrixSize=checkMatrixSize;exports.ErroredMatrix=exports.Matrix=exports.NotComputedMatrix=exports.MatrixSize=void 0;__webpack_require__(125);var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MatrixSize=function MatrixSize(width,height){_classCallCheck(this,MatrixSize);this.width=width;this.height=height;if(width<=0||height<=0){throw Error("Incorrect matrix size")}};exports.MatrixSize=MatrixSize;function matrixSizeForTranspose(inputSize){return new MatrixSize(inputSize.height,inputSize.width)}function matrixSizeForMultiplication(leftMatrixSize,rightMatrixSize){return new MatrixSize(rightMatrixSize.width,leftMatrixSize.height)}function matrixSizeForPoolFunction(inputMatrix,windowSize,stride){return new MatrixSize(1+(inputMatrix.width-windowSize)/stride,1+(inputMatrix.height-windowSize)/stride)}function checkMatrixSize(ast,formulaAddress){if(ast.type===_parser.AstNodeType.FUNCTION_CALL){switch(ast.procedureName){case"MMULT":{if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var left=checkMatrixSize(ast.args[0],formulaAddress);var right=checkMatrixSize(ast.args[1],formulaAddress);if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else if(left.width!==right.height){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return matrixSizeForMultiplication(left,right)}}case"MEDIANPOOL":case"MAXPOOL":{if(ast.args.length<2||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var matrix=checkMatrixSize(ast.args[0],formulaAddress);var windowArg=ast.args[1];if(matrix instanceof _Cell.CellError){return matrix}else if(windowArg.type!==_parser.AstNodeType.NUMBER){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var window=windowArg.value;var stride=windowArg.value;if(ast.args.length===3){var strideArg=ast.args[2];if(strideArg.type===_parser.AstNodeType.NUMBER){stride=strideArg.value}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}if(window>matrix.width||window>matrix.height||stride>window||(matrix.width-window)%stride!==0||(matrix.height-window)%stride!==0){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return matrixSizeForPoolFunction(matrix,window,stride)}case"TRANSPOSE":{if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args[0].type===_parser.AstNodeType.EMPTY){return new _Cell.CellError(_Cell.ErrorType.NUM)}var size=checkMatrixSize(ast.args[0],formulaAddress);return size instanceof _Cell.CellError?size:matrixSizeForTranspose(size)}default:{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}}else if(ast.type===_parser.AstNodeType.CELL_RANGE){var range=_AbsoluteCellRange.AbsoluteCellRange.fromCellRange(ast,formulaAddress);return{width:range.width(),height:range.height()}}else if(ast.type===_parser.AstNodeType.NUMBER||ast.type===_parser.AstNodeType.CELL_REFERENCE){return{width:1,height:1}}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}var NotComputedMatrix=function(){function NotComputedMatrix(size){_classCallCheck(this,NotComputedMatrix);this.size=size}_createClass(NotComputedMatrix,[{key:"width",value:function width(){return this.size.width}},{key:"height",value:function height(){return this.size.height}},{key:"get",value:function get(col,row){throw Error("Matrix not computed yet.")}}]);return NotComputedMatrix}();exports.NotComputedMatrix=NotComputedMatrix;var Matrix=function(){function Matrix(matrix){_classCallCheck(this,Matrix);this.size=new MatrixSize(matrix.length>0?matrix[0].length:0,matrix.length);this.matrix=matrix}_createClass(Matrix,[{key:"addRows",value:function addRows(aboveRow,numberOfRows){var _this$matrix;(_this$matrix=this.matrix).splice.apply(_this$matrix,[aboveRow,0].concat(_toConsumableArray(this.zeroArrays(numberOfRows,this.width()))));this.size.height+=numberOfRows}},{key:"addColumns",value:function addColumns(aboveColumn,numberOfColumns){for(var i=0;i<this.height();i++){var _this$matrix$i;(_this$matrix$i=this.matrix[i]).splice.apply(_this$matrix$i,[aboveColumn,0].concat(_toConsumableArray(new Array(numberOfColumns).fill(0))))}this.size.width+=numberOfColumns}},{key:"removeRows",value:function removeRows(startRow,endRow){if(this.outOfBound(0,startRow)||this.outOfBound(0,endRow)){throw Error("Matrix index out of bound")}var numberOfRows=endRow-startRow+1;this.matrix.splice(startRow,numberOfRows);this.size.height-=numberOfRows}},{key:"removeColumns",value:function removeColumns(leftmostColumn,rightmostColumn){if(this.outOfBound(leftmostColumn,0)||this.outOfBound(rightmostColumn,0)){throw Error("Matrix index out of bound")}var numberOfColumns=rightmostColumn-leftmostColumn+1;var _iterator=_createForOfIteratorHelper(this.matrix),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var row=_step.value;row.splice(leftmostColumn,numberOfColumns)}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.size.width-=numberOfColumns}},{key:"zeroArrays",value:function zeroArrays(count,size){var result=[];for(var i=0;i<count;++i){result.push(new Array(size).fill(0))}return result}},{key:"get",value:function get(col,row){if(this.outOfBound(col,row)){throw Error("Matrix index out of bound")}return this.matrix[row][col]}},{key:"set",value:function set(col,row,value){if(this.outOfBound(col,row)){throw Error("Matrix index out of bound")}this.matrix[row][col]=value}},{key:"width",value:function width(){return this.size.width}},{key:"height",value:function height(){return this.size.height}},{key:"raw",value:function raw(){return this.matrix}},{key:"generateValues",value:regeneratorRuntime.mark((function generateValues(leftCorner){var row,col;return regeneratorRuntime.wrap((function generateValues$(_context){while(1){switch(_context.prev=_context.next){case 0:row=0;case 1:if(!(row<this.size.height)){_context.next=12;break}col=0;case 3:if(!(col<this.size.width)){_context.next=9;break}_context.next=6;return[this.matrix[row][col],(0,_Cell.simpleCellAddress)(leftCorner.sheet,leftCorner.col+col,leftCorner.row+row)];case 6:++col;_context.next=3;break;case 9:++row;_context.next=1;break;case 12:case"end":return _context.stop()}}}),generateValues,this)}))},{key:"outOfBound",value:function outOfBound(col,row){return col<0||row<0||row>this.size.height-1||col>this.size.width-1}}]);return Matrix}();exports.Matrix=Matrix;var ErroredMatrix=function(){function ErroredMatrix(error,size){_classCallCheck(this,ErroredMatrix);this.error=error;this.size=size}_createClass(ErroredMatrix,[{key:"get",value:function get(col,row){return this.error}},{key:"width",value:function width(){return this.size.width}},{key:"height",value:function height(){return this.size.height}}]);return ErroredMatrix}();exports.ErroredMatrix=ErroredMatrix},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var toAbsoluteIndex=__webpack_require__(42);var toInteger=__webpack_require__(41);var toLength=__webpack_require__(40);var toObject=__webpack_require__(49);var arraySpeciesCreate=__webpack_require__(62);var createProperty=__webpack_require__(70);var arrayMethodHasSpeciesSupport=__webpack_require__(85);var arrayMethodUsesToLength=__webpack_require__(88);var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("splice");var USES_TO_LENGTH=arrayMethodUsesToLength("splice",{ACCESSORS:true,0:0,1:2});var max=Math.max;var min=Math.min;var MAX_SAFE_INTEGER=9007199254740991;var MAXIMUM_ALLOWED_LENGTH_EXCEEDED="Maximum allowed length exceeded";$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{splice:function splice(start,deleteCount){var O=toObject(this);var len=toLength(O.length);var actualStart=toAbsoluteIndex(start,len);var argumentsLength=arguments.length;var insertCount,actualDeleteCount,A,k,from,to;if(argumentsLength===0){insertCount=actualDeleteCount=0}else if(argumentsLength===1){insertCount=0;actualDeleteCount=len-actualStart}else{insertCount=argumentsLength-2;actualDeleteCount=min(max(toInteger(deleteCount),0),len-actualStart)}if(len+insertCount-actualDeleteCount>MAX_SAFE_INTEGER){throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED)}A=arraySpeciesCreate(O,actualDeleteCount);for(k=0;k<actualDeleteCount;k++){from=actualStart+k;if(from in O)createProperty(A,k,O[from])}A.length=actualDeleteCount;if(insertCount<actualDeleteCount){for(k=actualStart;k<len-actualDeleteCount;k++){from=k+actualDeleteCount;to=k+insertCount;if(from in O)O[to]=O[from];else delete O[to]}for(k=len;k>len-actualDeleteCount+insertCount;k--)delete O[k-1]}else if(insertCount>actualDeleteCount){for(k=len-actualDeleteCount;k>actualStart;k--){from=k+actualDeleteCount-1;to=k+insertCount-1;if(from in O)O[to]=O[from];else delete O[to]}}for(k=0;k<insertCount;k++){O[k+actualStart]=arguments[k+2]}O.length=len-actualDeleteCount+insertCount;return A}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(110);__webpack_require__(75);__webpack_require__(164);__webpack_require__(92);__webpack_require__(114);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.RangeVertex=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var RangeVertex=function(){function RangeVertex(range){_classCallCheck(this,RangeVertex);this.range=range;this.functionCache=new Map;this.criterionFunctionCache=new Map;this.dependentCacheRanges=new Set;this.bruteForce=false}_createClass(RangeVertex,[{key:"getFunctionValue",value:function getFunctionValue(functionName){return this.functionCache.get(functionName)||null}},{key:"setFunctionValue",value:function setFunctionValue(functionName,value){this.functionCache.set(functionName,value)}},{key:"getCriterionFunctionValue",value:function getCriterionFunctionValue(cacheKey,criterionString){var values=this.getCriterionFunctionValues(cacheKey);var value=values.get(criterionString);return value?value[0]:null}},{key:"getCriterionFunctionValues",value:function getCriterionFunctionValues(cacheKey){return this.criterionFunctionCache.get(cacheKey)||new Map}},{key:"setCriterionFunctionValues",value:function setCriterionFunctionValues(cacheKey,values){this.criterionFunctionCache.set(cacheKey,values)}},{key:"addDependentCacheRange",value:function addDependentCacheRange(dependentRange){if(dependentRange!==this){this.dependentCacheRanges.add(dependentRange)}}},{key:"clearCache",value:function clearCache(){this.functionCache.clear();this.criterionFunctionCache.clear();this.dependentCacheRanges.forEach((function(range){return range.criterionFunctionCache.clear()}));this.dependentCacheRanges.clear()}},{key:"getStart",value:function getStart(){return this.start}},{key:"getEnd",value:function getEnd(){return this.end}},{key:"start",get:function get(){return this.range.start}},{key:"end",get:function get(){return this.range.end}},{key:"sheet",get:function get(){return this.range.start.sheet}}]);return RangeVertex}();exports.RangeVertex=RangeVertex},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(193);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(114);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.Graph=void 0;function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var NodeVisitStatus;(function(NodeVisitStatus){NodeVisitStatus[NodeVisitStatus["ON_STACK"]=0]="ON_STACK";NodeVisitStatus[NodeVisitStatus["PROCESSED"]=1]="PROCESSED";NodeVisitStatus[NodeVisitStatus["POPPED"]=2]="POPPED"})(NodeVisitStatus||(NodeVisitStatus={}));var Graph=function(){function Graph(dependencyQuery){_classCallCheck(this,Graph);this.dependencyQuery=dependencyQuery;this.nodes=new Set;this.specialNodes=new Set;this.specialNodesStructuralChanges=new Set;this.specialNodesRecentlyChanged=new Set;this.infiniteRanges=new Set;this.edges=new Map}_createClass(Graph,[{key:"addNode",value:function addNode(node){this.nodes.add(node);if(!this.edges.has(node)){this.edges.set(node,new Set)}}},{key:"addEdge",value:function addEdge(fromNode,toNode){if(!this.nodes.has(fromNode)){throw new Error("Unknown node ".concat(fromNode))}if(!this.nodes.has(toNode)){throw new Error("Unknown node ".concat(toNode))}this.edges.get(fromNode).add(toNode)}},{key:"removeEdge",value:function removeEdge(fromNode,toNode){if(this.existsEdge(fromNode,toNode)){this.edges.get(fromNode).delete(toNode)}else{throw new Error("Edge does not exist")}}},{key:"softRemoveEdge",value:function softRemoveEdge(fromNode,toNode){var _a;(_a=this.edges.get(fromNode))===null||_a===void 0?void 0:_a.delete(toNode)}},{key:"removeIncomingEdges",value:function removeIncomingEdges(toNode){this.edges.forEach((function(nodeEdges){nodeEdges.delete(toNode)}))}},{key:"adjacentNodes",value:function adjacentNodes(node){return this.edges.get(node)}},{key:"adjacentNodesCount",value:function adjacentNodesCount(node){return this.adjacentNodes(node).size}},{key:"hasNode",value:function hasNode(node){return this.nodes.has(node)}},{key:"nodesCount",value:function nodesCount(){return this.nodes.size}},{key:"edgesCount",value:function edgesCount(){var result=0;this.edges.forEach((function(edgesForNode){return result+=edgesForNode.size}));return result}},{key:"removeNode",value:function removeNode(node){var _iterator=_createForOfIteratorHelper(this.adjacentNodes(node).values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var adjacentNode=_step.value;this.markNodeAsSpecialRecentlyChanged(adjacentNode)}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.edges.delete(node);this.nodes.delete(node);this.specialNodes.delete(node);this.specialNodesRecentlyChanged.delete(node);this.specialNodesStructuralChanges.delete(node);this.infiniteRanges.delete(node);return this.removeDependencies(node)}},{key:"markNodeAsSpecial",value:function markNodeAsSpecial(node){this.specialNodes.add(node)}},{key:"markNodeAsSpecialRecentlyChanged",value:function markNodeAsSpecialRecentlyChanged(node){if(this.nodes.has(node)){this.specialNodesRecentlyChanged.add(node)}}},{key:"markNodeAsChangingWithStructure",value:function markNodeAsChangingWithStructure(node){this.specialNodesStructuralChanges.add(node)}},{key:"clearSpecialNodesRecentlyChanged",value:function clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function markNodeAsInfiniteRange(node){this.infiniteRanges.add(node)}},{key:"existsEdge",value:function existsEdge(fromNode,toNode){var _a,_b;return(_b=(_a=this.edges.get(fromNode))===null||_a===void 0?void 0:_a.has(toNode))!==null&&_b!==void 0?_b:false}},{key:"topSortWithScc",value:function topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(function(_node){return true}),(function(_node){}))}},{key:"getTopSortedWithSccSubgraphFrom",value:function getTopSortedWithSccSubgraphFrom(modifiedNodes,operatingFunction,onCycle){var _this=this;var entranceTime=new Map;var low=new Map;var parent=new Map;var nodeStatus=new Map;var order=[];var time=0;modifiedNodes.reverse().forEach((function(v){if(nodeStatus.get(v)!==undefined){return}time++;var DFSstack=[v];nodeStatus.set(v,NodeVisitStatus.ON_STACK);var _loop=function _loop(){var u=DFSstack[DFSstack.length-1];switch(nodeStatus.get(u)){case NodeVisitStatus.ON_STACK:{nodeStatus.set(u,NodeVisitStatus.PROCESSED);entranceTime.set(u,time);low.set(u,time);_this.adjacentNodes(u).forEach((function(t){switch(nodeStatus.get(t)){case NodeVisitStatus.POPPED:break;case NodeVisitStatus.PROCESSED:{low.set(u,Math.min(low.get(u),entranceTime.get(t)));break}case undefined:case NodeVisitStatus.ON_STACK:{parent.set(t,u);DFSstack.push(t);nodeStatus.set(t,NodeVisitStatus.ON_STACK);time++;break}}}));break}case NodeVisitStatus.PROCESSED:{var pu=parent.get(u);if(pu!==null){low.set(pu,Math.min(low.get(pu),low.get(u)))}nodeStatus.set(u,NodeVisitStatus.POPPED);order.push(u);DFSstack.pop();break}case NodeVisitStatus.POPPED:{DFSstack.pop();break}}};while(DFSstack.length>0){_loop()}}));var sccMap=new Map;var sccNonSingletons=new Set;order.reverse();order.forEach((function(v){if(entranceTime.get(v)===low.get(v)){sccMap.set(v,v)}else{sccMap.set(v,sccMap.get(parent.get(v)))}}));this.edges.forEach((function(targets,v){targets.forEach((function(u){var uRepr=sccMap.get(u);var vRepr=sccMap.get(v);if(uRepr===vRepr){sccNonSingletons.add(uRepr)}}))}));var shouldBeUpdatedMapping=new Set(modifiedNodes);var sorted=[];var cycled=[];order.forEach((function(t){if(!sccNonSingletons.has(sccMap.get(t))){sorted.push(t);if(shouldBeUpdatedMapping.has(t)&&operatingFunction(t)){_this.adjacentNodes(t).forEach((function(s){return shouldBeUpdatedMapping.add(s)}))}}else{cycled.push(t);onCycle(t);_this.adjacentNodes(t).forEach((function(s){return shouldBeUpdatedMapping.add(s)}))}}));return{sorted:sorted,cycled:cycled}}},{key:"getDependencies",value:function getDependencies(vertex){var result=[];this.edges.forEach((function(adjacentNodes,sourceNode){if(adjacentNodes.has(vertex)){result.push(sourceNode)}}));return result}},{key:"destroy",value:function destroy(){this.edges.clear();this.nodes.clear();this.specialNodes.clear();this.specialNodesStructuralChanges.clear();this.clearSpecialNodesRecentlyChanged()}},{key:"removeDependencies",value:function removeDependencies(node){var dependencies=this.dependencyQuery(node);if(!dependencies){return new Set}var _iterator2=_createForOfIteratorHelper(dependencies),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dependency=_step2.value;this.softRemoveEdge(dependency,node)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return dependencies}}]);return Graph}();exports.Graph=Graph},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var isArray=__webpack_require__(48);var nativeReverse=[].reverse;var test=[1,2];$({target:"Array",proto:true,forced:String(test)===String(test.reverse())},{reverse:function reverse(){if(isArray(this))this.length=this.length;return nativeReverse.call(this)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.MatrixMapping=void 0;__webpack_require__(125);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var MatrixMapping=function(){function MatrixMapping(){_classCallCheck(this,MatrixMapping);this.matrixMapping=new Map}_createClass(MatrixMapping,[{key:"getMatrix",value:function getMatrix(range){return this.matrixMapping.get(range.toString())}},{key:"setMatrix",value:function setMatrix(range,vertex){this.matrixMapping.set(range.toString(),vertex)}},{key:"removeMatrix",value:function removeMatrix(range){this.matrixMapping.delete(range.toString())}},{key:"isFormulaMatrixInRow",value:function isFormulaMatrixInRow(sheet,row){var _iterator=_createForOfIteratorHelper(this.matrixMapping.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var mtx=_step.value;if(mtx.spansThroughSheetRows(sheet,row)&&mtx.isFormula()){return true}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return false}},{key:"isFormulaMatrixInRows",value:function isFormulaMatrixInRows(span){var _iterator2=_createForOfIteratorHelper(span.rows()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var row=_step2.value;if(this.isFormulaMatrixInRow(span.sheet,row)){return true}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return false}},{key:"isFormulaMatrixInColumn",value:function isFormulaMatrixInColumn(sheet,column){var _iterator3=_createForOfIteratorHelper(this.matrixMapping.values()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var mtx=_step3.value;if(mtx.spansThroughSheetColumn(sheet,column)&&mtx.isFormula()){return true}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return false}},{key:"isFormulaMatrixInColumns",value:function isFormulaMatrixInColumns(span){var _iterator4=_createForOfIteratorHelper(span.columns()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var col=_step4.value;if(this.isFormulaMatrixInColumn(span.sheet,col)){return true}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}return false}},{key:"isFormulaMatrixInRange",value:function isFormulaMatrixInRange(range){var _iterator5=_createForOfIteratorHelper(this.matrixMapping.values()),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var mtx=_step5.value;if(mtx.isFormula()&&mtx.getRange().doesOverlap(range)){return true}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return false}},{key:"isFormulaMatrixAtAddress",value:function isFormulaMatrixAtAddress(address){var _iterator6=_createForOfIteratorHelper(this.matrixMapping.values()),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var mtx=_step6.value;if(mtx.getRange().addressInRange(address)&&mtx.isFormula()){return true}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return false}},{key:"numericMatrices",value:regeneratorRuntime.mark((function numericMatrices(){var _iterator7,_step7,_step7$value,mtxKey,mtx;return regeneratorRuntime.wrap((function numericMatrices$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator7=_createForOfIteratorHelper(this.matrixMapping.entries());_context.prev=1;_iterator7.s();case 3:if((_step7=_iterator7.n()).done){_context.next=10;break}_step7$value=_slicedToArray(_step7.value,2),mtxKey=_step7$value[0],mtx=_step7$value[1];if(mtx.isFormula()){_context.next=8;break}_context.next=8;return[mtxKey,mtx];case 8:_context.next=3;break;case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](1);_iterator7.e(_context.t0);case 15:_context.prev=15;_iterator7.f();return _context.finish(15);case 18:case"end":return _context.stop()}}}),numericMatrices,this,[[1,12,15,18]])}))},{key:"numericMatricesInRows",value:regeneratorRuntime.mark((function numericMatricesInRows(rowsSpan){var _iterator8,_step8,_step8$value,mtxKey,mtx;return regeneratorRuntime.wrap((function numericMatricesInRows$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_iterator8=_createForOfIteratorHelper(this.matrixMapping.entries());_context2.prev=1;_iterator8.s();case 3:if((_step8=_iterator8.n()).done){_context2.next=10;break}_step8$value=_slicedToArray(_step8.value,2),mtxKey=_step8$value[0],mtx=_step8$value[1];if(!(mtx.spansThroughSheetRows(rowsSpan.sheet,rowsSpan.rowStart,rowsSpan.rowEnd)&&!mtx.isFormula())){_context2.next=8;break}_context2.next=8;return[mtxKey,mtx];case 8:_context2.next=3;break;case 10:_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](1);_iterator8.e(_context2.t0);case 15:_context2.prev=15;_iterator8.f();return _context2.finish(15);case 18:case"end":return _context2.stop()}}}),numericMatricesInRows,this,[[1,12,15,18]])}))},{key:"numericMatricesInColumns",value:regeneratorRuntime.mark((function numericMatricesInColumns(columnsSpan){var _iterator9,_step9,_step9$value,mtxKey,mtx;return regeneratorRuntime.wrap((function numericMatricesInColumns$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_iterator9=_createForOfIteratorHelper(this.matrixMapping.entries());_context3.prev=1;_iterator9.s();case 3:if((_step9=_iterator9.n()).done){_context3.next=10;break}_step9$value=_slicedToArray(_step9.value,2),mtxKey=_step9$value[0],mtx=_step9$value[1];if(!(mtx.spansThroughSheetColumn(columnsSpan.sheet,columnsSpan.columnStart,columnsSpan.columnEnd)&&!mtx.isFormula())){_context3.next=8;break}_context3.next=8;return[mtxKey,mtx];case 8:_context3.next=3;break;case 10:_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3["catch"](1);_iterator9.e(_context3.t0);case 15:_context3.prev=15;_iterator9.f();return _context3.finish(15);case 18:case"end":return _context3.stop()}}}),numericMatricesInColumns,this,[[1,12,15,18]])}))},{key:"numericMatricesInRange",value:regeneratorRuntime.mark((function numericMatricesInRange(range){var _iterator10,_step10,_step10$value,mtxKey,mtx;return regeneratorRuntime.wrap((function numericMatricesInRange$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_iterator10=_createForOfIteratorHelper(this.matrixMapping.entries());_context4.prev=1;_iterator10.s();case 3:if((_step10=_iterator10.n()).done){_context4.next=10;break}_step10$value=_slicedToArray(_step10.value,2),mtxKey=_step10$value[0],mtx=_step10$value[1];if(!mtx.getRange().doesOverlap(range)){_context4.next=8;break}_context4.next=8;return[mtxKey,mtx];case 8:_context4.next=3;break;case 10:_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4["catch"](1);_iterator10.e(_context4.t0);case 15:_context4.prev=15;_iterator10.f();return _context4.finish(15);case 18:case"end":return _context4.stop()}}}),numericMatricesInRange,this,[[1,12,15,18]])}))},{key:"truncateMatricesByRows",value:function truncateMatricesByRows(rowsSpan){var verticesToRemove=Array();var _iterator11=_createForOfIteratorHelper(this.numericMatricesInRows(rowsSpan)),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _step11$value=_slicedToArray(_step11.value,2),key=_step11$value[0],matrix=_step11$value[1];matrix.removeRows(rowsSpan);if(matrix.height===0){this.removeMatrix(key);verticesToRemove.push(matrix)}}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}return verticesToRemove}},{key:"truncateMatricesByColumns",value:function truncateMatricesByColumns(columnsSpan){var verticesToRemove=Array();var _iterator12=_createForOfIteratorHelper(this.numericMatricesInColumns(columnsSpan)),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var _step12$value=_slicedToArray(_step12.value,2),key=_step12$value[0],matrix=_step12$value[1];matrix.removeColumns(columnsSpan);if(matrix.width===0){this.removeMatrix(key);verticesToRemove.push(matrix)}}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}return verticesToRemove}},{key:"destroy",value:function destroy(){this.matrixMapping.clear()}}]);return MatrixMapping}();exports.MatrixMapping=MatrixMapping},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(196);__webpack_require__(89);__webpack_require__(164);__webpack_require__(133);__webpack_require__(136);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.RangeMapping=void 0;__webpack_require__(125);var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var RangeMapping=function(){function RangeMapping(){_classCallCheck(this,RangeMapping);this.rangeMapping=new Map}_createClass(RangeMapping,[{key:"getMappingSize",value:function getMappingSize(sheet){var _a,_b;return(_b=(_a=this.rangeMapping.get(sheet))===null||_a===void 0?void 0:_a.size)!==null&&_b!==void 0?_b:0}},{key:"setRange",value:function setRange(vertex){var sheetMap=this.rangeMapping.get(vertex.getStart().sheet);if(sheetMap===undefined){sheetMap=new Map;this.rangeMapping.set(vertex.getStart().sheet,sheetMap)}var key=keyFromAddresses(vertex.getStart(),vertex.getEnd());sheetMap.set(key,vertex)}},{key:"removeRange",value:function removeRange(vertex){var sheet=vertex.getStart().sheet;var sheetMap=this.rangeMapping.get(sheet);if(sheetMap===undefined){return}var key=keyFromAddresses(vertex.getStart(),vertex.getEnd());sheetMap.delete(key);if(sheetMap.size===0){this.rangeMapping.delete(sheet)}}},{key:"getRange",value:function getRange(start,end){var sheetMap=this.rangeMapping.get(start.sheet);var key=keyFromAddresses(start,end);return sheetMap===null||sheetMap===void 0?void 0:sheetMap.get(key)}},{key:"fetchRange",value:function fetchRange(start,end){var maybeRange=this.getRange(start,end);if(!maybeRange){throw Error("Range does not exist")}return maybeRange}},{key:"truncateRanges",value:function truncateRanges(span,coordinate){var verticesToRemove=Array();var updated=Array();var sheet=span.sheet;var _iterator=_createForOfIteratorHelper(this.entriesFromSheet(span.sheet)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),key=_step$value[0],vertex=_step$value[1];var range=vertex.range;if(span.start<=coordinate(vertex.range.end)){range.removeSpan(span);if(range.shouldBeRemoved()){this.removeByKey(sheet,key);verticesToRemove.push(vertex)}else{updated.push([key,vertex])}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var verticesToMerge=[];var _iterator2=_createForOfIteratorHelper(updated.sort((function(left,right){return compareBy(left[1],right[1],coordinate)}))),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),oldKey=_step2$value[0],_vertex=_step2$value[1];var newKey=keyFromRange(_vertex.range);if(newKey===oldKey){continue}var existingVertex=this.getByKey(sheet,newKey);this.removeByKey(sheet,oldKey);if(existingVertex!==undefined&&_vertex!=existingVertex){verticesToMerge.push([existingVertex,_vertex])}else{this.setRange(_vertex)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return{verticesToRemove:verticesToRemove,verticesToMerge:verticesToMerge}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function moveAllRangesInSheetAfterRowByRows(sheet,row,numberOfRows){this.updateVerticesFromSheet(sheet,(function(key,vertex){if(row<=vertex.start.row){vertex.range.shiftByRows(numberOfRows);return vertex}else if(row>vertex.start.row&&row<=vertex.end.row){vertex.range.expandByRows(numberOfRows);return vertex}else{return undefined}}))}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function moveAllRangesInSheetAfterColumnByColumns(sheet,column,numberOfColumns){this.updateVerticesFromSheet(sheet,(function(key,vertex){if(column<=vertex.start.col){vertex.range.shiftByColumns(numberOfColumns);return vertex}else if(column>vertex.start.col&&column<=vertex.end.col){vertex.range.expandByColumns(numberOfColumns);return vertex}else{return undefined}}))}},{key:"moveRangesInsideSourceRange",value:function moveRangesInsideSourceRange(sourceRange,toRight,toBottom,toSheet){this.updateVerticesFromSheet(sourceRange.sheet,(function(key,vertex){if(sourceRange.containsRange(vertex.range)){vertex.range.shiftByColumns(toRight);vertex.range.shiftByRows(toBottom);vertex.range.moveToSheet(toSheet);return vertex}else{return undefined}}))}},{key:"removeRangesInSheet",value:function removeRangesInSheet(sheet){if(this.rangeMapping.has(sheet)){var ranges=this.rangeMapping.get(sheet).values();this.rangeMapping.delete(sheet);return ranges}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark((function rangesInSheet(sheet){var sheetMap;return regeneratorRuntime.wrap((function rangesInSheet$(_context){while(1){switch(_context.prev=_context.next){case 0:sheetMap=this.rangeMapping.get(sheet);if(sheetMap){_context.next=3;break}return _context.abrupt("return");case 3:return _context.delegateYield(sheetMap.values(),"t0",4);case 4:case"end":return _context.stop()}}}),rangesInSheet,this)}))},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark((function rangeVerticesContainedInRange(sourceRange){var _iterator3,_step3,rangeVertex;return regeneratorRuntime.wrap((function rangeVerticesContainedInRange$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_iterator3=_createForOfIteratorHelper(this.rangesInSheet(sourceRange.sheet));_context2.prev=1;_iterator3.s();case 3:if((_step3=_iterator3.n()).done){_context2.next=10;break}rangeVertex=_step3.value;if(!sourceRange.containsRange(rangeVertex.range)){_context2.next=8;break}_context2.next=8;return rangeVertex;case 8:_context2.next=3;break;case 10:_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](1);_iterator3.e(_context2.t0);case 15:_context2.prev=15;_iterator3.f();return _context2.finish(15);case 18:case"end":return _context2.stop()}}}),rangeVerticesContainedInRange,this,[[1,12,15,18]])}))},{key:"findSmallerRange",value:function findSmallerRange(range){if(range.height()>1&&Number.isFinite(range.height())){var valuesRangeEndRowLess=(0,_Cell.simpleCellAddress)(range.end.sheet,range.end.col,range.end.row-1);var rowLessVertex=this.getRange(range.start,valuesRangeEndRowLess);if(rowLessVertex!==undefined){var restRange=new _AbsoluteCellRange.AbsoluteCellRange((0,_Cell.simpleCellAddress)(range.start.sheet,range.start.col,range.end.row),range.end);return{smallerRangeVertex:rowLessVertex,restRange:restRange}}}return{smallerRangeVertex:null,restRange:range}}},{key:"destroy",value:function destroy(){this.rangeMapping.clear()}},{key:"entriesFromSheet",value:regeneratorRuntime.mark((function entriesFromSheet(sheet){var sheetMap;return regeneratorRuntime.wrap((function entriesFromSheet$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:sheetMap=this.rangeMapping.get(sheet);if(sheetMap){_context3.next=3;break}return _context3.abrupt("return");case 3:return _context3.delegateYield(sheetMap.entries(),"t0",4);case 4:case"end":return _context3.stop()}}}),entriesFromSheet,this)}))},{key:"removeByKey",value:function removeByKey(sheet,key){this.rangeMapping.get(sheet).delete(key)}},{key:"getByKey",value:function getByKey(sheet,key){var _a;return(_a=this.rangeMapping.get(sheet))===null||_a===void 0?void 0:_a.get(key)}},{key:"updateVerticesFromSheet",value:function updateVerticesFromSheet(sheet,fn){var _this=this;var updated=Array();var _iterator4=_createForOfIteratorHelper(this.entriesFromSheet(sheet)),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),key=_step4$value[0],vertex=_step4$value[1];var result=fn(key,vertex);if(result!==undefined){this.removeByKey(sheet,key);updated.push(result)}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}updated.forEach((function(range){_this.setRange(range)}))}}]);return RangeMapping}();exports.RangeMapping=RangeMapping;function keyFromAddresses(start,end){return"".concat(start.col,",").concat(start.row,",").concat(end.col,",").concat(end.row)}function keyFromRange(range){return keyFromAddresses(range.start,range.end)}var compareBy=function compareBy(left,right,coordinate){var leftStart=coordinate(left.range.start);var rightStart=coordinate(left.range.start);if(leftStart===rightStart){var leftEnd=coordinate(left.range.end);var rightEnd=coordinate(right.range.end);return leftEnd-rightEnd}else{return leftStart-rightStart}}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var aFunction=__webpack_require__(61);var toObject=__webpack_require__(49);var fails=__webpack_require__(7);var arrayMethodIsStrict=__webpack_require__(112);var test=[];var nativeSort=test.sort;var FAILS_ON_UNDEFINED=fails((function(){test.sort(undefined)}));var FAILS_ON_NULL=fails((function(){test.sort(null)}));var STRICT_METHOD=arrayMethodIsStrict("sort");var FORCED=FAILS_ON_UNDEFINED||!FAILS_ON_NULL||!STRICT_METHOD;$({target:"Array",proto:true,forced:FORCED},{sort:function sort(comparefn){return comparefn===undefined?nativeSort.call(toObject(this)):nativeSort.call(toObject(this),aFunction(comparefn))}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.SheetMapping=void 0;__webpack_require__(125);var _i18n=__webpack_require__(198);var _errors=__webpack_require__(183);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function canonicalize(sheetDisplayName){return sheetDisplayName.toLowerCase()}var Sheet=function(){function Sheet(id,displayName){_classCallCheck(this,Sheet);this.id=id;this.displayName=displayName}_createClass(Sheet,[{key:"canonicalName",get:function get(){return canonicalize(this.displayName)}}]);return Sheet}();var SheetMapping=function(){function SheetMapping(languages){var _this=this;_classCallCheck(this,SheetMapping);this.languages=languages;this.mappingFromCanonicalName=new Map;this.mappingFromId=new Map;this.lastSheetId=-1;this.fetch=function(sheetName){var sheet=_this.mappingFromCanonicalName.get(canonicalize(sheetName));if(sheet===undefined){throw new _errors.NoSheetWithNameError(sheetName)}return sheet.id};this.get=function(sheetName){var sheet=_this.mappingFromCanonicalName.get(canonicalize(sheetName));if(sheet){return sheet.id}else{return undefined}};this.fetchDisplayName=function(sheetId){return _this.fetchSheetById(sheetId).displayName};this.sheetNamePrefix=languages.getUITranslation(_i18n.UIElement.NEW_SHEET_PREFIX)}_createClass(SheetMapping,[{key:"addSheet",value:function addSheet(){var newSheetDisplayName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2);var newSheetCanonicalName=canonicalize(newSheetDisplayName);if(this.mappingFromCanonicalName.has(newSheetCanonicalName)){throw new _errors.SheetNameAlreadyTakenError(newSheetDisplayName)}this.lastSheetId++;var sheet=new Sheet(this.lastSheetId,newSheetDisplayName);this.store(sheet);return sheet.id}},{key:"removeSheet",value:function removeSheet(sheetId){var sheet=this.fetchSheetById(sheetId);if(sheetId==this.lastSheetId){--this.lastSheetId}this.mappingFromCanonicalName.delete(sheet.canonicalName);this.mappingFromId.delete(sheet.id)}},{key:"getDisplayName",value:function getDisplayName(sheetId){var sheet=this.mappingFromId.get(sheetId);if(sheet){return sheet.displayName}else{return undefined}}},{key:"getDisplayNameByName",value:function getDisplayNameByName(sheetName){var sheet=this.mappingFromCanonicalName.get(canonicalize(sheetName));if(sheet){return sheet.displayName}else{return undefined}}},{key:"displayNames",value:regeneratorRuntime.mark((function displayNames(){var _iterator,_step,sheet;return regeneratorRuntime.wrap((function displayNames$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator=_createForOfIteratorHelper(this.mappingFromCanonicalName.values());_context.prev=1;_iterator.s();case 3:if((_step=_iterator.n()).done){_context.next=9;break}sheet=_step.value;_context.next=7;return sheet.displayName;case 7:_context.next=3;break;case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](1);_iterator.e(_context.t0);case 14:_context.prev=14;_iterator.f();return _context.finish(14);case 17:case"end":return _context.stop()}}}),displayNames,this,[[1,11,14,17]])}))},{key:"numberOfSheets",value:function numberOfSheets(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function hasSheetWithId(sheetId){return this.mappingFromId.has(sheetId)}},{key:"hasSheetWithName",value:function hasSheetWithName(sheetName){return this.mappingFromCanonicalName.has(canonicalize(sheetName))}},{key:"renameSheet",value:function renameSheet(sheetId,newDisplayName){var sheet=this.fetchSheetById(sheetId);var currentDisplayName=sheet.displayName;if(currentDisplayName===newDisplayName){return undefined}var sheetWithThisCanonicalName=this.mappingFromCanonicalName.get(canonicalize(newDisplayName));if(sheetWithThisCanonicalName&&sheetWithThisCanonicalName.id!==sheet.id){throw new _errors.SheetNameAlreadyTakenError(newDisplayName)}var currentCanonicalName=sheet.canonicalName;this.mappingFromCanonicalName.delete(currentCanonicalName);sheet.displayName=newDisplayName;this.store(sheet);return currentDisplayName}},{key:"destroy",value:function destroy(){this.mappingFromCanonicalName.clear();this.mappingFromId.clear()}},{key:"sheetNames",value:function sheetNames(){return Array.from(this.mappingFromId.values()).map((function(s){return s.displayName}))}},{key:"store",value:function store(sheet){this.mappingFromId.set(sheet.id,sheet);this.mappingFromCanonicalName.set(sheet.canonicalName,sheet)}},{key:"fetchSheetById",value:function fetchSheetById(sheetId){var sheet=this.mappingFromId.get(sheetId);if(sheet===undefined){throw new _errors.NoSheetWithIdError(sheetId)}return sheet}}]);return SheetMapping}();exports.SheetMapping=SheetMapping},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.UIElement=void 0;var _TranslationPackage=__webpack_require__(199);exports.buildTranslationPackage=_TranslationPackage.buildTranslationPackage;exports.TranslationPackage=_TranslationPackage.TranslationPackage;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var UIElement;exports.UIElement=UIElement;(function(UIElement){UIElement["NEW_SHEET_PREFIX"]="NEW_SHEET_PREFIX"})(UIElement||(exports.UIElement=UIElement={}))},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(140);__webpack_require__(84);__webpack_require__(89);__webpack_require__(158);__webpack_require__(90);__webpack_require__(200);__webpack_require__(92);__webpack_require__(201);__webpack_require__(96);__webpack_require__(114);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.buildTranslationPackage=buildTranslationPackage;exports.TranslationPackage=void 0;var _Cell=__webpack_require__(106);var _errors=__webpack_require__(183);var _index=__webpack_require__(198);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var TranslationPackage=function(){function TranslationPackage(functions,errors,ui){_classCallCheck(this,TranslationPackage);this.functions=functions;this.errors=errors;this.ui=ui;this._protectedTranslations={VERSION:"VERSION"};this.checkUI();this.checkErrors();this.checkFunctionTranslations(this.functions);Object.assign(this.functions,this._protectedTranslations)}_createClass(TranslationPackage,[{key:"extendFunctions",value:function extendFunctions(additionalFunctionTranslations){this.checkFunctionTranslations(additionalFunctionTranslations);Object.assign(this.functions,additionalFunctionTranslations)}},{key:"buildFunctionMapping",value:function buildFunctionMapping(){var _this=this;return Object.keys(this.functions).reduce((function(ret,key){ret[_this.functions[key]]=key;return ret}),{})}},{key:"buildErrorMapping",value:function buildErrorMapping(){var _this2=this;return Object.keys(this.errors).reduce((function(ret,key){ret[_this2.errors[key]]=key;return ret}),{})}},{key:"isFunctionTranslated",value:function isFunctionTranslated(key){return this.functions[key]!==undefined}},{key:"getFunctionTranslations",value:function getFunctionTranslations(functionIds){var translations=[];var _iterator=_createForOfIteratorHelper(functionIds),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var functionId=_step.value;if(this.isFunctionTranslated(functionId)){translations.push(this.functions[functionId])}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return translations}},{key:"getFunctionTranslation",value:function getFunctionTranslation(key){var val=this.functions[key];if(val===undefined){throw new _errors.MissingTranslationError("functions.".concat(key))}else{return val}}},{key:"getMaybeFunctionTranslation",value:function getMaybeFunctionTranslation(key){return this.functions[key]}},{key:"getErrorTranslation",value:function getErrorTranslation(key){var val=this.errors[key];if(val===undefined){throw new _errors.MissingTranslationError("errors.".concat(key))}else{return val}}},{key:"getUITranslation",value:function getUITranslation(key){var val=this.ui[key];if(val===undefined){throw new _errors.MissingTranslationError("ui.".concat(key))}else{return val}}},{key:"checkUI",value:function checkUI(){for(var _i=0,_Object$values=Object.values(_index.UIElement);_i<_Object$values.length;_i++){var key=_Object$values[_i];if(!(key in this.ui)){throw new _errors.MissingTranslationError("ui.".concat(key))}}}},{key:"checkErrors",value:function checkErrors(){for(var _i2=0,_Object$values2=Object.values(_Cell.ErrorType);_i2<_Object$values2.length;_i2++){var key=_Object$values2[_i2];if(!(key in this.errors)){throw new _errors.MissingTranslationError("errors.".concat(key))}}}},{key:"checkFunctionTranslations",value:function checkFunctionTranslations(functions){var functionNames=new Set(Object.getOwnPropertyNames(functions));var _iterator2=_createForOfIteratorHelper(Object.getOwnPropertyNames(this._protectedTranslations)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var protectedTranslation=_step2.value;if(functionNames.has(protectedTranslation)){throw new _errors.ProtectedFunctionTranslationError(protectedTranslation)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}]);return TranslationPackage}();exports.TranslationPackage=TranslationPackage;function buildTranslationPackage(rawTranslationPackage){return new TranslationPackage(Object.assign({},rawTranslationPackage.functions),Object.assign({},rawTranslationPackage.errors),Object.assign({},rawTranslationPackage.ui))}},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var toObject=__webpack_require__(49);var nativeKeys=__webpack_require__(52);var fails=__webpack_require__(7);var FAILS_ON_PRIMITIVES=fails((function(){nativeKeys(1)}));$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES},{keys:function keys(it){return nativeKeys(toObject(it))}})},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var $values=__webpack_require__(202).values;$({target:"Object",stat:true},{values:function values(O){return $values(O)}})},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(6);var objectKeys=__webpack_require__(52);var toIndexedObject=__webpack_require__(10);var propertyIsEnumerable=__webpack_require__(8).f;var createMethod=function(TO_ENTRIES){return function(it){var O=toIndexedObject(it);var keys=objectKeys(O);var length=keys.length;var i=0;var result=[];var key;while(length>i){key=keys[i++];if(!DESCRIPTORS||propertyIsEnumerable.call(O,key)){result.push(TO_ENTRIES?[key,O[key]]:O[key])}}return result}};module.exports={entries:createMethod(true),values:createMethod(false)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.SimpleRangeValue=exports.OnlyRangeData=exports.ArrayData=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ArrayData=function(){function ArrayData(size,data,_hasOnlyNumbers){_classCallCheck(this,ArrayData);this.size=size;this.data=data;this._hasOnlyNumbers=_hasOnlyNumbers}_createClass(ArrayData,[{key:"range",value:function range(){return undefined}},{key:"hasOnlyNumbers",value:function hasOnlyNumbers(){return this._hasOnlyNumbers}},{key:"valuesFromTopLeftCorner",value:regeneratorRuntime.mark((function valuesFromTopLeftCorner(){var i,j;return regeneratorRuntime.wrap((function valuesFromTopLeftCorner$(_context){while(1){switch(_context.prev=_context.next){case 0:i=0;case 1:if(!(i<this.size.height)){_context.next=12;break}j=0;case 3:if(!(j<this.size.width)){_context.next=9;break}_context.next=6;return this.data[i][j];case 6:j++;_context.next=3;break;case 9:i++;_context.next=1;break;case 12:case"end":return _context.stop()}}}),valuesFromTopLeftCorner,this)}))},{key:"raw",value:function raw(){return this.data}},{key:"rawNumbers",value:function rawNumbers(){if(this.hasOnlyNumbers()){return this.data}else{throw new Error("Data is not only numbers")}}}]);return ArrayData}();exports.ArrayData=ArrayData;var OnlyRangeData=function(){function OnlyRangeData(size,_range,dependencyGraph){_classCallCheck(this,OnlyRangeData);this.size=size;this._range=_range;this.dependencyGraph=dependencyGraph}_createClass(OnlyRangeData,[{key:"raw",value:function raw(){this.ensureThatComputed();return this.data}},{key:"rawNumbers",value:function rawNumbers(){if(this.hasOnlyNumbers()){return this.data}else{throw new Error("Data is not only numbers")}}},{key:"hasOnlyNumbers",value:function hasOnlyNumbers(){this.ensureThatComputed();if(this._hasOnlyNumbers===undefined){var _iterator=_createForOfIteratorHelper(this.valuesFromTopLeftCorner()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var v=_step.value;if(typeof v!=="number"){this._hasOnlyNumbers=false;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}this._hasOnlyNumbers=true}return this._hasOnlyNumbers}},{key:"range",value:function range(){return this._range}},{key:"valuesFromTopLeftCorner",value:regeneratorRuntime.mark((function valuesFromTopLeftCorner(){var i,j;return regeneratorRuntime.wrap((function valuesFromTopLeftCorner$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.ensureThatComputed();i=0;case 2:if(!(i<this.data.length)){_context2.next=13;break}j=0;case 4:if(!(j<this.data[0].length)){_context2.next=10;break}_context2.next=7;return this.data[i][j];case 7:j++;_context2.next=4;break;case 10:i++;_context2.next=2;break;case 13:case"end":return _context2.stop()}}}),valuesFromTopLeftCorner,this)}))},{key:"ensureThatComputed",value:function ensureThatComputed(){if(this.data===undefined){this.data=this.computeDataFromDependencyGraph()}}},{key:"computeDataFromDependencyGraph",value:function computeDataFromDependencyGraph(){var result=[];var i=0;var row=[];var _iterator2=_createForOfIteratorHelper(this._range.addresses(this.dependencyGraph)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var cellFromRange=_step2.value;var value=this.dependencyGraph.getCellValue(cellFromRange);if(value instanceof SimpleRangeValue){row.push(new _Cell.CellError(_Cell.ErrorType.VALUE))}else if(typeof value==="number"){row.push(value)}else{row.push(value);this._hasOnlyNumbers=false}++i;if(i%this.size.width===0){i=0;result.push(_toConsumableArray(row));row=[]}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return result}}]);return OnlyRangeData}();exports.OnlyRangeData=OnlyRangeData;var SimpleRangeValue=function(){function SimpleRangeValue(data){_classCallCheck(this,SimpleRangeValue);this.data=data}_createClass(SimpleRangeValue,[{key:"width",value:function width(){return this.data.size.width}},{key:"height",value:function height(){return this.data.size.height}},{key:"raw",value:function raw(){return this.data.raw()}},{key:"valuesFromTopLeftCorner",value:regeneratorRuntime.mark((function valuesFromTopLeftCorner(){return regeneratorRuntime.wrap((function valuesFromTopLeftCorner$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.delegateYield(this.data.valuesFromTopLeftCorner(),"t0",1);case 1:case"end":return _context3.stop()}}}),valuesFromTopLeftCorner,this)}))},{key:"numberOfElements",value:function numberOfElements(){return this.data.size.width*this.data.size.height}},{key:"hasOnlyNumbers",value:function hasOnlyNumbers(){return this.data.hasOnlyNumbers()}},{key:"rawNumbers",value:function rawNumbers(){return this.data.rawNumbers()}},{key:"range",value:function range(){return this.data.range()}},{key:"sameDimensionsAs",value:function sameDimensionsAs(other){return this.width()===other.width()&&this.height()===other.height()}},{key:"size",get:function get(){return this.data.size}}],[{key:"onlyNumbersDataWithRange",value:function onlyNumbersDataWithRange(data,size,_range){return new SimpleRangeValue(new ArrayData(size,data,true))}},{key:"onlyNumbersDataWithoutRange",value:function onlyNumbersDataWithoutRange(data,size){return new SimpleRangeValue(new ArrayData(size,data,true))}},{key:"onlyRange",value:function onlyRange(range,dependencyGraph){return new SimpleRangeValue(new OnlyRangeData({width:range.width(),height:range.height()},range,dependencyGraph))}},{key:"fromScalar",value:function fromScalar(scalar){var hasOnlyNumbers=typeof scalar==="number";return new SimpleRangeValue(new ArrayData({width:1,height:1},[[scalar]],hasOnlyNumbers))}}]);return SimpleRangeValue}();exports.SimpleRangeValue=SimpleRangeValue},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.EmptyCellVertex=void 0;var _Cell=__webpack_require__(106);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var EmptyCellVertex=function(){function EmptyCellVertex(address){_classCallCheck(this,EmptyCellVertex);this.address=address}_createClass(EmptyCellVertex,[{key:"getCellValue",value:function getCellValue(){return _Cell.EmptyValue}}]);return EmptyCellVertex}();exports.EmptyCellVertex=EmptyCellVertex},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.ValueCellVertex=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var ValueCellVertex=function(){function ValueCellVertex(cellValue){_classCallCheck(this,ValueCellVertex);this.cellValue=cellValue}_createClass(ValueCellVertex,[{key:"getCellValue",value:function getCellValue(){return this.cellValue}},{key:"setCellValue",value:function setCellValue(cellValue){this.cellValue=cellValue}}]);return ValueCellVertex}();exports.ValueCellVertex=ValueCellVertex},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.ParsingErrorVertex=void 0;var _Cell=__webpack_require__(106);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ParsingErrorVertex=function(){function ParsingErrorVertex(errors,rawInput){_classCallCheck(this,ParsingErrorVertex);this.errors=errors;this.rawInput=rawInput}_createClass(ParsingErrorVertex,[{key:"getCellValue",value:function getCellValue(){return _Cell.CellError.parsingError()}},{key:"getFormula",value:function getFormula(){return this.rawInput}}]);return ParsingErrorVertex}();exports.ParsingErrorVertex=ParsingErrorVertex},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.SparseStrategy=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var SparseStrategy=function(){function SparseStrategy(width,height){_classCallCheck(this,SparseStrategy);this.width=width;this.height=height;this.mapping=new Map}_createClass(SparseStrategy,[{key:"getCell",value:function getCell(address){var colMapping=this.mapping.get(address.col);if(!colMapping){return null}return colMapping.get(address.row)||null}},{key:"setCell",value:function setCell(address,newVertex){this.width=Math.max(this.width,address.col+1);this.height=Math.max(this.height,address.row+1);var colMapping=this.mapping.get(address.col);if(!colMapping){colMapping=new Map;this.mapping.set(address.col,colMapping)}colMapping.set(address.row,newVertex)}},{key:"has",value:function has(address){var colMapping=this.mapping.get(address.col);if(!colMapping){return false}return!!colMapping.get(address.row)}},{key:"getHeight",value:function getHeight(){return this.height}},{key:"getWidth",value:function getWidth(){return this.width}},{key:"removeCell",value:function removeCell(address){var colMapping=this.mapping.get(address.col);if(colMapping){colMapping.delete(address.row)}}},{key:"addRows",value:function addRows(row,numberOfRows){this.mapping.forEach((function(rowMapping){var tmpMapping=new Map;rowMapping.forEach((function(vertex,rowNumber){if(rowNumber>=row){tmpMapping.set(rowNumber+numberOfRows,vertex);rowMapping.delete(rowNumber)}}));tmpMapping.forEach((function(vertex,rowNumber){rowMapping.set(rowNumber,vertex)}))}));this.height+=numberOfRows}},{key:"addColumns",value:function addColumns(column,numberOfColumns){var _this=this;var tmpMapping=new Map;this.mapping.forEach((function(rowMapping,colNumber){if(colNumber>=column){tmpMapping.set(colNumber+numberOfColumns,rowMapping);_this.mapping.delete(colNumber)}}));tmpMapping.forEach((function(rowMapping,colNumber){_this.mapping.set(colNumber,rowMapping)}));this.width+=numberOfColumns}},{key:"removeRows",value:function removeRows(removedRows){this.mapping.forEach((function(rowMapping){var tmpMapping=new Map;rowMapping.forEach((function(vertex,rowNumber){if(rowNumber>=removedRows.rowStart){rowMapping.delete(rowNumber);if(rowNumber>removedRows.rowEnd){tmpMapping.set(rowNumber-removedRows.numberOfRows,vertex)}}}));tmpMapping.forEach((function(vertex,rowNumber){rowMapping.set(rowNumber,vertex)}))}));var rightmostRowRemoved=Math.min(this.height-1,removedRows.rowEnd);var numberOfRowsRemoved=Math.max(0,rightmostRowRemoved-removedRows.rowStart+1);this.height=Math.max(0,this.height-numberOfRowsRemoved)}},{key:"removeColumns",value:function removeColumns(removedColumns){var _this2=this;var tmpMapping=new Map;this.mapping.forEach((function(rowMapping,colNumber){if(colNumber>=removedColumns.columnStart){_this2.mapping.delete(colNumber);if(colNumber>removedColumns.columnEnd){tmpMapping.set(colNumber-removedColumns.numberOfColumns,rowMapping)}}}));tmpMapping.forEach((function(rowMapping,colNumber){_this2.mapping.set(colNumber,rowMapping)}));var rightmostColumnRemoved=Math.min(this.width-1,removedColumns.columnEnd);var numberOfColumnsRemoved=Math.max(0,rightmostColumnRemoved-removedColumns.columnStart+1);this.width=Math.max(0,this.width-numberOfColumnsRemoved)}},{key:"getEntries",value:regeneratorRuntime.mark((function getEntries(sheet){var _iterator,_step,_step$value,colNumber,col,_iterator2,_step2,_step2$value,rowNumber,value;return regeneratorRuntime.wrap((function getEntries$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator=_createForOfIteratorHelper(this.mapping);_context.prev=1;_iterator.s();case 3:if((_step=_iterator.n()).done){_context.next=24;break}_step$value=_slicedToArray(_step.value,2),colNumber=_step$value[0],col=_step$value[1];_iterator2=_createForOfIteratorHelper(col);_context.prev=6;_iterator2.s();case 8:if((_step2=_iterator2.n()).done){_context.next=14;break}_step2$value=_slicedToArray(_step2.value,2),rowNumber=_step2$value[0],value=_step2$value[1];_context.next=12;return[(0,_Cell.simpleCellAddress)(sheet,colNumber,rowNumber),value];case 12:_context.next=8;break;case 14:_context.next=19;break;case 16:_context.prev=16;_context.t0=_context["catch"](6);_iterator2.e(_context.t0);case 19:_context.prev=19;_iterator2.f();return _context.finish(19);case 22:_context.next=3;break;case 24:_context.next=29;break;case 26:_context.prev=26;_context.t1=_context["catch"](1);_iterator.e(_context.t1);case 29:_context.prev=29;_iterator.f();return _context.finish(29);case 32:case"end":return _context.stop()}}}),getEntries,this,[[1,26,29,32],[6,16,19,22]])}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function verticesFromColumn(column){var colMapping,_iterator3,_step3,_step3$value,_,vertex;return regeneratorRuntime.wrap((function verticesFromColumn$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:colMapping=this.mapping.get(column);if(colMapping){_context2.next=3;break}return _context2.abrupt("return");case 3:_iterator3=_createForOfIteratorHelper(colMapping);_context2.prev=4;_iterator3.s();case 6:if((_step3=_iterator3.n()).done){_context2.next=12;break}_step3$value=_slicedToArray(_step3.value,2),_=_step3$value[0],vertex=_step3$value[1];_context2.next=10;return vertex;case 10:_context2.next=6;break;case 12:_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2["catch"](4);_iterator3.e(_context2.t0);case 17:_context2.prev=17;_iterator3.f();return _context2.finish(17);case 20:case"end":return _context2.stop()}}}),verticesFromColumn,this,[[4,14,17,20]])}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function verticesFromRow(row){var _iterator4,_step4,colMapping,rowVertex;return regeneratorRuntime.wrap((function verticesFromRow$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_iterator4=_createForOfIteratorHelper(this.mapping.values());_context3.prev=1;_iterator4.s();case 3:if((_step4=_iterator4.n()).done){_context3.next=11;break}colMapping=_step4.value;rowVertex=colMapping.get(row);if(!rowVertex){_context3.next=9;break}_context3.next=9;return rowVertex;case 9:_context3.next=3;break;case 11:_context3.next=16;break;case 13:_context3.prev=13;_context3.t0=_context3["catch"](1);_iterator4.e(_context3.t0);case 16:_context3.prev=16;_iterator4.f();return _context3.finish(16);case 19:case"end":return _context3.stop()}}}),verticesFromRow,this,[[1,13,16,19]])}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function verticesFromColumnsSpan(columnsSpan){var _iterator5,_step5,column,colMapping,_iterator6,_step6,_step6$value,_,vertex;return regeneratorRuntime.wrap((function verticesFromColumnsSpan$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_iterator5=_createForOfIteratorHelper(columnsSpan.columns());_context4.prev=1;_iterator5.s();case 3:if((_step5=_iterator5.n()).done){_context4.next=27;break}column=_step5.value;colMapping=this.mapping.get(column);if(colMapping){_context4.next=8;break}return _context4.abrupt("continue",25);case 8:_iterator6=_createForOfIteratorHelper(colMapping);_context4.prev=9;_iterator6.s();case 11:if((_step6=_iterator6.n()).done){_context4.next=17;break}_step6$value=_slicedToArray(_step6.value,2),_=_step6$value[0],vertex=_step6$value[1];_context4.next=15;return vertex;case 15:_context4.next=11;break;case 17:_context4.next=22;break;case 19:_context4.prev=19;_context4.t0=_context4["catch"](9);_iterator6.e(_context4.t0);case 22:_context4.prev=22;_iterator6.f();return _context4.finish(22);case 25:_context4.next=3;break;case 27:_context4.next=32;break;case 29:_context4.prev=29;_context4.t1=_context4["catch"](1);_iterator5.e(_context4.t1);case 32:_context4.prev=32;_iterator5.f();return _context4.finish(32);case 35:case"end":return _context4.stop()}}}),verticesFromColumnsSpan,this,[[1,29,32,35],[9,19,22,25]])}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function verticesFromRowsSpan(rowsSpan){var _iterator7,_step7,colMapping,_iterator8,_step8,row,rowVertex;return regeneratorRuntime.wrap((function verticesFromRowsSpan$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_iterator7=_createForOfIteratorHelper(this.mapping.values());_context5.prev=1;_iterator7.s();case 3:if((_step7=_iterator7.n()).done){_context5.next=26;break}colMapping=_step7.value;_iterator8=_createForOfIteratorHelper(rowsSpan.rows());_context5.prev=6;_iterator8.s();case 8:if((_step8=_iterator8.n()).done){_context5.next=16;break}row=_step8.value;rowVertex=colMapping.get(row);if(!rowVertex){_context5.next=14;break}_context5.next=14;return rowVertex;case 14:_context5.next=8;break;case 16:_context5.next=21;break;case 18:_context5.prev=18;_context5.t0=_context5["catch"](6);_iterator8.e(_context5.t0);case 21:_context5.prev=21;_iterator8.f();return _context5.finish(21);case 24:_context5.next=3;break;case 26:_context5.next=31;break;case 28:_context5.prev=28;_context5.t1=_context5["catch"](1);_iterator7.e(_context5.t1);case 31:_context5.prev=31;_iterator7.f();return _context5.finish(31);case 34:case"end":return _context5.stop()}}}),verticesFromRowsSpan,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function entriesFromRowsSpan(rowsSpan){var _iterator9,_step9,_step9$value,col,colMapping,_iterator10,_step10,row,rowVertex;return regeneratorRuntime.wrap((function entriesFromRowsSpan$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_iterator9=_createForOfIteratorHelper(this.mapping.entries());_context6.prev=1;_iterator9.s();case 3:if((_step9=_iterator9.n()).done){_context6.next=26;break}_step9$value=_slicedToArray(_step9.value,2),col=_step9$value[0],colMapping=_step9$value[1];_iterator10=_createForOfIteratorHelper(rowsSpan.rows());_context6.prev=6;_iterator10.s();case 8:if((_step10=_iterator10.n()).done){_context6.next=16;break}row=_step10.value;rowVertex=colMapping.get(row);if(!rowVertex){_context6.next=14;break}_context6.next=14;return[(0,_Cell.simpleCellAddress)(rowsSpan.sheet,col,row),rowVertex];case 14:_context6.next=8;break;case 16:_context6.next=21;break;case 18:_context6.prev=18;_context6.t0=_context6["catch"](6);_iterator10.e(_context6.t0);case 21:_context6.prev=21;_iterator10.f();return _context6.finish(21);case 24:_context6.next=3;break;case 26:_context6.next=31;break;case 28:_context6.prev=28;_context6.t1=_context6["catch"](1);_iterator9.e(_context6.t1);case 31:_context6.prev=31;_iterator9.f();return _context6.finish(31);case 34:case"end":return _context6.stop()}}}),entriesFromRowsSpan,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function entriesFromColumnsSpan(columnsSpan){var _iterator11,_step11,col,colMapping,_iterator12,_step12,_step12$value,row,vertex;return regeneratorRuntime.wrap((function entriesFromColumnsSpan$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_iterator11=_createForOfIteratorHelper(columnsSpan.columns());_context7.prev=1;_iterator11.s();case 3:if((_step11=_iterator11.n()).done){_context7.next=26;break}col=_step11.value;colMapping=this.mapping.get(col);if(!colMapping){_context7.next=24;break}_iterator12=_createForOfIteratorHelper(colMapping.entries());_context7.prev=8;_iterator12.s();case 10:if((_step12=_iterator12.n()).done){_context7.next=16;break}_step12$value=_slicedToArray(_step12.value,2),row=_step12$value[0],vertex=_step12$value[1];_context7.next=14;return[(0,_Cell.simpleCellAddress)(columnsSpan.sheet,col,row),vertex];case 14:_context7.next=10;break;case 16:_context7.next=21;break;case 18:_context7.prev=18;_context7.t0=_context7["catch"](8);_iterator12.e(_context7.t0);case 21:_context7.prev=21;_iterator12.f();return _context7.finish(21);case 24:_context7.next=3;break;case 26:_context7.next=31;break;case 28:_context7.prev=28;_context7.t1=_context7["catch"](1);_iterator11.e(_context7.t1);case 31:_context7.prev=31;_iterator11.f();return _context7.finish(31);case 34:case"end":return _context7.stop()}}}),entriesFromColumnsSpan,this,[[1,28,31,34],[8,18,21,24]])}))},{key:"vertices",value:regeneratorRuntime.mark((function vertices(){var _iterator13,_step13,_step13$value,_,col,_iterator14,_step14,_step14$value,_2,value;return regeneratorRuntime.wrap((function vertices$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_iterator13=_createForOfIteratorHelper(this.mapping);_context8.prev=1;_iterator13.s();case 3:if((_step13=_iterator13.n()).done){_context8.next=25;break}_step13$value=_slicedToArray(_step13.value,2),_=_step13$value[0],col=_step13$value[1];_iterator14=_createForOfIteratorHelper(col);_context8.prev=6;_iterator14.s();case 8:if((_step14=_iterator14.n()).done){_context8.next=15;break}_step14$value=_slicedToArray(_step14.value,2),_2=_step14$value[0],value=_step14$value[1];if(!value){_context8.next=13;break}_context8.next=13;return value;case 13:_context8.next=8;break;case 15:_context8.next=20;break;case 17:_context8.prev=17;_context8.t0=_context8["catch"](6);_iterator14.e(_context8.t0);case 20:_context8.prev=20;_iterator14.f();return _context8.finish(20);case 23:_context8.next=3;break;case 25:_context8.next=30;break;case 27:_context8.prev=27;_context8.t1=_context8["catch"](1);_iterator13.e(_context8.t1);case 30:_context8.prev=30;_iterator13.f();return _context8.finish(30);case 33:case"end":return _context8.stop()}}}),vertices,this,[[1,27,30,33],[6,17,20,23]])}))}]);return SparseStrategy}();exports.SparseStrategy=SparseStrategy},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(190);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.DenseStrategy=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var DenseStrategy=function(){function DenseStrategy(width,height){_classCallCheck(this,DenseStrategy);this.width=width;this.height=height;this.mapping=new Array(height);for(var i=0;i<height;i++){this.mapping[i]=new Array(width)}}_createClass(DenseStrategy,[{key:"getCell",value:function getCell(address){return this.getCellVertex(address.col,address.row)}},{key:"setCell",value:function setCell(address,newVertex){this.width=Math.max(this.width,address.col+1);this.height=Math.max(this.height,address.row+1);var rowMapping=this.mapping[address.row];if(!rowMapping){this.mapping[address.row]=new Array(this.width)}this.mapping[address.row][address.col]=newVertex}},{key:"has",value:function has(address){var row=this.mapping[address.row];if(!row){return false}return!!row[address.col]}},{key:"getHeight",value:function getHeight(){return this.height}},{key:"getWidth",value:function getWidth(){return this.width}},{key:"removeCell",value:function removeCell(address){if(this.mapping[address.row]!==undefined){delete this.mapping[address.row][address.col]}}},{key:"addRows",value:function addRows(row,numberOfRows){var _this$mapping;var newRows=[];for(var i=0;i<numberOfRows;i++){newRows.push(new Array(this.width))}(_this$mapping=this.mapping).splice.apply(_this$mapping,[row,0].concat(newRows));this.height+=numberOfRows}},{key:"addColumns",value:function addColumns(column,numberOfColumns){for(var i=0;i<this.height;i++){var _this$mapping$i;(_this$mapping$i=this.mapping[i]).splice.apply(_this$mapping$i,[column,0].concat(_toConsumableArray(new Array(numberOfColumns))))}this.width+=numberOfColumns}},{key:"removeRows",value:function removeRows(removedRows){this.mapping.splice(removedRows.rowStart,removedRows.numberOfRows);var rightmostRowRemoved=Math.min(this.height-1,removedRows.rowEnd);var numberOfRowsRemoved=Math.max(0,rightmostRowRemoved-removedRows.rowStart+1);this.height=Math.max(0,this.height-numberOfRowsRemoved)}},{key:"removeColumns",value:function removeColumns(removedColumns){for(var i=0;i<this.height;i++){this.mapping[i].splice(removedColumns.columnStart,removedColumns.numberOfColumns)}var rightmostColumnRemoved=Math.min(this.width-1,removedColumns.columnEnd);var numberOfColumnsRemoved=Math.max(0,rightmostColumnRemoved-removedColumns.columnStart+1);this.width=Math.max(0,this.width-numberOfColumnsRemoved)}},{key:"getEntries",value:regeneratorRuntime.mark((function getEntries(sheet){var y,x,vertex;return regeneratorRuntime.wrap((function getEntries$(_context){while(1){switch(_context.prev=_context.next){case 0:y=0;case 1:if(!(y<this.height)){_context.next=14;break}x=0;case 3:if(!(x<this.width)){_context.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context.next=8;break}_context.next=8;return[(0,_Cell.simpleCellAddress)(sheet,x,y),vertex];case 8:++x;_context.next=3;break;case 11:++y;_context.next=1;break;case 14:case"end":return _context.stop()}}}),getEntries,this)}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function verticesFromColumn(column){var y,vertex;return regeneratorRuntime.wrap((function verticesFromColumn$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:y=0;case 1:if(!(y<this.height)){_context2.next=9;break}vertex=this.getCellVertex(column,y);if(!vertex){_context2.next=6;break}_context2.next=6;return vertex;case 6:++y;_context2.next=1;break;case 9:case"end":return _context2.stop()}}}),verticesFromColumn,this)}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function verticesFromRow(row){var x,vertex;return regeneratorRuntime.wrap((function verticesFromRow$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:x=0;case 1:if(!(x<this.width)){_context3.next=9;break}vertex=this.getCellVertex(x,row);if(!vertex){_context3.next=6;break}_context3.next=6;return vertex;case 6:++x;_context3.next=1;break;case 9:case"end":return _context3.stop()}}}),verticesFromRow,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function verticesFromColumnsSpan(columnsSpan){var x,y,vertex;return regeneratorRuntime.wrap((function verticesFromColumnsSpan$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:x=columnsSpan.columnStart;case 1:if(!(x<=columnsSpan.columnEnd)){_context4.next=14;break}y=0;case 3:if(!(y<this.height)){_context4.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context4.next=8;break}_context4.next=8;return vertex;case 8:++y;_context4.next=3;break;case 11:++x;_context4.next=1;break;case 14:case"end":return _context4.stop()}}}),verticesFromColumnsSpan,this)}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function verticesFromRowsSpan(rowsSpan){var x,y,vertex;return regeneratorRuntime.wrap((function verticesFromRowsSpan$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:x=0;case 1:if(!(x<this.width)){_context5.next=14;break}y=rowsSpan.rowStart;case 3:if(!(y<=rowsSpan.rowEnd)){_context5.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context5.next=8;break}_context5.next=8;return vertex;case 8:++y;_context5.next=3;break;case 11:++x;_context5.next=1;break;case 14:case"end":return _context5.stop()}}}),verticesFromRowsSpan,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function entriesFromRowsSpan(rowsSpan){var x,y,vertex;return regeneratorRuntime.wrap((function entriesFromRowsSpan$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:x=0;case 1:if(!(x<this.width)){_context6.next=14;break}y=rowsSpan.rowStart;case 3:if(!(y<=rowsSpan.rowEnd)){_context6.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context6.next=8;break}_context6.next=8;return[(0,_Cell.simpleCellAddress)(rowsSpan.sheet,x,y),vertex];case 8:++y;_context6.next=3;break;case 11:++x;_context6.next=1;break;case 14:case"end":return _context6.stop()}}}),entriesFromRowsSpan,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function entriesFromColumnsSpan(columnsSpan){var y,x,vertex;return regeneratorRuntime.wrap((function entriesFromColumnsSpan$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:y=0;case 1:if(!(y<this.height)){_context7.next=14;break}x=columnsSpan.columnStart;case 3:if(!(x<=columnsSpan.columnEnd)){_context7.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context7.next=8;break}_context7.next=8;return[(0,_Cell.simpleCellAddress)(columnsSpan.sheet,x,y),vertex];case 8:++x;_context7.next=3;break;case 11:++y;_context7.next=1;break;case 14:case"end":return _context7.stop()}}}),entriesFromColumnsSpan,this)}))},{key:"vertices",value:regeneratorRuntime.mark((function vertices(){var y,x,vertex;return regeneratorRuntime.wrap((function vertices$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:y=0;case 1:if(!(y<this.height)){_context8.next=14;break}x=0;case 3:if(!(x<this.width)){_context8.next=11;break}vertex=this.getCellVertex(x,y);if(!vertex){_context8.next=8;break}_context8.next=8;return vertex;case 8:++x;_context8.next=3;break;case 11:++y;_context8.next=1;break;case 14:case"end":return _context8.stop()}}}),vertices,this)}))},{key:"getCellVertex",value:function getCellVertex(x,y){var row=this.mapping[y];if(row){return this.mapping[y][x]||null}return null}}]);return DenseStrategy}();exports.DenseStrategy=DenseStrategy},function(module,exports,__webpack_require__){"use strict";__webpack_require__(89);__webpack_require__(210);exports.__esModule=true;exports.Exporter=exports.DetailedCellError=exports.ExportedNamedExpressionChange=exports.ExportedCellChange=void 0;var _Cell=__webpack_require__(106);var _NamedExpressions=__webpack_require__(211);var _InterpreterValue=__webpack_require__(203);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ExportedCellChange=function(){function ExportedCellChange(address,newValue){_classCallCheck(this,ExportedCellChange);this.address=address;this.newValue=newValue}_createClass(ExportedCellChange,[{key:"col",get:function get(){return this.address.col}},{key:"row",get:function get(){return this.address.row}},{key:"sheet",get:function get(){return this.address.sheet}},{key:"value",get:function get(){return this.newValue}}]);return ExportedCellChange}();exports.ExportedCellChange=ExportedCellChange;var ExportedNamedExpressionChange=function ExportedNamedExpressionChange(name,newValue){_classCallCheck(this,ExportedNamedExpressionChange);this.name=name;this.newValue=newValue};exports.ExportedNamedExpressionChange=ExportedNamedExpressionChange;var DetailedCellError=function DetailedCellError(error,value){_classCallCheck(this,DetailedCellError);this.value=value;this.type=error.type;this.message=error.message||""};exports.DetailedCellError=DetailedCellError;var Exporter=function(){function Exporter(config,namedExpressions){_classCallCheck(this,Exporter);this.config=config;this.namedExpressions=namedExpressions}_createClass(Exporter,[{key:"exportChange",value:function exportChange(change){if(change.sheet===_NamedExpressions.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var namedExpression=this.namedExpressions.namedExpressionInAddress(change.row);if(!namedExpression){throw"Missing named expression"}return new ExportedNamedExpressionChange(namedExpression.displayName,this.exportValue(change.value))}else{return new ExportedCellChange((0,_Cell.simpleCellAddress)(change.sheet,change.col,change.row),this.exportValue(change.value))}}},{key:"exportValue",value:function exportValue(value){if(value instanceof _InterpreterValue.SimpleRangeValue){return this.detailedError(new _Cell.CellError(_Cell.ErrorType.VALUE))}else if(this.config.smartRounding&&typeof value=="number"){return this.cellValueRounding(value)}else if(value instanceof _Cell.CellError){return this.detailedError(value)}else if(value===_Cell.EmptyValue){return null}else{return value}}},{key:"detailedError",value:function detailedError(error){return new DetailedCellError(error,this.config.translationPackage.getErrorTranslation(error.type))}},{key:"cellValueRounding",value:function cellValueRounding(value){if(value===0){return value}var magnitudeMultiplierExponent=Math.floor(Math.log10(Math.abs(value)));var placesMultiplier=Math.pow(10,this.config.precisionRounding-magnitudeMultiplierExponent);if(value<0){return-Math.round(-value*placesMultiplier)/placesMultiplier}else{return Math.round(value*placesMultiplier)/placesMultiplier}}}]);return Exporter}();exports.Exporter=Exporter},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var log=Math.log;var LOG10E=Math.LOG10E;$({target:"Math",stat:true},{log10:function log10(x){return log(x)*LOG10E}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(186);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(163);__webpack_require__(164);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.doesContainRelativeReferences=exports.NamedExpressions=exports.InternalNamedExpression=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var InternalNamedExpression=function(){function InternalNamedExpression(displayName,address,added,options){_classCallCheck(this,InternalNamedExpression);this.displayName=displayName;this.address=address;this.added=added;this.options=options}_createClass(InternalNamedExpression,[{key:"normalizeExpressionName",value:function normalizeExpressionName(){return this.displayName.toLowerCase()}},{key:"copy",value:function copy(){return new InternalNamedExpression(this.displayName,this.address,this.added,this.options)}}]);return InternalNamedExpression}();exports.InternalNamedExpression=InternalNamedExpression;var WorkbookStore=function(){function WorkbookStore(){_classCallCheck(this,WorkbookStore);this.mapping=new Map}_createClass(WorkbookStore,[{key:"has",value:function has(expressionName){return this.mapping.has(this.normalizeExpressionName(expressionName))}},{key:"isNameAvailable",value:function isNameAvailable(expressionName){var normalizedExpressionName=this.normalizeExpressionName(expressionName);var namedExpression=this.mapping.get(normalizedExpressionName);return!(namedExpression&&namedExpression.added)}},{key:"add",value:function add(namedExpression){this.mapping.set(namedExpression.normalizeExpressionName(),namedExpression)}},{key:"get",value:function get(expressionName){return this.mapping.get(this.normalizeExpressionName(expressionName))}},{key:"getExisting",value:function getExisting(expressionName){var namedExpression=this.mapping.get(this.normalizeExpressionName(expressionName));if(namedExpression&&namedExpression.added){return namedExpression}else{return undefined}}},{key:"remove",value:function remove(expressionName){var normalizedExpressionName=this.normalizeExpressionName(expressionName);var namedExpression=this.mapping.get(normalizedExpressionName);if(namedExpression){namedExpression.added=false}}},{key:"getAllNamedExpressions",value:function getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((function(ne){return ne.added}))}},{key:"normalizeExpressionName",value:function normalizeExpressionName(expressionName){return expressionName.toLowerCase()}}]);return WorkbookStore}();var WorksheetStore=function(){function WorksheetStore(){_classCallCheck(this,WorksheetStore);this.mapping=new Map}_createClass(WorksheetStore,[{key:"add",value:function add(namedExpression){this.mapping.set(this.normalizeExpressionName(namedExpression.displayName),namedExpression)}},{key:"get",value:function get(expressionName){return this.mapping.get(this.normalizeExpressionName(expressionName))}},{key:"has",value:function has(expressionName){return this.mapping.has(this.normalizeExpressionName(expressionName))}},{key:"normalizeExpressionName",value:function normalizeExpressionName(expressionName){return expressionName.toLowerCase()}},{key:"isNameAvailable",value:function isNameAvailable(expressionName){var normalizedExpressionName=this.normalizeExpressionName(expressionName);return!this.mapping.has(normalizedExpressionName)}},{key:"remove",value:function remove(expressionName){var normalizedExpressionName=this.normalizeExpressionName(expressionName);var namedExpression=this.mapping.get(normalizedExpressionName);if(namedExpression){this.mapping.delete(normalizedExpressionName)}}}]);return WorksheetStore}();var NamedExpressions=function(){function NamedExpressions(){_classCallCheck(this,NamedExpressions);this.nextNamedExpressionRow=0;this.workbookStore=new WorkbookStore;this.worksheetStores=new Map;this.addressCache=new Map}_createClass(NamedExpressions,[{key:"isNameAvailable",value:function isNameAvailable(expressionName,sheetId){if(sheetId===undefined){return this.workbookStore.isNameAvailable(expressionName)}else{return this.worksheetStore(sheetId).isNameAvailable(expressionName)}}},{key:"namedExpressionInAddress",value:function namedExpressionInAddress(row){var namedExpression=this.addressCache.get(row);if(namedExpression&&namedExpression.added){return namedExpression}else{return undefined}}},{key:"namedExpressionForScope",value:function namedExpressionForScope(expressionName,sheetId){if(sheetId===undefined){return this.workbookStore.getExisting(expressionName)}else{return this.worksheetStore(sheetId).get(expressionName)}}},{key:"nearestNamedExpression",value:function nearestNamedExpression(expressionName,sheetId){return this.worksheetStore(sheetId).get(expressionName)||this.workbookStore.getExisting(expressionName)}},{key:"isExpressionInScope",value:function isExpressionInScope(expressionName,sheetId){return this.worksheetStore(sheetId).has(expressionName)}},{key:"isNameValid",value:function isNameValid(expressionName){if(/^[A-Za-z]+[0-9]+$/.test(expressionName)){return false}return/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF\._]*$/.test(expressionName)}},{key:"addNamedExpression",value:function addNamedExpression(expressionName,sheetId,options){if(sheetId===undefined){var namedExpression=this.workbookStore.get(expressionName);if(namedExpression){namedExpression.added=true;namedExpression.displayName=expressionName;namedExpression.options=options}else{namedExpression=new InternalNamedExpression(expressionName,this.nextAddress(),true,options);this.workbookStore.add(namedExpression)}this.addressCache.set(namedExpression.address.row,namedExpression);return namedExpression}else{var store=this.worksheetStore(sheetId);var _namedExpression=new InternalNamedExpression(expressionName,this.nextAddress(),true,options);store.add(_namedExpression);this.addressCache.set(_namedExpression.address.row,_namedExpression);return _namedExpression}}},{key:"worksheetStore",value:function worksheetStore(sheetId){var store=this.worksheetStores.get(sheetId);if(!store){store=new WorksheetStore;this.worksheetStores.set(sheetId,store)}return store}},{key:"namedExpressionOrPlaceholder",value:function namedExpressionOrPlaceholder(expressionName,sheetId){var namedExpression=this.worksheetStore(sheetId).get(expressionName);if(namedExpression){return namedExpression}else{var _namedExpression2=this.workbookStore.get(expressionName);if(_namedExpression2===undefined){_namedExpression2=new InternalNamedExpression(expressionName,this.nextAddress(),false);this.workbookStore.add(_namedExpression2)}return _namedExpression2}}},{key:"workbookNamedExpressionOrPlaceholder",value:function workbookNamedExpressionOrPlaceholder(expressionName){var namedExpression=this.workbookStore.get(expressionName);if(namedExpression===undefined){namedExpression=new InternalNamedExpression(expressionName,this.nextAddress(),false);this.workbookStore.add(namedExpression)}return namedExpression}},{key:"remove",value:function remove(expressionName,sheetId){var store;if(sheetId===undefined){store=this.workbookStore}else{store=this.worksheetStore(sheetId)}var namedExpression=store.get(expressionName);if(namedExpression===undefined||!namedExpression.added){throw"Named expression does not exist"}store.remove(expressionName);this.addressCache.delete(namedExpression.address.row)}},{key:"getAllNamedExpressionsNames",value:function getAllNamedExpressionsNames(){return this.workbookStore.getAllNamedExpressions().map((function(ne){return ne.displayName}))}},{key:"nextAddress",value:function nextAddress(){return(0,_Cell.simpleCellAddress)(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}},{key:"lookupNextAddress",value:function lookupNextAddress(expressionName,sheetId){if(sheetId===undefined){var namedExpression=this.workbookStore.get(expressionName);if(namedExpression){return namedExpression.address}}return(0,_Cell.simpleCellAddress)(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow)}}]);return NamedExpressions}();exports.NamedExpressions=NamedExpressions;NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;var doesContainRelativeReferences=function doesContainRelativeReferences(ast){switch(ast.type){case _parser.AstNodeType.EMPTY:case _parser.AstNodeType.NUMBER:case _parser.AstNodeType.STRING:case _parser.AstNodeType.ERROR:case _parser.AstNodeType.ERROR_WITH_RAW_INPUT:return false;case _parser.AstNodeType.CELL_REFERENCE:return!ast.reference.isAbsolute();case _parser.AstNodeType.CELL_RANGE:case _parser.AstNodeType.COLUMN_RANGE:case _parser.AstNodeType.ROW_RANGE:return!ast.start.isAbsolute();case _parser.AstNodeType.NAMED_EXPRESSION:return false;case _parser.AstNodeType.PERCENT_OP:case _parser.AstNodeType.PLUS_UNARY_OP:case _parser.AstNodeType.MINUS_UNARY_OP:{return doesContainRelativeReferences(ast.value)}case _parser.AstNodeType.CONCATENATE_OP:case _parser.AstNodeType.EQUALS_OP:case _parser.AstNodeType.NOT_EQUAL_OP:case _parser.AstNodeType.LESS_THAN_OP:case _parser.AstNodeType.GREATER_THAN_OP:case _parser.AstNodeType.LESS_THAN_OR_EQUAL_OP:case _parser.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case _parser.AstNodeType.MINUS_OP:case _parser.AstNodeType.PLUS_OP:case _parser.AstNodeType.TIMES_OP:case _parser.AstNodeType.DIV_OP:case _parser.AstNodeType.POWER_OP:return doesContainRelativeReferences(ast.left)||doesContainRelativeReferences(ast.right);case _parser.AstNodeType.PARENTHESIS:return doesContainRelativeReferences(ast.expression);case _parser.AstNodeType.FUNCTION_CALL:{return ast.args.some((function(arg){return doesContainRelativeReferences(arg)}))}}};exports.doesContainRelativeReferences=doesContainRelativeReferences},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.HyperFormula=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _CellContentParser=__webpack_require__(213);var _i18n=__webpack_require__(198);var _Operations=__webpack_require__(220);var _errors=__webpack_require__(183);var _parser2=__webpack_require__(138);var _Emitter=__webpack_require__(233);var _BuildEngineFactory=__webpack_require__(235);var _FunctionRegistry=__webpack_require__(270);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var HyperFormula=function(){function HyperFormula(_config,_stats,_dependencyGraph,_columnSearch,_parser,_unparser,_cellContentParser,_evaluator,_lazilyTransformingAstService,_crudOperations,_exporter,_namedExpressions,_serialization,_functionRegistry){_classCallCheck(this,HyperFormula);this._config=_config;this._stats=_stats;this._dependencyGraph=_dependencyGraph;this._columnSearch=_columnSearch;this._parser=_parser;this._unparser=_unparser;this._cellContentParser=_cellContentParser;this._evaluator=_evaluator;this._lazilyTransformingAstService=_lazilyTransformingAstService;this._crudOperations=_crudOperations;this._exporter=_exporter;this._namedExpressions=_namedExpressions;this._serialization=_serialization;this._functionRegistry=_functionRegistry;this._emitter=new _Emitter.Emitter;this._evaluationSuspended=false}_createClass(HyperFormula,[{key:"getCellValue",value:function getCellValue(cellAddress){this.ensureEvaluationIsNotSuspended();return this._serialization.getCellValue(cellAddress)}},{key:"ensureEvaluationIsNotSuspended",value:function ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended){throw new _errors.EvaluationSuspendedError}}},{key:"getCellFormula",value:function getCellFormula(cellAddress){return this._serialization.getCellFormula(cellAddress)}},{key:"getCellSerialized",value:function getCellSerialized(cellAddress){this.ensureEvaluationIsNotSuspended();return this._serialization.getCellSerialized(cellAddress)}},{key:"getSheetValues",value:function getSheetValues(sheetId){this.ensureEvaluationIsNotSuspended();return this._serialization.getSheetValues(sheetId)}},{key:"getSheetFormulas",value:function getSheetFormulas(sheetId){return this._serialization.getSheetFormulas(sheetId)}},{key:"getSheetSerialized",value:function getSheetSerialized(sheetId){this.ensureEvaluationIsNotSuspended();return this._serialization.getSheetSerialized(sheetId)}},{key:"getAllSheetsDimensions",value:function getAllSheetsDimensions(){var _this=this;return this._serialization.genericAllSheetsGetter((function(arg){return _this.getSheetDimensions(arg)}))}},{key:"getSheetDimensions",value:function getSheetDimensions(sheetId){return{width:this.dependencyGraph.getSheetWidth(sheetId),height:this.dependencyGraph.getSheetHeight(sheetId)}}},{key:"getAllSheetsValues",value:function getAllSheetsValues(){this.ensureEvaluationIsNotSuspended();return this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function getAllSheetsSerialized(){this.ensureEvaluationIsNotSuspended();return this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function updateConfig(newParams){var newConfig=this._config.mergeConfig(newParams);var configNewLanguage=this._config.mergeConfig({language:newParams.language});var serializedSheets=this._serialization.withNewConfig(configNewLanguage,this._namedExpressions).getAllSheetsSerialized();var newEngine=_BuildEngineFactory.BuildEngineFactory.rebuildWithConfig(newConfig,serializedSheets,this._stats);this._config=newEngine.config;this._stats=newEngine.stats;this._dependencyGraph=newEngine.dependencyGraph;this._columnSearch=newEngine.columnSearch;this._parser=newEngine.parser;this._unparser=newEngine.unparser;this._cellContentParser=newEngine.cellContentParser;this._evaluator=newEngine.evaluator;this._lazilyTransformingAstService=newEngine.lazilyTransformingAstService;this._crudOperations=newEngine.crudOperations;this._exporter=newEngine.exporter;this._namedExpressions=newEngine.namedExpressions;this._serialization=newEngine.serialization;this._functionRegistry=newEngine.functionRegistry}},{key:"getConfig",value:function getConfig(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function rebuildAndRecalculate(){this.updateConfig({})}},{key:"getStats",value:function getStats(){return this._stats.snapshot()}},{key:"undo",value:function undo(){this._crudOperations.undo();return this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function redo(){this._crudOperations.redo();return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function isItPossibleToSetCellContents(topLeftCornerAddress){var width=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var height=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;try{this._crudOperations.ensureRangeInSizeLimits(_AbsoluteCellRange.AbsoluteCellRange.spanFrom(topLeftCornerAddress,width,height));for(var i=0;i<width;i++){for(var j=0;j<height;j++){this._crudOperations.ensureItIsPossibleToChangeContent({col:topLeftCornerAddress.col+i,row:topLeftCornerAddress.row+j,sheet:topLeftCornerAddress.sheet})}}}catch(e){return false}return true}},{key:"setCellContents",value:function setCellContents(topLeftCornerAddress,cellContents){this._crudOperations.setCellContents(topLeftCornerAddress,cellContents);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddRows",value:function isItPossibleToAddRows(sheetId){for(var _len=arguments.length,indexes=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){indexes[_key-1]=arguments[_key]}var normalizedIndexes=(0,_Operations.normalizeAddedIndexes)(indexes);try{var _this$_crudOperations;(_this$_crudOperations=this._crudOperations).ensureItIsPossibleToAddRows.apply(_this$_crudOperations,[sheetId].concat(_toConsumableArray(normalizedIndexes)));return true}catch(e){return false}}},{key:"addRows",value:function addRows(sheetId){var _this$_crudOperations2;for(var _len2=arguments.length,indexes=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){indexes[_key2-1]=arguments[_key2]}(_this$_crudOperations2=this._crudOperations).addRows.apply(_this$_crudOperations2,[sheetId].concat(indexes));return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function isItPossibleToRemoveRows(sheetId){for(var _len3=arguments.length,indexes=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){indexes[_key3-1]=arguments[_key3]}var normalizedIndexes=(0,_Operations.normalizeRemovedIndexes)(indexes);try{var _this$_crudOperations3;(_this$_crudOperations3=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(_this$_crudOperations3,[sheetId].concat(_toConsumableArray(normalizedIndexes)));return true}catch(e){return false}}},{key:"removeRows",value:function removeRows(sheetId){var _this$_crudOperations4;for(var _len4=arguments.length,indexes=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){indexes[_key4-1]=arguments[_key4]}(_this$_crudOperations4=this._crudOperations).removeRows.apply(_this$_crudOperations4,[sheetId].concat(indexes));return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function isItPossibleToAddColumns(sheetId){for(var _len5=arguments.length,indexes=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){indexes[_key5-1]=arguments[_key5]}var normalizedIndexes=(0,_Operations.normalizeAddedIndexes)(indexes);try{var _this$_crudOperations5;(_this$_crudOperations5=this._crudOperations).ensureItIsPossibleToAddColumns.apply(_this$_crudOperations5,[sheetId].concat(_toConsumableArray(normalizedIndexes)));return true}catch(e){return false}}},{key:"addColumns",value:function addColumns(sheetId){var _this$_crudOperations6;for(var _len6=arguments.length,indexes=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){indexes[_key6-1]=arguments[_key6]}(_this$_crudOperations6=this._crudOperations).addColumns.apply(_this$_crudOperations6,[sheetId].concat(indexes));return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function isItPossibleToRemoveColumns(sheetId){for(var _len7=arguments.length,indexes=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++){indexes[_key7-1]=arguments[_key7]}var normalizedIndexes=(0,_Operations.normalizeRemovedIndexes)(indexes);try{var _this$_crudOperations7;(_this$_crudOperations7=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(_this$_crudOperations7,[sheetId].concat(_toConsumableArray(normalizedIndexes)));return true}catch(e){return false}}},{key:"removeColumns",value:function removeColumns(sheetId){var _this$_crudOperations8;for(var _len8=arguments.length,indexes=new Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++){indexes[_key8-1]=arguments[_key8]}(_this$_crudOperations8=this._crudOperations).removeColumns.apply(_this$_crudOperations8,[sheetId].concat(indexes));return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function isItPossibleToMoveCells(sourceLeftCorner,width,height,destinationLeftCorner){try{this._crudOperations.operations.ensureItIsPossibleToMoveCells(sourceLeftCorner,width,height,destinationLeftCorner);return true}catch(e){return false}}},{key:"moveCells",value:function moveCells(sourceLeftCorner,width,height,destinationLeftCorner){this._crudOperations.moveCells(sourceLeftCorner,width,height,destinationLeftCorner);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function isItPossibleToMoveRows(sheetId,startRow,numberOfRows,targetRow){try{this._crudOperations.ensureItIsPossibleToMoveRows(sheetId,startRow,numberOfRows,targetRow);return true}catch(e){return false}}},{key:"moveRows",value:function moveRows(sheetId,startRow,numberOfRows,targetRow){this._crudOperations.moveRows(sheetId,startRow,numberOfRows,targetRow);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function isItPossibleToMoveColumns(sheetId,startColumn,numberOfColumns,targetColumn){try{this._crudOperations.ensureItIsPossibleToMoveColumns(sheetId,startColumn,numberOfColumns,targetColumn);return true}catch(e){return false}}},{key:"moveColumns",value:function moveColumns(sheetId,startColumn,numberOfColumns,targetColumn){this._crudOperations.moveColumns(sheetId,startColumn,numberOfColumns,targetColumn);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function copy(sourceLeftCorner,width,height){this._crudOperations.copy(sourceLeftCorner,width,height);return this.getRangeValues(sourceLeftCorner,width,height)}},{key:"cut",value:function cut(sourceLeftCorner,width,height){this._crudOperations.cut(sourceLeftCorner,width,height);return this.getRangeValues(sourceLeftCorner,width,height)}},{key:"paste",value:function paste(targetLeftCorner){this.ensureEvaluationIsNotSuspended();this._crudOperations.paste(targetLeftCorner);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function clearClipboard(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function getRangeValues(leftCorner,width,height){var _this2=this;var cellRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(leftCorner,width,height);return cellRange.arrayOfAddressesInRange().map((function(subarray){return subarray.map((function(address){return _this2.getCellValue(address)}))}))}},{key:"getRangeFormulas",value:function getRangeFormulas(leftCorner,width,height){var _this3=this;var cellRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(leftCorner,width,height);return cellRange.arrayOfAddressesInRange().map((function(subarray){return subarray.map((function(address){return _this3.getCellFormula(address)}))}))}},{key:"getRangeSerialized",value:function getRangeSerialized(leftCorner,width,height){var _this4=this;var cellRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(leftCorner,width,height);return cellRange.arrayOfAddressesInRange().map((function(subarray){return subarray.map((function(address){return _this4.getCellSerialized(address)}))}))}},{key:"isItPossibleToAddSheet",value:function isItPossibleToAddSheet(sheetName){try{this._crudOperations.ensureItIsPossibleToAddSheet(sheetName);return true}catch(e){return false}}},{key:"addSheet",value:function addSheet(sheetName){var addedSheetName=this._crudOperations.addSheet(sheetName);this._emitter.emit(_Emitter.Events.SheetAdded,addedSheetName);return addedSheetName}},{key:"isItPossibleToRemoveSheet",value:function isItPossibleToRemoveSheet(sheetName){try{this._crudOperations.ensureSheetExists(sheetName);return true}catch(e){return false}}},{key:"removeSheet",value:function removeSheet(sheetName){var displayName=this.sheetMapping.getDisplayNameByName(sheetName);this._crudOperations.removeSheet(sheetName);var changes=this.recomputeIfDependencyGraphNeedsIt();this._emitter.emit(_Emitter.Events.SheetRemoved,displayName,changes);return changes}},{key:"isItPossibleToClearSheet",value:function isItPossibleToClearSheet(sheetName){try{this._crudOperations.ensureSheetExists(sheetName);return true}catch(e){return false}}},{key:"clearSheet",value:function clearSheet(sheetName){this._crudOperations.ensureSheetExists(sheetName);this._crudOperations.clearSheet(sheetName);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function isItPossibleToReplaceSheetContent(sheetName,values){try{this._crudOperations.ensureSheetExists(sheetName);var sheetId=this.sheetMapping.fetch(sheetName);this._crudOperations.ensureItIsPossibleToChangeSheetContents(sheetId,values);return true}catch(e){return false}}},{key:"setSheetContent",value:function setSheetContent(sheetName,values){this._crudOperations.setSheetContent(sheetName,values);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function simpleCellAddressFromString(cellAddress,sheetId){return(0,_parser2.simpleCellAddressFromString)(this.sheetMapping.get,cellAddress,sheetId)}},{key:"simpleCellAddressToString",value:function simpleCellAddressToString(cellAddress,sheetId){return(0,_parser2.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,cellAddress,sheetId)}},{key:"getSheetName",value:function getSheetName(sheetId){return this.sheetMapping.getDisplayName(sheetId)}},{key:"getSheetNames",value:function getSheetNames(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function getSheetId(sheetName){return this.sheetMapping.get(sheetName)}},{key:"doesSheetExist",value:function doesSheetExist(sheetName){return this.sheetMapping.hasSheetWithName(sheetName)}},{key:"getCellType",value:function getCellType(cellAddress){var vertex=this.dependencyGraph.getCell(cellAddress);return(0,_Cell.getCellType)(vertex)}},{key:"doesCellHaveSimpleValue",value:function doesCellHaveSimpleValue(cellAddress){return this.getCellType(cellAddress)===_Cell.CellType.VALUE}},{key:"doesCellHaveFormula",value:function doesCellHaveFormula(cellAddress){return this.getCellType(cellAddress)===_Cell.CellType.FORMULA}},{key:"isCellEmpty",value:function isCellEmpty(cellAddress){return this.getCellType(cellAddress)===_Cell.CellType.EMPTY}},{key:"isCellPartOfMatrix",value:function isCellPartOfMatrix(cellAddress){return this.getCellType(cellAddress)===_Cell.CellType.MATRIX}},{key:"getCellValueType",value:function getCellValueType(cellAddress){this.ensureEvaluationIsNotSuspended();var value=this.dependencyGraph.getCellValue(cellAddress);return(0,_Cell.getCellValueType)(value)}},{key:"countSheets",value:function countSheets(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function isItPossibleToRenameSheet(sheetId,newName){try{this._crudOperations.ensureItIsPossibleToRenameSheet(sheetId,newName);return true}catch(e){return false}}},{key:"renameSheet",value:function renameSheet(sheetId,newName){var oldName=this._crudOperations.renameSheet(sheetId,newName);if(oldName!==undefined){this._emitter.emit(_Emitter.Events.SheetRenamed,oldName,newName)}}},{key:"batch",value:function batch(batchOperations){this.suspendEvaluation();this._crudOperations.beginUndoRedoBatchMode();try{batchOperations()}catch(e){this._crudOperations.commitUndoRedoBatchMode();this.resumeEvaluation();throw e}this._crudOperations.commitUndoRedoBatchMode();return this.resumeEvaluation()}},{key:"suspendEvaluation",value:function suspendEvaluation(){this._evaluationSuspended=true}},{key:"resumeEvaluation",value:function resumeEvaluation(){this._evaluationSuspended=false;return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isEvaluationSuspended",value:function isEvaluationSuspended(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function isItPossibleToAddNamedExpression(expressionName,expression,scope){try{this._crudOperations.ensureItIsPossibleToAddNamedExpression(expressionName,expression,scope);return true}catch(e){return false}}},{key:"addNamedExpression",value:function addNamedExpression(expressionName,expression,scope,options){this._crudOperations.addNamedExpression(expressionName,expression,scope,options);var changes=this.recomputeIfDependencyGraphNeedsIt();this._emitter.emit(_Emitter.Events.NamedExpressionAdded,expressionName,changes);return changes}},{key:"getNamedExpressionValue",value:function getNamedExpressionValue(expressionName,scope){this.ensureEvaluationIsNotSuspended();var sheetId=this._crudOperations.scopeId(scope);var namedExpression=this._namedExpressions.namedExpressionForScope(expressionName,sheetId);if(namedExpression){return this._serialization.getCellValue(namedExpression.address)}else{return undefined}}},{key:"getNamedExpressionFormula",value:function getNamedExpressionFormula(expressionName,scope){var sheetId=this._crudOperations.scopeId(scope);var namedExpression=this._namedExpressions.namedExpressionForScope(expressionName,sheetId);if(namedExpression===undefined){return undefined}else{return this._serialization.getCellFormula(namedExpression.address)}}},{key:"getNamedExpression",value:function getNamedExpression(expressionName,scope){var sheetId=this._crudOperations.scopeId(scope);var namedExpression=this._namedExpressions.namedExpressionForScope(expressionName,sheetId);if(namedExpression===undefined){return undefined}var expression=this._serialization.getCellFormula(namedExpression.address);return{name:expressionName,scope:scope,expression:expression,options:namedExpression.options}}},{key:"isItPossibleToChangeNamedExpression",value:function isItPossibleToChangeNamedExpression(expressionName,newExpression,scope){try{this._crudOperations.ensureItIsPossibleToChangeNamedExpression(expressionName,newExpression,scope);return true}catch(e){return false}}},{key:"changeNamedExpression",value:function changeNamedExpression(expressionName,newExpression,scope,options){this._crudOperations.changeNamedExpressionExpression(expressionName,scope,newExpression,options);return this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function isItPossibleToRemoveNamedExpression(expressionName,scope){try{this._crudOperations.isItPossibleToRemoveNamedExpression(expressionName,scope);return true}catch(e){return false}}},{key:"removeNamedExpression",value:function removeNamedExpression(expressionName,scope){var removedNamedExpression=this._crudOperations.removeNamedExpression(expressionName,scope);if(removedNamedExpression){var changes=this.recomputeIfDependencyGraphNeedsIt();this._emitter.emit(_Emitter.Events.NamedExpressionRemoved,removedNamedExpression.displayName,changes);return changes}else{return[]}}},{key:"listNamedExpressions",value:function listNamedExpressions(){return this._namedExpressions.getAllNamedExpressionsNames()}},{key:"normalizeFormula",value:function normalizeFormula(formulaString){var _this$extractTemporar=this.extractTemporaryFormula(formulaString),_this$extractTemporar2=_slicedToArray(_this$extractTemporar,2),ast=_this$extractTemporar2[0],address=_this$extractTemporar2[1];if(ast===undefined){throw new _errors.NotAFormulaError}return this._unparser.unparse(ast,address)}},{key:"calculateFormula",value:function calculateFormula(formulaString,sheetName){this._crudOperations.ensureSheetExists(sheetName);var sheetId=this.sheetMapping.fetch(sheetName);var _this$extractTemporar3=this.extractTemporaryFormula(formulaString,sheetId),_this$extractTemporar4=_slicedToArray(_this$extractTemporar3,3),ast=_this$extractTemporar4[0],address=_this$extractTemporar4[1],dependencies=_this$extractTemporar4[2];if(ast===undefined){throw new _errors.NotAFormulaError}var internalCellValue=this.evaluator.runAndForget(ast,address,dependencies);return this._exporter.exportValue(internalCellValue)}},{key:"validateFormula",value:function validateFormula(formulaString){var _this$extractTemporar5=this.extractTemporaryFormula(formulaString),_this$extractTemporar6=_slicedToArray(_this$extractTemporar5,1),ast=_this$extractTemporar6[0];if(ast===undefined){return false}if(ast.type===_parser2.AstNodeType.ERROR&&!ast.error){return false}return true}},{key:"getRegisteredFunctionNames",value:function getRegisteredFunctionNames(){var language=HyperFormula.getLanguage(this._config.language);return language.getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function getFunctionPlugin(functionId){return this._functionRegistry.getFunctionPlugin(functionId)}},{key:"getAllFunctionPlugins",value:function getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function numberToDateTime(val){return this._evaluator.dateHelper.numberToSimpleDateTime(val)}},{key:"numberToDate",value:function numberToDate(val){return this._evaluator.dateHelper.numberToSimpleDate(val)}},{key:"numberToTime",value:function numberToTime(val){return this._evaluator.dateHelper.numberToSimpleTime(val)}},{key:"extractTemporaryFormula",value:function extractTemporaryFormula(formulaString){var sheetId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var parsedCellContent=this._cellContentParser.parse(formulaString);var exampleTemporaryFormulaAddress={sheet:sheetId,col:0,row:0};if(!(parsedCellContent instanceof _CellContentParser.CellContent.Formula)){return[undefined,exampleTemporaryFormulaAddress,[]]}var _this$_parser$parse=this._parser.parse(parsedCellContent.formula,exampleTemporaryFormulaAddress),ast=_this$_parser$parse.ast,errors=_this$_parser$parse.errors,dependencies=_this$_parser$parse.dependencies;if(errors.length>0){return[undefined,exampleTemporaryFormulaAddress,[]]}return[ast,exampleTemporaryFormulaAddress,dependencies]}},{key:"on",value:function on(event,listener){this._emitter.on(event,listener)}},{key:"once",value:function once(event,listener){this._emitter.once(event,listener)}},{key:"off",value:function off(event,listener){this._emitter.off(event,listener)}},{key:"destroy",value:function destroy(){this.dependencyGraph.destroy();this.columnSearch.destroy();this.evaluator.destroy();this._parser.destroy();this._lazilyTransformingAstService.destroy();this._stats.destroy();this._crudOperations.clearClipboard()}},{key:"recomputeIfDependencyGraphNeedsIt",value:function recomputeIfDependencyGraphNeedsIt(){if(!this._evaluationSuspended){var changes=this._crudOperations.getAndClearContentChanges();var verticesToRecomputeFrom=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices();if(verticesToRecomputeFrom.length>0){changes.addAll(this.evaluator.partialRun(verticesToRecomputeFrom))}var exportedChanges=changes.exportChanges(this._exporter);if(!changes.isEmpty()){this._emitter.emit(_Emitter.Events.ValuesUpdated,exportedChanges)}return exportedChanges}else{return[]}}},{key:"graph",get:function get(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function get(){return this.dependencyGraph.rangeMapping}},{key:"matrixMapping",get:function get(){return this.dependencyGraph.matrixMapping}},{key:"sheetMapping",get:function get(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function get(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function get(){return this._dependencyGraph}},{key:"evaluator",get:function get(){return this._evaluator}},{key:"columnSearch",get:function get(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function get(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function get(){return this._config.licenseKeyValidityState}}],[{key:"buildFromEngineState",value:function buildFromEngineState(engine){return new HyperFormula(engine.config,engine.stats,engine.dependencyGraph,engine.columnSearch,engine.parser,engine.unparser,engine.cellContentParser,engine.evaluator,engine.lazilyTransformingAstService,engine.crudOperations,engine.exporter,engine.namedExpressions,engine.serialization,engine.functionRegistry)}},{key:"buildFromArray",value:function buildFromArray(sheet,configInput){return this.buildFromEngineState(_BuildEngineFactory.BuildEngineFactory.buildFromSheet(sheet,configInput))}},{key:"buildFromSheets",value:function buildFromSheets(sheets,configInput){return this.buildFromEngineState(_BuildEngineFactory.BuildEngineFactory.buildFromSheets(sheets,configInput))}},{key:"buildEmpty",value:function buildEmpty(configInput){return this.buildFromEngineState(_BuildEngineFactory.BuildEngineFactory.buildEmpty(configInput))}},{key:"getLanguage",value:function getLanguage(languageCode){var val=this.registeredLanguages.get(languageCode);if(val===undefined){throw new _errors.LanguageNotRegisteredError}else{return val}}},{key:"registerLanguage",value:function registerLanguage(languageCode,languagePackage){if(this.registeredLanguages.has(languageCode)){throw new _errors.LanguageAlreadyRegisteredError}else{this.registeredLanguages.set(languageCode,(0,_i18n.buildTranslationPackage)(languagePackage))}}},{key:"unregisterLanguage",value:function unregisterLanguage(languageCode){if(this.registeredLanguages.has(languageCode)){this.registeredLanguages.delete(languageCode)}else{throw new _errors.LanguageNotRegisteredError}}},{key:"getRegisteredLanguagesCodes",value:function getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function registerFunctionPlugin(plugin,translations){_FunctionRegistry.FunctionRegistry.registerFunctionPlugin(plugin,translations)}},{key:"unregisterFunctionPlugin",value:function unregisterFunctionPlugin(plugin){_FunctionRegistry.FunctionRegistry.unregisterFunctionPlugin(plugin)}},{key:"registerFunction",value:function registerFunction(functionId,plugin,translations){_FunctionRegistry.FunctionRegistry.registerFunction(functionId,plugin,translations)}},{key:"unregisterFunction",value:function unregisterFunction(functionId){_FunctionRegistry.FunctionRegistry.unregisterFunction(functionId)}},{key:"unregisterAllFunctions",value:function unregisterAllFunctions(){_FunctionRegistry.FunctionRegistry.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function getRegisteredFunctionNames(code){var functionIds=_FunctionRegistry.FunctionRegistry.getRegisteredFunctionIds();var language=this.getLanguage(code);return language.getFunctionTranslations(functionIds)}},{key:"getFunctionPlugin",value:function getFunctionPlugin(functionId){return _FunctionRegistry.FunctionRegistry.getFunctionPlugin(functionId)}},{key:"getAllFunctionPlugins",value:function getAllFunctionPlugins(){return _FunctionRegistry.FunctionRegistry.getPlugins()}}]);return HyperFormula}();exports.HyperFormula=HyperFormula;HyperFormula.version="0.1.3";HyperFormula.buildDate="21/07/2020 09:24:53";HyperFormula.releaseDate="21/07/2020";HyperFormula.languages={};HyperFormula.registeredLanguages=new Map},function(module,exports,__webpack_require__){"use strict";__webpack_require__(84);__webpack_require__(214);__webpack_require__(100);__webpack_require__(215);exports.__esModule=true;exports.isFormula=isFormula;exports.isBoolean=isBoolean;exports.isMatrix=isMatrix;exports.isError=isError;exports.CellContentParser=exports.CellContent=void 0;var _Cell=__webpack_require__(106);var _errors=__webpack_require__(183);var _ArithmeticHelper=__webpack_require__(217);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CellContent;exports.CellContent=CellContent;(function(CellContent){var Number=function Number(value){_classCallCheck(this,Number);this.value=value;this.value=(0,_ArithmeticHelper.fixNegativeZero)(this.value)};CellContent.Number=Number;var String=function String(value){_classCallCheck(this,String);this.value=value};CellContent.String=String;var Boolean=function Boolean(value){_classCallCheck(this,Boolean);this.value=value};CellContent.Boolean=Boolean;var Empty=function(){function Empty(){_classCallCheck(this,Empty)}_createClass(Empty,null,[{key:"getSingletonInstance",value:function getSingletonInstance(){if(!Empty.instance){Empty.instance=new Empty}return Empty.instance}}]);return Empty}();CellContent.Empty=Empty;var Formula=function Formula(formula){_classCallCheck(this,Formula);this.formula=formula};CellContent.Formula=Formula;var MatrixFormula=function(){function MatrixFormula(formula){_classCallCheck(this,MatrixFormula);this.formula=formula}_createClass(MatrixFormula,[{key:"formulaWithBraces",value:function formulaWithBraces(){return"{"+this.formula+"}"}}]);return MatrixFormula}();CellContent.MatrixFormula=MatrixFormula;var Error=function Error(errorType){_classCallCheck(this,Error);this.value=new _Cell.CellError(errorType)};CellContent.Error=Error})(CellContent||(exports.CellContent=CellContent={}));function isFormula(text){return text.startsWith("=")}function isBoolean(text){var tl=text.toLowerCase();return tl==="true"||tl==="false"}function isMatrix(text){if(typeof text!=="string"){return false}return text.length>1&&text.startsWith("{")&&text.endsWith("}")}function isError(text,errorMapping){var upperCased=text.toUpperCase();var errorRegex=/#[A-Za-z0-9\/]+[?!]?/;return errorRegex.test(upperCased)&&Object.prototype.hasOwnProperty.call(errorMapping,upperCased)}var CellContentParser=function(){function CellContentParser(config,dateHelper,numberLiteralsHelper){_classCallCheck(this,CellContentParser);this.config=config;this.dateHelper=dateHelper;this.numberLiteralsHelper=numberLiteralsHelper}_createClass(CellContentParser,[{key:"parse",value:function parse(content){if(content===undefined||content===null){return CellContent.Empty.getSingletonInstance()}else if(typeof content==="number"){if((0,_ArithmeticHelper.isNumberOverflow)(content)){return new CellContent.Error(_Cell.ErrorType.NUM)}else{return new CellContent.Number(content)}}else if(typeof content==="boolean"){return new CellContent.Boolean(content)}else if(content instanceof Date){return new CellContent.Number(this.dateHelper.dateToNumber({day:content.getDate(),month:content.getMonth()+1,year:content.getFullYear()}))}else if(typeof content==="string"){if(isBoolean(content)){return new CellContent.Boolean(content.toLowerCase()==="true")}else if(isMatrix(content)){return new CellContent.MatrixFormula(content.substr(1,content.length-2))}else if(isFormula(content)){return new CellContent.Formula(content)}else if(isError(content,this.config.errorMapping)){return new CellContent.Error(this.config.errorMapping[content.toUpperCase()])}else{var trimmedContent=content.trim();if(this.numberLiteralsHelper.isNumber(trimmedContent)){return new CellContent.Number(this.numberLiteralsHelper.numericStringToNumber(trimmedContent))}var parsedDateNumber=this.dateHelper.dateStringToDateNumber(trimmedContent);if(parsedDateNumber!==undefined){return new CellContent.Number(parsedDateNumber)}else{return new CellContent.String(content.startsWith("'")?content.slice(1):content)}}}else{throw new _errors.UnableToParseError(content)}}}]);return CellContentParser}();exports.CellContentParser=CellContentParser},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var getOwnPropertyDescriptor=__webpack_require__(5).f;var toLength=__webpack_require__(40);var notARegExp=__webpack_require__(101);var requireObjectCoercible=__webpack_require__(13);var correctIsRegExpLogic=__webpack_require__(103);var IS_PURE=__webpack_require__(30);var nativeEndsWith="".endsWith;var min=Math.min;var CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("endsWith");var MDN_POLYFILL_BUG=!IS_PURE&&!CORRECT_IS_REGEXP_LOGIC&&!!function(){var descriptor=getOwnPropertyDescriptor(String.prototype,"endsWith");return descriptor&&!descriptor.writable}();$({target:"String",proto:true,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{endsWith:function endsWith(searchString){var that=String(requireObjectCoercible(this));notARegExp(searchString);var endPosition=arguments.length>1?arguments[1]:undefined;var len=toLength(that.length);var end=endPosition===undefined?len:min(toLength(endPosition),len);var search=String(searchString);return nativeEndsWith?nativeEndsWith.call(that,search,end):that.slice(end-search.length,end)===search}})},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $trim=__webpack_require__(134).trim;var forcedStringTrimMethod=__webpack_require__(216);$({target:"String",proto:true,forced:forcedStringTrimMethod("trim")},{trim:function trim(){return $trim(this)}})},function(module,exports,__webpack_require__){var fails=__webpack_require__(7);var whitespaces=__webpack_require__(135);var non="​᠎";module.exports=function(METHOD_NAME){return fails((function(){return!!whitespaces[METHOD_NAME]()||non[METHOD_NAME]()!=non||whitespaces[METHOD_NAME].name!==METHOD_NAME}))}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(218);__webpack_require__(133);__webpack_require__(92);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(170);__webpack_require__(215);exports.__esModule=true;exports.coerceToRange=coerceToRange;exports.coerceToRangeNumbersOrError=coerceToRangeNumbersOrError;exports.coerceBooleanToNumber=coerceBooleanToNumber;exports.coerceEmptyToValue=coerceEmptyToValue;exports.coerceScalarToBoolean=coerceScalarToBoolean;exports.coerceScalarToString=coerceScalarToString;exports.multiply=multiply;exports.power=power;exports.divide=divide;exports.unaryminus=unaryminus;exports.percent=percent;exports.max=max;exports.maxa=maxa;exports.min=min;exports.mina=mina;exports.numberCmp=numberCmp;exports.isNumberOverflow=isNumberOverflow;exports.fixNegativeZero=fixNegativeZero;exports.ArithmeticHelper=void 0;var _Cell=__webpack_require__(106);var _StringHelper=__webpack_require__(219);var _InterpreterValue=__webpack_require__(203);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ArithmeticHelper=function(){function ArithmeticHelper(config,dateTimeHelper,numberLiteralsHelper){var _this=this;_classCallCheck(this,ArithmeticHelper);this.config=config;this.dateTimeHelper=dateTimeHelper;this.numberLiteralsHelper=numberLiteralsHelper;this.nonstrictadd=function(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else if(typeof left==="number"){if(typeof right==="number"){return _this.addWithEpsilon(left,right)}else{return left}}else if(typeof right==="number"){return right}else{return 0}};this.collator=(0,_StringHelper.collatorFromConfig)(config);this.actualEps=config.smartRounding?config.precisionEpsilon:0}_createClass(ArithmeticHelper,[{key:"eqMatcherFunction",value:function eqMatcherFunction(pattern){var _this2=this;var regexp=this.buildRegex(pattern);return function(cellValue){return typeof cellValue==="string"&&regexp.test(_this2.normalizeString(cellValue))}}},{key:"neqMatcherFunction",value:function neqMatcherFunction(pattern){var _this3=this;var regexp=this.buildRegex(pattern);return function(cellValue){return typeof cellValue!=="string"||!regexp.test(_this3.normalizeString(cellValue))}}},{key:"requiresRegex",value:function requiresRegex(pattern){if(!this.config.useRegularExpressions&&!this.config.useWildcards){return!this.config.matchWholeCell}for(var i=0;i<pattern.length;i++){var c=pattern.charAt(i);if(isWildcard(c)||this.config.useRegularExpressions&&needsEscape(c)){return true}}return false}},{key:"buildRegex",value:function buildRegex(pattern){pattern=this.normalizeString(pattern);var regexpStr;var useWildcards=this.config.useWildcards;var useRegularExpressions=this.config.useRegularExpressions;if(useRegularExpressions){try{RegExp(pattern)}catch(e){useRegularExpressions=false;useWildcards=false}}if(useRegularExpressions){regexpStr=escapeNoCharacters(pattern,this.config.caseSensitive)}else if(useWildcards){regexpStr=escapeNonWildcards(pattern,this.config.caseSensitive)}else{regexpStr=escapeAllCharacters(pattern,this.config.caseSensitive)}if(this.config.matchWholeCell){return RegExp("^("+regexpStr+")$")}else{return RegExp(regexpStr)}}},{key:"normalizeString",value:function normalizeString(str){if(!this.config.caseSensitive){str=str.toLowerCase()}if(!this.config.accentSensitive){str=str.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}return str}},{key:"compare",value:function compare(left,right){if(typeof left==="string"||typeof right==="string"){var leftTmp=typeof left==="string"?this.dateTimeHelper.dateStringToDateNumber(left):left;var rightTmp=typeof right==="string"?this.dateTimeHelper.dateStringToDateNumber(right):right;if(typeof leftTmp==="number"&&typeof rightTmp==="number"){return this.floatCmp(leftTmp,rightTmp)}}if(left===_Cell.EmptyValue){left=coerceEmptyToValue(right)}else if(right===_Cell.EmptyValue){right=coerceEmptyToValue(left)}if(typeof left==="string"&&typeof right==="string"){return this.stringCmp(left,right)}else if(typeof left==="boolean"&&typeof right==="boolean"){return numberCmp(coerceBooleanToNumber(left),coerceBooleanToNumber(right))}else if(typeof left==="number"&&typeof right==="number"){return this.floatCmp(left,right)}else if(left===_Cell.EmptyValue&&right===_Cell.EmptyValue){return 0}else{return numberCmp((0,_Cell.CellValueTypeOrd)((0,_Cell.getCellValueType)(left)),(0,_Cell.CellValueTypeOrd)((0,_Cell.getCellValueType)(right)))}}},{key:"floatCmp",value:function floatCmp(left,right){var mod=1+this.actualEps;if(right>=0&&left*mod>=right&&left<=right*mod){return 0}else if(right<=0&&left*mod<=right&&left>=right*mod){return 0}else if(left>right){return 1}else{return-1}}},{key:"stringCmp",value:function stringCmp(left,right){return this.collator.compare(left,right)}},{key:"add",value:function add(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{return this.addWithEpsilon(left,right)}}},{key:"addWithEpsilon",value:function addWithEpsilon(left,right){var ret=left+right;if(Math.abs(ret)<this.actualEps*Math.abs(left)){return 0}else{return ret}}},{key:"subtract",value:function subtract(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{var ret=left-right;if(Math.abs(ret)<this.actualEps*Math.abs(left)){return 0}else{return ret}}}},{key:"coerceScalarToNumberOrError",value:function coerceScalarToNumberOrError(arg){var _a;if(arg instanceof _Cell.CellError){return arg}return(_a=this.coerceToMaybeNumber(arg))!==null&&_a!==void 0?_a:new _Cell.CellError(_Cell.ErrorType.VALUE)}},{key:"coerceToMaybeNumber",value:function coerceToMaybeNumber(arg){var _a;return(_a=this.coerceNonDateScalarToMaybeNumber(arg))!==null&&_a!==void 0?_a:typeof arg==="string"?this.dateTimeHelper.dateStringToDateNumber(arg):undefined}},{key:"coerceNonDateScalarToMaybeNumber",value:function coerceNonDateScalarToMaybeNumber(arg){if(arg===_Cell.EmptyValue){return 0}else if(typeof arg==="string"&&this.numberLiteralsHelper.isNumber(arg)){return this.numberLiteralsHelper.numericStringToNumber(arg)}else{if(typeof arg==="string"&&arg.length>0&&arg.trim()===""){return undefined}var coercedNumber=Number(arg);if(isNaN(coercedNumber)){return undefined}else{return coercedNumber}}}}]);return ArithmeticHelper}();exports.ArithmeticHelper=ArithmeticHelper;function coerceToRange(arg){if(arg instanceof _InterpreterValue.SimpleRangeValue){return arg}else{return _InterpreterValue.SimpleRangeValue.fromScalar(arg)}}function coerceToRangeNumbersOrError(arg){if(arg instanceof _InterpreterValue.SimpleRangeValue&&arg.hasOnlyNumbers()||arg instanceof _Cell.CellError){return arg}else if(typeof arg==="number"){return _InterpreterValue.SimpleRangeValue.fromScalar(arg)}else{return null}}function coerceBooleanToNumber(arg){return Number(arg)}function coerceEmptyToValue(arg){if(typeof arg==="string"){return""}else if(typeof arg==="number"){return 0}else if(typeof arg==="boolean"){return false}else{return _Cell.EmptyValue}}function coerceScalarToBoolean(arg){if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(arg instanceof _Cell.CellError||typeof arg==="boolean"){return arg}else if(arg===_Cell.EmptyValue){return false}else if(typeof arg==="number"){return arg!==0}else{var argUppered=arg.toUpperCase();if(argUppered==="TRUE"){return true}else if(argUppered==="FALSE"){return false}else if(argUppered===""){return false}else{return null}}}function coerceScalarToString(arg){if(arg instanceof _Cell.CellError||typeof arg==="string"){return arg}else if(arg===_Cell.EmptyValue){return""}else if(typeof arg==="number"){return arg.toString()}else{return arg?"TRUE":"FALSE"}}function multiply(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{return left*right}}function power(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{return Math.pow(left,right)}}function divide(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else if(right===0){return new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}else{return left/right}}function unaryminus(value){if(value instanceof _Cell.CellError){return value}else{return-value}}function percent(value){if(value instanceof _Cell.CellError){return value}else{return value/100}}function max(left,right){if(left instanceof _Cell.CellError){return left}if(right instanceof _Cell.CellError){return right}if(typeof left==="number"){if(typeof right==="number"){return Math.max(left,right)}else{return left}}else if(typeof right==="number"){return right}else{return Number.NEGATIVE_INFINITY}}function maxa(left,right){if(left instanceof _Cell.CellError){return left}if(right instanceof _Cell.CellError){return right}if(typeof left==="boolean"){left=coerceBooleanToNumber(left)}if(typeof right==="boolean"){right=coerceBooleanToNumber(right)}if(typeof left==="number"){if(typeof right==="number"){return Math.max(left,right)}else{return left}}else if(typeof right==="number"){return right}else{return Number.NEGATIVE_INFINITY}}function min(left,right){if(left instanceof _Cell.CellError){return left}if(right instanceof _Cell.CellError){return right}if(typeof left==="number"){if(typeof right==="number"){return Math.min(left,right)}else{return left}}else if(typeof right==="number"){return right}else{return Number.POSITIVE_INFINITY}}function mina(left,right){if(left instanceof _Cell.CellError){return left}if(right instanceof _Cell.CellError){return right}if(typeof left==="boolean"){left=coerceBooleanToNumber(left)}if(typeof right==="boolean"){right=coerceBooleanToNumber(right)}if(typeof left==="number"){if(typeof right==="number"){return Math.min(left,right)}else{return left}}else if(typeof right==="number"){return right}else{return Number.POSITIVE_INFINITY}}function numberCmp(left,right){if(left>right){return 1}else if(left<right){return-1}else{return 0}}function isNumberOverflow(arg){return isNaN(arg)||arg===Infinity||arg===-Infinity}function fixNegativeZero(arg){if(arg===0){return 0}else{return arg}}function isWildcard(c){return["*","?"].includes(c)}var escapedCharacters=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function needsEscape(c){return escapedCharacters.includes(c)}function escapeNonWildcards(pattern,caseSensitive){var str="";for(var i=0;i<pattern.length;i++){var c=pattern.charAt(i);if(c==="~"){if(i==pattern.length-1){str+="~";continue}var d=pattern.charAt(i+1);if(isWildcard(d)||needsEscape(d)){str+="\\"+d;i++}else{str+=d;i++}}else if(isWildcard(c)){str+="."+c}else if(needsEscape(c)){str+="\\"+c}else if(caseSensitive){str+=c}else{str+=c.toLowerCase()}}return str}function escapeAllCharacters(pattern,caseSensitive){var str="";for(var i=0;i<pattern.length;i++){var c=pattern.charAt(i);if(isWildcard(c)||needsEscape(c)){str+="\\"+c}else if(caseSensitive){str+=c}else{str+=c.toLowerCase()}}return str}function escapeNoCharacters(pattern,caseSensitive){var str="";for(var i=0;i<pattern.length;i++){var c=pattern.charAt(i);if(isWildcard(c)||needsEscape(c)){str+=c}else if(caseSensitive){str+=c}else{str+=c.toLowerCase()}}return str}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $includes=__webpack_require__(39).includes;var addToUnscopables=__webpack_require__(76);var arrayMethodUsesToLength=__webpack_require__(88);var USES_TO_LENGTH=arrayMethodUsesToLength("indexOf",{ACCESSORS:true,1:0});$({target:"Array",proto:true,forced:!USES_TO_LENGTH},{includes:function includes(el){return $includes(this,el,arguments.length>1?arguments[1]:undefined)}});addToUnscopables("includes")},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.collatorFromConfig=collatorFromConfig;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function collatorFromConfig(config){var sensitivity=config.caseSensitive?config.accentSensitive?"variant":"case":config.accentSensitive?"accent":"base";var caseFirst=config.caseFirst;var ignorePunctuation=config.ignorePunctuation;return new Intl.Collator(config.localeLang,{sensitivity:sensitivity,caseFirst:caseFirst,ignorePunctuation:ignorePunctuation})}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(140);__webpack_require__(84);__webpack_require__(196);__webpack_require__(89);__webpack_require__(133);__webpack_require__(166);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.normalizeRemovedIndexes=normalizeRemovedIndexes;exports.normalizeAddedIndexes=normalizeAddedIndexes;exports.Operations=exports.RemoveColumnsCommand=exports.AddColumnsCommand=exports.AddRowsCommand=exports.RemoveRowsCommand=void 0;var _statistics=__webpack_require__(176);var _ClipboardOperations=__webpack_require__(221);var _Cell=__webpack_require__(106);var _CellContentParser=__webpack_require__(213);var _Span=__webpack_require__(174);var _ContentChanges=__webpack_require__(222);var _absolutizeDependencies=__webpack_require__(175);var _GraphBuilder=__webpack_require__(223);var _DependencyGraph=__webpack_require__(107);var _errors2=__webpack_require__(183);var _parser=__webpack_require__(138);var _AddRowsTransformer=__webpack_require__(225);var _RemoveRowsTransformer=__webpack_require__(227);var _AddColumnsTransformer=__webpack_require__(228);var _MoveCellsTransformer=__webpack_require__(229);var _RemoveSheetTransformer=__webpack_require__(230);var _RemoveColumnsTransformer=__webpack_require__(231);var _AbsoluteCellRange=__webpack_require__(132);var _Sheet=__webpack_require__(232);var _NamedExpressions=__webpack_require__(211);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var RemoveRowsCommand=function(){function RemoveRowsCommand(sheet,indexes){_classCallCheck(this,RemoveRowsCommand);this.sheet=sheet;this.indexes=indexes}_createClass(RemoveRowsCommand,[{key:"normalizedIndexes",value:function normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}},{key:"rowsSpans",value:function rowsSpans(){var _this=this;return this.normalizedIndexes().map((function(normalizedIndex){return _Span.RowsSpan.fromNumberOfRows(_this.sheet,normalizedIndex[0],normalizedIndex[1])}))}}]);return RemoveRowsCommand}();exports.RemoveRowsCommand=RemoveRowsCommand;var AddRowsCommand=function(){function AddRowsCommand(sheet,indexes){_classCallCheck(this,AddRowsCommand);this.sheet=sheet;this.indexes=indexes}_createClass(AddRowsCommand,[{key:"normalizedIndexes",value:function normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}},{key:"rowsSpans",value:function rowsSpans(){var _this2=this;return this.normalizedIndexes().map((function(normalizedIndex){return _Span.RowsSpan.fromNumberOfRows(_this2.sheet,normalizedIndex[0],normalizedIndex[1])}))}}]);return AddRowsCommand}();exports.AddRowsCommand=AddRowsCommand;var AddColumnsCommand=function(){function AddColumnsCommand(sheet,indexes){_classCallCheck(this,AddColumnsCommand);this.sheet=sheet;this.indexes=indexes}_createClass(AddColumnsCommand,[{key:"normalizedIndexes",value:function normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}},{key:"columnsSpans",value:function columnsSpans(){var _this3=this;return this.normalizedIndexes().map((function(normalizedIndex){return _Span.ColumnsSpan.fromNumberOfColumns(_this3.sheet,normalizedIndex[0],normalizedIndex[1])}))}}]);return AddColumnsCommand}();exports.AddColumnsCommand=AddColumnsCommand;var RemoveColumnsCommand=function(){function RemoveColumnsCommand(sheet,indexes){_classCallCheck(this,RemoveColumnsCommand);this.sheet=sheet;this.indexes=indexes}_createClass(RemoveColumnsCommand,[{key:"normalizedIndexes",value:function normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}},{key:"columnsSpans",value:function columnsSpans(){var _this4=this;return this.normalizedIndexes().map((function(normalizedIndex){return _Span.ColumnsSpan.fromNumberOfColumns(_this4.sheet,normalizedIndex[0],normalizedIndex[1])}))}}]);return RemoveColumnsCommand}();exports.RemoveColumnsCommand=RemoveColumnsCommand;var Operations=function(){function Operations(dependencyGraph,columnSearch,cellContentParser,parser,stats,lazilyTransformingAstService,namedExpressions,config){_classCallCheck(this,Operations);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.cellContentParser=cellContentParser;this.parser=parser;this.stats=stats;this.lazilyTransformingAstService=lazilyTransformingAstService;this.namedExpressions=namedExpressions;this.config=config;this.changes=_ContentChanges.ContentChanges.empty();this.allocateNamedExpressionAddressSpace()}_createClass(Operations,[{key:"removeRows",value:function removeRows(cmd){var rowsRemovals=[];var _iterator=_createForOfIteratorHelper(cmd.rowsSpans()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var rowsToRemove=_step.value;var rowsRemoval=this.doRemoveRows(rowsToRemove);if(rowsRemoval){rowsRemovals.push(rowsRemoval)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return rowsRemovals}},{key:"addRows",value:function addRows(cmd){var _iterator2=_createForOfIteratorHelper(cmd.rowsSpans()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var addedRows=_step2.value;this.doAddRows(addedRows)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},{key:"addColumns",value:function addColumns(cmd){var _iterator3=_createForOfIteratorHelper(cmd.columnsSpans()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var addedColumns=_step3.value;this.doAddColumns(addedColumns)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},{key:"removeColumns",value:function removeColumns(cmd){var columnsRemovals=[];var _iterator4=_createForOfIteratorHelper(cmd.columnsSpans()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var columnsToRemove=_step4.value;var columnsRemoval=this.doRemoveColumns(columnsToRemove);if(columnsRemoval){columnsRemovals.push(columnsRemoval)}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}return columnsRemovals}},{key:"removeSheet",value:function removeSheet(sheetName){var _this5=this;var sheetId=this.sheetMapping.fetch(sheetName);this.dependencyGraph.removeSheet(sheetId);var version;this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _RemoveSheetTransformer.RemoveSheetTransformer(sheetId);transformation.performEagerTransformations(_this5.dependencyGraph,_this5.parser);version=_this5.lazilyTransformingAstService.addTransformation(transformation)}));this.sheetMapping.removeSheet(sheetId);this.columnSearch.removeSheet(sheetId);return version}},{key:"clearSheet",value:function clearSheet(sheetId){this.dependencyGraph.clearSheet(sheetId);this.columnSearch.removeSheet(sheetId)}},{key:"addSheet",value:function addSheet(name){var sheetId=this.sheetMapping.addSheet(name);var sheet=[];this.dependencyGraph.addressMapping.autoAddSheet(sheetId,sheet,(0,_Sheet.findBoundaries)(sheet));return this.sheetMapping.fetchDisplayName(sheetId)}},{key:"renameSheet",value:function renameSheet(sheetId,newName){return this.sheetMapping.renameSheet(sheetId,newName)}},{key:"moveRows",value:function moveRows(sheet,startRow,numberOfRows,targetRow){var rowsToAdd=_Span.RowsSpan.fromNumberOfRows(sheet,targetRow,numberOfRows);this.doAddRows(rowsToAdd);if(targetRow<startRow){startRow+=numberOfRows}var startAddress=(0,_Cell.simpleCellAddress)(sheet,0,startRow);var targetAddress=(0,_Cell.simpleCellAddress)(sheet,0,targetRow);this.moveCells(startAddress,Number.POSITIVE_INFINITY,numberOfRows,targetAddress);var rowsToRemove=_Span.RowsSpan.fromNumberOfRows(sheet,startRow,numberOfRows);this.doRemoveRows(rowsToRemove)}},{key:"moveColumns",value:function moveColumns(sheet,startColumn,numberOfColumns,targetColumn){var columnsToAdd=_Span.ColumnsSpan.fromNumberOfColumns(sheet,targetColumn,numberOfColumns);this.doAddColumns(columnsToAdd);if(targetColumn<startColumn){startColumn+=numberOfColumns}var startAddress=(0,_Cell.simpleCellAddress)(sheet,startColumn,0);var targetAddress=(0,_Cell.simpleCellAddress)(sheet,targetColumn,0);this.moveCells(startAddress,numberOfColumns,Number.POSITIVE_INFINITY,targetAddress);var columnsToRemove=_Span.ColumnsSpan.fromNumberOfColumns(sheet,startColumn,numberOfColumns);this.doRemoveColumns(columnsToRemove)}},{key:"moveCells",value:function moveCells(sourceLeftCorner,width,height,destinationLeftCorner){var _this6=this;this.ensureItIsPossibleToMoveCells(sourceLeftCorner,width,height,destinationLeftCorner);var sourceRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(sourceLeftCorner,width,height);var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(destinationLeftCorner,width,height);this.dependencyGraph.breakNumericMatricesInRange(sourceRange);this.dependencyGraph.breakNumericMatricesInRange(targetRange);var toRight=destinationLeftCorner.col-sourceLeftCorner.col;var toBottom=destinationLeftCorner.row-sourceLeftCorner.row;var toSheet=destinationLeftCorner.sheet;var currentDataAtTarget=this.getRangeClipboardCells(targetRange);var valuesToRemove=this.dependencyGraph.valuesFromRange(targetRange);this.columnSearch.removeValues(valuesToRemove);var valuesToMove=this.dependencyGraph.valuesFromRange(sourceRange);this.columnSearch.moveValues(valuesToMove,toRight,toBottom,toSheet);var version;this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _MoveCellsTransformer.MoveCellsTransformer(sourceRange,toRight,toBottom,toSheet);transformation.performEagerTransformations(_this6.dependencyGraph,_this6.parser);version=_this6.lazilyTransformingAstService.addTransformation(transformation)}));this.dependencyGraph.moveCells(sourceRange,toRight,toBottom,toSheet);var addedGlobalNamedExpressions=this.updateNamedExpressionsForMovedCells(sourceLeftCorner,width,height,destinationLeftCorner);return{version:version,overwrittenCellsData:currentDataAtTarget,addedGlobalNamedExpressions:addedGlobalNamedExpressions}}},{key:"addNamedExpression",value:function addNamedExpression(expressionName,expression,sheetId,options){this.storeNamedExpressionInCell(this.namedExpressions.lookupNextAddress(expressionName,sheetId),expression);var namedExpression=this.namedExpressions.addNamedExpression(expressionName,sheetId,options);this.adjustNamedExpressionEdges(namedExpression,expressionName,sheetId)}},{key:"restoreNamedExpression",value:function restoreNamedExpression(namedExpression,content,sheetId){var expressionName=namedExpression.displayName;var options=namedExpression.options;this.restoreCell(namedExpression.address,content);var restoredNamedExpression=this.namedExpressions.addNamedExpression(expressionName,sheetId,options);this.adjustNamedExpressionEdges(restoredNamedExpression,expressionName,sheetId)}},{key:"changeNamedExpressionExpression",value:function changeNamedExpressionExpression(expressionName,newExpression,sheetId,options){var namedExpression=this.namedExpressions.namedExpressionForScope(expressionName,sheetId);if(!namedExpression){throw new _errors2.NamedExpressionDoesNotExistError(expressionName)}var oldNamedExpression=namedExpression.copy();namedExpression.options=options;var content=this.getClipboardCell(namedExpression.address);this.storeNamedExpressionInCell(namedExpression.address,newExpression);return[oldNamedExpression,content]}},{key:"removeNamedExpression",value:function removeNamedExpression(expressionName,sheetId){var namedExpression=this.namedExpressions.namedExpressionForScope(expressionName,sheetId);if(!namedExpression){throw new _errors2.NamedExpressionDoesNotExistError(expressionName)}this.namedExpressions.remove(namedExpression.displayName,sheetId);var content=this.getClipboardCell(namedExpression.address);if(sheetId!==undefined){var globalNamedExpression=this.namedExpressions.workbookNamedExpressionOrPlaceholder(expressionName);this.dependencyGraph.exchangeNode(namedExpression.address,globalNamedExpression.address)}else{this.dependencyGraph.setCellEmpty(namedExpression.address)}return[namedExpression,content]}},{key:"ensureItIsPossibleToMoveCells",value:function ensureItIsPossibleToMoveCells(sourceLeftCorner,width,height,destinationLeftCorner){if((0,_Cell.invalidSimpleCellAddress)(sourceLeftCorner)||!(isPositiveInteger(width)&&isPositiveInteger(height)||isRowOrColumnRange(sourceLeftCorner,width,height))||(0,_Cell.invalidSimpleCellAddress)(destinationLeftCorner)||!this.sheetMapping.hasSheetWithId(sourceLeftCorner.sheet)||!this.sheetMapping.hasSheetWithId(destinationLeftCorner.sheet)){throw new _errors2.InvalidArgumentsError("a valid range of cells to move.")}var sourceRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(sourceLeftCorner,width,height);var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(destinationLeftCorner,width,height);if(targetRange.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows)){throw new _errors2.SheetSizeLimitExceededError}if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(sourceRange)){throw new _errors2.SourceLocationHasMatrixError}if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(targetRange)){throw new _errors2.TargetLocationHasMatrixError}}},{key:"restoreClipboardCells",value:function restoreClipboardCells(sourceSheetId,cells){var addedNamedExpressions=[];var _iterator5=_createForOfIteratorHelper(cells),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),address=_step5$value[0],clipboardCell=_step5$value[1];this.restoreCell(address,clipboardCell);if(clipboardCell.type===_ClipboardOperations.ClipboardCellType.FORMULA){var _this$parser$fetchCac=this.parser.fetchCachedResult(clipboardCell.hash),dependencies=_this$parser$fetchCac.dependencies;addedNamedExpressions.push.apply(addedNamedExpressions,_toConsumableArray(this.updateNamedExpressionsForTargetAddress(sourceSheetId,address,dependencies)))}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return addedNamedExpressions}},{key:"restoreCell",value:function restoreCell(address,clipboardCell){switch(clipboardCell.type){case _ClipboardOperations.ClipboardCellType.VALUE:{this.setValueToCell(clipboardCell.value,address);break}case _ClipboardOperations.ClipboardCellType.FORMULA:{this.setFormulaToCellFromCache(clipboardCell.hash,address);break}case _ClipboardOperations.ClipboardCellType.EMPTY:{this.setCellEmpty(address);break}case _ClipboardOperations.ClipboardCellType.PARSING_ERROR:{this.setParsingErrorToCell(clipboardCell.rawInput,clipboardCell.errors,address);break}}}},{key:"doRemoveRows",value:function doRemoveRows(rowsToRemove){var _this7=this;if(this.rowEffectivelyNotInSheet(rowsToRemove.rowStart,rowsToRemove.sheet)){return}var removedCells=[];var _iterator6=_createForOfIteratorHelper(this.dependencyGraph.entriesFromRowsSpan(rowsToRemove)),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _step6$value=_slicedToArray(_step6.value,1),address=_step6$value[0];removedCells.push({address:address,cellType:this.getClipboardCell(address)})}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}this.dependencyGraph.removeRows(rowsToRemove);var version;this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _RemoveRowsTransformer.RemoveRowsTransformer(rowsToRemove);transformation.performEagerTransformations(_this7.dependencyGraph,_this7.parser);version=_this7.lazilyTransformingAstService.addTransformation(transformation)}));return{version:version,removedCells:removedCells,rowFrom:rowsToRemove.rowStart,rowCount:rowsToRemove.numberOfRows}}},{key:"doRemoveColumns",value:function doRemoveColumns(columnsToRemove){var _this8=this;if(this.columnEffectivelyNotInSheet(columnsToRemove.columnStart,columnsToRemove.sheet)){return}var removedCells=[];var _iterator7=_createForOfIteratorHelper(this.dependencyGraph.entriesFromColumnsSpan(columnsToRemove)),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step7$value=_slicedToArray(_step7.value,1),address=_step7$value[0];removedCells.push({address:address,cellType:this.getClipboardCell(address)})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.dependencyGraph.removeColumns(columnsToRemove);this.columnSearch.removeColumns(columnsToRemove);var version;this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _RemoveColumnsTransformer.RemoveColumnsTransformer(columnsToRemove);transformation.performEagerTransformations(_this8.dependencyGraph,_this8.parser);version=_this8.lazilyTransformingAstService.addTransformation(transformation)}));return{version:version,removedCells:removedCells,columnFrom:columnsToRemove.columnStart,columnCount:columnsToRemove.numberOfColumns}}},{key:"doAddRows",value:function doAddRows(addedRows){var _this9=this;if(this.rowEffectivelyNotInSheet(addedRows.rowStart,addedRows.sheet)){return}this.dependencyGraph.addRows(addedRows);this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _AddRowsTransformer.AddRowsTransformer(addedRows);transformation.performEagerTransformations(_this9.dependencyGraph,_this9.parser);_this9.lazilyTransformingAstService.addTransformation(transformation)}))}},{key:"doAddColumns",value:function doAddColumns(addedColumns){var _this10=this;if(this.columnEffectivelyNotInSheet(addedColumns.columnStart,addedColumns.sheet)){return}this.dependencyGraph.addColumns(addedColumns);this.columnSearch.addColumns(addedColumns);this.stats.measure(_statistics.StatType.TRANSFORM_ASTS,(function(){var transformation=new _AddColumnsTransformer.AddColumnsTransformer(addedColumns);transformation.performEagerTransformations(_this10.dependencyGraph,_this10.parser);_this10.lazilyTransformingAstService.addTransformation(transformation)}))}},{key:"getClipboardCell",value:function getClipboardCell(address){var vertex=this.dependencyGraph.getCell(address);if(vertex===null||vertex instanceof _DependencyGraph.EmptyCellVertex){return{type:_ClipboardOperations.ClipboardCellType.EMPTY}}else if(vertex instanceof _DependencyGraph.ValueCellVertex){return{type:_ClipboardOperations.ClipboardCellType.VALUE,value:vertex.getCellValue()}}else if(vertex instanceof _DependencyGraph.MatrixVertex){return{type:_ClipboardOperations.ClipboardCellType.VALUE,value:vertex.getMatrixCellValue(address)}}else if(vertex instanceof _DependencyGraph.FormulaCellVertex){return{type:_ClipboardOperations.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(vertex.getFormula(this.lazilyTransformingAstService))}}else if(vertex instanceof _DependencyGraph.ParsingErrorVertex){return{type:_ClipboardOperations.ClipboardCellType.PARSING_ERROR,rawInput:vertex.rawInput,errors:vertex.errors}}throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function getSheetClipboardCells(sheet){var sheetHeight=this.dependencyGraph.getSheetHeight(sheet);var sheetWidth=this.dependencyGraph.getSheetWidth(sheet);var arr=new Array(sheetHeight);for(var i=0;i<sheetHeight;i++){arr[i]=new Array(sheetWidth);for(var j=0;j<sheetWidth;j++){var address=(0,_Cell.simpleCellAddress)(sheet,j,i);arr[i][j]=this.getClipboardCell(address)}}return arr}},{key:"getRangeClipboardCells",value:function getRangeClipboardCells(range){var result=[];var _iterator8=_createForOfIteratorHelper(range.addresses(this.dependencyGraph)),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var address=_step8.value;result.push([address,this.getClipboardCell(address)])}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return result}},{key:"setCellContent",value:function setCellContent(address,newCellContent){var parsedCellContent=this.cellContentParser.parse(newCellContent);var vertex=this.dependencyGraph.getCell(address);if(vertex instanceof _DependencyGraph.MatrixVertex&&!vertex.isFormula()&&!(parsedCellContent instanceof _CellContentParser.CellContent.Number)){this.dependencyGraph.breakNumericMatrix(vertex);vertex=this.dependencyGraph.getCell(address)}if(vertex instanceof _DependencyGraph.MatrixVertex&&!vertex.isFormula()&&parsedCellContent instanceof _CellContentParser.CellContent.Number){var newValue=parsedCellContent.value;var oldValue=this.dependencyGraph.getCellValue(address);this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(vertex);vertex.setMatrixCellValue(address,newValue);this.columnSearch.change(oldValue,newValue,address);this.changes.addChange(newValue,address)}else if(!(vertex instanceof _DependencyGraph.MatrixVertex)&&parsedCellContent instanceof _CellContentParser.CellContent.MatrixFormula){var _this$parser$parse=this.parser.parse(parsedCellContent.formula,address),ast=_this$parser$parse.ast,errors=_this$parser$parse.errors,dependencies=_this$parser$parse.dependencies;if(errors.length>0){this.dependencyGraph.setParsingErrorToCell(address,new _DependencyGraph.ParsingErrorVertex(errors,parsedCellContent.formulaWithBraces()))}else{var newVertex=(0,_GraphBuilder.buildMatrixVertex)(ast,address);if(newVertex instanceof _DependencyGraph.ValueCellVertex){throw Error("What if new matrix vertex is not properly constructed?")}this.dependencyGraph.addNewMatrixVertex(newVertex);this.dependencyGraph.processCellDependencies((0,_absolutizeDependencies.absolutizeDependencies)(dependencies,address),newVertex);this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(newVertex)}}else if(!(vertex instanceof _DependencyGraph.MatrixVertex)){if(parsedCellContent instanceof _CellContentParser.CellContent.Formula){var _this$parser$parse2=this.parser.parse(parsedCellContent.formula,address),_ast=_this$parser$parse2.ast,_errors=_this$parser$parse2.errors,hasVolatileFunction=_this$parser$parse2.hasVolatileFunction,hasStructuralChangeFunction=_this$parser$parse2.hasStructuralChangeFunction,_dependencies=_this$parser$parse2.dependencies;if(_errors.length>0){this.dependencyGraph.setParsingErrorToCell(address,new _DependencyGraph.ParsingErrorVertex(_errors,parsedCellContent.formula))}else{this.dependencyGraph.setFormulaToCell(address,_ast,(0,_absolutizeDependencies.absolutizeDependencies)(_dependencies,address),hasVolatileFunction,hasStructuralChangeFunction)}}else if(parsedCellContent instanceof _CellContentParser.CellContent.Empty){this.setCellEmpty(address)}else if(parsedCellContent instanceof _CellContentParser.CellContent.MatrixFormula){throw new Error("Cant happen")}else{this.setValueToCell(parsedCellContent.value,address)}}else{throw new Error("Illegal operation")}}},{key:"setSheetContent",value:function setSheetContent(sheetId,newSheetContent){this.clearSheet(sheetId);for(var i=0;i<newSheetContent.length;i++){for(var j=0;j<newSheetContent[i].length;j++){var address=(0,_Cell.simpleCellAddress)(sheetId,j,i);this.setCellContent(address,newSheetContent[i][j])}}}},{key:"setValueToCell",value:function setValueToCell(value,address){var oldValue=this.dependencyGraph.getCellValue(address);this.dependencyGraph.setValueToCell(address,value);this.columnSearch.change(oldValue,value,address);this.changes.addChange(value,address)}},{key:"setCellEmpty",value:function setCellEmpty(address){var oldValue=this.dependencyGraph.getCellValue(address);this.columnSearch.remove(oldValue,address);this.changes.addChange(_Cell.EmptyValue,address);this.dependencyGraph.setCellEmpty(address)}},{key:"setFormulaToCellFromCache",value:function setFormulaToCellFromCache(formulaHash,address){var _this$parser$fetchCac2=this.parser.fetchCachedResult(formulaHash),ast=_this$parser$fetchCac2.ast,hasVolatileFunction=_this$parser$fetchCac2.hasVolatileFunction,hasStructuralChangeFunction=_this$parser$fetchCac2.hasStructuralChangeFunction,dependencies=_this$parser$fetchCac2.dependencies;this.dependencyGraph.setFormulaToCell(address,ast,(0,_absolutizeDependencies.absolutizeDependencies)(dependencies,address),hasVolatileFunction,hasStructuralChangeFunction)}},{key:"setParsingErrorToCell",value:function setParsingErrorToCell(rawInput,errors,address){this.dependencyGraph.setParsingErrorToCell(address,new _DependencyGraph.ParsingErrorVertex(errors,rawInput))}},{key:"rowEffectivelyNotInSheet",value:function rowEffectivelyNotInSheet(row,sheet){var height=this.dependencyGraph.addressMapping.getHeight(sheet);return row>=height}},{key:"getAndClearContentChanges",value:function getAndClearContentChanges(){var changes=this.changes;this.changes=_ContentChanges.ContentChanges.empty();return changes}},{key:"forceApplyPostponedTransformations",value:function forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"columnEffectivelyNotInSheet",value:function columnEffectivelyNotInSheet(column,sheet){var width=this.dependencyGraph.addressMapping.getWidth(sheet);return column>=width}},{key:"adjustNamedExpressionEdges",value:function adjustNamedExpressionEdges(namedExpression,expressionName,sheetId){if(sheetId!==undefined){var localVertex=this.dependencyGraph.fetchCellOrCreateEmpty(namedExpression.address);var globalNamedExpression=this.namedExpressions.workbookNamedExpressionOrPlaceholder(expressionName);var globalVertex=this.dependencyGraph.fetchCellOrCreateEmpty(globalNamedExpression.address);var _iterator9=_createForOfIteratorHelper(this.dependencyGraph.graph.adjacentNodes(globalVertex)),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var adjacentNode=_step9.value;if((adjacentNode instanceof _DependencyGraph.FormulaCellVertex||adjacentNode instanceof _DependencyGraph.MatrixVertex)&&adjacentNode.cellAddress.sheet===sheetId){var ast=adjacentNode.getFormula(this.lazilyTransformingAstService);if(ast){var formulaAddress=adjacentNode.getAddress(this.lazilyTransformingAstService);var _this$parser$fetchCac3=this.parser.fetchCachedResultForAst(ast),dependencies=_this$parser$fetchCac3.dependencies;var _iterator10=_createForOfIteratorHelper((0,_absolutizeDependencies.absolutizeDependencies)(dependencies,formulaAddress)),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var dependency=_step10.value;if(dependency instanceof _parser.NamedExpressionDependency&&dependency.name.toLowerCase()===namedExpression.displayName.toLowerCase()){this.dependencyGraph.graph.removeEdge(globalVertex,adjacentNode);this.dependencyGraph.graph.addEdge(localVertex,adjacentNode)}}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}}}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}}},{key:"storeNamedExpressionInCell",value:function storeNamedExpressionInCell(address,expression){var parsedCellContent=this.cellContentParser.parse(expression);if(parsedCellContent instanceof _CellContentParser.CellContent.MatrixFormula){throw new Error("Matrix formulas are not supported")}else if(parsedCellContent instanceof _CellContentParser.CellContent.Formula){var parsingResult=this.parser.parse(parsedCellContent.formula,(0,_Cell.simpleCellAddress)(-1,0,0));if((0,_NamedExpressions.doesContainRelativeReferences)(parsingResult.ast)){throw new _errors2.NoRelativeAddressesAllowedError}var ast=parsingResult.ast,hasVolatileFunction=parsingResult.hasVolatileFunction,hasStructuralChangeFunction=parsingResult.hasStructuralChangeFunction,dependencies=parsingResult.dependencies;this.dependencyGraph.setFormulaToCell(address,ast,(0,_absolutizeDependencies.absolutizeDependencies)(dependencies,address),hasVolatileFunction,hasStructuralChangeFunction)}else{if(parsedCellContent instanceof _CellContentParser.CellContent.Empty){this.setCellEmpty(address)}else{this.setValueToCell(parsedCellContent.value,address)}}}},{key:"updateNamedExpressionsForMovedCells",value:function updateNamedExpressionsForMovedCells(sourceLeftCorner,width,height,destinationLeftCorner){if(sourceLeftCorner.sheet===destinationLeftCorner.sheet){return[]}var addedGlobalNamedExpressions=[];var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(destinationLeftCorner,width,height);var _iterator11=_createForOfIteratorHelper(targetRange.addresses(this.dependencyGraph)),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var formulaAddress=_step11.value;var vertex=this.addressMapping.fetchCell(formulaAddress);if(vertex instanceof _DependencyGraph.FormulaCellVertex&&formulaAddress.sheet!==sourceLeftCorner.sheet){var ast=vertex.getFormula(this.lazilyTransformingAstService);var _this$parser$fetchCac4=this.parser.fetchCachedResultForAst(ast),dependencies=_this$parser$fetchCac4.dependencies;addedGlobalNamedExpressions.push.apply(addedGlobalNamedExpressions,_toConsumableArray(this.updateNamedExpressionsForTargetAddress(sourceLeftCorner.sheet,formulaAddress,dependencies)))}}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}return addedGlobalNamedExpressions}},{key:"updateNamedExpressionsForTargetAddress",value:function updateNamedExpressionsForTargetAddress(sourceSheet,targetAddress,dependencies){if(sourceSheet===targetAddress.sheet){return[]}var addedGlobalNamedExpressions=[];var vertex=this.addressMapping.fetchCell(targetAddress);var _iterator12=_createForOfIteratorHelper((0,_absolutizeDependencies.absolutizeDependencies)(dependencies,targetAddress)),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var namedExpressionDependency=_step12.value;if(!(namedExpressionDependency instanceof _parser.NamedExpressionDependency)){continue}var expressionName=namedExpressionDependency.name;var sourceVertex=this.dependencyGraph.fetchNamedExpressionVertex(expressionName,sourceSheet);var namedExpressionInTargetScope=this.namedExpressions.isExpressionInScope(expressionName,targetAddress.sheet);var targetScopeExpressionVertex=namedExpressionInTargetScope?this.dependencyGraph.fetchNamedExpressionVertex(expressionName,targetAddress.sheet):this.copyOrFetchGlobalNamedExpressionVertex(expressionName,sourceVertex,addedGlobalNamedExpressions);if(targetScopeExpressionVertex!==sourceVertex){this.dependencyGraph.graph.softRemoveEdge(sourceVertex,vertex);this.dependencyGraph.graph.addEdge(targetScopeExpressionVertex,vertex)}}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}return addedGlobalNamedExpressions}},{key:"allocateNamedExpressionAddressSpace",value:function allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(-1,new _DependencyGraph.SparseStrategy(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function copyOrFetchGlobalNamedExpressionVertex(expressionName,sourceVertex,addedNamedExpressions){var expression=this.namedExpressions.namedExpressionForScope(expressionName);if(expression===undefined){expression=this.namedExpressions.addNamedExpression(expressionName);addedNamedExpressions.push(expression.normalizeExpressionName());if(sourceVertex instanceof _DependencyGraph.FormulaCellVertex){var parsingResult=this.parser.fetchCachedResultForAst(sourceVertex.getFormula(this.lazilyTransformingAstService));var ast=parsingResult.ast,hasVolatileFunction=parsingResult.hasVolatileFunction,hasStructuralChangeFunction=parsingResult.hasStructuralChangeFunction,dependencies=parsingResult.dependencies;this.dependencyGraph.setFormulaToCell(expression.address,ast,(0,_absolutizeDependencies.absolutizeDependencies)(dependencies,expression.address),hasVolatileFunction,hasStructuralChangeFunction)}else if(sourceVertex instanceof _DependencyGraph.EmptyCellVertex){this.setCellEmpty(expression.address)}else if(sourceVertex instanceof _DependencyGraph.ValueCellVertex){this.setValueToCell(sourceVertex.getCellValue(),expression.address)}}return this.dependencyGraph.fetchCellOrCreateEmpty(expression.address)}},{key:"sheetMapping",get:function get(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function get(){return this.dependencyGraph.addressMapping}}]);return Operations}();exports.Operations=Operations;function normalizeRemovedIndexes(indexes){if(indexes.length<=1){return indexes}var sorted=indexes.sort((function(_ref,_ref2){var _ref3=_slicedToArray(_ref,1),a=_ref3[0];var _ref4=_slicedToArray(_ref2,1),b=_ref4[0];return a<b?-1:a>b?1:0}));var merged=sorted.reduce((function(acc,_ref5){var _ref6=_slicedToArray(_ref5,2),startIndex=_ref6[0],amount=_ref6[1];var previous=acc[acc.length-1];var lastIndex=previous[0]+previous[1];if(startIndex<=lastIndex){previous[1]+=Math.max(0,amount-(lastIndex-startIndex))}else{acc.push([startIndex,amount])}return acc}),[sorted[0]]);var shift=0;for(var i=0;i<merged.length;++i){merged[i][0]-=shift;shift+=merged[i][1]}return merged}function normalizeAddedIndexes(indexes){if(indexes.length<=1){return indexes}var sorted=indexes.sort((function(_ref7,_ref8){var _ref9=_slicedToArray(_ref7,1),a=_ref9[0];var _ref10=_slicedToArray(_ref8,1),b=_ref10[0];return a<b?-1:a>b?1:0}));var merged=sorted.reduce((function(acc,_ref11){var _ref12=_slicedToArray(_ref11,2),startIndex=_ref12[0],amount=_ref12[1];var previous=acc[acc.length-1];if(startIndex===previous[0]){previous[1]=Math.max(previous[1],amount)}else{acc.push([startIndex,amount])}return acc}),[sorted[0]]);var shift=0;for(var i=0;i<merged.length;++i){merged[i][0]+=shift;shift+=merged[i][1]}return merged}function isPositiveInteger(x){return Number.isInteger(x)&&x>0}function isRowOrColumnRange(leftCorner,width,height){return leftCorner.row===0&&isPositiveInteger(width)&&height===Number.POSITIVE_INFINITY||leftCorner.col===0&&isPositiveInteger(height)&&width===Number.POSITIVE_INFINITY}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.ClipboardOperations=exports.ClipboardCellType=void 0;__webpack_require__(125);var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _errors=__webpack_require__(183);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ClipboardOperationType;(function(ClipboardOperationType){ClipboardOperationType[ClipboardOperationType["COPY"]=0]="COPY";ClipboardOperationType[ClipboardOperationType["CUT"]=1]="CUT"})(ClipboardOperationType||(ClipboardOperationType={}));var ClipboardCellType;exports.ClipboardCellType=ClipboardCellType;(function(ClipboardCellType){ClipboardCellType[ClipboardCellType["VALUE"]=0]="VALUE";ClipboardCellType[ClipboardCellType["EMPTY"]=1]="EMPTY";ClipboardCellType[ClipboardCellType["FORMULA"]=2]="FORMULA";ClipboardCellType[ClipboardCellType["PARSING_ERROR"]=3]="PARSING_ERROR"})(ClipboardCellType||(exports.ClipboardCellType=ClipboardCellType={}));var Clipboard=function(){function Clipboard(sourceLeftCorner,width,height,type,content){_classCallCheck(this,Clipboard);this.sourceLeftCorner=sourceLeftCorner;this.width=width;this.height=height;this.type=type;this.content=content}_createClass(Clipboard,[{key:"getContent",value:regeneratorRuntime.mark((function getContent(leftCorner){var y,x;return regeneratorRuntime.wrap((function getContent$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.content===undefined)){_context.next=4;break}return _context.abrupt("return");case 4:y=0;case 5:if(!(y<this.height)){_context.next=16;break}x=0;case 7:if(!(x<this.width)){_context.next=13;break}_context.next=10;return[(0,_Cell.simpleCellAddress)(leftCorner.sheet,leftCorner.col+x,leftCorner.row+y),this.content[y][x]];case 10:++x;_context.next=7;break;case 13:++y;_context.next=5;break;case 16:case"end":return _context.stop()}}}),getContent,this)}))}]);return Clipboard}();var ClipboardOperations=function(){function ClipboardOperations(dependencyGraph,operations,parser,lazilyTransformingAstService,config){_classCallCheck(this,ClipboardOperations);this.dependencyGraph=dependencyGraph;this.operations=operations;this.parser=parser;this.lazilyTransformingAstService=lazilyTransformingAstService;this.config=config}_createClass(ClipboardOperations,[{key:"cut",value:function cut(leftCorner,width,height){this.clipboard=new Clipboard(leftCorner,width,height,ClipboardOperationType.CUT)}},{key:"copy",value:function copy(leftCorner,width,height){var content=[];for(var y=0;y<height;++y){content[y]=[];for(var x=0;x<width;++x){var clipboardCell=this.operations.getClipboardCell((0,_Cell.simpleCellAddress)(leftCorner.sheet,leftCorner.col+x,leftCorner.row+y));content[y].push(clipboardCell)}}this.clipboard=new Clipboard(leftCorner,width,height,ClipboardOperationType.COPY,content)}},{key:"abortCut",value:function abortCut(){if(this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT){this.clear()}}},{key:"clear",value:function clear(){this.clipboard=undefined}},{key:"ensureItIsPossibleToCopyPaste",value:function ensureItIsPossibleToCopyPaste(destinationLeftCorner){if(this.clipboard===undefined){return}if((0,_Cell.invalidSimpleCellAddress)(destinationLeftCorner)||!this.dependencyGraph.sheetMapping.hasSheetWithId(destinationLeftCorner.sheet)){throw new _errors.InvalidArgumentsError("a valid target address.")}var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(destinationLeftCorner,this.clipboard.width,this.clipboard.height);if(targetRange.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows)){throw new _errors.SheetSizeLimitExceededError}if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(targetRange)){throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function isCutClipboard(){return this.clipboard!==undefined&&this.clipboard.type===ClipboardOperationType.CUT}},{key:"isCopyClipboard",value:function isCopyClipboard(){return this.clipboard!==undefined&&this.clipboard.type===ClipboardOperationType.COPY}}]);return ClipboardOperations}();exports.ClipboardOperations=ClipboardOperations},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.ContentChanges=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var ContentChanges=function(){function ContentChanges(){_classCallCheck(this,ContentChanges);this.changes=[]}_createClass(ContentChanges,[{key:"addAll",value:function addAll(other){var _this$changes;(_this$changes=this.changes).push.apply(_this$changes,_toConsumableArray(other.changes));return this}},{key:"addMatrixChange",value:function addMatrixChange(newValue,address){var _iterator=_createForOfIteratorHelper(newValue.generateValues(address)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),matrixValue=_step$value[0],cellAddress=_step$value[1];this.addSingleCellValue(matrixValue,cellAddress)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"addChange",value:function addChange(newValue,address){this.addSingleCellValue(newValue,address)}},{key:"add",value:function add(){var _this$changes2;(_this$changes2=this.changes).push.apply(_this$changes2,arguments)}},{key:"exportChanges",value:function exportChanges(exporter){var _this=this;var ret=[];this.changes.forEach((function(e,i){ret[i]=exporter.exportChange(_this.changes[i])}));return ret}},{key:"getChanges",value:function getChanges(){return this.changes}},{key:"isEmpty",value:function isEmpty(){return this.changes===[]}},{key:"addSingleCellValue",value:function addSingleCellValue(value,address){this.add({sheet:address.sheet,col:address.col,row:address.row,value:value})}}],[{key:"empty",value:function empty(){return new ContentChanges}}]);return ContentChanges}();exports.ContentChanges=ContentChanges},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(193);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(133);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.buildMatrixVertex=buildMatrixVertex;exports.MatrixDetectionStrategy=exports.SimpleStrategy=exports.GraphBuilder=void 0;var _absolutizeDependencies=__webpack_require__(175);var _Cell=__webpack_require__(106);var _CellContentParser=__webpack_require__(213);var _DependencyGraph=__webpack_require__(107);var _GraphBuilderMatrixHeuristic=__webpack_require__(224);var _Matrix=__webpack_require__(189);var _statistics=__webpack_require__(176);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var GraphBuilder=function(){function GraphBuilder(dependencyGraph,columnSearch,parser,cellContentParser,config,stats){_classCallCheck(this,GraphBuilder);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.parser=parser;this.cellContentParser=cellContentParser;this.config=config;this.stats=stats;if(this.config.matrixDetection){this.buildStrategy=new MatrixDetectionStrategy(this.dependencyGraph,this.columnSearch,this.parser,this.stats,config.matrixDetectionThreshold,this.cellContentParser)}else{this.buildStrategy=new SimpleStrategy(this.dependencyGraph,this.columnSearch,this.parser,this.stats,this.cellContentParser)}}_createClass(GraphBuilder,[{key:"buildGraph",value:function buildGraph(sheets){var dependencies=this.buildStrategy.run(sheets);this.processDependencies(dependencies)}},{key:"processDependencies",value:function processDependencies(dependencies){var _this=this;dependencies.forEach((function(cellDependencies,endVertex){_this.dependencyGraph.processCellDependencies(cellDependencies,endVertex)}))}}]);return GraphBuilder}();exports.GraphBuilder=GraphBuilder;var SimpleStrategy=function(){function SimpleStrategy(dependencyGraph,columnIndex,parser,stats,cellContentParser){_classCallCheck(this,SimpleStrategy);this.dependencyGraph=dependencyGraph;this.columnIndex=columnIndex;this.parser=parser;this.stats=stats;this.cellContentParser=cellContentParser}_createClass(SimpleStrategy,[{key:"run",value:function run(sheets){var _this2=this;var dependencies=new Map;for(var sheetName in sheets){var sheetId=this.dependencyGraph.getSheetId(sheetName);var sheet=sheets[sheetName];for(var i=0;i<sheet.length;++i){var row=sheet[i];var _loop=function _loop(j){var cellContent=row[j];var address=(0,_Cell.simpleCellAddress)(sheetId,j,i);var parsedCellContent=_this2.cellContentParser.parse(cellContent);if(parsedCellContent instanceof _CellContentParser.CellContent.MatrixFormula){if(_this2.dependencyGraph.existsVertex(address)){return"continue"}var parseResult=_this2.stats.measure(_statistics.StatType.PARSER,(function(){return _this2.parser.parse(parsedCellContent.formula,address)}));if(parseResult.errors.length>0){var vertex=new _DependencyGraph.ParsingErrorVertex(parseResult.errors,parsedCellContent.formulaWithBraces());_this2.dependencyGraph.addVertex(address,vertex)}else{var _vertex=buildMatrixVertex(parseResult.ast,address);dependencies.set(_vertex,(0,_absolutizeDependencies.absolutizeDependencies)(parseResult.dependencies,address));_this2.dependencyGraph.addMatrixVertex(address,_vertex)}}else if(parsedCellContent instanceof _CellContentParser.CellContent.Formula){var _parseResult=_this2.stats.measure(_statistics.StatType.PARSER,(function(){return _this2.parser.parse(parsedCellContent.formula,address)}));if(_parseResult.errors.length>0){var _vertex2=new _DependencyGraph.ParsingErrorVertex(_parseResult.errors,parsedCellContent.formula);_this2.dependencyGraph.addVertex(address,_vertex2)}else{var _vertex3=new _DependencyGraph.FormulaCellVertex(_parseResult.ast,address,0);dependencies.set(_vertex3,(0,_absolutizeDependencies.absolutizeDependencies)(_parseResult.dependencies,address));_this2.dependencyGraph.addVertex(address,_vertex3);if(_parseResult.hasVolatileFunction){_this2.dependencyGraph.markAsVolatile(_vertex3)}if(_parseResult.hasStructuralChangeFunction){_this2.dependencyGraph.markAsDependentOnStructureChange(_vertex3)}}}else if(parsedCellContent instanceof _CellContentParser.CellContent.Empty){}else{var _vertex4=new _DependencyGraph.ValueCellVertex(parsedCellContent.value);_this2.columnIndex.add(parsedCellContent.value,address);_this2.dependencyGraph.addVertex(address,_vertex4)}};for(var j=0;j<row.length;++j){var _ret=_loop(j);if(_ret==="continue")continue}}}return dependencies}}]);return SimpleStrategy}();exports.SimpleStrategy=SimpleStrategy;var MatrixDetectionStrategy=function(){function MatrixDetectionStrategy(dependencyGraph,columnSearch,parser,stats,threshold,cellContentParser){_classCallCheck(this,MatrixDetectionStrategy);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.parser=parser;this.stats=stats;this.threshold=threshold;this.cellContentParser=cellContentParser}_createClass(MatrixDetectionStrategy,[{key:"run",value:function run(sheets){var _this3=this;var dependencies=new Map;var matrixHeuristic=new _GraphBuilderMatrixHeuristic.GraphBuilderMatrixHeuristic(this.dependencyGraph,this.columnSearch,this.threshold,this.cellContentParser);for(var sheetName in sheets){var sheetId=this.dependencyGraph.getSheetId(sheetName);var sheet=sheets[sheetName];matrixHeuristic.addSheet(sheetId,{width:this.dependencyGraph.getSheetWidth(sheetId),height:this.dependencyGraph.getSheetHeight(sheetId)});for(var i=0;i<sheet.length;++i){var row=sheet[i];var _loop2=function _loop2(j){var cellContent=row[j];var address=(0,_Cell.simpleCellAddress)(sheetId,j,i);var parsedCellContent=_this3.cellContentParser.parse(cellContent);if(parsedCellContent instanceof _CellContentParser.CellContent.MatrixFormula){if(_this3.dependencyGraph.existsVertex(address)){return"continue"}var parseResult=_this3.stats.measure(_statistics.StatType.PARSER,(function(){return _this3.parser.parse(parsedCellContent.formula,address)}));if(parseResult.errors.length>0){var vertex=new _DependencyGraph.ParsingErrorVertex(parseResult.errors,parsedCellContent.formulaWithBraces());_this3.dependencyGraph.addVertex(address,vertex)}else{var _vertex5=buildMatrixVertex(parseResult.ast,address);dependencies.set(_vertex5,(0,_absolutizeDependencies.absolutizeDependencies)(parseResult.dependencies,address));_this3.dependencyGraph.addMatrixVertex(address,_vertex5)}}else if(parsedCellContent instanceof _CellContentParser.CellContent.Formula){var _parseResult2=_this3.stats.measure(_statistics.StatType.PARSER,(function(){return _this3.parser.parse(parsedCellContent.formula,address)}));if(_parseResult2.errors.length>0){var _vertex6=new _DependencyGraph.ParsingErrorVertex(_parseResult2.errors,parsedCellContent.formula);_this3.dependencyGraph.addVertex(address,_vertex6)}else{var _vertex7=new _DependencyGraph.FormulaCellVertex(_parseResult2.ast,address,0);dependencies.set(_vertex7,(0,_absolutizeDependencies.absolutizeDependencies)(_parseResult2.dependencies,address));_this3.dependencyGraph.addVertex(address,_vertex7)}}else if(parsedCellContent instanceof _CellContentParser.CellContent.Empty){}else if(parsedCellContent instanceof _CellContentParser.CellContent.Number){matrixHeuristic.add(address)}else{var _vertex8=new _DependencyGraph.ValueCellVertex(parsedCellContent.value);_this3.columnSearch.add(parsedCellContent.value,address);_this3.dependencyGraph.addVertex(address,_vertex8)}};for(var j=0;j<row.length;++j){var _ret2=_loop2(j);if(_ret2==="continue")continue}}}this.stats.start(_statistics.StatType.MATRIX_DETECTION);var notMatrices=matrixHeuristic.run(sheets);for(var _i=notMatrices.length-1;_i>=0;--_i){var elem=notMatrices[_i];var _iterator=_createForOfIteratorHelper(elem.cells.reverse()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var address=_step.value;var value=sheets[this.dependencyGraph.getSheetName(address.sheet)][address.row][address.col];var vertex=new _DependencyGraph.ValueCellVertex(Number(value));this.columnSearch.add(Number(value),address);this.dependencyGraph.addVertex(address,vertex)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}this.stats.end(_statistics.StatType.MATRIX_DETECTION);return dependencies}}]);return MatrixDetectionStrategy}();exports.MatrixDetectionStrategy=MatrixDetectionStrategy;function buildMatrixVertex(ast,formulaAddress){var size=(0,_Matrix.checkMatrixSize)(ast,formulaAddress);if(size instanceof _Cell.CellError){return new _DependencyGraph.ValueCellVertex(size)}return new _DependencyGraph.MatrixVertex(formulaAddress,size.width,size.height,ast)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.findMatrices=_findMatrices;exports.GraphBuilderMatrixHeuristic=exports.Array2d=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _CellContentParser=__webpack_require__(213);var _DependencyGraph=__webpack_require__(107);var _Matrix=__webpack_require__(189);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Array2d=function(){function Array2d(size){_classCallCheck(this,Array2d);this._size=size;this.array=new Array(size.height);for(var y=0;y<size.height;++y){this.array[y]=new Array(size.width)}}_createClass(Array2d,[{key:"set",value:function set(x,y,value){this.array[y][x]=value}},{key:"get",value:function get(x,y){var row=this.array[y];if(!row){return null}return row[x]||null}},{key:"size",value:function size(){return this._size}}],[{key:"fromArray",value:function fromArray(input){var size=new _Matrix.MatrixSize(input[0].length,input.length);var array=new Array2d(size);for(var i=0;i<size.height;++i){for(var j=0;j<size.width;++j){array.set(j,i,input[i][j])}}return array}}]);return Array2d}();exports.Array2d=Array2d;var GraphBuilderMatrixHeuristic=function(){function GraphBuilderMatrixHeuristic(dependencyGraph,columnSearch,threshold,cellContentParser){_classCallCheck(this,GraphBuilderMatrixHeuristic);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.threshold=threshold;this.cellContentParser=cellContentParser;this.mapping=new Map}_createClass(GraphBuilderMatrixHeuristic,[{key:"addSheet",value:function addSheet(id,size){this.mapping.set(id,new Array2d(size))}},{key:"add",value:function add(cellAddress){if(!this.mapping.has(cellAddress.sheet)){throw Error("Sheet with id: ".concat(cellAddress.sheet," does not exists"))}this.mapping.get(cellAddress.sheet).set(cellAddress.col,cellAddress.row,true)}},{key:"run",value:function run(sheets){var _this=this;var notMatrices=[];var scanResult=this.findMatrices();scanResult.forEach((function(elem){if(!elem.isMatrix||elem.range.size()<_this.threshold){notMatrices.push(elem);return}var possibleMatrix=elem.range;var matrixVertex=_DependencyGraph.MatrixVertex.fromRange(possibleMatrix);var sheet=sheets[_this.dependencyGraph.getSheetName(possibleMatrix.start.sheet)];var matrix=_this.matrixFromPlainValues(possibleMatrix,sheet);matrixVertex.setCellValue(matrix);_this.dependencyGraph.addMatrixVertex(matrixVertex.getAddress(),matrixVertex);_this.columnSearch.add(matrix,matrixVertex.getAddress())}));this.mapping.clear();return notMatrices}},{key:"matrixFromPlainValues",value:function matrixFromPlainValues(range,sheet){var values=new Array(range.height());for(var i=0;i<range.height();++i){values[i]=new Array(range.width())}var _iterator=_createForOfIteratorHelper(range.addresses(this.dependencyGraph)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var address=_step.value;var cellContent=sheet[address.row][address.col];var parsedCellContent=this.cellContentParser.parse(cellContent);if(parsedCellContent instanceof _CellContentParser.CellContent.Number){values[address.row-range.start.row][address.col-range.start.col]=parsedCellContent.value}else{throw new Error("Range contains not numeric values")}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return new _Matrix.Matrix(values)}},{key:"findMatrices",value:function findMatrices(){var result=[];this.mapping.forEach((function(m,sheet){var _iterator2=_createForOfIteratorHelper(_findMatrices(sheet,m)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _possibleMatrix=_step2.value;result.push(_possibleMatrix)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}));return result}}]);return GraphBuilderMatrixHeuristic}();exports.GraphBuilderMatrixHeuristic=GraphBuilderMatrixHeuristic;function _findMatrices(sheet,input){var size=input.size();var result=new Map;var colours=new Array2d(size);var colour=0;for(var y=size.height-1;y>=0;--y){for(var x=size.width-1;x>=0;--x){var value=input.get(x,y);var _ref=[input.get(x+1,y),colours.get(x+1,y)],right=_ref[0],rightColour=_ref[1];var _ref2=[input.get(x,y+1),colours.get(x,y+1)],bottom=_ref2[0],bottomColour=_ref2[1];var _ref3=[input.get(x+1,y+1),colours.get(x+1,y+1)],diag=_ref3[0],diagColour=_ref3[1];if(!value){colours.set(x,y,0);if(rightColour===bottomColour){if(result.has(rightColour)){result.get(rightColour).isMatrix=false}}}else if(value!==right&&rightColour===bottomColour){colours.set(x,y,++colour);result.set(colour,possibleMatrix(_AbsoluteCellRange.AbsoluteCellRange.fromCoordinates(sheet,x,y,x,y),true,[(0,_Cell.simpleCellAddress)(sheet,x,y)]));if(result.has(rightColour)){result.get(rightColour).isMatrix=false}}else if(value!==diag){if(right===value&&right===bottom){if(result.has(rightColour)){result.get(rightColour).isMatrix=false}if(result.has(bottomColour)){result.get(bottomColour).isMatrix=false}colours.set(x,y,++colour);result.set(colour,possibleMatrix(_AbsoluteCellRange.AbsoluteCellRange.fromCoordinates(sheet,x,y,x,y),true,[(0,_Cell.simpleCellAddress)(sheet,x,y)]))}else if(right!==value&&bottom===value){if(result.has(bottomColour)&&result.get(bottomColour).isMatrix){colours.set(x,y,bottomColour);var old=result.get(bottomColour);old.cells.push((0,_Cell.simpleCellAddress)(sheet,x,y));result.set(bottomColour,possibleMatrix(old.range.withStart((0,_Cell.simpleCellAddress)(sheet,x,y)),true,old.cells))}else{colours.set(x,y,++colour);result.set(colour,possibleMatrix(_AbsoluteCellRange.AbsoluteCellRange.fromCoordinates(sheet,x,y,x,y),true,[(0,_Cell.simpleCellAddress)(sheet,x,y)]))}}else if(right===value&&bottom!==value){colours.set(x,y,rightColour);var _old=result.get(rightColour);_old.cells.push((0,_Cell.simpleCellAddress)(sheet,x,y));result.set(rightColour,possibleMatrix(_old.range.withStart((0,_Cell.simpleCellAddress)(sheet,x,y)),true,_old.cells))}else{colours.set(x,y,++colour);result.set(colour,possibleMatrix(_AbsoluteCellRange.AbsoluteCellRange.fromCoordinates(sheet,x,y,x,y),true,[(0,_Cell.simpleCellAddress)(sheet,x,y)]))}}else if(value===diag&&diagColour===rightColour&&diagColour===bottomColour){colours.set(x,y,rightColour);var _old2=result.get(rightColour);_old2.cells.push((0,_Cell.simpleCellAddress)(sheet,x,y));result.set(rightColour,possibleMatrix(_old2.range.withStart((0,_Cell.simpleCellAddress)(sheet,x,y)),true,_old2.cells))}else if(value===diag){colours.set(x,y,++colour);result.set(colour,possibleMatrix(_AbsoluteCellRange.AbsoluteCellRange.fromCoordinates(sheet,x,y,x,y),true,[(0,_Cell.simpleCellAddress)(sheet,x,y)]))}}}return result.values()}function possibleMatrix(range,isMatrix,cells){return{isMatrix:isMatrix,range:range,cells:cells}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(158);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.AddRowsTransformer=void 0;var _Cell=__webpack_require__(106);var _Transformer2=__webpack_require__(226);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var AddRowsTransformer=function(_Transformer){_inherits(AddRowsTransformer,_Transformer);var _super=_createSuper(AddRowsTransformer);function AddRowsTransformer(rowsSpan){var _this;_classCallCheck(this,AddRowsTransformer);_this=_super.call(this);_this.rowsSpan=rowsSpan;return _this}_createClass(AddRowsTransformer,[{key:"isIrreversible",value:function isIrreversible(){return false}},{key:"transformColumnRangeAst",value:function transformColumnRangeAst(ast,_formulaAddress){return ast}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformColumnRange",value:function transformColumnRange(_start,_end,_formulaAddress){throw Error("Not implemented")}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){var absoluteDependencySheet=(0,_Cell.absoluteSheetReference)(dependencyAddress,formulaAddress);if(absoluteDependencySheet!==this.rowsSpan.sheet&&formulaAddress.sheet!==this.rowsSpan.sheet){return false}var absolutizedDependencyAddress=dependencyAddress.toSimpleRowAddress(formulaAddress);if(absoluteDependencySheet===this.rowsSpan.sheet&&formulaAddress.sheet!==this.rowsSpan.sheet){if(this.rowsSpan.rowStart<=absolutizedDependencyAddress.row){return dependencyAddress.shiftedByRows(this.rowsSpan.numberOfRows)}else{return false}}if(formulaAddress.sheet===this.rowsSpan.sheet&&absoluteDependencySheet!==this.rowsSpan.sheet){if(dependencyAddress.isRowAbsolute()){return false}if(formulaAddress.row<this.rowsSpan.rowStart){return false}return dependencyAddress.shiftedByRows(-this.rowsSpan.numberOfRows)}if(dependencyAddress.isRowAbsolute()){if(dependencyAddress.row<this.rowsSpan.rowStart){return false}else{return dependencyAddress.shiftedByRows(this.rowsSpan.numberOfRows)}}else{if(absolutizedDependencyAddress.row<this.rowsSpan.rowStart){if(formulaAddress.row<this.rowsSpan.rowStart){return false}else{return dependencyAddress.shiftedByRows(-this.rowsSpan.numberOfRows)}}else{if(formulaAddress.row<this.rowsSpan.rowStart){return dependencyAddress.shiftedByRows(this.rowsSpan.numberOfRows)}else{return false}}}}},{key:"fixNodeAddress",value:function fixNodeAddress(address){if(this.rowsSpan.sheet===address.sheet&&this.rowsSpan.rowStart<=address.row){return Object.assign(Object.assign({},address),{row:address.row+this.rowsSpan.numberOfRows})}else{return address}}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var newStart=this.transformCellAddress(start,formulaAddress);var newEnd=this.transformCellAddress(end,formulaAddress);if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){return _Cell.ErrorType.REF}else if(newStart||newEnd){return[newStart||start,newEnd||end]}else{return false}}},{key:"sheet",get:function get(){return this.rowsSpan.sheet}}]);return AddRowsTransformer}(_Transformer2.Transformer);exports.AddRowsTransformer=AddRowsTransformer},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(158);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.Transformer=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Transformer=function(){function Transformer(){_classCallCheck(this,Transformer)}_createClass(Transformer,[{key:"performEagerTransformations",value:function performEagerTransformations(graph,parser){var _iterator=_createForOfIteratorHelper(graph.matrixFormulaNodes()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var node=_step.value;var _this$transformSingle=this.transformSingleAst(node.getFormula(),node.getAddress()),_this$transformSingle2=_slicedToArray(_this$transformSingle,2),newAst=_this$transformSingle2[0],newAddress=_this$transformSingle2[1];var cachedAst=parser.rememberNewAst(newAst);node.setFormula(cachedAst);node.setAddress(newAddress)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"transformSingleAst",value:function transformSingleAst(ast,address){var newAst=this.transformAst(ast,address);var newAddress=this.fixNodeAddress(address);return[newAst,newAddress]}},{key:"transformAst",value:function transformAst(ast,address){var _this=this;switch(ast.type){case _parser.AstNodeType.CELL_REFERENCE:{return this.transformCellReferenceAst(ast,address)}case _parser.AstNodeType.CELL_RANGE:{return this.transformCellRangeAst(ast,address)}case _parser.AstNodeType.COLUMN_RANGE:{return this.transformColumnRangeAst(ast,address)}case _parser.AstNodeType.ROW_RANGE:{return this.transformRowRangeAst(ast,address)}case _parser.AstNodeType.EMPTY:case _parser.AstNodeType.ERROR:case _parser.AstNodeType.NUMBER:case _parser.AstNodeType.NAMED_EXPRESSION:case _parser.AstNodeType.ERROR_WITH_RAW_INPUT:case _parser.AstNodeType.STRING:{return ast}case _parser.AstNodeType.PERCENT_OP:{return Object.assign(Object.assign({},ast),{type:ast.type,value:this.transformAst(ast.value,address)})}case _parser.AstNodeType.MINUS_UNARY_OP:{return Object.assign(Object.assign({},ast),{type:ast.type,value:this.transformAst(ast.value,address)})}case _parser.AstNodeType.PLUS_UNARY_OP:{return Object.assign(Object.assign({},ast),{type:ast.type,value:this.transformAst(ast.value,address)})}case _parser.AstNodeType.FUNCTION_CALL:{return Object.assign(Object.assign({},ast),{type:ast.type,procedureName:ast.procedureName,args:ast.args.map((function(arg){return _this.transformAst(arg,address)}))})}case _parser.AstNodeType.PARENTHESIS:{return Object.assign(Object.assign({},ast),{type:ast.type,expression:this.transformAst(ast.expression,address)})}default:{return Object.assign(Object.assign({},ast),{type:ast.type,left:this.transformAst(ast.left,address),right:this.transformAst(ast.right,address)})}}}},{key:"transformCellReferenceAst",value:function transformCellReferenceAst(ast,formulaAddress){var newCellAddress=this.transformCellAddress(ast.reference,formulaAddress);if(newCellAddress instanceof _parser.CellAddress){return Object.assign(Object.assign({},ast),{reference:newCellAddress})}else if(newCellAddress===_Cell.ErrorType.REF){return(0,_parser.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}else{return ast}}},{key:"transformCellRangeAst",value:function transformCellRangeAst(ast,formulaAddress){var newRange=this.transformCellRange(ast.start,ast.end,formulaAddress);if(Array.isArray(newRange)){return Object.assign(Object.assign({},ast),{start:newRange[0],end:newRange[1]})}else if(newRange===_Cell.ErrorType.REF){return(0,_parser.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}else{return ast}}},{key:"transformColumnRangeAst",value:function transformColumnRangeAst(ast,formulaAddress){var newRange=this.transformColumnRange(ast.start,ast.end,formulaAddress);if(Array.isArray(newRange)){return Object.assign(Object.assign({},ast),{start:newRange[0],end:newRange[1]})}else if(newRange===_Cell.ErrorType.REF){return(0,_parser.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}else{return ast}}},{key:"transformRowRangeAst",value:function transformRowRangeAst(ast,formulaAddress){var newRange=this.transformRowRange(ast.start,ast.end,formulaAddress);if(Array.isArray(newRange)){return Object.assign(Object.assign({},ast),{start:newRange[0],end:newRange[1]})}else if(newRange===_Cell.ErrorType.REF){return(0,_parser.buildCellErrorAst)(new _Cell.CellError(_Cell.ErrorType.REF))}else{return ast}}}]);return Transformer}();exports.Transformer=Transformer},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(158);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.RemoveRowsTransformer=void 0;var _Cell=__webpack_require__(106);var _Transformer2=__webpack_require__(226);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var RemoveRowsTransformer=function(_Transformer){_inherits(RemoveRowsTransformer,_Transformer);var _super=_createSuper(RemoveRowsTransformer);function RemoveRowsTransformer(rowsSpan){var _this;_classCallCheck(this,RemoveRowsTransformer);_this=_super.call(this);_this.rowsSpan=rowsSpan;return _this}_createClass(RemoveRowsTransformer,[{key:"isIrreversible",value:function isIrreversible(){return true}},{key:"transformColumnRangeAst",value:function transformColumnRangeAst(ast,_formulaAddress){return ast}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){var absoluteDependencySheet=(0,_Cell.absoluteSheetReference)(dependencyAddress,formulaAddress);if(this.rowsSpan.sheet!==formulaAddress.sheet&&this.rowsSpan.sheet!==absoluteDependencySheet){return false}if(this.rowsSpan.sheet!==formulaAddress.sheet&&this.rowsSpan.sheet===absoluteDependencySheet){var absoluteDependencyAddress=dependencyAddress.toSimpleRowAddress(formulaAddress);if(absoluteDependencyAddress.row<this.rowsSpan.rowStart){return false}else if(absoluteDependencyAddress.row>this.rowsSpan.rowEnd){return dependencyAddress.shiftedByRows(-this.rowsSpan.numberOfRows)}}if(this.rowsSpan.sheet===formulaAddress.sheet&&this.rowsSpan.sheet!==absoluteDependencySheet){if(dependencyAddress.isRowAbsolute()){return false}else{if(formulaAddress.row<this.rowsSpan.rowStart){return false}else if(formulaAddress.row>this.rowsSpan.rowEnd){return dependencyAddress.shiftedByRows(this.rowsSpan.numberOfRows)}}}if(this.rowsSpan.sheet===formulaAddress.sheet&&this.rowsSpan.sheet===absoluteDependencySheet){if(dependencyAddress.isRowAbsolute()){if(dependencyAddress.row<this.rowsSpan.rowStart){return false}else if(dependencyAddress.row>this.rowsSpan.rowEnd){return dependencyAddress.shiftedByRows(-this.rowsSpan.numberOfRows)}}else{var _absoluteDependencyAddress=dependencyAddress.toSimpleRowAddress(formulaAddress);if(_absoluteDependencyAddress.row<this.rowsSpan.rowStart){if(formulaAddress.row<this.rowsSpan.rowStart){return false}else if(formulaAddress.row>this.rowsSpan.rowEnd){return dependencyAddress.shiftedByRows(this.rowsSpan.numberOfRows)}}else if(_absoluteDependencyAddress.row>this.rowsSpan.rowEnd){if(formulaAddress.row<this.rowsSpan.rowStart){return dependencyAddress.shiftedByRows(-this.rowsSpan.numberOfRows)}else if(formulaAddress.row>this.rowsSpan.rowEnd){return false}}}}return _Cell.ErrorType.REF}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformColumnRange",value:function transformColumnRange(_start,_end,_formulaAddress){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function fixNodeAddress(address){if(this.rowsSpan.sheet===address.sheet&&this.rowsSpan.rowStart<=address.row){return Object.assign(Object.assign({},address),{row:address.row-this.rowsSpan.numberOfRows})}else{return address}}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var startSheet=(0,_Cell.absoluteSheetReference)(start,formulaAddress);var actualStart=start;var actualEnd=end;if(this.rowsSpan.sheet===startSheet){var startSCA=start.toSimpleRowAddress(formulaAddress);var endSCA=end.toSimpleRowAddress(formulaAddress);if(this.rowsSpan.rowStart<=startSCA.row&&this.rowsSpan.rowEnd>=endSCA.row){return _Cell.ErrorType.REF}if(startSCA.row>=this.rowsSpan.rowStart&&startSCA.row<=this.rowsSpan.rowEnd){actualStart=start.shiftedByRows(this.rowsSpan.rowEnd-startSCA.row+1)}if(endSCA.row>=this.rowsSpan.rowStart&&endSCA.row<=this.rowsSpan.rowEnd){actualEnd=end.shiftedByRows(-(endSCA.row-this.rowsSpan.rowStart+1))}}var newStart=this.transformCellAddress(actualStart,formulaAddress);var newEnd=this.transformCellAddress(actualEnd,formulaAddress);if(newStart===false&&newEnd===false){return[actualStart,actualEnd]}else if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){throw Error("Cannot happen")}else{return[newStart||actualStart,newEnd||actualEnd]}}},{key:"sheet",get:function get(){return this.rowsSpan.sheet}}]);return RemoveRowsTransformer}(_Transformer2.Transformer);exports.RemoveRowsTransformer=RemoveRowsTransformer},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(158);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.AddColumnsTransformer=void 0;var _Cell=__webpack_require__(106);var _Transformer2=__webpack_require__(226);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var AddColumnsTransformer=function(_Transformer){_inherits(AddColumnsTransformer,_Transformer);var _super=_createSuper(AddColumnsTransformer);function AddColumnsTransformer(columnsSpan){var _this;_classCallCheck(this,AddColumnsTransformer);_this=_super.call(this);_this.columnsSpan=columnsSpan;return _this}_createClass(AddColumnsTransformer,[{key:"isIrreversible",value:function isIrreversible(){return false}},{key:"transformRowRangeAst",value:function transformRowRangeAst(ast,_formulaAddress){return ast}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(_start,_end,_formulaAddress){throw Error("Not implemented")}},{key:"transformColumnRange",value:function transformColumnRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){var absoluteDependencySheet=(0,_Cell.absoluteSheetReference)(dependencyAddress,formulaAddress);if(absoluteDependencySheet!==this.columnsSpan.sheet&&formulaAddress.sheet!==this.columnsSpan.sheet){return false}var absolutizedDependencyAddress=dependencyAddress.toSimpleColumnAddress(formulaAddress);if(absoluteDependencySheet===this.columnsSpan.sheet&&formulaAddress.sheet!==this.columnsSpan.sheet){if(this.columnsSpan.columnStart<=absolutizedDependencyAddress.col){return dependencyAddress.shiftedByColumns(this.columnsSpan.numberOfColumns)}else{return false}}if(formulaAddress.sheet===this.columnsSpan.sheet&&absoluteDependencySheet!==this.columnsSpan.sheet){if(dependencyAddress.isColumnAbsolute()){return false}if(formulaAddress.col<this.columnsSpan.columnStart){return false}return dependencyAddress.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(dependencyAddress.isColumnAbsolute()){if(dependencyAddress.col<this.columnsSpan.columnStart){return false}else{return dependencyAddress.shiftedByColumns(this.columnsSpan.numberOfColumns)}}else{var _absolutizedDependencyAddress=dependencyAddress.toSimpleColumnAddress(formulaAddress);if(_absolutizedDependencyAddress.col<this.columnsSpan.columnStart){if(formulaAddress.col<this.columnsSpan.columnStart){return false}else{return dependencyAddress.shiftedByColumns(-this.columnsSpan.numberOfColumns)}}else{if(formulaAddress.col<this.columnsSpan.columnStart){return dependencyAddress.shiftedByColumns(this.columnsSpan.numberOfColumns)}else{return false}}}}},{key:"fixNodeAddress",value:function fixNodeAddress(address){if(this.columnsSpan.sheet===address.sheet&&this.columnsSpan.columnStart<=address.col){return Object.assign(Object.assign({},address),{col:address.col+this.columnsSpan.numberOfColumns})}else{return address}}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var newStart=this.transformCellAddress(start,formulaAddress);var newEnd=this.transformCellAddress(end,formulaAddress);if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){return _Cell.ErrorType.REF}else if(newStart||newEnd){return[newStart||start,newEnd||end]}else{return false}}},{key:"sheet",get:function get(){return this.columnsSpan.sheet}}]);return AddColumnsTransformer}(_Transformer2.Transformer);exports.AddColumnsTransformer=AddColumnsTransformer},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.MoveCellsTransformer=void 0;var _Transformer3=__webpack_require__(226);var _parser=__webpack_require__(138);var _Cell=__webpack_require__(106);var _RowAddress=__webpack_require__(155);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var MoveCellsTransformer=function(_Transformer){_inherits(MoveCellsTransformer,_Transformer);var _super=_createSuper(MoveCellsTransformer);function MoveCellsTransformer(sourceRange,toRight,toBottom,toSheet){var _this;_classCallCheck(this,MoveCellsTransformer);_this=_super.call(this);_this.sourceRange=sourceRange;_this.toRight=toRight;_this.toBottom=toBottom;_this.toSheet=toSheet;_this.dependentFormulaTransformer=new DependentFormulaTransformer(sourceRange,toRight,toBottom,toSheet);return _this}_createClass(MoveCellsTransformer,[{key:"isIrreversible",value:function isIrreversible(){return true}},{key:"transformSingleAst",value:function transformSingleAst(ast,address){if(this.sourceRange.addressInRange(address)){var newAst=this.transformAst(ast,address);return[newAst,this.fixNodeAddress(address)]}else{return this.dependentFormulaTransformer.transformSingleAst(ast,address)}}},{key:"fixNodeAddress",value:function fixNodeAddress(address){return(0,_Cell.simpleCellAddress)(this.toSheet,address.col+this.toRight,address.row+this.toBottom)}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){return this.transformAddress(dependencyAddress,formulaAddress)}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformColumnRange",value:function transformColumnRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformAddress",value:function transformAddress(dependencyAddress,formulaAddress){var sourceRange=this.sourceRange;var targetRange=sourceRange.shifted(this.toRight,this.toBottom);if(dependencyAddress instanceof _parser.CellAddress){var absoluteDependencyAddress=dependencyAddress.toSimpleCellAddress(formulaAddress);if(sourceRange.addressInRange(absoluteDependencyAddress)){return dependencyAddress.shiftAbsoluteDimensions(this.toRight,this.toBottom)}else if(targetRange.addressInRange(absoluteDependencyAddress)){return _Cell.ErrorType.REF}}return dependencyAddress.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var newStart=this.transformAddress(start,formulaAddress);var newEnd=this.transformAddress(end,formulaAddress);if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){return _Cell.ErrorType.REF}else if(newStart||newEnd){return[newStart||start,newEnd||end]}else{return false}}},{key:"sheet",get:function get(){return this.sourceRange.sheet}}]);return MoveCellsTransformer}(_Transformer3.Transformer);exports.MoveCellsTransformer=MoveCellsTransformer;var DependentFormulaTransformer=function(_Transformer2){_inherits(DependentFormulaTransformer,_Transformer2);var _super2=_createSuper(DependentFormulaTransformer);function DependentFormulaTransformer(sourceRange,toRight,toBottom,toSheet){var _this2;_classCallCheck(this,DependentFormulaTransformer);_this2=_super2.call(this);_this2.sourceRange=sourceRange;_this2.toRight=toRight;_this2.toBottom=toBottom;_this2.toSheet=toSheet;return _this2}_createClass(DependentFormulaTransformer,[{key:"isIrreversible",value:function isIrreversible(){return true}},{key:"fixNodeAddress",value:function fixNodeAddress(address){return address}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){if(this.shouldMove(dependencyAddress,formulaAddress)){return dependencyAddress.moved(this.toSheet,this.toRight,this.toBottom)}return false}},{key:"shouldMove",value:function shouldMove(dependencyAddress,formulaAddress){if(dependencyAddress instanceof _parser.CellAddress){return this.sourceRange.addressInRange(dependencyAddress.toSimpleCellAddress(formulaAddress))}else if(dependencyAddress instanceof _RowAddress.RowAddress){return this.sourceRange.rowInRange(dependencyAddress.toSimpleRowAddress(formulaAddress))&&!this.sourceRange.isFinite()}else{return this.sourceRange.columnInRange(dependencyAddress.toSimpleColumnAddress(formulaAddress))&&!this.sourceRange.isFinite()}}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformColumnRange",value:function transformColumnRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var newStart=this.transformCellAddress(start,formulaAddress);var newEnd=this.transformCellAddress(end,formulaAddress);if(newStart&&newEnd){return[newStart,newEnd]}return false}},{key:"sheet",get:function get(){return this.sourceRange.sheet}}]);return DependentFormulaTransformer}(_Transformer3.Transformer)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.RemoveSheetTransformer=void 0;var _Transformer2=__webpack_require__(226);var _Cell=__webpack_require__(106);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var RemoveSheetTransformer=function(_Transformer){_inherits(RemoveSheetTransformer,_Transformer);var _super=_createSuper(RemoveSheetTransformer);function RemoveSheetTransformer(sheet){var _this;_classCallCheck(this,RemoveSheetTransformer);_this=_super.call(this);_this.sheet=sheet;return _this}_createClass(RemoveSheetTransformer,[{key:"isIrreversible",value:function isIrreversible(){return true}},{key:"performEagerTransformations",value:function performEagerTransformations(graph,_parser){var _iterator=_createForOfIteratorHelper(graph.matrixFormulaNodes()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var node=_step.value;var _this$transformSingle=this.transformSingleAst(node.getFormula(),node.getAddress()),_this$transformSingle2=_slicedToArray(_this$transformSingle,1),newAst=_this$transformSingle2[0];node.setFormula(newAst)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"fixNodeAddress",value:function fixNodeAddress(address){return address}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,_formulaAddress){if(dependencyAddress.sheet===this.sheet){return _Cell.ErrorType.REF}return false}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){var newStart=this.transformCellAddress(start,formulaAddress);var newEnd=this.transformCellAddress(end,formulaAddress);if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){return _Cell.ErrorType.REF}else if(newStart||newEnd){return[newStart||start,newEnd||end]}else{return false}}},{key:"transformColumnRange",value:function transformColumnRange(start,_end,_formulaAddress){if(start.sheet===this.sheet||start.sheet===this.sheet){return _Cell.ErrorType.REF}return false}},{key:"transformRowRange",value:function transformRowRange(start,_end,_formulaAddress){if(start.sheet===this.sheet||start.sheet===this.sheet){return _Cell.ErrorType.REF}return false}}]);return RemoveSheetTransformer}(_Transformer2.Transformer);exports.RemoveSheetTransformer=RemoveSheetTransformer},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(158);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.RemoveColumnsTransformer=void 0;var _Cell=__webpack_require__(106);var _Transformer2=__webpack_require__(226);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var RemoveColumnsTransformer=function(_Transformer){_inherits(RemoveColumnsTransformer,_Transformer);var _super=_createSuper(RemoveColumnsTransformer);function RemoveColumnsTransformer(columnsSpan){var _this;_classCallCheck(this,RemoveColumnsTransformer);_this=_super.call(this);_this.columnsSpan=columnsSpan;return _this}_createClass(RemoveColumnsTransformer,[{key:"isIrreversible",value:function isIrreversible(){return true}},{key:"transformRowRangeAst",value:function transformRowRangeAst(ast,_formulaAddress){return ast}},{key:"transformCellRange",value:function transformCellRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformRowRange",value:function transformRowRange(_start,_end,_formulaAddress){throw Error("Not implemented")}},{key:"transformColumnRange",value:function transformColumnRange(start,end,formulaAddress){return this.transformRange(start,end,formulaAddress)}},{key:"transformCellAddress",value:function transformCellAddress(dependencyAddress,formulaAddress){var absoluteDependencySheet=(0,_Cell.absoluteSheetReference)(dependencyAddress,formulaAddress);if(this.columnsSpan.sheet!==formulaAddress.sheet&&this.columnsSpan.sheet!==absoluteDependencySheet){return false}if(this.columnsSpan.sheet!==formulaAddress.sheet&&this.columnsSpan.sheet===absoluteDependencySheet){var absoluteDependencyAddress=dependencyAddress.toSimpleColumnAddress(formulaAddress);if(absoluteDependencyAddress.col<this.columnsSpan.columnStart){return false}else if(absoluteDependencyAddress.col>this.columnsSpan.columnEnd){return dependencyAddress.shiftedByColumns(-this.columnsSpan.numberOfColumns)}}if(this.columnsSpan.sheet===formulaAddress.sheet&&this.columnsSpan.sheet!==absoluteDependencySheet){if(dependencyAddress.isColumnAbsolute()){return false}else{if(formulaAddress.col<this.columnsSpan.columnStart){return false}else if(formulaAddress.col>this.columnsSpan.columnEnd){return dependencyAddress.shiftedByColumns(this.columnsSpan.numberOfColumns)}}}if(this.columnsSpan.sheet===formulaAddress.sheet&&this.columnsSpan.sheet===absoluteDependencySheet){if(dependencyAddress.isColumnAbsolute()){if(dependencyAddress.col<this.columnsSpan.columnStart){return false}else if(dependencyAddress.col>this.columnsSpan.columnEnd){return dependencyAddress.shiftedByColumns(-this.columnsSpan.numberOfColumns)}}else{var _absoluteDependencyAddress=dependencyAddress.toSimpleColumnAddress(formulaAddress);if(_absoluteDependencyAddress.col<this.columnsSpan.columnStart){if(formulaAddress.col<this.columnsSpan.columnStart){return false}else if(formulaAddress.col>this.columnsSpan.columnEnd){return dependencyAddress.shiftedByColumns(this.columnsSpan.numberOfColumns)}}else if(_absoluteDependencyAddress.col>this.columnsSpan.columnEnd){if(formulaAddress.col<this.columnsSpan.columnStart){return dependencyAddress.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else if(formulaAddress.col>this.columnsSpan.columnEnd){return false}}}}return _Cell.ErrorType.REF}},{key:"fixNodeAddress",value:function fixNodeAddress(address){if(this.columnsSpan.sheet===address.sheet&&this.columnsSpan.columnStart<=address.col){return Object.assign(Object.assign({},address),{col:address.col-this.columnsSpan.numberOfColumns})}else{return address}}},{key:"transformRange",value:function transformRange(start,end,formulaAddress){var startSheet=(0,_Cell.absoluteSheetReference)(start,formulaAddress);var actualStart=start;var actualEnd=end;if(this.columnsSpan.sheet===startSheet){var startSCA=start.toSimpleColumnAddress(formulaAddress);var endSCA=end.toSimpleColumnAddress(formulaAddress);if(this.columnsSpan.columnStart<=startSCA.col&&this.columnsSpan.columnEnd>=endSCA.col){return _Cell.ErrorType.REF}if(startSCA.col>=this.columnsSpan.columnStart&&startSCA.col<=this.columnsSpan.columnEnd){actualStart=start.shiftedByColumns(this.columnsSpan.columnEnd-startSCA.col+1)}if(endSCA.col>=this.columnsSpan.columnStart&&endSCA.col<=this.columnsSpan.columnEnd){actualEnd=end.shiftedByColumns(-(endSCA.col-this.columnsSpan.columnStart+1))}}var newStart=this.transformCellAddress(actualStart,formulaAddress);var newEnd=this.transformCellAddress(actualEnd,formulaAddress);if(newStart===false&&newEnd===false){return[actualStart,actualEnd]}else if(newStart===_Cell.ErrorType.REF||newEnd===_Cell.ErrorType.REF){throw Error("Cannot happen")}else{return[newStart||actualStart,newEnd||actualEnd]}}},{key:"sheet",get:function get(){return this.columnsSpan.sheet}}]);return RemoveColumnsTransformer}(_Transformer2.Transformer);exports.RemoveColumnsTransformer=RemoveColumnsTransformer},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.validateAsSheet=validateAsSheet;exports.findBoundaries=findBoundaries;var _errors=__webpack_require__(183);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function validateAsSheet(sheet){if(!Array.isArray(sheet)){throw new _errors.InvalidArgumentsError("an array of arrays.")}for(var i=0;i<sheet.length;i++){if(!Array.isArray(sheet[i])){throw new _errors.InvalidArgumentsError("an array of arrays.")}}}function findBoundaries(sheet){var width=0;var height=0;var cellsCount=0;for(var currentRow=0;currentRow<sheet.length;currentRow++){var currentRowWidth=0;for(var currentCol=0;currentCol<sheet[currentRow].length;currentCol++){var currentValue=sheet[currentRow][currentCol];if(currentValue===undefined||currentValue===null){continue}currentRowWidth=currentCol+1;++cellsCount}width=Math.max(width,currentRowWidth);if(currentRowWidth>0){height=currentRow+1}}var sheetSize=width*height;return{height:height,width:width,fill:sheetSize===0?0:cellsCount/sheetSize}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(75);__webpack_require__(168);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(169);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.Emitter=exports.Events=void 0;var _tinyEmitter=__webpack_require__(234);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var Events;exports.Events=Events;(function(Events){Events["SheetAdded"]="sheetAdded";Events["SheetRemoved"]="sheetRemoved";Events["SheetRenamed"]="sheetRenamed";Events["NamedExpressionAdded"]="namedExpressionAdded";Events["NamedExpressionRemoved"]="namedExpressionRemoved";Events["ValuesUpdated"]="valuesUpdated"})(Events||(exports.Events=Events={}));var Emitter=function(_TinyEmitter){_inherits(Emitter,_TinyEmitter);var _super=_createSuper(Emitter);function Emitter(){_classCallCheck(this,Emitter);return _super.apply(this,arguments)}_createClass(Emitter,[{key:"emit",value:function emit(event){var _get2;for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}(_get2=_get(_getPrototypeOf(Emitter.prototype),"emit",this)).call.apply(_get2,[this,event].concat(args));return this}}]);return Emitter}(_tinyEmitter.TinyEmitter);exports.Emitter=Emitter},function(module,exports){function E(){}E.prototype={on:function(name,callback,ctx){var e=this.e||(this.e={});(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx});return this},once:function(name,callback,ctx){var self=this;function listener(){self.off(name,listener);callback.apply(ctx,arguments)}listener._=callback;return this.on(name,listener,ctx)},emit:function(name){var data=[].slice.call(arguments,1);var evtArr=((this.e||(this.e={}))[name]||[]).slice();var i=0;var len=evtArr.length;for(i;i<len;i++){evtArr[i].fn.apply(evtArr[i].ctx,data)}return this},off:function(name,callback){var e=this.e||(this.e={});var evts=e[name];var liveEvents=[];if(evts&&callback){for(var i=0,len=evts.length;i<len;i++){if(evts[i].fn!==callback&&evts[i].fn._!==callback)liveEvents.push(evts[i])}}liveEvents.length?e[name]=liveEvents:delete e[name];return this}};module.exports=E;module.exports.TinyEmitter=E},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.BuildEngineFactory=void 0;var _LazilyTransformingAstService=__webpack_require__(236);var _CellContentParser=__webpack_require__(213);var _CellValue=__webpack_require__(209);var _ColumnSearchStrategy=__webpack_require__(237);var _Config=__webpack_require__(242);var _DateTimeHelper=__webpack_require__(247);var _CrudOperations=__webpack_require__(261);var _DependencyGraph=__webpack_require__(107);var _Evaluator=__webpack_require__(263);var _GraphBuilder=__webpack_require__(223);var _i18n=__webpack_require__(198);var _NamedExpressions=__webpack_require__(211);var _NumberLiteralHelper=__webpack_require__(268);var _parser=__webpack_require__(138);var _Serialization=__webpack_require__(269);var _statistics=__webpack_require__(176);var _errors=__webpack_require__(183);var _Sheet=__webpack_require__(232);var _FunctionRegistry=__webpack_require__(270);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var BuildEngineFactory=function(){function BuildEngineFactory(){_classCallCheck(this,BuildEngineFactory)}_createClass(BuildEngineFactory,null,[{key:"buildEngine",value:function buildEngine(config){var sheets=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var stats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:config.useStats?new _statistics.Statistics:new _statistics.EmptyStatistics;stats.start(_statistics.StatType.BUILD_ENGINE_TOTAL);var namedExpressions=new _NamedExpressions.NamedExpressions;var functionRegistry=new _FunctionRegistry.FunctionRegistry(config);var lazilyTransformingAstService=new _LazilyTransformingAstService.LazilyTransformingAstService(stats);var dependencyGraph=_DependencyGraph.DependencyGraph.buildEmpty(lazilyTransformingAstService,config,functionRegistry,namedExpressions,stats);var columnSearch=(0,_ColumnSearchStrategy.buildColumnSearchStrategy)(dependencyGraph,config,stats);var sheetMapping=dependencyGraph.sheetMapping;var addressMapping=dependencyGraph.addressMapping;for(var sheetName in sheets){if(Object.prototype.hasOwnProperty.call(sheets,sheetName)){var sheet=sheets[sheetName];(0,_Sheet.validateAsSheet)(sheet);var boundaries=(0,_Sheet.findBoundaries)(sheet);if(boundaries.height>config.maxRows||boundaries.width>config.maxColumns){throw new _errors.SheetSizeLimitExceededError}var sheetId=sheetMapping.addSheet(sheetName);addressMapping.autoAddSheet(sheetId,sheet,boundaries)}}var parser=new _parser.ParserWithCaching(config,functionRegistry,sheetMapping.get);var unparser=new _parser.Unparser(config,(0,_parser.buildLexerConfig)(config),sheetMapping.fetchDisplayName,namedExpressions);var dateHelper=new _DateTimeHelper.DateTimeHelper(config);var numberLiteralHelper=new _NumberLiteralHelper.NumberLiteralHelper(config);var cellContentParser=new _CellContentParser.CellContentParser(config,dateHelper,numberLiteralHelper);var crudOperations=new _CrudOperations.CrudOperations(config,stats,dependencyGraph,columnSearch,parser,cellContentParser,lazilyTransformingAstService,namedExpressions);stats.measure(_statistics.StatType.GRAPH_BUILD,(function(){var graphBuilder=new _GraphBuilder.GraphBuilder(dependencyGraph,columnSearch,parser,cellContentParser,config,stats);graphBuilder.buildGraph(sheets)}));lazilyTransformingAstService.undoRedo=crudOperations.undoRedo;lazilyTransformingAstService.parser=parser;var evaluator=new _Evaluator.Evaluator(dependencyGraph,columnSearch,config,stats,dateHelper,numberLiteralHelper,functionRegistry,namedExpressions);evaluator.run();var exporter=new _CellValue.Exporter(config,namedExpressions);var serialization=new _Serialization.Serialization(dependencyGraph,unparser,config,exporter);stats.end(_statistics.StatType.BUILD_ENGINE_TOTAL);return{config:config,stats:stats,dependencyGraph:dependencyGraph,columnSearch:columnSearch,parser:parser,unparser:unparser,cellContentParser:cellContentParser,evaluator:evaluator,lazilyTransformingAstService:lazilyTransformingAstService,crudOperations:crudOperations,exporter:exporter,namedExpressions:namedExpressions,serialization:serialization,functionRegistry:functionRegistry}}},{key:"buildFromSheets",value:function buildFromSheets(sheets,configInput){var config=new _Config.Config(configInput);return this.buildEngine(config,sheets)}},{key:"buildFromSheet",value:function buildFromSheet(sheet,configInput){var config=new _Config.Config(configInput);var newsheetprefix=config.translationPackage.getUITranslation(_i18n.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(config,_defineProperty({},newsheetprefix,sheet))}},{key:"buildEmpty",value:function buildEmpty(configInput){return this.buildEngine(new _Config.Config(configInput))}},{key:"rebuildWithConfig",value:function rebuildWithConfig(config,sheets,stats){return this.buildEngine(config,sheets,stats)}}]);return BuildEngineFactory}();exports.BuildEngineFactory=BuildEngineFactory},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.LazilyTransformingAstService=void 0;__webpack_require__(125);var _statistics=__webpack_require__(176);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var LazilyTransformingAstService=function(){function LazilyTransformingAstService(stats){_classCallCheck(this,LazilyTransformingAstService);this.stats=stats;this.transformations=[]}_createClass(LazilyTransformingAstService,[{key:"version",value:function version(){return this.transformations.length}},{key:"addTransformation",value:function addTransformation(transformation){this.transformations.push(transformation);return this.version()}},{key:"applyTransformations",value:function applyTransformations(ast,address,version){this.stats.start(_statistics.StatType.TRANSFORM_ASTS_POSTPONED);for(var v=version;v<this.transformations.length;v++){var transformation=this.transformations[v];if(transformation.isIrreversible()){this.undoRedo.storeDataForVersion(v,address,this.parser.computeHashFromAst(ast))}var _transformation$trans=transformation.transformSingleAst(ast,address),_transformation$trans2=_slicedToArray(_transformation$trans,2),newAst=_transformation$trans2[0],newAddress=_transformation$trans2[1];ast=newAst;address=newAddress}var cachedAst=this.parser.rememberNewAst(ast);this.stats.end(_statistics.StatType.TRANSFORM_ASTS_POSTPONED);return[cachedAst,address,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark((function getTransformationsFrom(version,filter){var v,transformation;return regeneratorRuntime.wrap((function getTransformationsFrom$(_context){while(1){switch(_context.prev=_context.next){case 0:v=version;case 1:if(!(v<this.transformations.length)){_context.next=9;break}transformation=this.transformations[v];if(!(!filter||filter(transformation))){_context.next=6;break}_context.next=6;return transformation;case 6:v++;_context.next=1;break;case 9:case"end":return _context.stop()}}}),getTransformationsFrom,this)}))},{key:"destroy",value:function destroy(){this.parser=undefined;this.transformations=[]}}]);return LazilyTransformingAstService}();exports.LazilyTransformingAstService=LazilyTransformingAstService},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.buildColumnSearchStrategy=buildColumnSearchStrategy;var _ColumnBinarySearch=__webpack_require__(238);var _ColumnIndex=__webpack_require__(240);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function buildColumnSearchStrategy(dependencyGraph,config,statistics){if(config.useColumnIndex){return new _ColumnIndex.ColumnIndex(dependencyGraph,config,statistics)}else{return new _ColumnBinarySearch.ColumnBinarySearch(dependencyGraph,config)}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(184);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.ColumnBinarySearch=void 0;var _binarySearch=__webpack_require__(239);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ColumnBinarySearch=function(){function ColumnBinarySearch(dependencyGraph,config){_classCallCheck(this,ColumnBinarySearch);this.dependencyGraph=dependencyGraph;this.config=config}_createClass(ColumnBinarySearch,[{key:"add",value:function add(value,address){}},{key:"remove",value:function remove(value,address){}},{key:"change",value:function change(oldValue,newValue,address){}},{key:"addColumns",value:function addColumns(columnsSpan){}},{key:"removeColumns",value:function removeColumns(columnsSpan){}},{key:"removeSheet",value:function removeSheet(sheetId){}},{key:"moveValues",value:function moveValues(sourceRange,toRight,toBottom,toSheet){}},{key:"removeValues",value:function removeValues(range){}},{key:"destroy",value:function destroy(){}},{key:"find",value:function find(key,range,sorted){if(range.height()<this.config.vlookupThreshold||!sorted){var values=this.computeListOfValuesInRange(range);var index=values.indexOf(key);return index<0?index:index+range.start.row}else{return(0,_binarySearch.rangeLowerBound)(range,key,this.dependencyGraph)}}},{key:"advancedFind",value:function advancedFind(keyMatcher,range){var values=this.computeListOfValuesInRange(range);for(var i=0;i<values.length;i++){if(keyMatcher(values[i])){return i+range.start.row}}return-1}},{key:"computeListOfValuesInRange",value:function computeListOfValuesInRange(range){var values=[];var _iterator=_createForOfIteratorHelper(range.addresses(this.dependencyGraph)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var cellFromRange=_step.value;var value=this.dependencyGraph.getScalarValue(cellFromRange);values.push(value)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return values}}]);return ColumnBinarySearch}();exports.ColumnBinarySearch=ColumnBinarySearch},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.rangeLowerBound=rangeLowerBound;exports.lowerBound=lowerBound;exports.compare=compare;var _Cell=__webpack_require__(106);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function rangeLowerBound(range,key,dependencyGraph){var start=range.start.row;var end=range.end.row;while(start<=end){var center=Math.floor((start+end)/2);var cmp=compare(key,dependencyGraph.getCellValue((0,_Cell.simpleCellAddress)(range.sheet,range.start.col,center)));if(cmp>0){start=center+1}else if(cmp<0){end=center-1}else if(start!=center){end=center}else{return center}}return end}function lowerBound(values,key){var start=0;var end=values.length-1;while(start<=end){var center=Math.floor((start+end)/2);var cmp=compare(key,values[center]);if(cmp>0){start=center+1}else if(cmp<0){end=center-1}else if(start!=center){end=center}else{return center}}return end}function compare(left,right){if(_typeof(left)===_typeof(right)){return left<right?-1:left>right?1:0}if(typeof left==="number"&&typeof right==="string"){return-1}if(typeof left==="number"&&typeof right==="boolean"){return-1}if(typeof left==="string"&&typeof right==="number"){return 1}if(typeof left==="string"&&typeof right==="boolean"){return-1}return 1}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(241);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(190);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.upperBound=upperBound;exports.lowerBound=lowerBound;exports.ColumnIndex=void 0;var _Cell=__webpack_require__(106);var _Matrix=__webpack_require__(189);var _statistics=__webpack_require__(176);var _ColumnBinarySearch=__webpack_require__(238);var _AddRowsTransformer=__webpack_require__(225);var _RemoveRowsTransformer=__webpack_require__(227);var _InterpreterValue=__webpack_require__(203);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ColumnIndex=function(){function ColumnIndex(dependencyGraph,config,stats){_classCallCheck(this,ColumnIndex);this.dependencyGraph=dependencyGraph;this.config=config;this.stats=stats;this.index=new Map;this.transformingService=this.dependencyGraph.lazilyTransformingAstService;this.binarySearchStrategy=new _ColumnBinarySearch.ColumnBinarySearch(dependencyGraph,config)}_createClass(ColumnIndex,[{key:"add",value:function add(value,address){if(value instanceof _Matrix.Matrix){var _iterator=_createForOfIteratorHelper(value.generateValues(address)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),matrixValue=_step$value[0],cellAddress=_step$value[1];this.addSingleCellValue(matrixValue,cellAddress)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else if(!(value instanceof _Cell.CellError||value instanceof _InterpreterValue.SimpleRangeValue)){this.addSingleCellValue(value,address)}}},{key:"remove",value:function remove(value,address){if(!value){return}if(value instanceof _Matrix.Matrix){var _iterator2=_createForOfIteratorHelper(value.generateValues(address)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),matrixValue=_step2$value[0],cellAddress=_step2$value[1];this.removeSingleValue(matrixValue,cellAddress)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else{this.removeSingleValue(value,address)}}},{key:"change",value:function change(oldValue,newValue,address){if(oldValue===newValue){return}this.remove(oldValue,address);this.add(newValue,address)}},{key:"moveValues",value:function moveValues(sourceRange,toRight,toBottom,toSheet){var _iterator3=_createForOfIteratorHelper(sourceRange),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),value=_step3$value[0],address=_step3$value[1];var targetAddress=(0,_Cell.movedSimpleCellAddress)(address,toSheet,toRight,toBottom);this.remove(value,address);this.add(value,targetAddress)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},{key:"removeValues",value:function removeValues(range){var _iterator4=_createForOfIteratorHelper(range),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),value=_step4$value[0],address=_step4$value[1];this.remove(value,address)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"find",value:function find(key,range,sorted){this.ensureRecentData(range.sheet,range.start.col,key);var columnMap=this.getColumnMap(range.sheet,range.start.col);if(!columnMap){return-1}var valueIndex=columnMap.get(key);if(!valueIndex){return this.binarySearchStrategy.find(key,range,sorted)}var index=upperBound(valueIndex.index,range.start.row);var rowNumber=valueIndex.index[index];return rowNumber<=range.end.row?rowNumber:this.binarySearchStrategy.find(key,range,sorted)}},{key:"advancedFind",value:function advancedFind(keyMatcher,range){return this.binarySearchStrategy.advancedFind(keyMatcher,range)}},{key:"addColumns",value:function addColumns(columnsSpan){var sheetIndex=this.index.get(columnsSpan.sheet);if(!sheetIndex){return}sheetIndex.splice.apply(sheetIndex,[columnsSpan.columnStart,0].concat(_toConsumableArray(Array(columnsSpan.numberOfColumns))))}},{key:"removeColumns",value:function removeColumns(columnsSpan){var sheetIndex=this.index.get(columnsSpan.sheet);if(!sheetIndex){return}sheetIndex.splice(columnsSpan.columnStart,columnsSpan.numberOfColumns)}},{key:"removeSheet",value:function removeSheet(sheetId){this.index.delete(sheetId)}},{key:"getColumnMap",value:function getColumnMap(sheet,col){if(!this.index.has(sheet)){this.index.set(sheet,[])}var sheetMap=this.index.get(sheet);var columnMap=sheetMap[col];if(!columnMap){columnMap=new Map;sheetMap[col]=columnMap}return columnMap}},{key:"getValueIndex",value:function getValueIndex(sheet,col,value){var columnMap=this.getColumnMap(sheet,col);var index=this.getColumnMap(sheet,col).get(value);if(!index){index={version:this.transformingService.version(),index:[]};columnMap.set(value,index)}return index}},{key:"ensureRecentData",value:function ensureRecentData(sheet,col,value){var valueIndex=this.getValueIndex(sheet,col,value);var actualVersion=this.transformingService.version();if(valueIndex.version===actualVersion){return}var relevantTransformations=this.transformingService.getTransformationsFrom(valueIndex.version,(function(transformation){return transformation.sheet===sheet&&(transformation instanceof _AddRowsTransformer.AddRowsTransformer||transformation instanceof _RemoveRowsTransformer.RemoveRowsTransformer)}));var _iterator5=_createForOfIteratorHelper(relevantTransformations),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var transformation=_step5.value;if(transformation instanceof _AddRowsTransformer.AddRowsTransformer){this.addRows(col,transformation.rowsSpan,value)}else if(transformation instanceof _RemoveRowsTransformer.RemoveRowsTransformer){this.removeRows(col,transformation.rowsSpan,value)}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}valueIndex.version=actualVersion}},{key:"destroy",value:function destroy(){this.index.clear()}},{key:"addSingleCellValue",value:function addSingleCellValue(value,address){var _this=this;this.stats.measure(_statistics.StatType.BUILD_COLUMN_INDEX,(function(){_this.ensureRecentData(address.sheet,address.col,value);var valueIndex=_this.getValueIndex(address.sheet,address.col,value);_this.addValue(valueIndex,address.row)}))}},{key:"removeSingleValue",value:function removeSingleValue(value,address){var _this2=this;this.stats.measure(_statistics.StatType.BUILD_COLUMN_INDEX,(function(){_this2.ensureRecentData(address.sheet,address.col,value);var columnMap=_this2.getColumnMap(address.sheet,address.col);var valueIndex=columnMap.get(value);if(!valueIndex){return}var index=upperBound(valueIndex.index,address.row);valueIndex.index.splice(index,1);if(valueIndex.index.length===0){columnMap.delete(value)}if(columnMap.size===0){delete _this2.index.get(address.sheet)[address.col]}}))}},{key:"addRows",value:function addRows(col,rowsSpan,value){var valueIndex=this.getValueIndex(rowsSpan.sheet,col,value);this.shiftRows(valueIndex,rowsSpan.rowStart,rowsSpan.numberOfRows)}},{key:"removeRows",value:function removeRows(col,rowsSpan,value){var valueIndex=this.getValueIndex(rowsSpan.sheet,col,value);this.removeRowsFromValues(valueIndex,rowsSpan);this.shiftRows(valueIndex,rowsSpan.rowEnd+1,-rowsSpan.numberOfRows)}},{key:"addValue",value:function addValue(valueIndex,rowNumber){var rowIndex=lowerBound(valueIndex.index,rowNumber);var value=valueIndex.index[rowIndex];if(value===rowNumber){return}if(rowIndex===valueIndex.index.length-1){valueIndex.index.push(rowNumber)}else{valueIndex.index.splice(rowIndex+1,0,rowNumber)}}},{key:"removeRowsFromValues",value:function removeRowsFromValues(rows,rowsSpan){var start=upperBound(rows.index,rowsSpan.rowStart);var end=lowerBound(rows.index,rowsSpan.rowEnd);if(rows.index[start]<=rowsSpan.rowEnd){rows.index.splice(start,end-start+1)}}},{key:"shiftRows",value:function shiftRows(rows,afterRow,numberOfRows){var index=upperBound(rows.index,afterRow);for(var i=index;i<rows.index.length;++i){rows.index[i]+=numberOfRows}}}]);return ColumnIndex}();exports.ColumnIndex=ColumnIndex;function upperBound(values,key){var start=0;var end=values.length-1;while(start<=end){var center=Math.floor((start+end)/2);if(key>values[center]){start=center+1}else if(key<values[center]){end=center-1}else{return center}}return start}function lowerBound(values,key){var start=0;var end=values.length-1;while(start<=end){var center=Math.floor((start+end)/2);if(key>values[center]){start=center+1}else if(key<values[center]){end=center-1}else{return center}}return end}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $find=__webpack_require__(59).find;var addToUnscopables=__webpack_require__(76);var arrayMethodUsesToLength=__webpack_require__(88);var FIND="find";var SKIPS_HOLES=true;var USES_TO_LENGTH=arrayMethodUsesToLength(FIND);if(FIND in[])Array(1)[FIND]((function(){SKIPS_HOLES=false}));$({target:"Array",proto:true,forced:SKIPS_HOLES||!USES_TO_LENGTH},{find:function find(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined)}});addToUnscopables(FIND)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(218);__webpack_require__(75);__webpack_require__(157);__webpack_require__(113);__webpack_require__(84);__webpack_require__(196);__webpack_require__(89);__webpack_require__(164);__webpack_require__(158);__webpack_require__(92);__webpack_require__(96);__webpack_require__(243);__webpack_require__(98);__webpack_require__(244);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.Config=void 0;var _DateTimeDefault=__webpack_require__(246);var _DateTimeHelper=__webpack_require__(247);var _errors=__webpack_require__(183);var _ChooseAddressMappingPolicy=__webpack_require__(248);var _format=__webpack_require__(249);var _HyperFormula=__webpack_require__(212);var _licenseKeyValidator=__webpack_require__(255);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var __classPrivateFieldSet=void 0&&(void 0).__classPrivateFieldSet||function(receiver,privateMap,value){if(!privateMap.has(receiver)){throw new TypeError("attempted to set private field on non-instance")}privateMap.set(receiver,value);return value};var __classPrivateFieldGet=void 0&&(void 0).__classPrivateFieldGet||function(receiver,privateMap){if(!privateMap.has(receiver)){throw new TypeError("attempted to get private field on non-instance")}return privateMap.get(receiver)};var _licenseKeyValidityState;var PossibleGPUModeString=["gpu","cpu","dev"];var Config=function(){function Config(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},accentSensitive=_ref.accentSensitive,caseSensitive=_ref.caseSensitive,caseFirst=_ref.caseFirst,chooseAddressMappingPolicy=_ref.chooseAddressMappingPolicy,dateFormats=_ref.dateFormats,timeFormats=_ref.timeFormats,functionArgSeparator=_ref.functionArgSeparator,decimalSeparator=_ref.decimalSeparator,thousandSeparator=_ref.thousandSeparator,language=_ref.language,licenseKey=_ref.licenseKey,functionPlugins=_ref.functionPlugins,gpuMode=_ref.gpuMode,ignorePunctuation=_ref.ignorePunctuation,leapYear1900=_ref.leapYear1900,localeLang=_ref.localeLang,smartRounding=_ref.smartRounding,matrixDetection=_ref.matrixDetection,matrixDetectionThreshold=_ref.matrixDetectionThreshold,nullYear=_ref.nullYear,parseDateTime=_ref.parseDateTime,stringifyDateTime=_ref.stringifyDateTime,stringifyDuration=_ref.stringifyDuration,precisionEpsilon=_ref.precisionEpsilon,precisionRounding=_ref.precisionRounding,useColumnIndex=_ref.useColumnIndex,vlookupThreshold=_ref.vlookupThreshold,nullDate=_ref.nullDate,useStats=_ref.useStats,undoLimit=_ref.undoLimit,useRegularExpressions=_ref.useRegularExpressions,useWildcards=_ref.useWildcards,matchWholeCell=_ref.matchWholeCell,maxRows=_ref.maxRows,maxColumns=_ref.maxColumns;_classCallCheck(this,Config);_licenseKeyValidityState.set(this,void 0);this.accentSensitive=this.valueFromParam(accentSensitive,"boolean","accentSensitive");this.caseSensitive=this.valueFromParam(caseSensitive,"boolean","caseSensitive");this.caseFirst=this.valueFromParam(caseFirst,["upper","lower","false"],"caseFirst");this.ignorePunctuation=this.valueFromParam(ignorePunctuation,"boolean","ignorePunctuation");this.chooseAddressMappingPolicy=chooseAddressMappingPolicy!==null&&chooseAddressMappingPolicy!==void 0?chooseAddressMappingPolicy:Config.defaultConfig.chooseAddressMappingPolicy;this.dateFormats=this.valueFromParamCheck(dateFormats,Array.isArray,"array","dateFormats");this.timeFormats=this.valueFromParamCheck(timeFormats,Array.isArray,"array","timeFormats");this.functionArgSeparator=this.valueFromParam(functionArgSeparator,"string","functionArgSeparator");this.decimalSeparator=this.valueFromParam(decimalSeparator,[".",","],"decimalSeparator");this.language=this.valueFromParam(language,"string","language");this.licenseKey=this.valueFromParam(licenseKey,"string","licenseKey");__classPrivateFieldSet(this,_licenseKeyValidityState,(0,_licenseKeyValidator.checkLicenseKeyValidity)(this.licenseKey));this.thousandSeparator=this.valueFromParam(thousandSeparator,["",","," ","."],"thousandSeparator");this.localeLang=this.valueFromParam(localeLang,"string","localeLang");this.functionPlugins=functionPlugins!==null&&functionPlugins!==void 0?functionPlugins:Config.defaultConfig.functionPlugins;this.gpuMode=this.valueFromParam(gpuMode,PossibleGPUModeString,"gpuMode");this.smartRounding=this.valueFromParam(smartRounding,"boolean","smartRounding");this.matrixDetection=this.valueFromParam(matrixDetection,"boolean","matrixDetection");this.matrixDetectionThreshold=this.valueFromParam(matrixDetectionThreshold,"number","matrixDetectionThreshold");this.validateNumberToBeAtLeast(this.matrixDetectionThreshold,"matrixDetectionThreshold",1);this.nullYear=this.valueFromParam(nullYear,"number","nullYear");this.validateNumberToBeAtLeast(this.nullYear,"nullYear",0);this.validateNumberToBeAtMost(this.nullYear,"nullYear",100);this.precisionRounding=this.valueFromParam(precisionRounding,"number","precisionRounding");this.validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0);this.precisionEpsilon=this.valueFromParam(precisionEpsilon,"number","precisionEpsilon");this.validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0);this.useColumnIndex=this.valueFromParam(useColumnIndex,"boolean","useColumnIndex");this.useStats=this.valueFromParam(useStats,"boolean","useStats");this.vlookupThreshold=this.valueFromParam(vlookupThreshold,"number","vlookupThreshold");this.validateNumberToBeAtLeast(this.vlookupThreshold,"vlookupThreshold",1);this.parseDateTime=this.valueFromParam(parseDateTime,"function","parseDateTime");this.stringifyDateTime=this.valueFromParam(stringifyDateTime,"function","stringifyDateTime");this.stringifyDuration=this.valueFromParam(stringifyDuration,"function","stringifyDuration");this.translationPackage=_HyperFormula.HyperFormula.getLanguage(this.language);this.errorMapping=this.translationPackage.buildErrorMapping();this.nullDate=this.valueFromParamCheck(nullDate,_DateTimeHelper.instanceOfSimpleDate,"IDate","nullDate");this.leapYear1900=this.valueFromParam(leapYear1900,"boolean","leapYear1900");this.undoLimit=this.valueFromParam(undoLimit,"number","undoLimit");this.useRegularExpressions=this.valueFromParam(useRegularExpressions,"boolean","useRegularExpressions");this.useWildcards=this.valueFromParam(useWildcards,"boolean","useWildcards");this.matchWholeCell=this.valueFromParam(matchWholeCell,"boolean","matchWholeCell");this.validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0);this.maxRows=this.valueFromParam(maxRows,"number","maxRows");this.validateNumberToBeAtLeast(this.maxRows,"maxRows",1);this.maxColumns=this.valueFromParam(maxColumns,"number","maxColumns");this.validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1);this.checkIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"})}_createClass(Config,[{key:"getConfig",value:function getConfig(){return this}},{key:"mergeConfig",value:function mergeConfig(init){var mergedConfig=Object.assign({},this.getConfig(),init);return new Config(mergedConfig)}},{key:"valueFromParam",value:function valueFromParam(inputValue,expectedType,paramName){if(typeof inputValue==="undefined"){return Config.defaultConfig[paramName]}else if(typeof expectedType==="string"){if(_typeof(inputValue)===expectedType){return inputValue}else{throw new _errors.ExpectedValueOfTypeError(expectedType,paramName)}}else{if(expectedType.includes(inputValue)){return inputValue}else{throw new _errors.ExpectedOneOfValuesError(expectedType.map((function(val){return"'"+val+"'"})).join(" "),paramName)}}}},{key:"valueFromParamCheck",value:function valueFromParamCheck(inputValue,typeCheck,expectedType,paramName){if(typeCheck(inputValue)){return inputValue}else if(typeof inputValue==="undefined"){return Config.defaultConfig[paramName]}else{throw new _errors.ExpectedValueOfTypeError(expectedType,paramName)}}},{key:"checkIfParametersNotInConflict",value:function checkIfParametersNotInConflict(){var valuesMap=new Map;for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++){params[_key]=arguments[_key]}params.forEach((function(param){var names=valuesMap.get(param.value)||[];names.push(param.name);valuesMap.set(param.value,names)}));var duplicates=[];var _iterator=_createForOfIteratorHelper(valuesMap.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var entry=_step.value;if(entry.length>1){duplicates.push(entry)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(duplicates.length>0){var paramNames=duplicates.map((function(entry){return"[".concat(entry.sort(),"]")})).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(paramNames))}}},{key:"validateNumberToBeAtLeast",value:function validateNumberToBeAtLeast(value,paramName,minimum){if(value<minimum){throw new _errors.ConfigValueTooSmallError(paramName,minimum)}}},{key:"validateNumberToBeAtMost",value:function validateNumberToBeAtMost(value,paramName,maximum){if(value>maximum){throw new _errors.ConfigValueTooBigError(paramName,maximum)}}},{key:"licenseKeyValidityState",get:function get(){return __classPrivateFieldGet(this,_licenseKeyValidityState)}}]);return Config}();exports.Config=Config;_licenseKeyValidityState=new WeakMap;Config.defaultConfig={accentSensitive:false,caseSensitive:false,caseFirst:"lower",ignorePunctuation:false,chooseAddressMappingPolicy:new _ChooseAddressMappingPolicy.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],functionArgSeparator:",",decimalSeparator:".",thousandSeparator:"",language:"enGB",licenseKey:"",functionPlugins:[],gpuMode:"gpu",leapYear1900:false,smartRounding:true,localeLang:"en",matrixDetection:true,matrixDetectionThreshold:100,nullYear:30,parseDateTime:_DateTimeDefault.defaultParseToDateTime,stringifyDateTime:_format.defaultStringifyDateTime,stringifyDuration:_format.defaultStringifyDuration,precisionEpsilon:1e-13,precisionRounding:14,useColumnIndex:false,useStats:false,vlookupThreshold:20,nullDate:{year:1899,month:12,day:30},undoLimit:20,useRegularExpressions:false,useWildcards:true,matchWholeCell:true,maxRows:4e4,maxColumns:18278}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var notARegExp=__webpack_require__(101);var requireObjectCoercible=__webpack_require__(13);var correctIsRegExpLogic=__webpack_require__(103);$({target:"String",proto:true,forced:!correctIsRegExpLogic("includes")},{includes:function includes(searchString){return!!~String(requireObjectCoercible(this)).indexOf(notARegExp(searchString),arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(3);var redefineAll=__webpack_require__(122);var InternalMetadataModule=__webpack_require__(116);var collection=__webpack_require__(115);var collectionWeak=__webpack_require__(245);var isObject=__webpack_require__(15);var enforceIternalState=__webpack_require__(26).enforce;var NATIVE_WEAK_MAP=__webpack_require__(27);var IS_IE11=!global.ActiveXObject&&"ActiveXObject"in global;var isExtensible=Object.isExtensible;var InternalWeakMap;var wrapper=function(init){return function WeakMap(){return init(this,arguments.length?arguments[0]:undefined)}};var $WeakMap=module.exports=collection("WeakMap",wrapper,collectionWeak);if(NATIVE_WEAK_MAP&&IS_IE11){InternalWeakMap=collectionWeak.getConstructor(wrapper,"WeakMap",true);InternalMetadataModule.REQUIRED=true;var WeakMapPrototype=$WeakMap.prototype;var nativeDelete=WeakMapPrototype["delete"];var nativeHas=WeakMapPrototype.has;var nativeGet=WeakMapPrototype.get;var nativeSet=WeakMapPrototype.set;redefineAll(WeakMapPrototype,{delete:function(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeDelete.call(this,key)||state.frozen["delete"](key)}return nativeDelete.call(this,key)},has:function has(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeHas.call(this,key)||state.frozen.has(key)}return nativeHas.call(this,key)},get:function get(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeHas.call(this,key)?nativeGet.call(this,key):state.frozen.get(key)}return nativeGet.call(this,key)},set:function set(key,value){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;nativeHas.call(this,key)?nativeSet.call(this,key,value):state.frozen.set(key,value)}else nativeSet.call(this,key,value);return this}})}},function(module,exports,__webpack_require__){"use strict";var redefineAll=__webpack_require__(122);var getWeakData=__webpack_require__(116).getWeakData;var anObject=__webpack_require__(21);var isObject=__webpack_require__(15);var anInstance=__webpack_require__(119);var iterate=__webpack_require__(118);var ArrayIterationModule=__webpack_require__(59);var $has=__webpack_require__(16);var InternalStateModule=__webpack_require__(26);var setInternalState=InternalStateModule.set;var internalStateGetterFor=InternalStateModule.getterFor;var find=ArrayIterationModule.find;var findIndex=ArrayIterationModule.findIndex;var id=0;var uncaughtFrozenStore=function(store){return store.frozen||(store.frozen=new UncaughtFrozenStore)};var UncaughtFrozenStore=function(){this.entries=[]};var findUncaughtFrozen=function(store,key){return find(store.entries,(function(it){return it[0]===key}))};UncaughtFrozenStore.prototype={get:function(key){var entry=findUncaughtFrozen(this,key);if(entry)return entry[1]},has:function(key){return!!findUncaughtFrozen(this,key)},set:function(key,value){var entry=findUncaughtFrozen(this,key);if(entry)entry[1]=value;else this.entries.push([key,value])},delete:function(key){var index=findIndex(this.entries,(function(it){return it[0]===key}));if(~index)this.entries.splice(index,1);return!!~index}};module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var C=wrapper((function(that,iterable){anInstance(that,C,CONSTRUCTOR_NAME);setInternalState(that,{type:CONSTRUCTOR_NAME,id:id++,frozen:undefined});if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP)}));var getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME);var define=function(that,key,value){var state=getInternalState(that);var data=getWeakData(anObject(key),true);if(data===true)uncaughtFrozenStore(state).set(key,value);else data[state.id]=value;return that};redefineAll(C.prototype,{delete:function(key){var state=getInternalState(this);if(!isObject(key))return false;var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state)["delete"](key);return data&&$has(data,state.id)&&delete data[state.id]},has:function has(key){var state=getInternalState(this);if(!isObject(key))return false;var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state).has(key);return data&&$has(data,state.id)}});redefineAll(C.prototype,IS_MAP?{get:function get(key){var state=getInternalState(this);if(isObject(key)){var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state).get(key);return data?data[state.id]:undefined}},set:function set(key,value){return define(this,key,value)}}:{add:function add(value){return define(this,value,true)}});return C}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(218);__webpack_require__(184);__webpack_require__(84);__webpack_require__(133);__webpack_require__(158);__webpack_require__(144);__webpack_require__(214);__webpack_require__(243);__webpack_require__(170);__webpack_require__(146);__webpack_require__(215);exports.__esModule=true;exports.defaultParseToDateTime=defaultParseToDateTime;exports.defaultParseToTime=defaultParseToTime;exports.defaultParseToDate=defaultParseToDate;exports.secondsExtendedRegexp=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function defaultParseToDateTime(dateTimeString,dateFormat,timeFormat){dateTimeString=dateTimeString.replace(/\s\s+/g," ").trim().toLowerCase();var ampmtoken=dateTimeString.substring(dateTimeString.length-2);if(ampmtoken==="am"||ampmtoken==="pm"){dateTimeString=dateTimeString.substring(0,dateTimeString.length-2).trim()}else{ampmtoken=dateTimeString.substring(dateTimeString.length-1);if(ampmtoken==="a"||ampmtoken==="p"){dateTimeString=dateTimeString.substring(0,dateTimeString.length-1).trim()}else{ampmtoken=undefined}}var dateItems=dateTimeString.split(/[ /.-]/g);if(dateItems.length>=2&&dateItems[dateItems.length-2].includes(":")){dateItems[dateItems.length-2]=dateItems[dateItems.length-2]+"."+dateItems[dateItems.length-1];dateItems.pop()}var timeItems=dateItems[dateItems.length-1].split(":");if(ampmtoken!==undefined){timeItems.push(ampmtoken)}if(dateItems.length===1){return defaultParseToTime(timeItems,timeFormat)}if(timeItems.length===1){return defaultParseToDate(dateItems,dateFormat)}var parsedDate=defaultParseToDate(dateItems.slice(0,dateItems.length-1),dateFormat);var parsedTime=defaultParseToTime(timeItems,timeFormat);if(parsedDate===undefined){return undefined}else if(parsedTime===undefined){return undefined}else{return Object.assign(Object.assign({},parsedDate),parsedTime)}}var secondsExtendedRegexp=/^ss\.(s+|0+)$/;exports.secondsExtendedRegexp=secondsExtendedRegexp;function defaultParseToTime(timeItems,timeFormat){timeFormat=timeFormat.toLowerCase();if(timeFormat.endsWith("am/pm")){timeFormat=timeFormat.substring(0,timeFormat.length-5).trim()}else if(timeFormat.endsWith("a/p")){timeFormat=timeFormat.substring(0,timeFormat.length-3).trim()}var formatItems=timeFormat.split(":");var ampm=undefined;if(timeItems[timeItems.length-1]==="am"||timeItems[timeItems.length-1]==="a"){ampm=false;timeItems.pop()}else if(timeItems[timeItems.length-1]==="pm"||timeItems[timeItems.length-1]==="p"){ampm=true;timeItems.pop()}var fractionOfSecondPrecision=0;if(formatItems.length>=1&&secondsExtendedRegexp.test(formatItems[formatItems.length-1])){fractionOfSecondPrecision=formatItems[formatItems.length-1].length-3;formatItems[formatItems.length-1]="ss"}if(timeItems.length!==formatItems.length){return undefined}var hourIndex=formatItems.indexOf("hh");var minuteIndex=formatItems.indexOf("mm");var secondIndex=formatItems.indexOf("ss");var hourString=hourIndex!==-1?timeItems[hourIndex]:"0";if(!/^\d+$/.test(hourString)){return undefined}var hours=Number(hourString);if(ampm!==undefined){if(hours<0||hours>12){return undefined}hours=hours%12;if(ampm){hours=hours+12}}var minuteString=minuteIndex!==-1?timeItems[minuteIndex]:"0";if(!/^\d+$/.test(minuteString)){return undefined}var minutes=Number(minuteString);var secondString=secondIndex!==-1?timeItems[secondIndex]:"0";if(!/^\d+(\.\d+)?$/.test(secondString)){return undefined}var seconds=Number(secondString);seconds=Math.round(seconds*Math.pow(10,fractionOfSecondPrecision))/Math.pow(10,fractionOfSecondPrecision);return{hours:hours,minutes:minutes,seconds:seconds}}function defaultParseToDate(dateItems,dateFormat){var formatItems=dateFormat.toLowerCase().split(/[ /.-]/g);if(dateItems.length!==formatItems.length){return undefined}var monthIndex=formatItems.indexOf("mm");var dayIndex=formatItems.indexOf("dd");var yearIndexLong=formatItems.indexOf("yyyy");var yearIndexShort=formatItems.indexOf("yy");if(!(monthIndex in dateItems)||!(dayIndex in dateItems)||!(yearIndexLong in dateItems)&&!(yearIndexShort in dateItems)){return undefined}if(yearIndexLong in dateItems&&yearIndexShort in dateItems){return undefined}var year;if(yearIndexLong in dateItems){var yearString=dateItems[yearIndexLong];if(/^\d+$/.test(yearString)){year=Number(yearString);if(year<1e3||year>9999){return undefined}}else{return undefined}}else{var _yearString=dateItems[yearIndexShort];if(/^\d+$/.test(_yearString)){year=Number(_yearString);if(year<0||year>99){return undefined}}else{return undefined}}var monthString=dateItems[monthIndex];if(!/^\d+$/.test(monthString)){return undefined}var month=Number(monthString);var dayString=dateItems[dayIndex];if(!/^\d+$/.test(dayString)){return undefined}var day=Number(dayString);return{year:year,month:month,day:day}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(158);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.instanceOfSimpleDate=instanceOfSimpleDate;exports.instanceOfSimpleTime=instanceOfSimpleTime;exports.endOfMonth=endOfMonth;exports.offsetMonth=offsetMonth;exports.DateTimeHelper=exports.maxDate=void 0;function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var numDays=[31,28,31,30,31,30,31,31,30,31,30,31];var prefSumDays=[0,31,59,90,120,151,181,212,243,273,303,334];function instanceOfSimpleDate(obj){if(obj&&(_typeof(obj)==="object"||typeof obj==="function")){return"year"in obj&&typeof obj.year==="number"&&"month"in obj&&typeof obj.month==="number"&&"day"in obj&&typeof obj.day==="number"}else{return false}}function instanceOfSimpleTime(obj){if(obj&&(_typeof(obj)==="object"||typeof obj==="function")){return"hours"in obj&&typeof obj.hours==="number"&&"minutes"in obj&&typeof obj.minutes==="number"&&"seconds"in obj&&typeof obj.seconds==="number"}else{return false}}var maxDate={year:9999,month:12,day:31};exports.maxDate=maxDate;var DateTimeHelper=function(){function DateTimeHelper(config){_classCallCheck(this,DateTimeHelper);this.config=config;this.minDateAboluteValue=this.dateToNumberFromZero(config.nullDate);this.maxDateValue=this.dateToNumber(maxDate);if(!config.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})){this.epochYearZero=this.numberToSimpleDate(2).year}else{this.epochYearZero=this.numberToSimpleDate(1).year}this.parseDateTime=config.parseDateTime}_createClass(DateTimeHelper,[{key:"getWithinBounds",value:function getWithinBounds(dayNumber){return dayNumber<=this.maxDateValue&&dayNumber>=0}},{key:"dateStringToDateNumber",value:function dateStringToDateNumber(dateTimeString){var dateTime=this.parseDateTimeFromFormats(dateTimeString,this.config.dateFormats,this.config.timeFormats);if(dateTime===undefined){return undefined}return(instanceOfSimpleTime(dateTime)?this.timeToNumber(dateTime):0)+(instanceOfSimpleDate(dateTime)?this.dateToNumber(dateTime):0)}},{key:"parseSingleFormat",value:function parseSingleFormat(dateString,dateFormat,timeFormat){var dateTime=this.parseDateTime(dateString,dateFormat,timeFormat);if(instanceOfSimpleDate(dateTime)){if(dateTime.year>=0&&dateTime.year<100){if(dateTime.year<this.getNullYear()){dateTime.year+=2e3}else{dateTime.year+=1900}}if(!this.isValidDate(dateTime)){return undefined}}return dateTime}},{key:"parseDateTimeFromFormats",value:function parseDateTimeFromFormats(dateString,dateFormats,timeFormats){var _iterator=_createForOfIteratorHelper(dateFormats),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var dateFormat=_step.value;var _iterator2=_createForOfIteratorHelper(timeFormats),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var timeFormat=_step2.value;var dateTime=this.parseSingleFormat(dateString,dateFormat,timeFormat);if(dateTime!==undefined){return dateTime}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return undefined}},{key:"getNullYear",value:function getNullYear(){return this.config.nullYear}},{key:"getEpochYearZero",value:function getEpochYearZero(){return this.epochYearZero}},{key:"isValidDate",value:function isValidDate(date){if(isNaN(date.year)||isNaN(date.month)||isNaN(date.day)){return false}else if(date.day!==Math.round(date.day)||date.month!==Math.round(date.month)||date.year!==Math.round(date.year)){return false}else if(date.year<1582){return false}else if(date.month<1||date.month>12){return false}else if(date.day<1){return false}else if(this.isLeapYear(date.year)&&date.month===2){return date.day<=29}else{return date.day<=numDays[date.month-1]}}},{key:"dateToNumber",value:function dateToNumber(date){return this.dateToNumberFromZero(date)-this.minDateAboluteValue}},{key:"timeToNumber",value:function timeToNumber(time){return((time.seconds/60+time.minutes)/60+time.hours)/24}},{key:"numberToSimpleDate",value:function numberToSimpleDate(arg){var dateNumber=arg+this.minDateAboluteValue;var year=Math.floor(dateNumber/365.2425);if(this.dateToNumberFromZero({year:year+1,month:1,day:1})<=dateNumber){year++}else if(this.dateToNumberFromZero({year:year-1,month:1,day:1})>dateNumber){year--}var dayOfYear=dateNumber-this.dateToNumberFromZero({year:year,month:1,day:1});var month=dayToMonth(this.isLeapYear(year)&&dayOfYear>=59?dayOfYear-1:dayOfYear);var day=dayOfYear-prefSumDays[month];return{year:year,month:month+1,day:day+1}}},{key:"numberToSimpleTime",value:function numberToSimpleTime(arg){arg=Math.round(arg*24*60*60*1e5)/(24*60*60*1e5);arg*=24;var hours=Math.floor(arg);arg-=hours;arg*=60;var minutes=Math.floor(arg);arg-=minutes;arg*=60;var seconds=Math.round(arg*1e5)/1e5;return{hours:hours,minutes:minutes,seconds:seconds}}},{key:"numberToSimpleDateTime",value:function numberToSimpleDateTime(arg){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(arg))),this.numberToSimpleTime(arg%1))}},{key:"leapYearsCount",value:function leapYearsCount(year){return Math.floor(year/4)-Math.floor(year/100)+Math.floor(year/400)+(this.config.leapYear1900&&year>=1900?1:0)}},{key:"dateToNumberFromZero",value:function dateToNumberFromZero(date){return 365*date.year+prefSumDays[date.month-1]+date.day-1+(date.month<=2?this.leapYearsCount(date.year-1):this.leapYearsCount(date.year))}},{key:"isLeapYear",value:function isLeapYear(year){if(year%4){return false}else if(year%100){return true}else if(year%400){return year===1900&&this.config.leapYear1900}else{return true}}}]);return DateTimeHelper}();exports.DateTimeHelper=DateTimeHelper;function dayToMonth(dayOfYear){var month=0;if(prefSumDays[month+6]<=dayOfYear){month+=6}if(prefSumDays[month+3]<=dayOfYear){month+=3}if(prefSumDays[month+2]<=dayOfYear){month+=2}else if(prefSumDays[month+1]<=dayOfYear){month+=1}return month}function endOfMonth(date){return{year:date.year,month:date.month,day:numDays[date.month-1]}}function offsetMonth(date,offset){var totalM=12*date.year+date.month-1+offset;return{year:Math.floor(totalM/12),month:totalM%12+1,day:date.day}}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.AlwaysDense=exports.AlwaysSparse=exports.DenseSparseChooseBasedOnThreshold=void 0;var _DenseStrategy=__webpack_require__(208);var _SparseStrategy=__webpack_require__(207);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var DenseSparseChooseBasedOnThreshold=function(){function DenseSparseChooseBasedOnThreshold(threshold){_classCallCheck(this,DenseSparseChooseBasedOnThreshold);this.threshold=threshold}_createClass(DenseSparseChooseBasedOnThreshold,[{key:"call",value:function call(fill){if(fill>this.threshold){return _DenseStrategy.DenseStrategy}else{return _SparseStrategy.SparseStrategy}}}]);return DenseSparseChooseBasedOnThreshold}();exports.DenseSparseChooseBasedOnThreshold=DenseSparseChooseBasedOnThreshold;var AlwaysSparse=function(){function AlwaysSparse(){_classCallCheck(this,AlwaysSparse)}_createClass(AlwaysSparse,[{key:"call",value:function call(){return _SparseStrategy.SparseStrategy}}]);return AlwaysSparse}();exports.AlwaysSparse=AlwaysSparse;var AlwaysDense=function(){function AlwaysDense(){_classCallCheck(this,AlwaysDense)}_createClass(AlwaysDense,[{key:"call",value:function call(){return _DenseStrategy.DenseStrategy}}]);return AlwaysDense}();exports.AlwaysDense=AlwaysDense},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(133);__webpack_require__(250);__webpack_require__(92);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(146);__webpack_require__(100);__webpack_require__(104);exports.__esModule=true;exports.format=format;exports.padLeft=padLeft;exports.padRight=padRight;exports.defaultStringifyDuration=defaultStringifyDuration;exports.defaultStringifyDateTime=defaultStringifyDateTime;var _DateTimeDefault=__webpack_require__(246);var _parser=__webpack_require__(253);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function format(value,formatArg,config,dateHelper){var tryDateTime=config.stringifyDateTime(dateHelper.numberToSimpleDateTime(value),formatArg);if(tryDateTime!==undefined){return tryDateTime}var tryDuration=config.stringifyDuration(dateHelper.numberToSimpleTime(value),formatArg);if(tryDuration!==undefined){return tryDuration}var expression=(0,_parser.parseForNumberFormat)(formatArg);if(expression!==undefined){return numberFormat(expression.tokens,value)}return formatArg}function padLeft(number,size){var result=number+"";while(result.length<size){result="0"+result}return result}function padRight(number,size){var result=number+"";while(result.length<size){result=result+"0"}return result}function countChars(text,char){return text.split(char).length-1}function numberFormat(tokens,value){var result="";for(var i=0;i<tokens.length;++i){var token=tokens[i];if(token.type===_parser.TokenType.FREE_TEXT){result+=token.value;continue}var tokenParts=token.value.split(".");var integerFormat=tokenParts[0];var decimalFormat=tokenParts[1]||"";var separator=tokenParts[1]?".":"";var valueParts=Number(value.toFixed(decimalFormat.length)).toString().split(".");var integerPart=valueParts[0]||"";var decimalPart=valueParts[1]||"";if(integerFormat.length>integerPart.length){var _padSize=countChars(integerFormat.substr(0,integerFormat.length-integerPart.length),"0");integerPart=padLeft(integerPart,_padSize+integerPart.length)}var padSize=countChars(decimalFormat.substr(decimalPart.length,decimalFormat.length-decimalPart.length),"0");decimalPart=padRight(decimalPart,padSize+decimalPart.length);result+=integerPart+separator+decimalPart}return result}function defaultStringifyDuration(time,formatArg){var expression=(0,_parser.parseForDateTimeFormat)(formatArg);if(expression===undefined){return undefined}var tokens=expression.tokens;var result="";var _iterator=_createForOfIteratorHelper(tokens),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var token=_step.value;if(token.type===_parser.TokenType.FREE_TEXT){result+=token.value;continue}if(_DateTimeDefault.secondsExtendedRegexp.test(token.value)){var fractionOfSecondPrecision=token.value.length-3;result+=(time.seconds<10?"0":"")+Math.round(time.seconds*Math.pow(10,fractionOfSecondPrecision))/Math.pow(10,fractionOfSecondPrecision);continue}switch(token.value.toLowerCase()){case"h":case"hh":{result+=padLeft(time.hours,token.value.length);time.hours=0;break}case"[hh]":{result+=padLeft(time.hours,token.value.length-2);time.hours=0;break}case"m":case"mm":{result+=padLeft(time.minutes,token.value.length);time.minutes=0;break}case"[mm]":{result+=padLeft(time.minutes+60*time.hours,token.value.length-2);time.minutes=0;time.hours=0;break}case"s":case"ss":{result+=padLeft(time.seconds,token.value.length);break}default:{return undefined}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return result}function defaultStringifyDateTime(dateTime,formatArg){var expression=(0,_parser.parseForDateTimeFormat)(formatArg);if(expression===undefined){return undefined}var tokens=expression.tokens;var result="";var minutes=false;var ampm=tokens.some((function(token){return token.type===_parser.TokenType.FORMAT&&(token.value==="a/p"||token.value==="A/P"||token.value==="am/pm"||token.value==="AM/PM")}));for(var i=0;i<tokens.length;i++){var token=tokens[i];if(token.type===_parser.TokenType.FREE_TEXT){result+=token.value;continue}if(_DateTimeDefault.secondsExtendedRegexp.test(token.value)){var fractionOfSecondPrecision=token.value.length-3;result+=(dateTime.seconds<10?"0":"")+Math.round(dateTime.seconds*Math.pow(10,fractionOfSecondPrecision))/Math.pow(10,fractionOfSecondPrecision);continue}switch(token.value.toLowerCase()){case"h":case"hh":{minutes=true;result+=padLeft(ampm?(dateTime.hours+11)%12+1:dateTime.hours,token.value.length);break}case"d":case"dd":{result+=padLeft(dateTime.day,token.value.length);break}case"s":case"ss":{result+=padLeft(Math.round(dateTime.seconds),token.value.length);break}case"m":case"mm":{if(i+1<tokens.length&&tokens[i+1].value.startsWith(":")){minutes=true}if(minutes){result+=padLeft(dateTime.minutes,token.value.length)}else{result+=padLeft(dateTime.month,token.value.length)}minutes=true;break}case"yy":{result+=padLeft(dateTime.year%100,token.value.length);break}case"yyyy":{result+=dateTime.year;break}case"am/pm":case"a/p":{var _token$value$split=token.value.split("/"),_token$value$split2=_slicedToArray(_token$value$split,2),am=_token$value$split2[0],pm=_token$value$split2[1];result+=dateTime.hours<12?am:pm;break}default:{return undefined}}}return result}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var toInteger=__webpack_require__(41);var thisNumberValue=__webpack_require__(251);var repeat=__webpack_require__(252);var fails=__webpack_require__(7);var nativeToFixed=1..toFixed;var floor=Math.floor;var pow=function(x,n,acc){return n===0?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)};var log=function(x){var n=0;var x2=x;while(x2>=4096){n+=12;x2/=4096}while(x2>=2){n+=1;x2/=2}return n};var FORCED=nativeToFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(0xde0b6b3a7640080).toFixed(0)!=="1000000000000000128")||!fails((function(){nativeToFixed.call({})}));$({target:"Number",proto:true,forced:FORCED},{toFixed:function toFixed(fractionDigits){var number=thisNumberValue(this);var fractDigits=toInteger(fractionDigits);var data=[0,0,0,0,0,0];var sign="";var result="0";var e,z,j,k;var multiply=function(n,c){var index=-1;var c2=c;while(++index<6){c2+=n*data[index];data[index]=c2%1e7;c2=floor(c2/1e7)}};var divide=function(n){var index=6;var c=0;while(--index>=0){c+=data[index];data[index]=floor(c/n);c=c%n*1e7}};var dataToString=function(){var index=6;var s="";while(--index>=0){if(s!==""||index===0||data[index]!==0){var t=String(data[index]);s=s===""?t:s+repeat.call("0",7-t.length)+t}}return s};if(fractDigits<0||fractDigits>20)throw RangeError("Incorrect fraction digits");if(number!=number)return"NaN";if(number<=-1e21||number>=1e21)return String(number);if(number<0){sign="-";number=-number}if(number>1e-21){e=log(number*pow(2,69,1))-69;z=e<0?number*pow(2,-e,1):number/pow(2,e,1);z*=4503599627370496;e=52-e;if(e>0){multiply(0,z);j=fractDigits;while(j>=7){multiply(1e7,0);j-=7}multiply(pow(10,j,1),0);j=e-1;while(j>=23){divide(1<<23);j-=23}divide(1<<j);multiply(1,1);divide(2);result=dataToString()}else{multiply(0,z);multiply(1<<-e,0);result=dataToString()+repeat.call("0",fractDigits)}}if(fractDigits>0){k=result.length;result=sign+(k<=fractDigits?"0."+repeat.call("0",fractDigits-k)+result:result.slice(0,k-fractDigits)+"."+result.slice(k-fractDigits))}else{result=sign+result}return result}})},function(module,exports,__webpack_require__){var classof=__webpack_require__(12);module.exports=function(value){if(typeof value!="number"&&classof(value)!="Number"){throw TypeError("Incorrect invocation")}return+value}},function(module,exports,__webpack_require__){"use strict";var toInteger=__webpack_require__(41);var requireObjectCoercible=__webpack_require__(13);module.exports="".repeat||function repeat(count){var str=String(requireObjectCoercible(this));var result="";var n=toInteger(count);if(n<0||n==Infinity)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)result+=str;return result}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(254);__webpack_require__(144);__webpack_require__(100);exports.__esModule=true;exports.formatToken=formatToken;exports.parseForDateTimeFormat=parseForDateTimeFormat;exports.parseForNumberFormat=parseForNumberFormat;exports.parse=parse;exports.isEscapeToken=isEscapeToken;exports.FormatExpressionType=exports.TokenType=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var dateFormatRegex=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g;var numberFormatRegex=/(\\.|[#0]+(\.[#0]*)?)/g;var TokenType;exports.TokenType=TokenType;(function(TokenType){TokenType["FORMAT"]="FORMAT";TokenType["FREE_TEXT"]="FREE_TEXT"})(TokenType||(exports.TokenType=TokenType={}));function formatToken(type,value){return{type:type,value:value}}var FormatExpressionType;exports.FormatExpressionType=FormatExpressionType;(function(FormatExpressionType){FormatExpressionType["DATE"]="DATE";FormatExpressionType["NUMBER"]="NUMBER";FormatExpressionType["STRING"]="STRING"})(FormatExpressionType||(exports.FormatExpressionType=FormatExpressionType={}));function matchDateFormat(str){dateFormatRegex.lastIndex=0;var tokens=[];var m;do{m=dateFormatRegex.exec(str);if(m!==null){tokens.push(m)}}while(m);return tokens}function matchNumberFormat(str){numberFormatRegex.lastIndex=0;var numberFormatToken=numberFormatRegex.exec(str);if(numberFormatToken!==null){return[numberFormatToken]}else{return[]}}function createTokens(regexTokens,str){var tokens=[];var start=0;for(var i=0;i<regexTokens.length;++i){var token=regexTokens[i];if(token.index!==start){var beforeToken=str.substr(start,token.index-start);tokens.push(formatToken(TokenType.FREE_TEXT,beforeToken))}if(token[0].startsWith("\\")){tokens.push(formatToken(TokenType.FREE_TEXT,token[0]))}else{tokens.push(formatToken(TokenType.FORMAT,token[0]))}start=token.index+token[0].length}var lastToken=regexTokens[regexTokens.length-1];if(lastToken.index+lastToken[0].length<str.length){var afterLastToken=str.substr(lastToken.index+lastToken[0].length,str.length);tokens.push(formatToken(TokenType.FREE_TEXT,afterLastToken))}return tokens}function parseForDateTimeFormat(str){var dateFormatTokens=matchDateFormat(str);if(dateFormatTokens.every((function(elem){return isEscapeToken(elem)}))){return undefined}else{return{type:FormatExpressionType.DATE,tokens:createTokens(dateFormatTokens,str)}}}function parseForNumberFormat(str){var numberFormatTokens=matchNumberFormat(str);if(numberFormatTokens.every((function(elem){return isEscapeToken(elem)}))){return undefined}else{return{type:FormatExpressionType.NUMBER,tokens:createTokens(numberFormatTokens,str)}}}function parse(str){var _a,_b;return(_b=(_a=parseForDateTimeFormat(str))!==null&&_a!==void 0?_a:parseForNumberFormat(str))!==null&&_b!==void 0?_b:{type:FormatExpressionType.STRING,tokens:[{type:TokenType.FREE_TEXT,value:str}]}}function isEscapeToken(token){return token[0].startsWith("\\")}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $every=__webpack_require__(59).every;var arrayMethodIsStrict=__webpack_require__(112);var arrayMethodUsesToLength=__webpack_require__(88);var STRICT_METHOD=arrayMethodIsStrict("every");var USES_TO_LENGTH=arrayMethodUsesToLength("every");$({target:"Array",proto:true,forced:!STRICT_METHOD||!USES_TO_LENGTH},{every:function every(callbackfn){return $every(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(146);__webpack_require__(104);exports.__esModule=true;exports.checkLicenseKeyValidity=checkLicenseKeyValidity;var _licenseKeyHelper=__webpack_require__(256);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var consoleMessages={invalid:function invalid(){return"The license key for HyperFormula is invalid."},expired:function expired(_ref){var keyValidityDate=_ref.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(keyValidityDate,", and is not valid for the installed version.")},missing:function missing(){return"The license key for HyperFormula is missing."}};var _notified=false;function checkLicenseKeyValidity(licenseKey){var messageDescriptor={template:"missing",vars:{}};if(licenseKey==="non-commercial-and-evaluation"||licenseKey==="agpl-v3"||licenseKey==="internal-use-in-handsontable"){messageDescriptor.template="valid"}else if(typeof licenseKey==="string"&&(0,_licenseKeyHelper.checkKeySchema)(licenseKey)){var _split=("21/07/2020"||false).split("/"),_split2=_slicedToArray(_split,3),day=_split2[0],month=_split2[1],year=_split2[2];var releaseDays=Math.floor(new Date("".concat(month,"/").concat(day,"/").concat(year)).getTime()/864e5);var keyValidityDays=(0,_licenseKeyHelper.extractTime)(licenseKey);messageDescriptor.vars.keyValidityDate=formatDate(new Date((keyValidityDays+1)*864e5));if(releaseDays>keyValidityDays){messageDescriptor.template="expired"}else{messageDescriptor.template="valid"}}else if(licenseKey!==""){messageDescriptor.template="invalid"}if(!_notified&&messageDescriptor.template!=="valid"){console.warn(consoleMessages[messageDescriptor.template](messageDescriptor.vars));_notified=true}return messageDescriptor.template}function formatDate(date){var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var month=monthNames[date.getMonth()];var day=date.getDate();var year=date.getFullYear();return"".concat(month," ").concat(day,", ").concat(year)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(140);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(144);__webpack_require__(96);__webpack_require__(257);__webpack_require__(98);__webpack_require__(258);__webpack_require__(170);__webpack_require__(104);exports.__esModule=true;exports.extractTime=extractTime;exports.checkKeySchema=checkKeySchema;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var _rl="length";var _hd=function _hd(v){return parseInt(v,16)};var _pi=function _pi(v){return parseInt(v,10)};var _nm=function _nm(v){return(v+"").replace(/\-/g,"")};var _ss=function _ss(v,s,l){return v["substr"](s,l)};var _cp=function _cp(v){return v["codePointAt"](0)-65};function extractTime(v){return _nm(v)[_rl]===50>>1?_hd(_ss(_nm(v),_hd("12"),_cp("F")))/(_hd(_ss(_nm(v),_cp("C"),_cp("Y")>>4))||(~~![][_rl]<<3)+1):0}function checkKeySchema(v){v=(v+"").replace(/\-/g,"");if(v[_rl]!==_cp("Z")){return false}var sp=0;return[[0,_cp("G")+1],[_cp("H"),_cp("H")-1],[_cp("G")+_cp("H"),_cp("G")]].reduce((function(e,_ref,c){var _ref2=_slicedToArray(_ref,2),a=_ref2[0],b=_ref2[1];e|=(_pi("".concat(_pi(_hd(_ss.apply(void 0,[v].concat([sp+a-(c===3>>2?0:2),b+(!c?0:2)])))+(_hd(_ss.apply(void 0,[v].concat([sp+a+b,2])))+[]).padStart(2,"0"))))%97||2)>>1;sp+=2;return e}),_cp("A"))===[]+1>>1}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var codeAt=__webpack_require__(99).codeAt;$({target:"String",proto:true},{codePointAt:function codePointAt(pos){return codeAt(this,pos)}})},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(2);var $padStart=__webpack_require__(259).start;var WEBKIT_BUG=__webpack_require__(260);$({target:"String",proto:true,forced:WEBKIT_BUG},{padStart:function padStart(maxLength){return $padStart(this,maxLength,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){var toLength=__webpack_require__(40);var repeat=__webpack_require__(252);var requireObjectCoercible=__webpack_require__(13);var ceil=Math.ceil;var createMethod=function(IS_END){return function($this,maxLength,fillString){var S=String(requireObjectCoercible($this));var stringLength=S.length;var fillStr=fillString===undefined?" ":String(fillString);var intMaxLength=toLength(maxLength);var fillLen,stringFiller;if(intMaxLength<=stringLength||fillStr=="")return S;fillLen=intMaxLength-stringLength;stringFiller=repeat.call(fillStr,ceil(fillLen/fillStr.length));if(stringFiller.length>fillLen)stringFiller=stringFiller.slice(0,fillLen);return IS_END?S+stringFiller:stringFiller+S}};module.exports={start:createMethod(false),end:createMethod(true)}},function(module,exports,__webpack_require__){var userAgent=__webpack_require__(87);module.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(140);__webpack_require__(84);__webpack_require__(89);__webpack_require__(133);__webpack_require__(166);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.CrudOperations=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _CellContentParser=__webpack_require__(213);var _ClipboardOperations=__webpack_require__(221);var _Operations=__webpack_require__(220);var _NamedExpressions=__webpack_require__(211);var _errors=__webpack_require__(183);var _Span=__webpack_require__(174);var _UndoRedo=__webpack_require__(262);var _Sheet=__webpack_require__(232);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CrudOperations=function(){function CrudOperations(config,stats,dependencyGraph,columnSearch,parser,cellContentParser,lazilyTransformingAstService,namedExpressions){_classCallCheck(this,CrudOperations);this.config=config;this.stats=stats;this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.parser=parser;this.cellContentParser=cellContentParser;this.lazilyTransformingAstService=lazilyTransformingAstService;this.namedExpressions=namedExpressions;this.operations=new _Operations.Operations(this.dependencyGraph,this.columnSearch,this.cellContentParser,this.parser,this.stats,this.lazilyTransformingAstService,this.namedExpressions,this.config);this.clipboardOperations=new _ClipboardOperations.ClipboardOperations(this.dependencyGraph,this.operations,this.parser,this.lazilyTransformingAstService,this.config);this.undoRedo=new _UndoRedo.UndoRedo(this.config,this.operations)}_createClass(CrudOperations,[{key:"addRows",value:function addRows(sheet){for(var _len=arguments.length,indexes=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){indexes[_key-1]=arguments[_key]}var addRowsCommand=new _Operations.AddRowsCommand(sheet,indexes);this.ensureItIsPossibleToAddRows.apply(this,[sheet].concat(indexes));this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.operations.addRows(addRowsCommand);this.undoRedo.saveOperation(new _UndoRedo.AddRowsUndoEntry(addRowsCommand))}},{key:"removeRows",value:function removeRows(sheet){for(var _len2=arguments.length,indexes=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){indexes[_key2-1]=arguments[_key2]}var removeRowsCommand=new _Operations.RemoveRowsCommand(sheet,indexes);this.ensureItIsPossibleToRemoveRows.apply(this,[sheet].concat(indexes));this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var rowsRemovals=this.operations.removeRows(removeRowsCommand);this.undoRedo.saveOperation(new _UndoRedo.RemoveRowsUndoEntry(removeRowsCommand,rowsRemovals))}},{key:"addColumns",value:function addColumns(sheet){for(var _len3=arguments.length,indexes=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){indexes[_key3-1]=arguments[_key3]}var addColumnsCommand=new _Operations.AddColumnsCommand(sheet,indexes);this.ensureItIsPossibleToAddColumns.apply(this,[sheet].concat(indexes));this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.operations.addColumns(addColumnsCommand);this.undoRedo.saveOperation(new _UndoRedo.AddColumnsUndoEntry(addColumnsCommand))}},{key:"removeColumns",value:function removeColumns(sheet){for(var _len4=arguments.length,indexes=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){indexes[_key4-1]=arguments[_key4]}var removeColumnsCommand=new _Operations.RemoveColumnsCommand(sheet,indexes);this.ensureItIsPossibleToRemoveColumns.apply(this,[sheet].concat(indexes));this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var columnsRemovals=this.operations.removeColumns(removeColumnsCommand);this.undoRedo.saveOperation(new _UndoRedo.RemoveColumnsUndoEntry(removeColumnsCommand,columnsRemovals))}},{key:"moveCells",value:function moveCells(sourceLeftCorner,width,height,destinationLeftCorner){this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var _this$operations$move=this.operations.moveCells(sourceLeftCorner,width,height,destinationLeftCorner),version=_this$operations$move.version,overwrittenCellsData=_this$operations$move.overwrittenCellsData,addedGlobalNamedExpressions=_this$operations$move.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new _UndoRedo.MoveCellsUndoEntry(sourceLeftCorner,width,height,destinationLeftCorner,overwrittenCellsData,addedGlobalNamedExpressions,version))}},{key:"moveRows",value:function moveRows(sheet,startRow,numberOfRows,targetRow){this.ensureItIsPossibleToMoveRows(sheet,startRow,numberOfRows,targetRow);this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.operations.moveRows(sheet,startRow,numberOfRows,targetRow);this.undoRedo.saveOperation(new _UndoRedo.MoveRowsUndoEntry(sheet,startRow,numberOfRows,targetRow))}},{key:"moveColumns",value:function moveColumns(sheet,startColumn,numberOfColumns,targetColumn){this.ensureItIsPossibleToMoveColumns(sheet,startColumn,numberOfColumns,targetColumn);this.undoRedo.clearRedoStack();this.operations.moveColumns(sheet,startColumn,numberOfColumns,targetColumn);this.undoRedo.saveOperation(new _UndoRedo.MoveColumnsUndoEntry(sheet,startColumn,numberOfColumns,targetColumn))}},{key:"cut",value:function cut(sourceLeftCorner,width,height){this.clipboardOperations.cut(sourceLeftCorner,width,height)}},{key:"ensureItIsPossibleToCopy",value:function ensureItIsPossibleToCopy(sourceLeftCorner,width,height){if(!isPositiveInteger(width)){throw new _errors.InvalidArgumentsError("width to be positive integer.")}if(!isPositiveInteger(height)){throw new _errors.InvalidArgumentsError("height to be positive integer.")}}},{key:"copy",value:function copy(sourceLeftCorner,width,height){this.ensureItIsPossibleToCopy(sourceLeftCorner,width,height);this.clipboardOperations.copy(sourceLeftCorner,width,height)}},{key:"paste",value:function paste(targetLeftCorner){var clipboard=this.clipboardOperations.clipboard;if(clipboard===undefined){throw new _errors.NothingToPasteError}else if(this.clipboardOperations.isCutClipboard()){this.moveCells(clipboard.sourceLeftCorner,clipboard.width,clipboard.height,targetLeftCorner)}else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(targetLeftCorner);var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(targetLeftCorner,clipboard.width,clipboard.height);var oldContent=this.operations.getRangeClipboardCells(targetRange);this.undoRedo.clearRedoStack();this.dependencyGraph.breakNumericMatricesInRange(targetRange);var addedGlobalNamedExpressions=this.operations.restoreClipboardCells(clipboard.sourceLeftCorner.sheet,clipboard.getContent(targetLeftCorner));this.undoRedo.saveOperation(new _UndoRedo.PasteUndoEntry(targetLeftCorner,oldContent,clipboard.content,addedGlobalNamedExpressions))}}},{key:"beginUndoRedoBatchMode",value:function beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function isClipboardEmpty(){return this.clipboardOperations.clipboard===undefined}},{key:"clearClipboard",value:function clearClipboard(){this.clipboardOperations.clear()}},{key:"addSheet",value:function addSheet(name){if(name){this.ensureItIsPossibleToAddSheet(name)}this.undoRedo.clearRedoStack();var addedSheetName=this.operations.addSheet(name);this.undoRedo.saveOperation(new _UndoRedo.AddSheetUndoEntry(addedSheetName));return addedSheetName}},{key:"removeSheet",value:function removeSheet(sheetName){this.ensureSheetExists(sheetName);this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var sheetId=this.sheetMapping.fetch(sheetName);var originalName=this.sheetMapping.fetchDisplayName(sheetId);var oldSheetContent=this.operations.getSheetClipboardCells(sheetId);var version=this.operations.removeSheet(sheetName);this.undoRedo.saveOperation(new _UndoRedo.RemoveSheetUndoEntry(originalName,sheetId,oldSheetContent,version))}},{key:"renameSheet",value:function renameSheet(sheetId,newName){this.ensureItIsPossibleToRenameSheet(sheetId,newName);var oldName=this.operations.renameSheet(sheetId,newName);if(oldName!==undefined){this.undoRedo.clearRedoStack();this.undoRedo.saveOperation(new _UndoRedo.RenameSheetUndoEntry(sheetId,oldName,newName))}return oldName}},{key:"clearSheet",value:function clearSheet(sheetName){this.ensureSheetExists(sheetName);this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var sheetId=this.sheetMapping.fetch(sheetName);var oldSheetContent=this.operations.getSheetClipboardCells(sheetId);this.operations.clearSheet(sheetId);this.undoRedo.saveOperation(new _UndoRedo.ClearSheetUndoEntry(sheetId,oldSheetContent))}},{key:"setCellContents",value:function setCellContents(topLeftCornerAddress,cellContents){if(!(cellContents instanceof Array)){cellContents=[[cellContents]]}else{for(var i=0;i<cellContents.length;i++){if(!(cellContents[i]instanceof Array)){throw new _errors.InvalidArgumentsError("an array of arrays or a raw cell value.")}for(var j=0;j<cellContents[i].length;j++){if((0,_CellContentParser.isMatrix)(cellContents[i][j])){throw new Error("Cant change matrices in batch operation")}}}}this.ensureItIsPossibleToChangeCellContents(topLeftCornerAddress,cellContents);this.undoRedo.clearRedoStack();var modifiedCellContents=[];for(var _i=0;_i<cellContents.length;_i++){for(var _j=0;_j<cellContents[_i].length;_j++){var address={sheet:topLeftCornerAddress.sheet,row:topLeftCornerAddress.row+_i,col:topLeftCornerAddress.col+_j};this.clipboardOperations.abortCut();var oldContent=this.operations.getClipboardCell(address);this.operations.setCellContent(address,cellContents[_i][_j]);modifiedCellContents.push({address:address,newContent:cellContents[_i][_j],oldContent:oldContent})}}this.undoRedo.saveOperation(new _UndoRedo.SetCellContentsUndoEntry(modifiedCellContents))}},{key:"setSheetContent",value:function setSheetContent(sheetName,values){this.ensureSheetExists(sheetName);var sheetId=this.sheetMapping.fetch(sheetName);this.ensureItIsPossibleToChangeSheetContents(sheetId,values);(0,_Sheet.validateAsSheet)(values);this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();var oldSheetContent=this.operations.getSheetClipboardCells(sheetId);this.operations.setSheetContent(sheetId,values);this.undoRedo.saveOperation(new _UndoRedo.SetSheetContentUndoEntry(sheetId,oldSheetContent,values))}},{key:"undo",value:function undo(){if(this.undoRedo.isUndoStackEmpty()){throw new _errors.NoOperationToUndoError}this.clipboardOperations.abortCut();this.undoRedo.undo()}},{key:"redo",value:function redo(){if(this.undoRedo.isRedoStackEmpty()){throw new _errors.NoOperationToRedoError}this.clipboardOperations.abortCut();this.undoRedo.redo()}},{key:"addNamedExpression",value:function addNamedExpression(expressionName,expression,sheetScope,options){var sheetId=this.scopeId(sheetScope);this.ensureNamedExpressionNameIsValid(expressionName,sheetId);this.operations.addNamedExpression(expressionName,expression,sheetId,options);this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.undoRedo.saveOperation(new _UndoRedo.AddNamedExpressionUndoEntry(expressionName,expression,sheetId,options))}},{key:"changeNamedExpressionExpression",value:function changeNamedExpressionExpression(expressionName,sheetScope,newExpression,options){var sheetId=this.scopeId(sheetScope);var _this$operations$chan=this.operations.changeNamedExpressionExpression(expressionName,newExpression,sheetId,options),_this$operations$chan2=_slicedToArray(_this$operations$chan,2),oldNamedExpression=_this$operations$chan2[0],content=_this$operations$chan2[1];this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.undoRedo.saveOperation(new _UndoRedo.ChangeNamedExpressionUndoEntry(oldNamedExpression,newExpression,content,sheetId,options))}},{key:"removeNamedExpression",value:function removeNamedExpression(expressionName,sheetScope){var sheetId=this.scopeId(sheetScope);var _this$operations$remo=this.operations.removeNamedExpression(expressionName,sheetId),_this$operations$remo2=_slicedToArray(_this$operations$remo,2),namedExpression=_this$operations$remo2[0],content=_this$operations$remo2[1];this.undoRedo.clearRedoStack();this.clipboardOperations.abortCut();this.undoRedo.saveOperation(new _UndoRedo.RemoveNamedExpressionUndoEntry(namedExpression,content,sheetId));return namedExpression}},{key:"ensureItIsPossibleToAddNamedExpression",value:function ensureItIsPossibleToAddNamedExpression(expressionName,expression,sheetScope){var scopeId=this.scopeId(sheetScope);this.ensureNamedExpressionNameIsValid(expressionName,scopeId);this.ensureNamedExpressionIsValid(expression)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function ensureItIsPossibleToChangeNamedExpression(expressionName,expression,sheetScope){var scopeId=this.scopeId(sheetScope);if(this.namedExpressions.namedExpressionForScope(expressionName,scopeId)===undefined){throw new _errors.NamedExpressionDoesNotExistError(expressionName)}this.ensureNamedExpressionIsValid(expression)}},{key:"isItPossibleToRemoveNamedExpression",value:function isItPossibleToRemoveNamedExpression(expressionName,sheetScope){var scopeId=this.scopeId(sheetScope);if(this.namedExpressions.namedExpressionForScope(expressionName,scopeId)===undefined){throw new _errors.NamedExpressionDoesNotExistError(expressionName)}}},{key:"ensureItIsPossibleToAddRows",value:function ensureItIsPossibleToAddRows(sheet){if(!this.sheetMapping.hasSheetWithId(sheet)){throw new _errors.NoSheetWithIdError(sheet)}var sheetHeight=this.dependencyGraph.getSheetHeight(sheet);for(var _len5=arguments.length,indexes=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){indexes[_key5-1]=arguments[_key5]}var newRowsCount=indexes.map((function(index){return index[1]})).reduce((function(a,b){return a+b}),0);if(sheetHeight+newRowsCount>this.config.maxRows){throw new _errors.SheetSizeLimitExceededError}for(var _i2=0,_indexes=indexes;_i2<_indexes.length;_i2++){var _indexes$_i=_slicedToArray(_indexes[_i2],2),row=_indexes$_i[0],numberOfRowsToAdd=_indexes$_i[1];if(!isNonnegativeInteger(row)||!isPositiveInteger(numberOfRowsToAdd)){throw new _errors.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}if(isPositiveInteger(row)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(sheet,row-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(sheet,row)){throw new _errors.TargetLocationHasMatrixError}}}},{key:"ensureItIsPossibleToRemoveRows",value:function ensureItIsPossibleToRemoveRows(sheet){for(var _len6=arguments.length,indexes=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){indexes[_key6-1]=arguments[_key6]}for(var _i3=0,_indexes2=indexes;_i3<_indexes2.length;_i3++){var _indexes2$_i=_slicedToArray(_indexes2[_i3],2),rowStart=_indexes2$_i[0],numberOfRows=_indexes2$_i[1];var rowEnd=rowStart+numberOfRows-1;if(!isNonnegativeInteger(rowStart)||!isNonnegativeInteger(rowEnd)){throw new _errors.InvalidArgumentsError("starting and ending row to be nonnegative.")}if(rowEnd<rowStart){throw new _errors.InvalidArgumentsError("starting row to be smaller than the ending row.")}var rowsToRemove=_Span.RowsSpan.fromRowStartAndEnd(sheet,rowStart,rowEnd);if(!this.sheetMapping.hasSheetWithId(sheet)){throw new _errors.NoSheetWithIdError(sheet)}if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRows(rowsToRemove)){throw new _errors.SourceLocationHasMatrixError}}}},{key:"ensureItIsPossibleToAddColumns",value:function ensureItIsPossibleToAddColumns(sheet){if(!this.sheetMapping.hasSheetWithId(sheet)){throw new _errors.NoSheetWithIdError(sheet)}var sheetWidth=this.dependencyGraph.getSheetWidth(sheet);for(var _len7=arguments.length,indexes=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++){indexes[_key7-1]=arguments[_key7]}var newColumnsCount=indexes.map((function(index){return index[1]})).reduce((function(a,b){return a+b}),0);if(sheetWidth+newColumnsCount>this.config.maxColumns){throw new _errors.SheetSizeLimitExceededError}for(var _i4=0,_indexes3=indexes;_i4<_indexes3.length;_i4++){var _indexes3$_i=_slicedToArray(_indexes3[_i4],2),column=_indexes3$_i[0],numberOfColumnsToAdd=_indexes3$_i[1];if(!isNonnegativeInteger(column)||!isPositiveInteger(numberOfColumnsToAdd)){throw new _errors.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}if(isPositiveInteger(column)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(sheet,column-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(sheet,column)){throw new _errors.TargetLocationHasMatrixError}}}},{key:"ensureItIsPossibleToRemoveColumns",value:function ensureItIsPossibleToRemoveColumns(sheet){for(var _len8=arguments.length,indexes=new Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++){indexes[_key8-1]=arguments[_key8]}for(var _i5=0,_indexes4=indexes;_i5<_indexes4.length;_i5++){var _indexes4$_i=_slicedToArray(_indexes4[_i5],2),columnStart=_indexes4$_i[0],numberOfColumns=_indexes4$_i[1];var columnEnd=columnStart+numberOfColumns-1;if(!isNonnegativeInteger(columnStart)||!isNonnegativeInteger(columnEnd)){throw new _errors.InvalidArgumentsError("starting and ending column to be nonnegative.")}if(columnEnd<columnStart){throw new _errors.InvalidArgumentsError("starting column to be smaller than the ending column.")}var columnsToRemove=_Span.ColumnsSpan.fromColumnStartAndEnd(sheet,columnStart,columnEnd);if(!this.sheetMapping.hasSheetWithId(sheet)){throw new _errors.NoSheetWithIdError(sheet)}if(this.dependencyGraph.matrixMapping.isFormulaMatrixInColumns(columnsToRemove)){throw new _errors.SourceLocationHasMatrixError}}}},{key:"ensureItIsPossibleToMoveRows",value:function ensureItIsPossibleToMoveRows(sheet,startRow,numberOfRows,targetRow){this.ensureItIsPossibleToAddRows(sheet,[targetRow,numberOfRows]);var sourceStart=(0,_Cell.simpleCellAddress)(sheet,0,startRow);var targetStart=(0,_Cell.simpleCellAddress)(sheet,0,targetRow);if(!this.sheetMapping.hasSheetWithId(sheet)||(0,_Cell.invalidSimpleCellAddress)(sourceStart)||(0,_Cell.invalidSimpleCellAddress)(targetStart)||!isPositiveInteger(numberOfRows)||targetRow<=startRow+numberOfRows&&targetRow>=startRow){throw new _errors.InvalidArgumentsError("a valid range of rows to move.")}var width=this.dependencyGraph.getSheetWidth(sheet);var sourceRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(sourceStart,width,numberOfRows);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(sourceRange)){throw new _errors.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToMoveColumns",value:function ensureItIsPossibleToMoveColumns(sheet,startColumn,numberOfColumns,targetColumn){this.ensureItIsPossibleToAddColumns(sheet,[targetColumn,numberOfColumns]);var sourceStart=(0,_Cell.simpleCellAddress)(sheet,startColumn,0);var targetStart=(0,_Cell.simpleCellAddress)(sheet,targetColumn,0);if(!this.sheetMapping.hasSheetWithId(sheet)||(0,_Cell.invalidSimpleCellAddress)(sourceStart)||(0,_Cell.invalidSimpleCellAddress)(targetStart)||!isPositiveInteger(numberOfColumns)||targetColumn<=startColumn+numberOfColumns&&targetColumn>=startColumn){throw new _errors.InvalidArgumentsError("a valid range of columns to move.")}var sheetHeight=this.dependencyGraph.getSheetHeight(sheet);var sourceRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(sourceStart,numberOfColumns,sheetHeight);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(sourceRange)){throw new _errors.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToAddSheet",value:function ensureItIsPossibleToAddSheet(name){if(this.sheetMapping.hasSheetWithName(name)){throw new _errors.SheetNameAlreadyTakenError(name)}}},{key:"ensureItIsPossibleToRenameSheet",value:function ensureItIsPossibleToRenameSheet(sheetId,name){if(!this.sheetMapping.hasSheetWithId(sheetId)){throw new _errors.NoSheetWithIdError(sheetId)}var existingSheetId=this.sheetMapping.get(name);if(existingSheetId!==undefined&&existingSheetId!==sheetId){throw new _errors.SheetNameAlreadyTakenError(name)}}},{key:"ensureItIsPossibleToChangeContent",value:function ensureItIsPossibleToChangeContent(address){if((0,_Cell.invalidSimpleCellAddress)(address)){throw new _errors.InvalidAddressError(address)}if(!this.sheetMapping.hasSheetWithId(address.sheet)){throw new _errors.NoSheetWithIdError(address.sheet)}if(this.dependencyGraph.matrixMapping.isFormulaMatrixAtAddress(address)){throw new _errors.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToChangeCellContents",value:function ensureItIsPossibleToChangeCellContents(address,content){var boundaries=(0,_Sheet.findBoundaries)(content);var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(address,boundaries.width,boundaries.height);this.ensureRangeInSizeLimits(targetRange);var _iterator=_createForOfIteratorHelper(targetRange.addresses(this.dependencyGraph)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _address=_step.value;this.ensureItIsPossibleToChangeContent(_address)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function ensureItIsPossibleToChangeSheetContents(sheetId,content){var boundaries=(0,_Sheet.findBoundaries)(content);var targetRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom((0,_Cell.simpleCellAddress)(sheetId,0,0),boundaries.width,boundaries.height);this.ensureRangeInSizeLimits(targetRange)}},{key:"ensureRangeInSizeLimits",value:function ensureRangeInSizeLimits(range){if(range.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows)){throw new _errors.SheetSizeLimitExceededError}}},{key:"isThereSomethingToUndo",value:function isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}},{key:"ensureSheetExists",value:function ensureSheetExists(sheetName){if(!this.sheetMapping.hasSheetWithName(sheetName)){throw new _errors.NoSheetWithNameError(sheetName)}}},{key:"scopeId",value:function scopeId(sheetName){if(sheetName!==undefined){this.ensureSheetExists(sheetName);return this.sheetMapping.fetch(sheetName)}return undefined}},{key:"ensureNamedExpressionNameIsValid",value:function ensureNamedExpressionNameIsValid(expressionName,sheetId){if(!this.namedExpressions.isNameValid(expressionName)){throw new _errors.NamedExpressionNameIsInvalidError(expressionName)}if(!this.namedExpressions.isNameAvailable(expressionName,sheetId)){throw new _errors.NamedExpressionNameIsAlreadyTakenError(expressionName)}}},{key:"ensureNamedExpressionIsValid",value:function ensureNamedExpressionIsValid(expression){var parsedExpression=this.cellContentParser.parse(expression);if(parsedExpression instanceof _CellContentParser.CellContent.MatrixFormula){throw new _errors.MatrixFormulasNotSupportedError}else if(parsedExpression instanceof _CellContentParser.CellContent.Formula){var parsingResult=this.parser.parse(parsedExpression.formula,(0,_Cell.simpleCellAddress)(-1,0,0));if((0,_NamedExpressions.doesContainRelativeReferences)(parsingResult.ast)){throw new _errors.NoRelativeAddressesAllowedError}}}},{key:"sheetMapping",get:function get(){return this.dependencyGraph.sheetMapping}}]);return CrudOperations}();exports.CrudOperations=CrudOperations;function isPositiveInteger(x){return Number.isInteger(x)&&x>0}function isNonnegativeInteger(x){return Number.isInteger(x)&&x>=0}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(190);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.UndoRedo=exports.BatchUndoEntry=exports.ChangeNamedExpressionUndoEntry=exports.RemoveNamedExpressionUndoEntry=exports.AddNamedExpressionUndoEntry=exports.PasteUndoEntry=exports.SetCellContentsUndoEntry=exports.ClearSheetUndoEntry=exports.RenameSheetUndoEntry=exports.RemoveSheetUndoEntry=exports.AddSheetUndoEntry=exports.RemoveColumnsUndoEntry=exports.AddColumnsUndoEntry=exports.MoveColumnsUndoEntry=exports.MoveRowsUndoEntry=exports.SetSheetContentUndoEntry=exports.AddRowsUndoEntry=exports.MoveCellsUndoEntry=exports.RemoveRowsUndoEntry=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);var _Operations=__webpack_require__(220);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RemoveRowsUndoEntry=function RemoveRowsUndoEntry(command,rowsRemovals){_classCallCheck(this,RemoveRowsUndoEntry);this.command=command;this.rowsRemovals=rowsRemovals};exports.RemoveRowsUndoEntry=RemoveRowsUndoEntry;var MoveCellsUndoEntry=function MoveCellsUndoEntry(sourceLeftCorner,width,height,destinationLeftCorner,overwrittenCellsData,addedGlobalNamedExpressions,version){_classCallCheck(this,MoveCellsUndoEntry);this.sourceLeftCorner=sourceLeftCorner;this.width=width;this.height=height;this.destinationLeftCorner=destinationLeftCorner;this.overwrittenCellsData=overwrittenCellsData;this.addedGlobalNamedExpressions=addedGlobalNamedExpressions;this.version=version};exports.MoveCellsUndoEntry=MoveCellsUndoEntry;var AddRowsUndoEntry=function AddRowsUndoEntry(command){_classCallCheck(this,AddRowsUndoEntry);this.command=command};exports.AddRowsUndoEntry=AddRowsUndoEntry;var SetSheetContentUndoEntry=function SetSheetContentUndoEntry(sheetId,oldSheetContent,newSheetContent){_classCallCheck(this,SetSheetContentUndoEntry);this.sheetId=sheetId;this.oldSheetContent=oldSheetContent;this.newSheetContent=newSheetContent};exports.SetSheetContentUndoEntry=SetSheetContentUndoEntry;var MoveRowsUndoEntry=function MoveRowsUndoEntry(sheet,startRow,numberOfRows,targetRow){_classCallCheck(this,MoveRowsUndoEntry);this.sheet=sheet;this.startRow=startRow;this.numberOfRows=numberOfRows;this.targetRow=targetRow};exports.MoveRowsUndoEntry=MoveRowsUndoEntry;var MoveColumnsUndoEntry=function MoveColumnsUndoEntry(sheet,startColumn,numberOfColumns,targetColumn){_classCallCheck(this,MoveColumnsUndoEntry);this.sheet=sheet;this.startColumn=startColumn;this.numberOfColumns=numberOfColumns;this.targetColumn=targetColumn};exports.MoveColumnsUndoEntry=MoveColumnsUndoEntry;var AddColumnsUndoEntry=function AddColumnsUndoEntry(command){_classCallCheck(this,AddColumnsUndoEntry);this.command=command};exports.AddColumnsUndoEntry=AddColumnsUndoEntry;var RemoveColumnsUndoEntry=function RemoveColumnsUndoEntry(command,columnsRemovals){_classCallCheck(this,RemoveColumnsUndoEntry);this.command=command;this.columnsRemovals=columnsRemovals};exports.RemoveColumnsUndoEntry=RemoveColumnsUndoEntry;var AddSheetUndoEntry=function AddSheetUndoEntry(sheetName){_classCallCheck(this,AddSheetUndoEntry);this.sheetName=sheetName};exports.AddSheetUndoEntry=AddSheetUndoEntry;var RemoveSheetUndoEntry=function RemoveSheetUndoEntry(sheetName,sheetId,oldSheetContent,version){_classCallCheck(this,RemoveSheetUndoEntry);this.sheetName=sheetName;this.sheetId=sheetId;this.oldSheetContent=oldSheetContent;this.version=version};exports.RemoveSheetUndoEntry=RemoveSheetUndoEntry;var RenameSheetUndoEntry=function RenameSheetUndoEntry(sheetId,oldName,newName){_classCallCheck(this,RenameSheetUndoEntry);this.sheetId=sheetId;this.oldName=oldName;this.newName=newName};exports.RenameSheetUndoEntry=RenameSheetUndoEntry;var ClearSheetUndoEntry=function ClearSheetUndoEntry(sheetId,oldSheetContent){_classCallCheck(this,ClearSheetUndoEntry);this.sheetId=sheetId;this.oldSheetContent=oldSheetContent};exports.ClearSheetUndoEntry=ClearSheetUndoEntry;var SetCellContentsUndoEntry=function SetCellContentsUndoEntry(cellContents){_classCallCheck(this,SetCellContentsUndoEntry);this.cellContents=cellContents};exports.SetCellContentsUndoEntry=SetCellContentsUndoEntry;var PasteUndoEntry=function PasteUndoEntry(targetLeftCorner,oldContent,newContent,addedGlobalNamedExpressions){_classCallCheck(this,PasteUndoEntry);this.targetLeftCorner=targetLeftCorner;this.oldContent=oldContent;this.newContent=newContent;this.addedGlobalNamedExpressions=addedGlobalNamedExpressions};exports.PasteUndoEntry=PasteUndoEntry;var AddNamedExpressionUndoEntry=function AddNamedExpressionUndoEntry(name,newContent,scope,options){_classCallCheck(this,AddNamedExpressionUndoEntry);this.name=name;this.newContent=newContent;this.scope=scope;this.options=options};exports.AddNamedExpressionUndoEntry=AddNamedExpressionUndoEntry;var RemoveNamedExpressionUndoEntry=function RemoveNamedExpressionUndoEntry(namedExpression,content,scope){_classCallCheck(this,RemoveNamedExpressionUndoEntry);this.namedExpression=namedExpression;this.content=content;this.scope=scope};exports.RemoveNamedExpressionUndoEntry=RemoveNamedExpressionUndoEntry;var ChangeNamedExpressionUndoEntry=function ChangeNamedExpressionUndoEntry(namedExpression,newContent,oldContent,scope,options){_classCallCheck(this,ChangeNamedExpressionUndoEntry);this.namedExpression=namedExpression;this.newContent=newContent;this.oldContent=oldContent;this.scope=scope;this.options=options};exports.ChangeNamedExpressionUndoEntry=ChangeNamedExpressionUndoEntry;var BatchUndoEntry=function(){function BatchUndoEntry(){_classCallCheck(this,BatchUndoEntry);this.operations=[]}_createClass(BatchUndoEntry,[{key:"add",value:function add(operation){this.operations.push(operation)}},{key:"reversedOperations",value:regeneratorRuntime.mark((function reversedOperations(){var i;return regeneratorRuntime.wrap((function reversedOperations$(_context){while(1){switch(_context.prev=_context.next){case 0:i=this.operations.length-1;case 1:if(!(i>=0)){_context.next=7;break}_context.next=4;return this.operations[i];case 4:i--;_context.next=1;break;case 7:case"end":return _context.stop()}}}),reversedOperations,this)}))}]);return BatchUndoEntry}();exports.BatchUndoEntry=BatchUndoEntry;var UndoRedo=function(){function UndoRedo(config,operations){_classCallCheck(this,UndoRedo);this.operations=operations;this.undoStack=[];this.redoStack=[];this.oldData=new Map;this.undoLimit=config.undoLimit}_createClass(UndoRedo,[{key:"saveOperation",value:function saveOperation(operation){if(this.batchUndoEntry!==undefined){this.batchUndoEntry.add(operation)}else{this.addUndoEntry(operation)}}},{key:"beginBatchMode",value:function beginBatchMode(){this.batchUndoEntry=new BatchUndoEntry}},{key:"addUndoEntry",value:function addUndoEntry(operation){this.undoStack.push(operation);this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"commitBatchMode",value:function commitBatchMode(){if(this.batchUndoEntry===undefined){throw"Batch mode wasn't started"}this.addUndoEntry(this.batchUndoEntry);this.batchUndoEntry=undefined}},{key:"storeDataForVersion",value:function storeDataForVersion(version,address,astHash){if(!this.oldData.has(version)){this.oldData.set(version,[])}var currentOldData=this.oldData.get(version);currentOldData.push([address,astHash])}},{key:"clearRedoStack",value:function clearRedoStack(){this.redoStack=[]}},{key:"clearUndoStack",value:function clearUndoStack(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function isUndoStackEmpty(){return this.undoStack.length===0}},{key:"isRedoStackEmpty",value:function isRedoStackEmpty(){return this.redoStack.length===0}},{key:"undo",value:function undo(){var operation=this.undoStack.pop();if(!operation){throw"Attempted to undo without operation on stack"}this.undoEntry(operation);this.redoStack.push(operation)}},{key:"undoEntry",value:function undoEntry(operation){if(operation instanceof RemoveRowsUndoEntry){this.undoRemoveRows(operation)}else if(operation instanceof AddRowsUndoEntry){this.undoAddRows(operation)}else if(operation instanceof SetCellContentsUndoEntry){this.undoSetCellContents(operation)}else if(operation instanceof MoveRowsUndoEntry){this.undoMoveRows(operation)}else if(operation instanceof AddSheetUndoEntry){this.undoAddSheet(operation)}else if(operation instanceof RemoveSheetUndoEntry){this.undoRemoveSheet(operation)}else if(operation instanceof RenameSheetUndoEntry){this.undoRenameSheet(operation)}else if(operation instanceof ClearSheetUndoEntry){this.undoClearSheet(operation)}else if(operation instanceof AddColumnsUndoEntry){this.undoAddColumns(operation)}else if(operation instanceof RemoveColumnsUndoEntry){this.undoRemoveColumns(operation)}else if(operation instanceof MoveColumnsUndoEntry){this.undoMoveColumns(operation)}else if(operation instanceof MoveCellsUndoEntry){this.undoMoveCells(operation)}else if(operation instanceof SetSheetContentUndoEntry){this.undoSetSheetContent(operation)}else if(operation instanceof PasteUndoEntry){this.undoPaste(operation)}else if(operation instanceof BatchUndoEntry){this.undoBatch(operation)}else if(operation instanceof AddNamedExpressionUndoEntry){this.undoAddNamedExpression(operation)}else if(operation instanceof RemoveNamedExpressionUndoEntry){this.undoRemoveNamedExpression(operation)}else if(operation instanceof ChangeNamedExpressionUndoEntry){this.undoChangeNamedExpression(operation)}else{throw"Unknown element"}}},{key:"undoBatch",value:function undoBatch(batchOperation){var _iterator=_createForOfIteratorHelper(batchOperation.reversedOperations()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var operation=_step.value;this.undoEntry(operation)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"undoRemoveRows",value:function undoRemoveRows(operation){this.operations.forceApplyPostponedTransformations();var sheet=operation.command.sheet,rowsRemovals=operation.rowsRemovals;for(var i=rowsRemovals.length-1;i>=0;--i){var rowsRemoval=rowsRemovals[i];this.operations.addRows(new _Operations.AddRowsCommand(sheet,[[rowsRemoval.rowFrom,rowsRemoval.rowCount]]));var _iterator2=_createForOfIteratorHelper(rowsRemoval.removedCells),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_step2.value,address=_step2$value.address,cellType=_step2$value.cellType;this.operations.restoreCell(address,cellType)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.restoreOldDataFromVersion(rowsRemoval.version-1)}}},{key:"undoRemoveColumns",value:function undoRemoveColumns(operation){this.operations.forceApplyPostponedTransformations();var sheet=operation.command.sheet,columnsRemovals=operation.columnsRemovals;for(var i=columnsRemovals.length-1;i>=0;--i){var columnsRemoval=columnsRemovals[i];this.operations.addColumns(new _Operations.AddColumnsCommand(sheet,[[columnsRemoval.columnFrom,columnsRemoval.columnCount]]));var _iterator3=_createForOfIteratorHelper(columnsRemoval.removedCells),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_step3.value,address=_step3$value.address,cellType=_step3$value.cellType;this.operations.restoreCell(address,cellType)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}this.restoreOldDataFromVersion(columnsRemoval.version-1)}}},{key:"undoAddRows",value:function undoAddRows(operation){var addedRowsSpans=operation.command.rowsSpans();for(var i=addedRowsSpans.length-1;i>=0;--i){var addedRows=addedRowsSpans[i];this.operations.removeRows(new _Operations.RemoveRowsCommand(operation.command.sheet,[[addedRows.rowStart,addedRows.numberOfRows]]))}}},{key:"undoAddColumns",value:function undoAddColumns(operation){var addedColumnsSpans=operation.command.columnsSpans();for(var i=addedColumnsSpans.length-1;i>=0;--i){var addedColumns=addedColumnsSpans[i];this.operations.removeColumns(new _Operations.RemoveColumnsCommand(operation.command.sheet,[[addedColumns.columnStart,addedColumns.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function undoSetCellContents(operation){var _iterator4=_createForOfIteratorHelper(operation.cellContents),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var cellContentData=_step4.value;this.operations.restoreCell(cellContentData.address,cellContentData.oldContent)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"undoPaste",value:function undoPaste(operation){var _iterator5=_createForOfIteratorHelper(operation.oldContent),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),address=_step5$value[0],clipboardCell=_step5$value[1];this.operations.restoreCell(address,clipboardCell)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var _iterator6=_createForOfIteratorHelper(operation.addedGlobalNamedExpressions),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var namedExpression=_step6.value;this.operations.removeNamedExpression(namedExpression)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}},{key:"undoMoveRows",value:function undoMoveRows(operation){var sheet=operation.sheet;this.operations.moveRows(sheet,operation.targetRow-operation.numberOfRows,operation.numberOfRows,operation.startRow)}},{key:"undoMoveColumns",value:function undoMoveColumns(operation){var sheet=operation.sheet;this.operations.moveColumns(sheet,operation.targetColumn-operation.numberOfColumns,operation.numberOfColumns,operation.startColumn)}},{key:"undoMoveCells",value:function undoMoveCells(operation){this.operations.forceApplyPostponedTransformations();this.operations.moveCells(operation.destinationLeftCorner,operation.width,operation.height,operation.sourceLeftCorner);var _iterator7=_createForOfIteratorHelper(operation.overwrittenCellsData),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step7$value=_slicedToArray(_step7.value,2),address=_step7$value[0],clipboardCell=_step7$value[1];this.operations.restoreCell(address,clipboardCell)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.restoreOldDataFromVersion(operation.version-1);var _iterator8=_createForOfIteratorHelper(operation.addedGlobalNamedExpressions),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var namedExpression=_step8.value;this.operations.removeNamedExpression(namedExpression)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}},{key:"undoAddSheet",value:function undoAddSheet(operation){var sheetName=operation.sheetName;this.operations.removeSheet(sheetName)}},{key:"undoRemoveSheet",value:function undoRemoveSheet(operation){this.operations.forceApplyPostponedTransformations();var oldSheetContent=operation.oldSheetContent,sheetId=operation.sheetId;this.operations.addSheet(operation.sheetName);for(var rowIndex=0;rowIndex<oldSheetContent.length;rowIndex++){var row=oldSheetContent[rowIndex];for(var col=0;col<row.length;col++){var cellType=row[col];var address=(0,_Cell.simpleCellAddress)(sheetId,col,rowIndex);this.operations.restoreCell(address,cellType)}}this.restoreOldDataFromVersion(operation.version-1)}},{key:"undoRenameSheet",value:function undoRenameSheet(operation){this.operations.renameSheet(operation.sheetId,operation.oldName)}},{key:"undoClearSheet",value:function undoClearSheet(operation){var oldSheetContent=operation.oldSheetContent,sheetId=operation.sheetId;for(var rowIndex=0;rowIndex<oldSheetContent.length;rowIndex++){var row=oldSheetContent[rowIndex];for(var col=0;col<row.length;col++){var cellType=row[col];var address=(0,_Cell.simpleCellAddress)(sheetId,col,rowIndex);this.operations.restoreCell(address,cellType)}}}},{key:"undoSetSheetContent",value:function undoSetSheetContent(operation){var oldSheetContent=operation.oldSheetContent,newSheetContent=operation.newSheetContent,sheetId=operation.sheetId;this.operations.clearSheet(sheetId);for(var rowIndex=0;rowIndex<oldSheetContent.length;rowIndex++){var row=oldSheetContent[rowIndex];for(var col=0;col<row.length;col++){var cellType=row[col];var address=(0,_Cell.simpleCellAddress)(sheetId,col,rowIndex);this.operations.restoreCell(address,cellType)}}}},{key:"undoAddNamedExpression",value:function undoAddNamedExpression(operation){this.operations.removeNamedExpression(operation.name,operation.scope)}},{key:"undoRemoveNamedExpression",value:function undoRemoveNamedExpression(operation){this.operations.restoreNamedExpression(operation.namedExpression,operation.content,operation.scope)}},{key:"undoChangeNamedExpression",value:function undoChangeNamedExpression(operation){this.operations.restoreNamedExpression(operation.namedExpression,operation.oldContent,operation.scope)}},{key:"redo",value:function redo(){var operation=this.redoStack.pop();if(!operation){throw"Attempted to redo without operation on stack"}this.redoEntry(operation);this.undoStack.push(operation)}},{key:"redoEntry",value:function redoEntry(operation){if(operation instanceof RemoveRowsUndoEntry){this.redoRemoveRows(operation)}else if(operation instanceof RemoveRowsUndoEntry){this.redoRemoveRows(operation)}else if(operation instanceof AddRowsUndoEntry){this.redoAddRows(operation)}else if(operation instanceof SetCellContentsUndoEntry){this.redoSetCellContents(operation)}else if(operation instanceof MoveRowsUndoEntry){this.redoMoveRows(operation)}else if(operation instanceof AddSheetUndoEntry){this.redoAddSheet(operation)}else if(operation instanceof RemoveSheetUndoEntry){this.redoRemoveSheet(operation)}else if(operation instanceof RenameSheetUndoEntry){this.redoRenameSheet(operation)}else if(operation instanceof ClearSheetUndoEntry){this.redoClearSheet(operation)}else if(operation instanceof AddColumnsUndoEntry){this.redoAddColumns(operation)}else if(operation instanceof RemoveColumnsUndoEntry){this.redoRemoveColumns(operation)}else if(operation instanceof MoveColumnsUndoEntry){this.redoMoveColumns(operation)}else if(operation instanceof MoveCellsUndoEntry){this.redoMoveCells(operation)}else if(operation instanceof SetSheetContentUndoEntry){this.redoSetSheetContent(operation)}else if(operation instanceof PasteUndoEntry){this.redoPaste(operation)}else if(operation instanceof BatchUndoEntry){this.redoBatch(operation)}else if(operation instanceof AddNamedExpressionUndoEntry){this.redoAddNamedExpression(operation)}else if(operation instanceof RemoveNamedExpressionUndoEntry){this.redoRemoveNamedExpression(operation)}else if(operation instanceof ChangeNamedExpressionUndoEntry){this.redoChangeNamedExpression(operation)}else{throw"Unknown element"}}},{key:"redoBatch",value:function redoBatch(batchOperation){var _iterator9=_createForOfIteratorHelper(batchOperation.operations),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var operation=_step9.value;this.redoEntry(operation)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}},{key:"redoRemoveRows",value:function redoRemoveRows(operation){this.operations.removeRows(operation.command)}},{key:"redoMoveCells",value:function redoMoveCells(operation){this.operations.moveCells(operation.sourceLeftCorner,operation.width,operation.height,operation.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function redoRemoveColumns(operation){this.operations.removeColumns(operation.command)}},{key:"redoPaste",value:function redoPaste(operation){var targetLeftCorner=operation.targetLeftCorner,newContent=operation.newContent;var height=newContent.length;var width=newContent[0].length;for(var y=0;y<height;++y){for(var x=0;x<width;++x){var address=(0,_Cell.simpleCellAddress)(targetLeftCorner.sheet,targetLeftCorner.col+x,targetLeftCorner.row+y);this.operations.restoreCell(address,newContent[y][x])}}}},{key:"redoSetCellContents",value:function redoSetCellContents(operation){var _iterator10=_createForOfIteratorHelper(operation.cellContents),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var cellContentData=_step10.value;this.operations.setCellContent(cellContentData.address,cellContentData.newContent)}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}},{key:"redoAddRows",value:function redoAddRows(operation){this.operations.addRows(operation.command)}},{key:"redoAddColumns",value:function redoAddColumns(operation){this.operations.addColumns(operation.command)}},{key:"redoRemoveSheet",value:function redoRemoveSheet(operation){this.operations.removeSheet(operation.sheetName)}},{key:"redoAddSheet",value:function redoAddSheet(operation){this.operations.addSheet(operation.sheetName)}},{key:"redoRenameSheet",value:function redoRenameSheet(operation){this.operations.renameSheet(operation.sheetId,operation.newName)}},{key:"redoMoveRows",value:function redoMoveRows(operation){this.operations.moveRows(operation.sheet,operation.startRow,operation.numberOfRows,operation.targetRow)}},{key:"redoMoveColumns",value:function redoMoveColumns(operation){this.operations.moveColumns(operation.sheet,operation.startColumn,operation.numberOfColumns,operation.targetColumn)}},{key:"redoClearSheet",value:function redoClearSheet(operation){this.operations.clearSheet(operation.sheetId)}},{key:"redoSetSheetContent",value:function redoSetSheetContent(operation){var sheetId=operation.sheetId,newSheetContent=operation.newSheetContent;this.operations.setSheetContent(sheetId,newSheetContent)}},{key:"redoAddNamedExpression",value:function redoAddNamedExpression(operation){this.operations.addNamedExpression(operation.name,operation.newContent,operation.scope,operation.options)}},{key:"redoRemoveNamedExpression",value:function redoRemoveNamedExpression(operation){this.operations.removeNamedExpression(operation.namedExpression.displayName,operation.scope)}},{key:"redoChangeNamedExpression",value:function redoChangeNamedExpression(operation){this.operations.changeNamedExpressionExpression(operation.namedExpression.displayName,operation.newContent,operation.scope,operation.options)}},{key:"restoreOldDataFromVersion",value:function restoreOldDataFromVersion(version){var oldDataToRestore=this.oldData.get(version)||[];var _iterator11=_createForOfIteratorHelper(oldDataToRestore),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var entryToRestore=_step11.value;var _entryToRestore=_slicedToArray(entryToRestore,2),address=_entryToRestore[0],hash=_entryToRestore[1];this.operations.setFormulaToCellFromCache(hash,address)}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}}}]);return UndoRedo}();exports.UndoRedo=UndoRedo},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.Evaluator=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _absolutizeDependencies=__webpack_require__(175);var _Cell=__webpack_require__(106);var _ContentChanges=__webpack_require__(222);var _DependencyGraph=__webpack_require__(107);var _ArithmeticHelper=__webpack_require__(217);var _Interpreter=__webpack_require__(264);var _InterpreterValue=__webpack_require__(203);var _Matrix=__webpack_require__(189);var _statistics=__webpack_require__(176);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Evaluator=function(){function Evaluator(dependencyGraph,columnSearch,config,stats,dateHelper,numberLiteralsHelper,functionRegistry,namedExpressions){_classCallCheck(this,Evaluator);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.config=config;this.stats=stats;this.dateHelper=dateHelper;this.numberLiteralsHelper=numberLiteralsHelper;this.functionRegistry=functionRegistry;this.namedExpressions=namedExpressions;this.interpreter=new _Interpreter.Interpreter(this.dependencyGraph,this.columnSearch,this.config,this.stats,this.dateHelper,this.numberLiteralsHelper,this.functionRegistry,this.namedExpressions)}_createClass(Evaluator,[{key:"run",value:function run(){var _this=this;this.stats.start(_statistics.StatType.TOP_SORT);var _this$dependencyGraph=this.dependencyGraph.topSortWithScc(),sorted=_this$dependencyGraph.sorted,cycled=_this$dependencyGraph.cycled;this.stats.end(_statistics.StatType.TOP_SORT);this.stats.measure(_statistics.StatType.EVALUATION,(function(){_this.recomputeFormulas(cycled,sorted)}))}},{key:"partialRun",value:function partialRun(vertices){var _this2=this;var changes=new _ContentChanges.ContentChanges;this.stats.measure(_statistics.StatType.EVALUATION,(function(){_this2.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(vertices,(function(vertex){if(vertex instanceof _DependencyGraph.FormulaCellVertex){var address=vertex.getAddress(_this2.dependencyGraph.lazilyTransformingAstService);var formula=vertex.getFormula(_this2.dependencyGraph.lazilyTransformingAstService);var currentValue=vertex.isComputed()?vertex.getCellValue():null;var newCellValue=_this2.evaluateAstToCellValue(formula,address);vertex.setCellValue(newCellValue);if(newCellValue!==currentValue){changes.addChange(newCellValue,address);_this2.columnSearch.change(currentValue,newCellValue,address);return true}return false}else if(vertex instanceof _DependencyGraph.MatrixVertex&&vertex.isFormula()){var _address=vertex.getAddress();var _formula=vertex.getFormula();var _currentValue=vertex.isComputed()?vertex.getCellValue():null;var _newCellValue=_this2.evaluateAstToRangeValue(_formula,_address);if(_newCellValue instanceof _InterpreterValue.SimpleRangeValue){var newCellMatrix=new _Matrix.Matrix(_newCellValue.rawNumbers());vertex.setCellValue(newCellMatrix);changes.addMatrixChange(newCellMatrix,_address);_this2.columnSearch.change(_currentValue,newCellMatrix,_address)}else{vertex.setErrorValue(_newCellValue);changes.addChange(_newCellValue,_address);_this2.columnSearch.change(_currentValue,_newCellValue,_address)}return true}else if(vertex instanceof _DependencyGraph.RangeVertex){vertex.clearCache();return true}else{return true}}),(function(vertex){if(vertex instanceof _DependencyGraph.RangeVertex){vertex.clearCache()}else if(vertex instanceof _DependencyGraph.FormulaCellVertex){var error=new _Cell.CellError(_Cell.ErrorType.CYCLE);vertex.setCellValue(error);changes.addChange(error,vertex.address)}}))}));return changes}},{key:"destroy",value:function destroy(){this.interpreter.destroy()}},{key:"runAndForget",value:function runAndForget(ast,address,dependencies){var _this3=this;var tmpRanges=[];var _iterator=_createForOfIteratorHelper((0,_absolutizeDependencies.absolutizeDependencies)(dependencies,address)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var dep=_step.value;if(dep instanceof _AbsoluteCellRange.AbsoluteCellRange){var range=dep;if(this.dependencyGraph.getRange(range.start,range.end)===undefined){var rangeVertex=new _DependencyGraph.RangeVertex(range);this.dependencyGraph.rangeMapping.setRange(rangeVertex);tmpRanges.push(rangeVertex)}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var ret=this.evaluateAstToCellValue(ast,address);tmpRanges.forEach((function(rangeVertex){_this3.dependencyGraph.rangeMapping.removeRange(rangeVertex)}));return ret}},{key:"recomputeFormulas",value:function recomputeFormulas(cycled,sorted){var _this4=this;cycled.forEach((function(vertex){if(vertex instanceof _DependencyGraph.FormulaCellVertex){vertex.setCellValue(new _Cell.CellError(_Cell.ErrorType.CYCLE))}}));sorted.forEach((function(vertex){if(vertex instanceof _DependencyGraph.FormulaCellVertex){var address=vertex.getAddress(_this4.dependencyGraph.lazilyTransformingAstService);var formula=vertex.getFormula(_this4.dependencyGraph.lazilyTransformingAstService);var newCellValue=_this4.evaluateAstToCellValue(formula,address);vertex.setCellValue(newCellValue);_this4.columnSearch.add(newCellValue,address)}else if(vertex instanceof _DependencyGraph.MatrixVertex&&vertex.isFormula()){var _address2=vertex.getAddress();var _formula2=vertex.getFormula();var _newCellValue2=_this4.evaluateAstToRangeValue(_formula2,_address2);if(_newCellValue2 instanceof _InterpreterValue.SimpleRangeValue){var newCellMatrix=new _Matrix.Matrix(_newCellValue2.rawNumbers());vertex.setCellValue(newCellMatrix);_this4.columnSearch.add(newCellMatrix,_address2)}else{vertex.setErrorValue(_newCellValue2);_this4.columnSearch.add(_newCellValue2,_address2)}}else if(vertex instanceof _DependencyGraph.RangeVertex){vertex.clearCache()}}))}},{key:"evaluateAstToCellValue",value:function evaluateAstToCellValue(ast,formulaAddress){var interpreterValue=this.interpreter.evaluateAst(ast,formulaAddress);if(interpreterValue instanceof _InterpreterValue.SimpleRangeValue){return interpreterValue}else if(typeof interpreterValue==="number"){if((0,_ArithmeticHelper.isNumberOverflow)(interpreterValue)){return new _Cell.CellError(_Cell.ErrorType.NUM)}else{return(0,_ArithmeticHelper.fixNegativeZero)(interpreterValue)}}else{return interpreterValue}}},{key:"evaluateAstToRangeValue",value:function evaluateAstToRangeValue(ast,formulaAddress){var interpreterValue=this.interpreter.evaluateAst(ast,formulaAddress);if(interpreterValue instanceof _Cell.CellError){return interpreterValue}else if(interpreterValue instanceof _InterpreterValue.SimpleRangeValue&&interpreterValue.hasOnlyNumbers()){return interpreterValue}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}}]);return Evaluator}();exports.Evaluator=Evaluator},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.Interpreter=void 0;var _gpu=_interopRequireDefault(__webpack_require__(265));var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _Matrix=__webpack_require__(189);var _Ast=__webpack_require__(160);var _ArithmeticHelper=__webpack_require__(217);var _Criterion=__webpack_require__(266);var _InterpreterValue=__webpack_require__(203);var _text=__webpack_require__(267);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Interpreter=function(){function Interpreter(dependencyGraph,columnSearch,config,stats,dateHelper,numberLiteralsHelper,functionRegistry,namedExpressions){_classCallCheck(this,Interpreter);this.dependencyGraph=dependencyGraph;this.columnSearch=columnSearch;this.config=config;this.stats=stats;this.dateHelper=dateHelper;this.numberLiteralsHelper=numberLiteralsHelper;this.functionRegistry=functionRegistry;this.namedExpressions=namedExpressions;this.functionRegistry.initializePlugins(this);this.arithmeticHelper=new _ArithmeticHelper.ArithmeticHelper(config,dateHelper,numberLiteralsHelper);this.criterionBuilder=new _Criterion.CriterionBuilder(config)}_createClass(Interpreter,[{key:"evaluateAst",value:function evaluateAst(ast,formulaAddress){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;switch(ast.type){case _Ast.AstNodeType.EMPTY:{throw new Error("Empty argument should not be evaluated.")}case _Ast.AstNodeType.CELL_REFERENCE:{var address=ast.reference.toSimpleCellAddress(formulaAddress);if((0,_Cell.invalidSimpleCellAddress)(address)){return new _Cell.CellError(_Cell.ErrorType.REF)}return this.dependencyGraph.getCellValue(address)}case _Ast.AstNodeType.NUMBER:case _Ast.AstNodeType.STRING:{return ast.value}case _Ast.AstNodeType.CONCATENATE_OP:{var left=this.evaluateAst(ast.left,formulaAddress);var right=this.evaluateAst(ast.right,formulaAddress);return(0,_text.concatenate)([left,right])}case _Ast.AstNodeType.EQUALS_OP:{var leftResult=this.evaluateAst(ast.left,formulaAddress);var rightResult=this.evaluateAst(ast.right,formulaAddress);return(_a=this.passErrors(leftResult,rightResult))!==null&&_a!==void 0?_a:this.arithmeticHelper.compare(leftResult,rightResult)===0}case _Ast.AstNodeType.NOT_EQUAL_OP:{var _leftResult=this.evaluateAst(ast.left,formulaAddress);var _rightResult=this.evaluateAst(ast.right,formulaAddress);return(_b=this.passErrors(_leftResult,_rightResult))!==null&&_b!==void 0?_b:this.arithmeticHelper.compare(_leftResult,_rightResult)!==0}case _Ast.AstNodeType.GREATER_THAN_OP:{var _leftResult2=this.evaluateAst(ast.left,formulaAddress);var _rightResult2=this.evaluateAst(ast.right,formulaAddress);return(_c=this.passErrors(_leftResult2,_rightResult2))!==null&&_c!==void 0?_c:this.arithmeticHelper.compare(_leftResult2,_rightResult2)>0}case _Ast.AstNodeType.LESS_THAN_OP:{var _leftResult3=this.evaluateAst(ast.left,formulaAddress);var _rightResult3=this.evaluateAst(ast.right,formulaAddress);return(_d=this.passErrors(_leftResult3,_rightResult3))!==null&&_d!==void 0?_d:this.arithmeticHelper.compare(_leftResult3,_rightResult3)<0}case _Ast.AstNodeType.GREATER_THAN_OR_EQUAL_OP:{var _leftResult4=this.evaluateAst(ast.left,formulaAddress);var _rightResult4=this.evaluateAst(ast.right,formulaAddress);return(_e=this.passErrors(_leftResult4,_rightResult4))!==null&&_e!==void 0?_e:this.arithmeticHelper.compare(_leftResult4,_rightResult4)>=0}case _Ast.AstNodeType.LESS_THAN_OR_EQUAL_OP:{var _leftResult5=this.evaluateAst(ast.left,formulaAddress);var _rightResult5=this.evaluateAst(ast.right,formulaAddress);return(_f=this.passErrors(_leftResult5,_rightResult5))!==null&&_f!==void 0?_f:this.arithmeticHelper.compare(_leftResult5,_rightResult5)<=0}case _Ast.AstNodeType.PLUS_OP:{var _leftResult6=this.evaluateAst(ast.left,formulaAddress);var _rightResult6=this.evaluateAst(ast.right,formulaAddress);return(_g=this.passErrors(_leftResult6,_rightResult6))!==null&&_g!==void 0?_g:this.arithmeticHelper.add(this.arithmeticHelper.coerceScalarToNumberOrError(_leftResult6),this.arithmeticHelper.coerceScalarToNumberOrError(_rightResult6))}case _Ast.AstNodeType.MINUS_OP:{var _leftResult7=this.evaluateAst(ast.left,formulaAddress);var _rightResult7=this.evaluateAst(ast.right,formulaAddress);return(_h=this.passErrors(_leftResult7,_rightResult7))!==null&&_h!==void 0?_h:this.arithmeticHelper.subtract(this.arithmeticHelper.coerceScalarToNumberOrError(_leftResult7),this.arithmeticHelper.coerceScalarToNumberOrError(_rightResult7))}case _Ast.AstNodeType.TIMES_OP:{var _leftResult8=this.evaluateAst(ast.left,formulaAddress);var _rightResult8=this.evaluateAst(ast.right,formulaAddress);return(_j=this.passErrors(_leftResult8,_rightResult8))!==null&&_j!==void 0?_j:(0,_ArithmeticHelper.multiply)(this.arithmeticHelper.coerceScalarToNumberOrError(_leftResult8),this.arithmeticHelper.coerceScalarToNumberOrError(_rightResult8))}case _Ast.AstNodeType.POWER_OP:{var _leftResult9=this.evaluateAst(ast.left,formulaAddress);var _rightResult9=this.evaluateAst(ast.right,formulaAddress);return(_k=this.passErrors(_leftResult9,_rightResult9))!==null&&_k!==void 0?_k:(0,_ArithmeticHelper.power)(this.arithmeticHelper.coerceScalarToNumberOrError(_leftResult9),this.arithmeticHelper.coerceScalarToNumberOrError(_rightResult9))}case _Ast.AstNodeType.DIV_OP:{var _leftResult10=this.evaluateAst(ast.left,formulaAddress);var _rightResult10=this.evaluateAst(ast.right,formulaAddress);return(_l=this.passErrors(_leftResult10,_rightResult10))!==null&&_l!==void 0?_l:(0,_ArithmeticHelper.divide)(this.arithmeticHelper.coerceScalarToNumberOrError(_leftResult10),this.arithmeticHelper.coerceScalarToNumberOrError(_rightResult10))}case _Ast.AstNodeType.PLUS_UNARY_OP:{var result=this.evaluateAst(ast.value,formulaAddress);if(result instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return result}}case _Ast.AstNodeType.MINUS_UNARY_OP:{var _result=this.evaluateAst(ast.value,formulaAddress);if(_result instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return(0,_ArithmeticHelper.unaryminus)(this.arithmeticHelper.coerceScalarToNumberOrError(_result))}}case _Ast.AstNodeType.PERCENT_OP:{var _result2=this.evaluateAst(ast.value,formulaAddress);if(_result2 instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return(0,_ArithmeticHelper.percent)(this.arithmeticHelper.coerceScalarToNumberOrError(_result2))}}case _Ast.AstNodeType.FUNCTION_CALL:{var pluginEntry=this.functionRegistry.getFunction(ast.procedureName);if(pluginEntry&&this.config.translationPackage.isFunctionTranslated(ast.procedureName)){var _pluginEntry=_slicedToArray(pluginEntry,2),pluginFunction=_pluginEntry[0],pluginInstance=_pluginEntry[1];return pluginInstance[pluginFunction](ast,formulaAddress)}else{return new _Cell.CellError(_Cell.ErrorType.NAME)}}case _Ast.AstNodeType.NAMED_EXPRESSION:{var namedExpression=this.namedExpressions.nearestNamedExpression(ast.expressionName,formulaAddress.sheet);if(namedExpression){return this.dependencyGraph.getCellValue(namedExpression.address)}else{return new _Cell.CellError(_Cell.ErrorType.NAME)}}case _Ast.AstNodeType.CELL_RANGE:{if(!this.rangeSpansOneSheet(ast)){return new _Cell.CellError(_Cell.ErrorType.REF)}var range=_AbsoluteCellRange.AbsoluteCellRange.fromCellRange(ast,formulaAddress);var matrixVertex=this.dependencyGraph.getMatrix(range);if(matrixVertex){var matrix=matrixVertex.matrix;if(matrix instanceof _Matrix.NotComputedMatrix){throw new Error("Matrix should be already computed")}else if(matrix instanceof _Cell.CellError){return matrix}else if(matrix instanceof _Matrix.Matrix){return _InterpreterValue.SimpleRangeValue.onlyNumbersDataWithRange(matrix.raw(),matrix.size,range)}else{throw new Error("Unknown matrix")}}else{return _InterpreterValue.SimpleRangeValue.onlyRange(range,this.dependencyGraph)}}case _Ast.AstNodeType.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(ast)){return new _Cell.CellError(_Cell.ErrorType.REF)}var _range=_AbsoluteCellRange.AbsoluteColumnRange.fromColumnRange(ast,formulaAddress);return _InterpreterValue.SimpleRangeValue.onlyRange(_range,this.dependencyGraph)}case _Ast.AstNodeType.ROW_RANGE:{if(!this.rangeSpansOneSheet(ast)){return new _Cell.CellError(_Cell.ErrorType.REF)}var _range2=_AbsoluteCellRange.AbsoluteRowRange.fromRowRange(ast,formulaAddress);return _InterpreterValue.SimpleRangeValue.onlyRange(_range2,this.dependencyGraph)}case _Ast.AstNodeType.PARENTHESIS:{return this.evaluateAst(ast.expression,formulaAddress)}case _Ast.AstNodeType.ERROR_WITH_RAW_INPUT:case _Ast.AstNodeType.ERROR:{return ast.error}}}},{key:"getGpuInstance",value:function getGpuInstance(){if(!this.gpu){var GPUConstructor=_gpu.default.GPU||_gpu.default;this.gpu=new GPUConstructor({mode:this.config.gpuMode})}return this.gpu}},{key:"destroy",value:function destroy(){if(this.gpu){this.gpu.destroy()}}},{key:"rangeSpansOneSheet",value:function rangeSpansOneSheet(ast){return ast.start.sheet===ast.end.sheet}},{key:"passErrors",value:function passErrors(left,right){if(left instanceof _Cell.CellError){return left}else if(left instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(right instanceof _Cell.CellError){return right}else if(right instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return undefined}}}]);return Interpreter}();exports.Interpreter=Interpreter},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE__265__},function(module,exports,__webpack_require__){"use strict";__webpack_require__(144);exports.__esModule=true;exports.buildCriterionLambda=exports.CriterionBuilder=exports.buildCriterion=exports.CriterionType=void 0;var _Cell=__webpack_require__(106);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CriterionType;exports.CriterionType=CriterionType;(function(CriterionType){CriterionType["GREATER_THAN"]="GREATER_THAN";CriterionType["GREATER_THAN_OR_EQUAL"]="GREATER_THAN_OR_EQUAL";CriterionType["LESS_THAN"]="LESS_THAN";CriterionType["LESS_THAN_OR_EQUAL"]="LESS_THAN_OR_EQUAL";CriterionType["NOT_EQUAL"]="NOT_EQUAL";CriterionType["EQUAL"]="EQUAL"})(CriterionType||(exports.CriterionType=CriterionType={}));var buildCriterion=function buildCriterion(operator,value){return{operator:operator,value:value}};exports.buildCriterion=buildCriterion;var CriterionBuilder=function(){function CriterionBuilder(config){_classCallCheck(this,CriterionBuilder);var _a,_b,_c,_d;this.trueString=(_b=(_a=config.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||_a===void 0?void 0:_a.toLowerCase())!==null&&_b!==void 0?_b:"true";this.falseString=(_d=(_c=config.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||_c===void 0?void 0:_c.toLowerCase())!==null&&_d!==void 0?_d:"false"}_createClass(CriterionBuilder,[{key:"fromCellValue",value:function fromCellValue(raw,arithmeticHelper){if(typeof raw!=="string"&&typeof raw!=="boolean"&&typeof raw!=="number"){return undefined}var criterion=this.parseCriterion(raw,arithmeticHelper);if(criterion===undefined){return undefined}return{raw:raw,lambda:buildCriterionLambda(criterion,arithmeticHelper)}}},{key:"parseCriterion",value:function parseCriterion(criterion,arithmeticHelper){if(typeof criterion==="number"||typeof criterion==="boolean"){return buildCriterion(CriterionType.EQUAL,criterion)}else if(typeof criterion==="string"){var regexResult=ANY_CRITERION_REGEX.exec(criterion);var criterionValue;var criterionType;if(regexResult){criterionType=StrToCriterionType(regexResult[1]);criterionValue=regexResult[2]}else{criterionType=CriterionType.EQUAL;criterionValue=criterion}var value=arithmeticHelper.coerceToMaybeNumber(criterionValue);var boolvalue=criterionValue.toLowerCase()===this.trueString?true:criterionValue.toLowerCase()===this.falseString?false:undefined;if(criterionType===undefined){return undefined}if(criterionValue===""){return buildCriterion(criterionType,null)}else if(value===undefined){if(criterionType===CriterionType.EQUAL||criterionType===CriterionType.NOT_EQUAL){return buildCriterion(criterionType,boolvalue!==null&&boolvalue!==void 0?boolvalue:criterionValue)}}else{return buildCriterion(criterionType,value)}}return undefined}}]);return CriterionBuilder}();exports.CriterionBuilder=CriterionBuilder;var ANY_CRITERION_REGEX=/([<>=]+)(.*)/;function StrToCriterionType(str){switch(str){case">":return CriterionType.GREATER_THAN;case">=":return CriterionType.GREATER_THAN_OR_EQUAL;case"<":return CriterionType.LESS_THAN;case"<=":return CriterionType.LESS_THAN_OR_EQUAL;case"<>":return CriterionType.NOT_EQUAL;case"=":return CriterionType.EQUAL;default:return undefined}}var buildCriterionLambda=function buildCriterionLambda(criterion,arithmeticHelper){switch(criterion.operator){case CriterionType.GREATER_THAN:{if(typeof criterion.value==="number"){return function(cellValue){return typeof cellValue==="number"&&arithmeticHelper.floatCmp(cellValue,criterion.value)>0}}else{return function(_cellValue){return false}}}case CriterionType.GREATER_THAN_OR_EQUAL:{if(typeof criterion.value==="number"){return function(cellValue){return typeof cellValue==="number"&&arithmeticHelper.floatCmp(cellValue,criterion.value)>=0}}else{return function(_cellValue){return false}}}case CriterionType.LESS_THAN:{if(typeof criterion.value==="number"){return function(cellValue){return typeof cellValue==="number"&&arithmeticHelper.floatCmp(cellValue,criterion.value)<0}}else{return function(_cellValue){return false}}}case CriterionType.LESS_THAN_OR_EQUAL:{if(typeof criterion.value==="number"){return function(cellValue){return typeof cellValue==="number"&&arithmeticHelper.floatCmp(cellValue,criterion.value)<=0}}else{return function(_cellValue){return false}}}case CriterionType.EQUAL:{if(typeof criterion.value==="number"){return function(cellValue){if(typeof cellValue==="number"){return arithmeticHelper.floatCmp(cellValue,criterion.value)===0}else if(typeof cellValue==="string"){if(cellValue===""){return false}var val=arithmeticHelper.coerceToMaybeNumber(cellValue);if(val===undefined){return false}return arithmeticHelper.floatCmp(val,criterion.value)===0}else{return false}}}else if(typeof criterion.value==="string"){return arithmeticHelper.eqMatcherFunction(criterion.value)}else if(typeof criterion.value==="boolean"){return function(cellValue){return typeof cellValue==="boolean"&&cellValue===criterion.value}}else{return function(cellValue){return cellValue===_Cell.EmptyValue}}}case CriterionType.NOT_EQUAL:{if(typeof criterion.value==="number"){return function(cellValue){if(typeof cellValue==="number"){return arithmeticHelper.floatCmp(cellValue,criterion.value)!==0}else if(typeof cellValue==="string"){if(cellValue===""){return true}var val=arithmeticHelper.coerceToMaybeNumber(cellValue);if(val===undefined){return true}return arithmeticHelper.floatCmp(val,criterion.value)!==0}else{return true}}}else if(typeof criterion.value==="string"){return arithmeticHelper.neqMatcherFunction(criterion.value)}else if(typeof criterion.value==="boolean"){return function(cellValue){return typeof cellValue!=="boolean"||cellValue!==criterion.value}}else{return function(cellValue){return cellValue!==_Cell.EmptyValue}}}}};exports.buildCriterionLambda=buildCriterionLambda},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);__webpack_require__(140);__webpack_require__(92);__webpack_require__(96);exports.__esModule=true;exports.concatenate=concatenate;var _Cell=__webpack_require__(106);var _InterpreterValue=__webpack_require__(203);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function concatenate(args){return args.reduce((function(acc,arg){if(acc instanceof _Cell.CellError){return acc}else if(arg instanceof _Cell.CellError){return arg}else if(arg===_Cell.EmptyValue){return acc}else if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return acc.concat(arg.toString())}}),"")}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(109);__webpack_require__(133);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(170);exports.__esModule=true;exports.NumberLiteralHelper=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var NumberLiteralHelper=function(){function NumberLiteralHelper(config){_classCallCheck(this,NumberLiteralHelper);this.config=config;var thousandSeparator=this.config.thousandSeparator==="."?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator;var decimalSeparator=this.config.decimalSeparator==="."?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(decimalSeparator,"\\d+)|(\\d+(").concat(thousandSeparator,"\\d{3,})*(").concat(decimalSeparator,"\\d+)?)))$"));this.allThousandSeparatorsRegex=new RegExp("".concat(thousandSeparator),"g")}_createClass(NumberLiteralHelper,[{key:"isNumber",value:function isNumber(input){var match=this.numberPattern.test(input);return match}},{key:"numericStringToNumber",value:function numericStringToNumber(input){var normalized=input.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(normalized)}}]);return NumberLiteralHelper}();exports.NumberLiteralHelper=NumberLiteralHelper},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.Serialization=void 0;var _Cell=__webpack_require__(106);var _CellValue=__webpack_require__(209);var _DependencyGraph=__webpack_require__(107);var _parser=__webpack_require__(138);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Serialization=function(){function Serialization(dependencyGraph,unparser,config,exporter){_classCallCheck(this,Serialization);this.dependencyGraph=dependencyGraph;this.unparser=unparser;this.config=config;this.exporter=exporter}_createClass(Serialization,[{key:"getCellFormula",value:function getCellFormula(address){var formulaVertex=this.dependencyGraph.getCell(address);if(formulaVertex instanceof _DependencyGraph.FormulaCellVertex){var formula=formulaVertex.getFormula(this.dependencyGraph.lazilyTransformingAstService);return this.unparser.unparse(formula,address)}else if(formulaVertex instanceof _DependencyGraph.MatrixVertex){var _formula=formulaVertex.getFormula();if(_formula){return"{"+this.unparser.unparse(_formula,formulaVertex.getAddress())+"}"}}else if(formulaVertex instanceof _DependencyGraph.ParsingErrorVertex){return formulaVertex.getFormula()}return undefined}},{key:"getCellSerialized",value:function getCellSerialized(address){var formula=this.getCellFormula(address);if(formula!==undefined){return formula}else{var value=this.getCellValue(address);if(value instanceof _CellValue.DetailedCellError){return this.config.translationPackage.getErrorTranslation(value.type)}else{return value}}}},{key:"getCellValue",value:function getCellValue(address){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(address))}},{key:"getSheetValues",value:function getSheetValues(sheet){var _this=this;return this.genericSheetGetter(sheet,(function(arg){return _this.getCellValue(arg)}))}},{key:"getSheetFormulas",value:function getSheetFormulas(sheet){var _this2=this;return this.genericSheetGetter(sheet,(function(arg){return _this2.getCellFormula(arg)}))}},{key:"genericSheetGetter",value:function genericSheetGetter(sheet,getter){var sheetHeight=this.dependencyGraph.getSheetHeight(sheet);var sheetWidth=this.dependencyGraph.getSheetWidth(sheet);var arr=new Array(sheetHeight);for(var i=0;i<sheetHeight;i++){arr[i]=new Array(sheetWidth);for(var j=0;j<sheetWidth;j++){var address=(0,_Cell.simpleCellAddress)(sheet,j,i);arr[i][j]=getter(address)}for(var _j=sheetWidth-1;_j>=0;_j--){if(arr[i][_j]===null||arr[i][_j]===undefined){arr[i].pop()}else{break}}}for(var _i=sheetHeight-1;_i>=0;_i--){if(arr[_i].length===0){arr.pop()}else{break}}return arr}},{key:"genericAllSheetsGetter",value:function genericAllSheetsGetter(sheetGetter){var result={};var _iterator=_createForOfIteratorHelper(this.dependencyGraph.sheetMapping.displayNames()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var sheetName=_step.value;var sheetId=this.dependencyGraph.sheetMapping.fetch(sheetName);result[sheetName]=sheetGetter(sheetId)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return result}},{key:"getSheetSerialized",value:function getSheetSerialized(sheet){var _this3=this;return this.genericSheetGetter(sheet,(function(arg){return _this3.getCellSerialized(arg)}))}},{key:"getAllSheetsValues",value:function getAllSheetsValues(){var _this4=this;return this.genericAllSheetsGetter((function(arg){return _this4.getSheetValues(arg)}))}},{key:"getAllSheetsFormulas",value:function getAllSheetsFormulas(){var _this5=this;return this.genericAllSheetsGetter((function(arg){return _this5.getSheetFormulas(arg)}))}},{key:"getAllSheetsSerialized",value:function getAllSheetsSerialized(){var _this6=this;return this.genericAllSheetsGetter((function(arg){return _this6.getSheetSerialized(arg)}))}},{key:"withNewConfig",value:function withNewConfig(newConfig,namedExpressions){var newUnparser=new _parser.Unparser(newConfig,(0,_parser.buildLexerConfig)(newConfig),this.dependencyGraph.sheetMapping.fetchDisplayName,namedExpressions);return new Serialization(this.dependencyGraph,newUnparser,newConfig,this.exporter)}}]);return Serialization}();exports.Serialization=Serialization},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(241);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(200);__webpack_require__(92);__webpack_require__(96);__webpack_require__(114);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.FunctionRegistry=void 0;__webpack_require__(125);var _errors=__webpack_require__(183);var _HyperFormula=__webpack_require__(212);var _VersionPlugin=__webpack_require__(271);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var FunctionRegistry=function(){function FunctionRegistry(config){var _this=this;_classCallCheck(this,FunctionRegistry);this.config=config;this.functions=new Map;this.volatileFunctions=new Set;this.structuralChangeFunctions=new Set;this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set;this.doesFunctionNeedArgumentToBeComputed=function(functionId){return _this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(functionId)};this.isFunctionVolatile=function(functionId){return _this.volatileFunctions.has(functionId)};this.isFunctionDependentOnSheetStructureChange=function(functionId){return _this.structuralChangeFunctions.has(functionId)};if(config.functionPlugins.length>0){this.instancePlugins=new Map;var _iterator=_createForOfIteratorHelper(config.functionPlugins),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var plugin=_step.value;FunctionRegistry.loadPluginFunctions(plugin,this.instancePlugins)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else{this.instancePlugins=new Map(FunctionRegistry.plugins)}var _iterator2=_createForOfIteratorHelper(FunctionRegistry.protectedFunctions()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),functionId=_step2$value[0],_plugin=_step2$value[1];FunctionRegistry.loadFunctionUnprotected(_plugin,functionId,this.instancePlugins)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _iterator3=_createForOfIteratorHelper(this.instancePlugins.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),_functionId=_step3$value[0],_plugin2=_step3$value[1];this.categorizeFunction(_functionId,_plugin2.implementedFunctions[_functionId])}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}_createClass(FunctionRegistry,[{key:"initializePlugins",value:function initializePlugins(interpreter){var _this2=this;var instances=[];var _iterator4=_createForOfIteratorHelper(this.instancePlugins.entries()),_step4;try{var _loop=function _loop(){var _step4$value=_slicedToArray(_step4.value,2),functionId=_step4$value[0],plugin=_step4$value[1];var pluginInstance=instances.find((function(pluginInstance){return pluginInstance instanceof plugin}));if(pluginInstance===undefined){pluginInstance=new plugin(interpreter);instances.push(pluginInstance)}var methodName=plugin.implementedFunctions[functionId].method;_this2.functions.set(functionId,[methodName,pluginInstance])};for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"getFunctionPlugin",value:function getFunctionPlugin(functionId){if(FunctionRegistry.functionIsProtected(functionId)){return undefined}return this.instancePlugins.get(functionId)}},{key:"getFunction",value:function getFunction(functionId){return this.functions.get(functionId)}},{key:"getPlugins",value:function getPlugins(){var plugins=new Set;var _iterator5=_createForOfIteratorHelper(this.instancePlugins),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),functionId=_step5$value[0],plugin=_step5$value[1];if(!FunctionRegistry.functionIsProtected(functionId)){plugins.add(plugin)}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return Array.from(plugins)}},{key:"getRegisteredFunctionIds",value:function getRegisteredFunctionIds(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function categorizeFunction(functionId,functionMetadata){if(functionMetadata.isVolatile){this.volatileFunctions.add(functionId)}if(functionMetadata.doesNotNeedArgumentsToBeComputed){this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(functionId)}if(functionMetadata.isDependentOnSheetStructureChange){this.structuralChangeFunctions.add(functionId)}}}],[{key:"registerFunctionPlugin",value:function registerFunctionPlugin(plugin,translations){this.loadPluginFunctions(plugin,this.plugins);if(translations!==undefined){this.loadTranslations(translations)}}},{key:"registerFunction",value:function registerFunction(functionId,plugin,translations){var entry=plugin.implementedFunctions[functionId];if(entry!==undefined){this.loadPluginFunction(plugin,functionId,this.plugins)}else{throw _errors.FunctionPluginValidationError.functionNotDeclaredInPlugin(functionId,plugin.name)}if(translations!==undefined){this.loadTranslations(translations)}}},{key:"unregisterFunction",value:function unregisterFunction(functionId){if(this.functionIsProtected(functionId)){throw _errors.ProtectedFunctionError.cannotUnregisterFunctionWithId(functionId)}this.plugins.delete(functionId)}},{key:"unregisterFunctionPlugin",value:function unregisterFunctionPlugin(plugin){var _iterator6=_createForOfIteratorHelper(this.protectedPlugins()),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var protectedPlugin=_step6.value;if(protectedPlugin===plugin){throw _errors.ProtectedFunctionError.cannotUnregisterProtectedPlugin()}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var _iterator7=_createForOfIteratorHelper(this.plugins.entries()),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step7$value=_slicedToArray(_step7.value,2),functionId=_step7$value[0],registeredPlugin=_step7$value[1];if(registeredPlugin===plugin){this.plugins.delete(functionId)}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}},{key:"unregisterAll",value:function unregisterAll(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function getRegisteredFunctionIds(){return[].concat(_toConsumableArray(Array.from(this.plugins.keys())),_toConsumableArray(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function getPlugins(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function getFunctionPlugin(functionId){if(this.functionIsProtected(functionId)){return undefined}else{return this.plugins.get(functionId)}}},{key:"loadTranslations",value:function loadTranslations(translations){var registeredLanguages=new Set(_HyperFormula.HyperFormula.getRegisteredLanguagesCodes());Object.keys(translations).forEach((function(code){if(registeredLanguages.has(code)){_HyperFormula.HyperFormula.getLanguage(code).extendFunctions(translations[code])}}))}},{key:"loadPluginFunctions",value:function loadPluginFunctions(plugin,registry){var _this3=this;Object.keys(plugin.implementedFunctions).forEach((function(functionName){_this3.loadPluginFunction(plugin,functionName,registry)}))}},{key:"loadPluginFunction",value:function loadPluginFunction(plugin,functionId,registry){if(this.functionIsProtected(functionId)){throw _errors.ProtectedFunctionError.cannotRegisterFunctionWithId(functionId)}else{this.loadFunctionUnprotected(plugin,functionId,registry)}}},{key:"loadFunctionUnprotected",value:function loadFunctionUnprotected(plugin,functionId,registry){var methodName=plugin.implementedFunctions[functionId].method;if(Object.prototype.hasOwnProperty.call(plugin.prototype,methodName)){registry.set(functionId,plugin)}else{throw _errors.FunctionPluginValidationError.functionMethodNotFound(methodName,plugin.name)}}},{key:"functionIsProtected",value:function functionIsProtected(functionId){return this._protectedPlugins.has(functionId)}},{key:"protectedFunctions",value:regeneratorRuntime.mark((function protectedFunctions(){var _iterator8,_step8,_step8$value,functionId,plugin;return regeneratorRuntime.wrap((function protectedFunctions$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator8=_createForOfIteratorHelper(this._protectedPlugins);_context.prev=1;_iterator8.s();case 3:if((_step8=_iterator8.n()).done){_context.next=10;break}_step8$value=_slicedToArray(_step8.value,2),functionId=_step8$value[0],plugin=_step8$value[1];if(!(plugin!==undefined)){_context.next=8;break}_context.next=8;return[functionId,plugin];case 8:_context.next=3;break;case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](1);_iterator8.e(_context.t0);case 15:_context.prev=15;_iterator8.f();return _context.finish(15);case 18:case"end":return _context.stop()}}}),protectedFunctions,this,[[1,12,15,18]])}))},{key:"protectedPlugins",value:regeneratorRuntime.mark((function protectedPlugins(){var _iterator9,_step9,_step9$value,plugin;return regeneratorRuntime.wrap((function protectedPlugins$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_iterator9=_createForOfIteratorHelper(this._protectedPlugins);_context2.prev=1;_iterator9.s();case 3:if((_step9=_iterator9.n()).done){_context2.next=10;break}_step9$value=_slicedToArray(_step9.value,2),plugin=_step9$value[1];if(!(plugin!==undefined)){_context2.next=8;break}_context2.next=8;return plugin;case 8:_context2.next=3;break;case 10:_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](1);_iterator9.e(_context2.t0);case 15:_context2.prev=15;_iterator9.f();return _context2.finish(15);case 18:case"end":return _context2.stop()}}}),protectedPlugins,this,[[1,12,15,18]])}))}]);return FunctionRegistry}();exports.FunctionRegistry=FunctionRegistry;FunctionRegistry.plugins=new Map;FunctionRegistry._protectedPlugins=new Map([["VERSION",_VersionPlugin.VersionPlugin],["OFFSET",undefined]])},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(75);__webpack_require__(84);__webpack_require__(164);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.VersionPlugin=void 0;var _FunctionPlugin2=__webpack_require__(272);var _HyperFormula=__webpack_require__(212);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var LICENSE_STATUS_MAP=new Map([["agpl-v3",1],["non-commercial-and-evaluation",2],["missing",3],["invalid",4],["expired",5]]);var VersionPlugin=function(_FunctionPlugin){_inherits(VersionPlugin,_FunctionPlugin);var _super=_createSuper(VersionPlugin);function VersionPlugin(){_classCallCheck(this,VersionPlugin);return _super.apply(this,arguments)}_createClass(VersionPlugin,[{key:"version",value:function version(){var _this$config=this.config,validityState=_this$config.licenseKeyValidityState,licenseKey=_this$config.licenseKey;var status;if(LICENSE_STATUS_MAP.has(licenseKey)){status=LICENSE_STATUS_MAP.get(licenseKey)}else if(LICENSE_STATUS_MAP.has(validityState)){status=LICENSE_STATUS_MAP.get(validityState)}else if(!status&&validityState==="valid"){status=licenseKey.slice(-5)}return"HyperFormula v".concat(_HyperFormula.HyperFormula.version,", ").concat(status)}}]);return VersionPlugin}(_FunctionPlugin2.FunctionPlugin);exports.VersionPlugin=VersionPlugin;VersionPlugin.implementedFunctions={VERSION:{method:"version"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.FunctionPlugin=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _InterpreterValue=__webpack_require__(203);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var FunctionPlugin=function(){function FunctionPlugin(interpreter){_classCallCheck(this,FunctionPlugin);this.interpreter=interpreter;this.dependencyGraph=interpreter.dependencyGraph;this.columnSearch=interpreter.columnSearch;this.config=interpreter.config}_createClass(FunctionPlugin,[{key:"evaluateAst",value:function evaluateAst(ast,formulaAddress){return this.interpreter.evaluateAst(ast,formulaAddress)}},{key:"iterateOverScalarValues",value:regeneratorRuntime.mark((function iterateOverScalarValues(asts,formulaAddress){var _iterator,_step,argAst,value,_iterator2,_step2,scalarValue;return regeneratorRuntime.wrap((function iterateOverScalarValues$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator=_createForOfIteratorHelper(asts);_context.prev=1;_iterator.s();case 3:if((_step=_iterator.n()).done){_context.next=30;break}argAst=_step.value;value=this.evaluateAst(argAst,formulaAddress);if(!(value instanceof _InterpreterValue.SimpleRangeValue)){_context.next=26;break}_iterator2=_createForOfIteratorHelper(value.valuesFromTopLeftCorner());_context.prev=8;_iterator2.s();case 10:if((_step2=_iterator2.n()).done){_context.next=16;break}scalarValue=_step2.value;_context.next=14;return scalarValue;case 14:_context.next=10;break;case 16:_context.next=21;break;case 18:_context.prev=18;_context.t0=_context["catch"](8);_iterator2.e(_context.t0);case 21:_context.prev=21;_iterator2.f();return _context.finish(21);case 24:_context.next=28;break;case 26:_context.next=28;return value;case 28:_context.next=3;break;case 30:_context.next=35;break;case 32:_context.prev=32;_context.t1=_context["catch"](1);_iterator.e(_context.t1);case 35:_context.prev=35;_iterator.f();return _context.finish(35);case 38:case"end":return _context.stop()}}}),iterateOverScalarValues,this,[[1,32,35,38],[8,18,21,24]])}))},{key:"computeListOfValuesInRange",value:function computeListOfValuesInRange(range){var values=[];var _iterator3=_createForOfIteratorHelper(range.addresses(this.dependencyGraph)),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var cellFromRange=_step3.value;var value=this.dependencyGraph.getScalarValue(cellFromRange);values.push(value)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return values}},{key:"templateWithOneCoercedToNumberArgument",value:function templateWithOneCoercedToNumberArgument(ast,formulaAddress,fn){var _this=this;return this.templateWithOneArgumentCoercion(ast,formulaAddress,(function(arg){return _this.coerceScalarToNumberOrError(arg)}),fn)}},{key:"templateWithOneCoercedToStringArgument",value:function templateWithOneCoercedToStringArgument(ast,formulaAddress,fn){return this.templateWithOneArgumentCoercion(ast,formulaAddress,_ArithmeticHelper.coerceScalarToString,fn)}},{key:"validateTwoNumericArguments",value:function validateTwoNumericArguments(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var left=this.evaluateAst(ast.args[0],formulaAddress);if(left instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedLeft=this.coerceScalarToNumberOrError(left);if(coercedLeft instanceof _Cell.CellError){return coercedLeft}var right=this.evaluateAst(ast.args[1],formulaAddress);if(right instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedRight=this.coerceScalarToNumberOrError(right);if(coercedRight instanceof _Cell.CellError){return coercedRight}return[coercedLeft,coercedRight]}},{key:"getNumericArgument",value:function getNumericArgument(ast,formulaAddress,position,min,max){if(position>ast.args.length-1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args[position].type===_parser.AstNodeType.EMPTY){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[position],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var value=this.coerceScalarToNumberOrError(arg);if(typeof value==="number"&&min!==undefined&&max!==undefined&&(value<min||value>max)){return new _Cell.CellError(_Cell.ErrorType.NUM)}return value}},{key:"coerceScalarToNumberOrError",value:function coerceScalarToNumberOrError(arg){return this.interpreter.arithmeticHelper.coerceScalarToNumberOrError(arg)}},{key:"templateWithOneArgumentCoercion",value:function templateWithOneArgumentCoercion(ast,formulaAddress,coerceFunction,fn){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedArg=coerceFunction(arg);if(coercedArg instanceof _Cell.CellError){return coercedArg}else{return fn(coercedArg)}}}]);return FunctionPlugin}();exports.FunctionPlugin=FunctionPlugin},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */var dictionary={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",VALUE:"#VALUE!"},functions:{ABS:"ABS",ACOS:"ACOS",AND:"AND",ASIN:"ASIN",ATAN:"ATAN",ATAN2:"ATAN2",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CODE:"CODE",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COT:"COT",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",DATE:"DATE",DAY:"DAY",DAYS:"DAYS",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",E:"E",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXP:"EXP",FALSE:"FALSE",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",ISBLANK:"ISBLANK",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISLOGICAL:"ISLOGICAL",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISTEXT:"ISTEXT",LN:"LN",LOG:"LOG",LOG10:"LOG10",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MIN:"MIN",MINA:"MINA",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NOT:"NOT",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",POWER:"POWER",RADIANS:"RADIANS",RAND:"RAND",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROWS:"ROWS",SIN:"SIN",SPLIT:"SPLIT",SQRT:"SQRT",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",TAN:"TAN",TEXT:"TEXT",TRANSPOSE:"TRANSPOSE",TRUE:"TRUE",TRUNC:"TRUNC",VLOOKUP:"VLOOKUP",XOR:"XOR",YEAR:"YEAR"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};var _default=dictionary;exports.default=_default},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.CorrelPlugin=exports.ErrorFunctionPlugin=exports.CodePlugin=exports.CharPlugin=exports.DeltaPlugin=exports.ModuloPlugin=exports.SqrtPlugin=exports.MathConstantsPlugin=exports.PowerPlugin=exports.BitShiftPlugin=exports.BitwiseLogicOperationsPlugin=exports.LogarithmPlugin=exports.RadixConversionPlugin=exports.RoundingPlugin=exports.IsOddPlugin=exports.IsEvenPlugin=exports.VlookupPlugin=exports.RandomPlugin=exports.RadiansPlugin=exports.DegreesPlugin=exports.AbsPlugin=exports.ExpPlugin=exports.MatrixPlugin=exports.SumprodPlugin=exports.CountUniquePlugin=exports.TrigonometryPlugin=exports.InformationPlugin=exports.BooleanPlugin=exports.DatePlugin=exports.MedianPlugin=exports.NumericAggregationPlugin=exports.TextPlugin=exports.SumifPlugin=void 0;var _SumifPlugin=__webpack_require__(275);exports.SumifPlugin=_SumifPlugin.SumifPlugin;var _TextPlugin=__webpack_require__(278);exports.TextPlugin=_TextPlugin.TextPlugin;var _NumericAggregationPlugin=__webpack_require__(279);exports.NumericAggregationPlugin=_NumericAggregationPlugin.NumericAggregationPlugin;var _MedianPlugin=__webpack_require__(280);exports.MedianPlugin=_MedianPlugin.MedianPlugin;var _DatePlugin=__webpack_require__(281);exports.DatePlugin=_DatePlugin.DatePlugin;var _BooleanPlugin=__webpack_require__(283);exports.BooleanPlugin=_BooleanPlugin.BooleanPlugin;var _InformationPlugin=__webpack_require__(284);exports.InformationPlugin=_InformationPlugin.InformationPlugin;var _TrigonometryPlugin=__webpack_require__(285);exports.TrigonometryPlugin=_TrigonometryPlugin.TrigonometryPlugin;var _CountUniquePlugin=__webpack_require__(286);exports.CountUniquePlugin=_CountUniquePlugin.CountUniquePlugin;var _SumprodPlugin=__webpack_require__(287);exports.SumprodPlugin=_SumprodPlugin.SumprodPlugin;var _MatrixPlugin=__webpack_require__(288);exports.MatrixPlugin=_MatrixPlugin.MatrixPlugin;var _ExpPlugin=__webpack_require__(289);exports.ExpPlugin=_ExpPlugin.ExpPlugin;var _AbsPlugin=__webpack_require__(290);exports.AbsPlugin=_AbsPlugin.AbsPlugin;var _DegreesPlugin=__webpack_require__(291);exports.DegreesPlugin=_DegreesPlugin.DegreesPlugin;var _RadiansPlugin=__webpack_require__(292);exports.RadiansPlugin=_RadiansPlugin.RadiansPlugin;var _RandomPlugin=__webpack_require__(293);exports.RandomPlugin=_RandomPlugin.RandomPlugin;var _VlookupPlugin=__webpack_require__(294);exports.VlookupPlugin=_VlookupPlugin.VlookupPlugin;var _IsEvenPlugin=__webpack_require__(295);exports.IsEvenPlugin=_IsEvenPlugin.IsEvenPlugin;var _IsOddPlugin=__webpack_require__(296);exports.IsOddPlugin=_IsOddPlugin.IsOddPlugin;var _RoundingPlugin=__webpack_require__(297);exports.RoundingPlugin=_RoundingPlugin.RoundingPlugin;var _RadixConversionPlugin=__webpack_require__(298);exports.RadixConversionPlugin=_RadixConversionPlugin.RadixConversionPlugin;var _LogarithmPlugin=__webpack_require__(299);exports.LogarithmPlugin=_LogarithmPlugin.LogarithmPlugin;var _BitwiseLogicOperationsPlugin=__webpack_require__(300);exports.BitwiseLogicOperationsPlugin=_BitwiseLogicOperationsPlugin.BitwiseLogicOperationsPlugin;var _BitShiftPlugin=__webpack_require__(301);exports.BitShiftPlugin=_BitShiftPlugin.BitShiftPlugin;var _PowerPlugin=__webpack_require__(302);exports.PowerPlugin=_PowerPlugin.PowerPlugin;var _MathConstantsPlugin=__webpack_require__(303);exports.MathConstantsPlugin=_MathConstantsPlugin.MathConstantsPlugin;var _SqrtPlugin=__webpack_require__(304);exports.SqrtPlugin=_SqrtPlugin.SqrtPlugin;var _ModuloPlugin=__webpack_require__(305);exports.ModuloPlugin=_ModuloPlugin.ModuloPlugin;var _DeltaPlugin=__webpack_require__(306);exports.DeltaPlugin=_DeltaPlugin.DeltaPlugin;var _CharPlugin=__webpack_require__(307);exports.CharPlugin=_CharPlugin.CharPlugin;var _CodePlugin=__webpack_require__(308);exports.CodePlugin=_CodePlugin.CodePlugin;var _ErrorFunctionPlugin=__webpack_require__(309);exports.ErrorFunctionPlugin=_ErrorFunctionPlugin.ErrorFunctionPlugin;var _CorrelPlugin=__webpack_require__(310);exports.CorrelPlugin=_CorrelPlugin.CorrelPlugin},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(157);__webpack_require__(113);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.SumifPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _CriterionFunctionCompute=__webpack_require__(276);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var AverageResult=function(){function AverageResult(sum,count){_classCallCheck(this,AverageResult);this.sum=sum;this.count=count}_createClass(AverageResult,[{key:"compose",value:function compose(other){return new AverageResult(this.sum+other.sum,this.count+other.count)}},{key:"averageValue",value:function averageValue(){if(this.count>0){return this.sum/this.count}else{return undefined}}}],[{key:"single",value:function single(arg){return new AverageResult(arg,1)}}]);return AverageResult}();AverageResult.empty=new AverageResult(0,0);function sumifCacheKey(conditions){var conditionsStrings=conditions.map((function(c){return"".concat(c.conditionRange.range().sheet,",").concat(c.conditionRange.range().start.col,",").concat(c.conditionRange.range().start.row)}));return["SUMIF"].concat(_toConsumableArray(conditionsStrings)).join(",")}function averageifCacheKey(conditions){var conditionsStrings=conditions.map((function(c){return"".concat(c.conditionRange.range().sheet,",").concat(c.conditionRange.range().start.col,",").concat(c.conditionRange.range().start.row)}));return["AVERAGEIF"].concat(_toConsumableArray(conditionsStrings)).join(",")}function countifsCacheKey(conditions){var conditionsStrings=conditions.map((function(c){return"".concat(c.conditionRange.range().sheet,",").concat(c.conditionRange.range().start.col,",").concat(c.conditionRange.range().start.row)}));return["COUNTIFS"].concat(_toConsumableArray(conditionsStrings)).join(",")}var SumifPlugin=function(_FunctionPlugin){_inherits(SumifPlugin,_FunctionPlugin);var _super=_createSuper(SumifPlugin);function SumifPlugin(){_classCallCheck(this,SumifPlugin);return _super.apply(this,arguments)}_createClass(SumifPlugin,[{key:"sumif",value:function sumif(ast,formulaAddress){var _this=this;if(ast.args.length<2||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var conditionArgValue=this.evaluateAst(ast.args[0],formulaAddress);if(conditionArgValue instanceof _Cell.CellError){return conditionArgValue}var conditionArg=(0,_ArithmeticHelper.coerceToRange)(conditionArgValue);var criterionValue=this.evaluateAst(ast.args[1],formulaAddress);if(criterionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(criterionValue instanceof _Cell.CellError){return criterionValue}var criterion=this.interpreter.criterionBuilder.fromCellValue(criterionValue,this.interpreter.arithmeticHelper);if(criterion===undefined){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var valuesArg;if(ast.args.length==2){valuesArg=conditionArg}else{var valuesArgValue=this.evaluateAst(ast.args[2],formulaAddress);if(valuesArgValue instanceof _Cell.CellError){return valuesArgValue}valuesArg=(0,_ArithmeticHelper.coerceToRange)(valuesArgValue)}var result=new _CriterionFunctionCompute.CriterionFunctionCompute(this.interpreter,sumifCacheKey,0,(function(left,right){return _this.interpreter.arithmeticHelper.nonstrictadd(left,right)}),(function(arg){return arg})).compute(valuesArg,[new _CriterionFunctionCompute.Condition(conditionArg,criterion)]);return result}},{key:"sumifs",value:function sumifs(ast,formulaAddress){var _this2=this;if(ast.args.length<3||ast.args.length%2===0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var valueArgValue=this.evaluateAst(ast.args[0],formulaAddress);if(valueArgValue instanceof _Cell.CellError){return valueArgValue}var valuesArg=(0,_ArithmeticHelper.coerceToRange)(valueArgValue);var conditions=[];for(var i=1;i<ast.args.length;i+=2){var conditionArgValue=this.evaluateAst(ast.args[i],formulaAddress);if(conditionArgValue instanceof _Cell.CellError){return conditionArgValue}var conditionArg=(0,_ArithmeticHelper.coerceToRange)(conditionArgValue);var criterionValue=this.evaluateAst(ast.args[i+1],formulaAddress);if(criterionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(criterionValue instanceof _Cell.CellError){return criterionValue}var criterionPackage=this.interpreter.criterionBuilder.fromCellValue(criterionValue,this.interpreter.arithmeticHelper);if(criterionPackage===undefined){return new _Cell.CellError(_Cell.ErrorType.VALUE)}conditions.push(new _CriterionFunctionCompute.Condition(conditionArg,criterionPackage))}var result=new _CriterionFunctionCompute.CriterionFunctionCompute(this.interpreter,sumifCacheKey,0,(function(left,right){return _this2.interpreter.arithmeticHelper.nonstrictadd(left,right)}),(function(arg){return arg})).compute(valuesArg,conditions);return result}},{key:"averageif",value:function averageif(ast,formulaAddress){if(ast.args.length<2||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var conditionArgValue=this.evaluateAst(ast.args[0],formulaAddress);if(conditionArgValue instanceof _Cell.CellError){return conditionArgValue}var conditionArg=(0,_ArithmeticHelper.coerceToRange)(conditionArgValue);var criterionValue=this.evaluateAst(ast.args[1],formulaAddress);if(criterionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(criterionValue instanceof _Cell.CellError){return criterionValue}var criterionPackage=this.interpreter.criterionBuilder.fromCellValue(criterionValue,this.interpreter.arithmeticHelper);if(criterionPackage===undefined){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var valuesArg;if(ast.args.length==2){valuesArg=conditionArg}else{var valuesArgValue=this.evaluateAst(ast.args[2],formulaAddress);if(valuesArgValue instanceof _Cell.CellError){return valuesArgValue}valuesArg=(0,_ArithmeticHelper.coerceToRange)(valuesArgValue)}var averageResult=new _CriterionFunctionCompute.CriterionFunctionCompute(this.interpreter,averageifCacheKey,AverageResult.empty,(function(left,right){return left.compose(right)}),(function(arg){if(typeof arg==="number"){return AverageResult.single(arg)}else{return AverageResult.empty}})).compute(valuesArg,[new _CriterionFunctionCompute.Condition(conditionArg,criterionPackage)]);if(averageResult instanceof _Cell.CellError){return averageResult}else{return averageResult.averageValue()||new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}}},{key:"countif",value:function countif(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var conditionArgValue=this.evaluateAst(ast.args[0],formulaAddress);if(conditionArgValue instanceof _Cell.CellError){return conditionArgValue}var conditionArg=(0,_ArithmeticHelper.coerceToRange)(conditionArgValue);var criterionValue=this.evaluateAst(ast.args[1],formulaAddress);if(criterionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(criterionValue instanceof _Cell.CellError){return criterionValue}var criterionPackage=this.interpreter.criterionBuilder.fromCellValue(criterionValue,this.interpreter.arithmeticHelper);if(criterionPackage===undefined){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var result=new _CriterionFunctionCompute.CriterionFunctionCompute(this.interpreter,(function(){return"COUNTIF"}),0,(function(left,right){return left+right}),(function(){return 1})).compute(conditionArg,[new _CriterionFunctionCompute.Condition(conditionArg,criterionPackage)]);return result}},{key:"countifs",value:function countifs(ast,formulaAddress){if(ast.args.length<2||ast.args.length%2===1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var conditions=[];for(var i=0;i<ast.args.length;i+=2){var conditionArgValue=this.evaluateAst(ast.args[i],formulaAddress);if(conditionArgValue instanceof _Cell.CellError){return conditionArgValue}var conditionArg=(0,_ArithmeticHelper.coerceToRange)(conditionArgValue);var criterionValue=this.evaluateAst(ast.args[i+1],formulaAddress);if(criterionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else if(criterionValue instanceof _Cell.CellError){return criterionValue}var criterionPackage=this.interpreter.criterionBuilder.fromCellValue(criterionValue,this.interpreter.arithmeticHelper);if(criterionPackage===undefined){return new _Cell.CellError(_Cell.ErrorType.VALUE)}conditions.push(new _CriterionFunctionCompute.Condition(conditionArg,criterionPackage))}var result=new _CriterionFunctionCompute.CriterionFunctionCompute(this.interpreter,countifsCacheKey,0,(function(left,right){return left+right}),(function(){return 1})).compute(conditions[0].conditionRange,conditions);return result}}]);return SumifPlugin}(_FunctionPlugin2.FunctionPlugin);exports.SumifPlugin=SumifPlugin;SumifPlugin.implementedFunctions={SUMIF:{method:"sumif"},COUNTIF:{method:"countif"},AVERAGEIF:{method:"averageif"},SUMIFS:{method:"sumifs"},COUNTIFS:{method:"countifs"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(254);__webpack_require__(110);__webpack_require__(65);__webpack_require__(75);__webpack_require__(157);__webpack_require__(113);__webpack_require__(84);__webpack_require__(89);__webpack_require__(164);__webpack_require__(92);__webpack_require__(96);__webpack_require__(98);__webpack_require__(124);__webpack_require__(104);exports.__esModule=true;exports.Condition=exports.CriterionFunctionCompute=void 0;__webpack_require__(125);var _Cell=__webpack_require__(106);var _generatorUtils=__webpack_require__(277);var _marked=regeneratorRuntime.mark(getRangeValues),_marked2=regeneratorRuntime.mark(ifFilter);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var findSmallerRangeForMany=function findSmallerRangeForMany(dependencyGraph,conditionRanges,valuesRange){if(valuesRange.end.row>valuesRange.start.row){var valuesRangeEndRowLess=(0,_Cell.simpleCellAddress)(valuesRange.end.sheet,valuesRange.end.col,valuesRange.end.row-1);var rowLessVertex=dependencyGraph.getRange(valuesRange.start,valuesRangeEndRowLess);if(rowLessVertex!==undefined){return{smallerRangeVertex:rowLessVertex,restValuesRange:valuesRange.withStart((0,_Cell.simpleCellAddress)(valuesRange.start.sheet,valuesRange.start.col,valuesRange.end.row)),restConditionRanges:conditionRanges.map((function(conditionRange){return conditionRange.withStart((0,_Cell.simpleCellAddress)(conditionRange.start.sheet,conditionRange.start.col,conditionRange.end.row))}))}}}return{smallerRangeVertex:null,restValuesRange:valuesRange,restConditionRanges:conditionRanges}};var CriterionFunctionCompute=function(){function CriterionFunctionCompute(interpreter,cacheKey,reduceInitialValue,composeFunction,mapFunction){_classCallCheck(this,CriterionFunctionCompute);this.interpreter=interpreter;this.cacheKey=cacheKey;this.reduceInitialValue=reduceInitialValue;this.composeFunction=composeFunction;this.mapFunction=mapFunction;this.dependencyGraph=this.interpreter.dependencyGraph}_createClass(CriterionFunctionCompute,[{key:"compute",value:function compute(simpleValuesRange,conditions){var _this=this;var _iterator=_createForOfIteratorHelper(conditions),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var condition=_step.value;if(!condition.conditionRange.sameDimensionsAs(simpleValuesRange)){return new _Cell.CellError(_Cell.ErrorType.VALUE)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var valuesRangeVertex=this.tryToGetRangeVertexForRangeValue(simpleValuesRange);var conditionsVertices=conditions.map((function(c){return _this.tryToGetRangeVertexForRangeValue(c.conditionRange)}));if(valuesRangeVertex&&conditionsVertices.every((function(e){return e!==undefined}))){var fullCriterionString=conditions.map((function(c){return c.criterionPackage.raw})).join(",");var cachedResult=this.findAlreadyComputedValueInCache(valuesRangeVertex,this.cacheKey(conditions),fullCriterionString);if(cachedResult){this.interpreter.stats.incrementCriterionFunctionFullCacheUsed();return cachedResult}var cache=this.buildNewCriterionCache(this.cacheKey(conditions),conditions.map((function(c){return c.conditionRange.range()})),simpleValuesRange.range());if(!cache.has(fullCriterionString)){cache.set(fullCriterionString,[this.evaluateRangeValue(simpleValuesRange,conditions),conditions.map((function(condition){return condition.criterionPackage.lambda}))])}valuesRangeVertex.setCriterionFunctionValues(this.cacheKey(conditions),cache);conditionsVertices.forEach((function(range){if(range!==undefined){range.addDependentCacheRange(valuesRangeVertex)}}));return cache.get(fullCriterionString)[0]}else{return this.evaluateRangeValue(simpleValuesRange,conditions)}}},{key:"tryToGetRangeVertexForRangeValue",value:function tryToGetRangeVertexForRangeValue(rangeValue){var maybeRange=rangeValue.range();if(maybeRange===undefined){return undefined}else{return this.dependencyGraph.getRange(maybeRange.start,maybeRange.end)}}},{key:"reduceFunction",value:function reduceFunction(iterable){var acc=this.reduceInitialValue;var _iterator2=_createForOfIteratorHelper(iterable),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var val=_step2.value;acc=this.composeFunction(acc,val)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return acc}},{key:"findAlreadyComputedValueInCache",value:function findAlreadyComputedValueInCache(rangeVertex,cacheKey,criterionString){return rangeVertex.getCriterionFunctionValue(cacheKey,criterionString)}},{key:"evaluateRangeValue",value:function evaluateRangeValue(simpleValuesRange,conditions){var criterionLambdas=conditions.map((function(condition){return condition.criterionPackage.lambda}));var values=Array.from(simpleValuesRange.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator]();var conditionsIterators=conditions.map((function(condition){return condition.conditionRange.valuesFromTopLeftCorner()}));var filteredValues=ifFilter(criterionLambdas,conditionsIterators,values);return this.reduceFunction(filteredValues)}},{key:"buildNewCriterionCache",value:function buildNewCriterionCache(cacheKey,simpleConditionRanges,simpleValuesRange){var _this2=this;var currentRangeVertex=this.dependencyGraph.getRange(simpleValuesRange.start,simpleValuesRange.end);var _findSmallerRangeForM=findSmallerRangeForMany(this.dependencyGraph,simpleConditionRanges,simpleValuesRange),smallerRangeVertex=_findSmallerRangeForM.smallerRangeVertex,restConditionRanges=_findSmallerRangeForM.restConditionRanges,restValuesRange=_findSmallerRangeForM.restValuesRange;var smallerCache;if(smallerRangeVertex&&this.dependencyGraph.existsEdge(smallerRangeVertex,currentRangeVertex)){smallerCache=smallerRangeVertex.getCriterionFunctionValues(cacheKey)}else{smallerCache=new Map}var newCache=new Map;smallerCache.forEach((function(_ref,key){var _ref2=_slicedToArray(_ref,2),value=_ref2[0],criterionLambdas=_ref2[1];var filteredValues=ifFilter(criterionLambdas,restConditionRanges.map((function(rcr){return getRangeValues(_this2.dependencyGraph,rcr)})),Array.from(getRangeValues(_this2.dependencyGraph,restValuesRange)).map(_this2.mapFunction)[Symbol.iterator]());var newCacheValue=_this2.composeFunction(value,_this2.reduceFunction(filteredValues));_this2.interpreter.stats.incrementCriterionFunctionPartialCacheUsed();newCache.set(key,[newCacheValue,criterionLambdas])}));return newCache}}]);return CriterionFunctionCompute}();exports.CriterionFunctionCompute=CriterionFunctionCompute;var Condition=function Condition(conditionRange,criterionPackage){_classCallCheck(this,Condition);this.conditionRange=conditionRange;this.criterionPackage=criterionPackage};exports.Condition=Condition;function getRangeValues(dependencyGraph,cellRange){var _iterator3,_step3,cellFromRange;return regeneratorRuntime.wrap((function getRangeValues$(_context){while(1){switch(_context.prev=_context.next){case 0:_iterator3=_createForOfIteratorHelper(cellRange.addresses(dependencyGraph));_context.prev=1;_iterator3.s();case 3:if((_step3=_iterator3.n()).done){_context.next=9;break}cellFromRange=_step3.value;_context.next=7;return dependencyGraph.getScalarValue(cellFromRange);case 7:_context.next=3;break;case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](1);_iterator3.e(_context.t0);case 14:_context.prev=14;_iterator3.f();return _context.finish(14);case 17:case"end":return _context.stop()}}}),_marked,null,[[1,11,14,17]])}function ifFilter(criterionLambdas,conditionalIterables,computableIterable){var _iterator4,_step4,computable,conditionalSplits,conditionalFirsts;return regeneratorRuntime.wrap((function ifFilter$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_iterator4=_createForOfIteratorHelper(computableIterable);_context2.prev=1;_iterator4.s();case 3:if((_step4=_iterator4.n()).done){_context2.next=15;break}computable=_step4.value;conditionalSplits=conditionalIterables.map((function(conditionalIterable){return(0,_generatorUtils.split)(conditionalIterable)}));if(conditionalSplits.every((function(cs){return Object.prototype.hasOwnProperty.call(cs,"value")}))){_context2.next=8;break}return _context2.abrupt("return");case 8:conditionalFirsts=conditionalSplits.map((function(cs){return cs.value}));if(!zip(conditionalFirsts,criterionLambdas).every((function(_ref3){var _ref4=_slicedToArray(_ref3,2),conditionalFirst=_ref4[0],criterionLambda=_ref4[1];return criterionLambda(conditionalFirst)}))){_context2.next=12;break}_context2.next=12;return computable;case 12:conditionalIterables=conditionalSplits.map((function(cs){return cs.rest}));case 13:_context2.next=3;break;case 15:_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2["catch"](1);_iterator4.e(_context2.t0);case 20:_context2.prev=20;_iterator4.f();return _context2.finish(20);case 23:case"end":return _context2.stop()}}}),_marked2,null,[[1,17,20,23]])}function zip(arr1,arr2){var result=[];for(var i=0;i<Math.min(arr1.length,arr2.length);i++){result.push([arr1[i],arr2[i]])}return result}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(92);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.empty=empty;exports.split=split;exports.first=first;__webpack_require__(125);var _marked=regeneratorRuntime.mark(empty);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function empty(){return regeneratorRuntime.wrap((function empty$(_context){while(1){switch(_context.prev=_context.next){case 0:case"end":return _context.stop()}}}),_marked)}function split(iterable){var iterator=iterable[Symbol.iterator]();var _iterator$next=iterator.next(),done=_iterator$next.done,value=_iterator$next.value;if(done){return{rest:empty()}}else{return{value:value,rest:iterator}}}function first(iterable){var iterator=iterable[Symbol.iterator]();var _iterator$next2=iterator.next(),done=_iterator$next2.done,value=_iterator$next2.value;if(!done){return value}return undefined}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(109);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(146);__webpack_require__(104);exports.__esModule=true;exports.TextPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var TextPlugin=function(_FunctionPlugin){_inherits(TextPlugin,_FunctionPlugin);var _super=_createSuper(TextPlugin);function TextPlugin(){_classCallCheck(this,TextPlugin);return _super.apply(this,arguments)}_createClass(TextPlugin,[{key:"concatenate",value:function concatenate(ast,formulaAddress){if(ast.args.length==0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result="";var _iterator=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;var coercedValue=(0,_ArithmeticHelper.coerceScalarToString)(value);if(coercedValue instanceof _Cell.CellError){return value}else{result=result.concat(coercedValue)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return result}},{key:"split",value:function split(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var stringArg=ast.args[0];var indexArg=ast.args[1];var stringToSplit=this.evaluateAst(stringArg,formulaAddress);if(typeof stringToSplit!=="string"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var indexToUse=this.evaluateAst(indexArg,formulaAddress);if(typeof indexToUse!=="number"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var splittedString=stringToSplit.split(" ");if(indexToUse>splittedString.length||indexToUse<0){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return splittedString[indexToUse]}}]);return TextPlugin}(_FunctionPlugin2.FunctionPlugin);exports.TextPlugin=TextPlugin;TextPlugin.implementedFunctions={CONCATENATE:{method:"concatenate"},SPLIT:{method:"split"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(113);__webpack_require__(140);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(133);__webpack_require__(136);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.NumericAggregationPlugin=void 0;var _assert=_interopRequireDefault(__webpack_require__(126));var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function idMap(arg){return arg}function square(arg){if(arg instanceof _Cell.CellError){return arg}else if(typeof arg==="number"){return arg*arg}else{return 0}}function zeroForInfinite(value){if(typeof value==="number"&&!Number.isFinite(value)){return 0}else{return value}}var AverageResult=function(){function AverageResult(sum,count){_classCallCheck(this,AverageResult);this.sum=sum;this.count=count}_createClass(AverageResult,[{key:"compose",value:function compose(other){return new AverageResult(this.sum+other.sum,this.count+other.count)}},{key:"averageValue",value:function averageValue(){if(this.count>0){return this.sum/this.count}else{return undefined}}}],[{key:"single",value:function single(arg){return new AverageResult(arg,1)}}]);return AverageResult}();AverageResult.empty=new AverageResult(0,0);var NumericAggregationPlugin=function(_FunctionPlugin){_inherits(NumericAggregationPlugin,_FunctionPlugin);var _super=_createSuper(NumericAggregationPlugin);function NumericAggregationPlugin(){_classCallCheck(this,NumericAggregationPlugin);return _super.apply(this,arguments)}_createClass(NumericAggregationPlugin,[{key:"sum",value:function sum(ast,formulaAddress){var _this=this;if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}return this.reduce(ast,formulaAddress,0,"SUM",this.interpreter.arithmeticHelper.nonstrictadd,idMap,(function(arg){return _this.coerceScalarToNumberOrError(arg)}))}},{key:"sumsq",value:function sumsq(ast,formulaAddress){var _this2=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}return this.reduce(ast,formulaAddress,0,"SUMSQ",this.interpreter.arithmeticHelper.nonstrictadd,square,(function(arg){return _this2.coerceScalarToNumberOrError(arg)}))}},{key:"countblank",value:function countblank(ast,formulaAddress){if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var counter=0;var _iterator=_createForOfIteratorHelper(ast.args),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var arg=_step.value;var rangeValue=(0,_ArithmeticHelper.coerceToRange)(this.evaluateAst(arg,formulaAddress));var _iterator2=_createForOfIteratorHelper(rangeValue.valuesFromTopLeftCorner()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var value=_step2.value;if(value===_Cell.EmptyValue){counter++}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return counter}},{key:"max",value:function max(ast,formulaAddress){var _this3=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,Number.NEGATIVE_INFINITY,"MAX",_ArithmeticHelper.max,idMap,(function(arg){return _this3.coerceScalarToNumberOrError(arg)}));return zeroForInfinite(value)}},{key:"maxa",value:function maxa(ast,formulaAddress){var _this4=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,Number.NEGATIVE_INFINITY,"MAXA",_ArithmeticHelper.maxa,idMap,(function(arg){return _this4.coerceScalarToNumberOrError(arg)}));return zeroForInfinite(value)}},{key:"min",value:function min(ast,formulaAddress){var _this5=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,Number.POSITIVE_INFINITY,"MIN",_ArithmeticHelper.min,idMap,(function(arg){return _this5.coerceScalarToNumberOrError(arg)}));return zeroForInfinite(value)}},{key:"mina",value:function mina(ast,formulaAddress){var _this6=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,Number.POSITIVE_INFINITY,"MINA",_ArithmeticHelper.mina,idMap,(function(arg){return _this6.coerceScalarToNumberOrError(arg)}));return zeroForInfinite(value)}},{key:"count",value:function count(ast,formulaAddress){var _this7=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,0,"COUNT",(function(left,right){return left+right}),(function(arg){return typeof arg==="number"?1:0}),(function(arg){return _this7.coerceScalarToNumberOrError(arg)}));return value}},{key:"counta",value:function counta(ast,formulaAddress){var _this8=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.reduce(ast,formulaAddress,0,"COUNTA",(function(left,right){return left+right}),(function(arg){return arg===_Cell.EmptyValue?0:1}),(function(arg){return _this8.coerceScalarToNumberOrError(arg)}));return value}},{key:"average",value:function average(ast,formulaAddress){var _this9=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result=this.reduce(ast,formulaAddress,AverageResult.empty,"AVERAGE",(function(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{return left.compose(right)}}),(function(arg){if(arg instanceof _Cell.CellError){return arg}else if(typeof arg==="number"){return AverageResult.single(arg)}else{return AverageResult.empty}}),(function(arg){return _this9.coerceScalarToNumberOrError(arg)}));if(result instanceof _Cell.CellError){return result}else{return result.averageValue()||new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}}},{key:"averagea",value:function averagea(ast,formulaAddress){var _this10=this;if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result=this.reduce(ast,formulaAddress,AverageResult.empty,"AVERAGE",(function(left,right){if(left instanceof _Cell.CellError){return left}else if(right instanceof _Cell.CellError){return right}else{return left.compose(right)}}),(function(arg){if(arg===_Cell.EmptyValue){return AverageResult.empty}else if(arg instanceof _Cell.CellError){return arg}else{var coercedArg=_this10.interpreter.arithmeticHelper.coerceNonDateScalarToMaybeNumber(arg);if(coercedArg===undefined){return AverageResult.empty}else{return AverageResult.single(coercedArg)}}}),(function(arg){return _this10.coerceScalarToNumberOrError(arg)}));if(result instanceof _Cell.CellError){return result}else{return result.averageValue()||new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}}},{key:"reduce",value:function reduce(ast,formulaAddress,initialAccValue,functionName,reducingFunction,mapFunction,coerceFunction){var _this11=this;return ast.args.reduce((function(acc,arg){var value;if(arg.type===_parser.AstNodeType.CELL_RANGE||arg.type===_parser.AstNodeType.COLUMN_RANGE||arg.type===_parser.AstNodeType.ROW_RANGE){value=_this11.evaluateRange(arg,formulaAddress,acc,functionName,reducingFunction,mapFunction)}else{value=_this11.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){value=_this11.reduceRange(Array.from(value.valuesFromTopLeftCorner()).map(mapFunction),initialAccValue,reducingFunction)}else if(arg.type===_parser.AstNodeType.CELL_REFERENCE){value=mapFunction(value);value=reducingFunction(initialAccValue,value)}else{value=coerceFunction(value);value=mapFunction(value)}}return reducingFunction(acc,value)}),initialAccValue)}},{key:"reduceRange",value:function reduceRange(rangeValues,initialAccValue,reducingFunction){var acc=initialAccValue;var _iterator3=_createForOfIteratorHelper(rangeValues),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var val=_step3.value;acc=reducingFunction(acc,val)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return acc}},{key:"evaluateRange",value:function evaluateRange(ast,formulaAddress,initialAccValue,functionName,reducingFunction,mapFunction){var range;try{range=_AbsoluteCellRange.AbsoluteCellRange.fromAst(ast,formulaAddress)}catch(err){if(err.message===_AbsoluteCellRange.DIFFERENT_SHEETS_ERROR){return mapFunction(new _Cell.CellError(_Cell.ErrorType.REF))}else{throw err}}var rangeStart=range.start;var rangeEnd=range.end;var rangeVertex=this.dependencyGraph.getRange(rangeStart,rangeEnd);_assert.default.ok(rangeVertex,"Range does not exists in graph");var value=rangeVertex.getFunctionValue(functionName);if(!value){var rangeValues=this.getRangeValues(functionName,range,mapFunction);value=this.reduceRange(rangeValues,initialAccValue,reducingFunction);rangeVertex.setFunctionValue(functionName,value)}return value}},{key:"getRangeValues",value:function getRangeValues(functionName,range,mapFunction){var rangeResult=[];var _this$dependencyGraph=this.dependencyGraph.rangeMapping.findSmallerRange(range),smallerRangeVertex=_this$dependencyGraph.smallerRangeVertex,restRange=_this$dependencyGraph.restRange;var currentRangeVertex=this.dependencyGraph.getRange(range.start,range.end);var actualRange;if(smallerRangeVertex&&this.dependencyGraph.existsEdge(smallerRangeVertex,currentRangeVertex)){var cachedValue=smallerRangeVertex.getFunctionValue(functionName);if(cachedValue){rangeResult.push(cachedValue)}else{var _iterator4=_createForOfIteratorHelper(smallerRangeVertex.range.addresses(this.dependencyGraph)),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var cellFromRange=_step4.value;rangeResult.push(mapFunction(this.dependencyGraph.getScalarValue(cellFromRange)))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}actualRange=restRange}else{actualRange=range}var _iterator5=_createForOfIteratorHelper(actualRange.addresses(this.dependencyGraph)),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _cellFromRange=_step5.value;rangeResult.push(mapFunction(this.dependencyGraph.getScalarValue(_cellFromRange)))}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return rangeResult}}]);return NumericAggregationPlugin}(_FunctionPlugin2.FunctionPlugin);exports.NumericAggregationPlugin=NumericAggregationPlugin;NumericAggregationPlugin.implementedFunctions={SUM:{method:"sum"},SUMSQ:{method:"sumsq"},MAX:{method:"max"},MIN:{method:"min"},MAXA:{method:"maxa"},MINA:{method:"mina"},COUNTBLANK:{method:"countblank"},COUNT:{method:"count"},COUNTA:{method:"counta"},AVERAGE:{method:"average"},AVERAGEA:{method:"averagea"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(196);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.MedianPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var MedianPlugin=function(_FunctionPlugin){_inherits(MedianPlugin,_FunctionPlugin);var _super=_createSuper(MedianPlugin);function MedianPlugin(){_classCallCheck(this,MedianPlugin);return _super.apply(this,arguments)}_createClass(MedianPlugin,[{key:"median",value:function median(ast,formulaAddress){if(ast.args.length===0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var values=[];var _iterator=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var scalarValue=_step.value;if(scalarValue instanceof _Cell.CellError){return scalarValue}else if(typeof scalarValue==="number"){values.push(scalarValue)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(values.length===0){return new _Cell.CellError(_Cell.ErrorType.NUM)}values.sort((function(a,b){return a-b}));if(values.length%2===0){return(values[values.length/2-1]+values[values.length/2])/2}else{return values[Math.floor(values.length/2)]}}}]);return MedianPlugin}(_FunctionPlugin2.FunctionPlugin);exports.MedianPlugin=MedianPlugin;MedianPlugin.implementedFunctions={MEDIAN:{method:"median"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(282);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.DatePlugin=void 0;var _Cell=__webpack_require__(106);var _DateTimeHelper=__webpack_require__(247);var _format=__webpack_require__(249);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var DatePlugin=function(_FunctionPlugin){_inherits(DatePlugin,_FunctionPlugin);var _super=_createSuper(DatePlugin);function DatePlugin(){_classCallCheck(this,DatePlugin);return _super.apply(this,arguments)}_createClass(DatePlugin,[{key:"date",value:function date(ast,formulaAddress){if(ast.args.length!==3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var year=this.evaluateAst(ast.args[0],formulaAddress);var month=this.evaluateAst(ast.args[1],formulaAddress);var day=this.evaluateAst(ast.args[2],formulaAddress);if(year instanceof _InterpreterValue.SimpleRangeValue||month instanceof _InterpreterValue.SimpleRangeValue||day instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedYear=this.coerceScalarToNumberOrError(year);var coercedMonth=this.coerceScalarToNumberOrError(month);var coercedDay=this.coerceScalarToNumberOrError(day);if(coercedYear instanceof _Cell.CellError){return coercedYear}if(coercedMonth instanceof _Cell.CellError){return coercedMonth}if(coercedDay instanceof _Cell.CellError){return coercedDay}var d=Math.trunc(coercedDay);var m=Math.trunc(coercedMonth);var y=Math.trunc(coercedYear);if(y<this.interpreter.dateHelper.getEpochYearZero()){y+=this.interpreter.dateHelper.getEpochYearZero()}var delta=Math.floor((m-1)/12);y+=delta;m-=delta*12;var date={year:y,month:m,day:1};if(this.interpreter.dateHelper.isValidDate(date)){var ret=this.interpreter.dateHelper.dateToNumber(date)+(d-1);if(this.interpreter.dateHelper.getWithinBounds(ret)){return ret}}return new _Cell.CellError(_Cell.ErrorType.VALUE)}},{key:"eomonth",value:function eomonth(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var dateNumber=this.coerceScalarToNumberOrError(arg);if(dateNumber instanceof _Cell.CellError){return dateNumber}var numberOfMonthsToShiftValue=this.evaluateAst(ast.args[1],formulaAddress);if(numberOfMonthsToShiftValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var numberOfMonthsToShift=this.coerceScalarToNumberOrError(numberOfMonthsToShiftValue);if(numberOfMonthsToShift instanceof _Cell.CellError){return numberOfMonthsToShift}var date=this.interpreter.dateHelper.numberToSimpleDate(dateNumber);return this.interpreter.dateHelper.dateToNumber((0,_DateTimeHelper.endOfMonth)((0,_DateTimeHelper.offsetMonth)(date,numberOfMonthsToShift)))}},{key:"day",value:function day(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var dateNumber=this.coerceScalarToNumberOrError(arg);if(dateNumber instanceof _Cell.CellError){return dateNumber}return this.interpreter.dateHelper.numberToSimpleDate(dateNumber).day}},{key:"days",value:function days(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var endDate=this.evaluateAst(ast.args[0],formulaAddress);if(endDate instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var endDateNumber=this.coerceScalarToNumberOrError(endDate);if(endDateNumber instanceof _Cell.CellError){return endDateNumber}var startDate=this.evaluateAst(ast.args[1],formulaAddress);if(startDate instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var startDateNumber=this.coerceScalarToNumberOrError(startDate);if(startDateNumber instanceof _Cell.CellError){return startDateNumber}return endDateNumber-startDateNumber}},{key:"month",value:function month(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var dateNumber=this.coerceScalarToNumberOrError(arg);if(dateNumber instanceof _Cell.CellError){return dateNumber}return this.interpreter.dateHelper.numberToSimpleDate(dateNumber).month}},{key:"year",value:function year(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var dateNumber=this.coerceScalarToNumberOrError(arg);if(dateNumber instanceof _Cell.CellError){return dateNumber}return this.interpreter.dateHelper.numberToSimpleDate(dateNumber).year}},{key:"text",value:function text(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var dateArg=this.evaluateAst(ast.args[0],formulaAddress);var formatArg=this.evaluateAst(ast.args[1],formulaAddress);if(dateArg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var numberRepresentation=this.coerceScalarToNumberOrError(dateArg);if(numberRepresentation instanceof _Cell.CellError){return numberRepresentation}if(typeof formatArg!=="string"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return(0,_format.format)(numberRepresentation,formatArg,this.config,this.interpreter.dateHelper)}}]);return DatePlugin}(_FunctionPlugin2.FunctionPlugin);exports.DatePlugin=DatePlugin;DatePlugin.implementedFunctions={DATE:{method:"date"},MONTH:{method:"month"},YEAR:{method:"year"},TEXT:{method:"text"},EOMONTH:{method:"eomonth"},DAY:{method:"day"},DAYS:{method:"days"}}},function(module,exports,__webpack_require__){var $=__webpack_require__(2);var ceil=Math.ceil;var floor=Math.floor;$({target:"Math",stat:true},{trunc:function trunc(it){return(it>0?floor:ceil)(it)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.BooleanPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var BooleanPlugin=function(_FunctionPlugin){_inherits(BooleanPlugin,_FunctionPlugin);var _super=_createSuper(BooleanPlugin);function BooleanPlugin(){_classCallCheck(this,BooleanPlugin);return _super.apply(this,arguments)}_createClass(BooleanPlugin,[{key:"literalTrue",value:function literalTrue(ast,formulaAddress){if(ast.args.length>0){return new _Cell.CellError(_Cell.ErrorType.NA)}else{return true}}},{key:"literalFalse",value:function literalFalse(ast,formulaAddress){if(ast.args.length>0){return new _Cell.CellError(_Cell.ErrorType.NA)}else{return false}}},{key:"conditionalIf",value:function conditionalIf(ast,formulaAddress){if(ast.args.length>3||ast.args.length<2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var conditionValue=this.evaluateAst(ast.args[0],formulaAddress);if(conditionValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var condition=(0,_ArithmeticHelper.coerceScalarToBoolean)(conditionValue);if(condition===true){return this.evaluateAst(ast.args[1],formulaAddress)}else if(condition===false){if(ast.args[2]!==undefined){return this.evaluateAst(ast.args[2],formulaAddress)}else{return false}}else if(condition instanceof _Cell.CellError){return condition}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}},{key:"and",value:function and(ast,formulaAddress){if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result=true;var anyReasonableValue=false;var _iterator=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var scalarValue=_step.value;var coercedValue=(0,_ArithmeticHelper.coerceScalarToBoolean)(scalarValue);if(coercedValue instanceof _Cell.CellError){return coercedValue}else if(coercedValue!==null){result=result&&coercedValue;anyReasonableValue=true}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(anyReasonableValue){return result}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}},{key:"or",value:function or(ast,formulaAddress){if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result=null;var _iterator2=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var scalarValue=_step2.value;var coercedValue=(0,_ArithmeticHelper.coerceScalarToBoolean)(scalarValue);if(coercedValue instanceof _Cell.CellError){return coercedValue}else if(coercedValue!==null){result=result||coercedValue}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(result===null){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{return result}}},{key:"not",value:function not(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var argValue=this.evaluateAst(ast.args[0],formulaAddress);if(argValue instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}else{var coercedValue=(0,_ArithmeticHelper.coerceScalarToBoolean)(argValue);if(coercedValue instanceof _Cell.CellError){return coercedValue}else{return!coercedValue}}}},{key:"xor",value:function xor(ast,formulaAddress){if(ast.args.length<1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var truesCount=0;var anyFalseValue=false;var _iterator3=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var scalarValue=_step3.value;var coercedValue=(0,_ArithmeticHelper.coerceScalarToBoolean)(scalarValue);if(coercedValue instanceof _Cell.CellError){return coercedValue}else if(coercedValue===true){truesCount++}else if(coercedValue===false){anyFalseValue=true}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(anyFalseValue||truesCount>0){return truesCount%2===1}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}},{key:"switch",value:function _switch(ast,formulaAddress){if(ast.args.length<3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var vals=[];var _iterator4=_createForOfIteratorHelper(ast.args),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var arg=_step4.value;var val=this.evaluateAst(arg,formulaAddress);if(val instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}vals.push(val)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var n=vals.length;if(vals[0]instanceof _Cell.CellError){return vals[0]}var i=1;for(;i+1<n;i+=2){if(vals[i]instanceof _Cell.CellError){continue}if(this.interpreter.arithmeticHelper.compare(vals[0],vals[i])===0){return vals[i+1]}}if(i<n){return vals[i]}else{return new _Cell.CellError(_Cell.ErrorType.NA)}}},{key:"iferror",value:function iferror(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var left=this.evaluateAst(ast.args[0],formulaAddress);var right=this.evaluateAst(ast.args[1],formulaAddress);if(left instanceof _InterpreterValue.SimpleRangeValue||right instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}if(left instanceof _Cell.CellError){return right}else{return left}}},{key:"ifna",value:function ifna(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var left=this.evaluateAst(ast.args[0],formulaAddress);var right=this.evaluateAst(ast.args[1],formulaAddress);if(left instanceof _InterpreterValue.SimpleRangeValue||right instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}if(left instanceof _Cell.CellError&&left.type===_Cell.ErrorType.NA){return right}else{return left}}},{key:"choose",value:function choose(ast,formulaAddress){if(ast.args.length<2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var vals=[];var _iterator5=_createForOfIteratorHelper(ast.args),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var arg=_step5.value;var val=this.evaluateAst(arg,formulaAddress);if(val instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}vals.push(val)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var n=vals.length;if(vals[0]instanceof _Cell.CellError){return vals[0]}var selector=this.interpreter.arithmeticHelper.coerceToMaybeNumber(vals[0]);if(selector===undefined||selector!=Math.round(selector)||selector<1||selector>=n){return new _Cell.CellError(_Cell.ErrorType.NUM)}return vals[selector]}}]);return BooleanPlugin}(_FunctionPlugin2.FunctionPlugin);exports.BooleanPlugin=BooleanPlugin;BooleanPlugin.implementedFunctions={TRUE:{method:"literalTrue"},FALSE:{method:"literalFalse"},IF:{method:"conditionalIf"},AND:{method:"and"},OR:{method:"or"},XOR:{method:"xor"},NOT:{method:"not"},SWITCH:{method:"switch"},IFERROR:{method:"iferror"},IFNA:{method:"ifna"},CHOOSE:{method:"choose"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.InformationPlugin=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var InformationPlugin=function(_FunctionPlugin){_inherits(InformationPlugin,_FunctionPlugin);var _super=_createSuper(InformationPlugin);function InformationPlugin(){_classCallCheck(this,InformationPlugin);return _super.apply(this,arguments)}_createClass(InformationPlugin,[{key:"iserror",value:function iserror(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return arg instanceof _Cell.CellError}},{key:"isblank",value:function isblank(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=ast.args[0];var value=this.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return value===_Cell.EmptyValue}},{key:"isnumber",value:function isnumber(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=ast.args[0];var value=this.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return typeof value==="number"}},{key:"islogical",value:function islogical(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=ast.args[0];var value=this.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return typeof value==="boolean"}},{key:"istext",value:function istext(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=ast.args[0];var value=this.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return typeof value==="string"}},{key:"isnontext",value:function isnontext(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=ast.args[0];var value=this.evaluateAst(arg,formulaAddress);if(value instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return typeof value!=="string"}},{key:"columns",value:function columns(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var rangeAst=ast.args[0];if(rangeAst.type===_parser.AstNodeType.CELL_RANGE){return rangeAst.end.col-rangeAst.start.col+1}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}},{key:"rows",value:function rows(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var rangeAst=ast.args[0];if(rangeAst.type===_parser.AstNodeType.CELL_RANGE){return rangeAst.end.row-rangeAst.start.row+1}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}},{key:"index",value:function index(ast,formulaAddress){var rangeArg=ast.args[0];if(ast.args.length<1||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var width,height;var range;if(rangeArg.type===_parser.AstNodeType.CELL_RANGE){range=_AbsoluteCellRange.AbsoluteCellRange.fromCellRange(rangeArg,formulaAddress);width=range.width();height=range.height()}else{width=1;height=1}var rowArg=ast.args[1];var rowValue=this.evaluateAst(rowArg,formulaAddress);if(typeof rowValue!=="number"||rowValue<0||rowValue>height){return new _Cell.CellError(_Cell.ErrorType.NUM)}var columnArg=ast.args[2];var columnValue=this.evaluateAst(columnArg,formulaAddress);if(typeof columnValue!=="number"||columnValue<0||columnValue>width){return new _Cell.CellError(_Cell.ErrorType.NUM)}if(columnValue===0||rowValue===0||range===undefined){throw Error("Not implemented yet")}var address=range.getAddress(columnValue-1,rowValue-1);return this.dependencyGraph.getCellValue(address)}}]);return InformationPlugin}(_FunctionPlugin2.FunctionPlugin);exports.InformationPlugin=InformationPlugin;InformationPlugin.implementedFunctions={ISERROR:{method:"iserror"},ISBLANK:{method:"isblank"},ISNUMBER:{method:"isnumber"},ISLOGICAL:{method:"islogical"},ISTEXT:{method:"istext"},ISNONTEXT:{method:"isnontext"},COLUMNS:{method:"columns",isDependentOnSheetStructureChange:true,doesNotNeedArgumentsToBeComputed:true},ROWS:{method:"rows",isDependentOnSheetStructureChange:true,doesNotNeedArgumentsToBeComputed:true},INDEX:{method:"index"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.TrigonometryPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var TrigonometryPlugin=function(_FunctionPlugin){_inherits(TrigonometryPlugin,_FunctionPlugin);var _super=_createSuper(TrigonometryPlugin);function TrigonometryPlugin(){_classCallCheck(this,TrigonometryPlugin);return _super.apply(this,arguments)}_createClass(TrigonometryPlugin,[{key:"acos",value:function acos(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){if(-1<=coercedArg&&coercedArg<=1){return Math.acos(coercedArg)}else{return new _Cell.CellError(_Cell.ErrorType.NUM)}}))}},{key:"asin",value:function asin(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){if(-1<=coercedArg&&coercedArg<=1){return Math.asin(coercedArg)}else{return new _Cell.CellError(_Cell.ErrorType.NUM)}}))}},{key:"cos",value:function cos(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){return Math.cos(coercedArg)}))}},{key:"sin",value:function sin(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){return Math.sin(coercedArg)}))}},{key:"tan",value:function tan(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){return Math.tan(coercedArg)}))}},{key:"atan",value:function atan(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){return Math.atan(coercedArg)}))}},{key:"atan2",value:function atan2(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg1=this.evaluateAst(ast.args[0],formulaAddress);if(arg1 instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var arg2=this.evaluateAst(ast.args[1],formulaAddress);if(arg2 instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedArg1=this.coerceScalarToNumberOrError(arg1);if(coercedArg1 instanceof _Cell.CellError){return coercedArg1}var coercedArg2=this.coerceScalarToNumberOrError(arg2);if(coercedArg2 instanceof _Cell.CellError){return coercedArg2}return Math.atan2(coercedArg1,coercedArg2)}},{key:"ctg",value:function ctg(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedArg){if(coercedArg===0){return new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}else{return 1/Math.tan(coercedArg)}}))}}]);return TrigonometryPlugin}(_FunctionPlugin2.FunctionPlugin);exports.TrigonometryPlugin=TrigonometryPlugin;TrigonometryPlugin.implementedFunctions={ACOS:{method:"acos"},ASIN:{method:"asin"},COS:{method:"cos"},SIN:{method:"sin"},TAN:{method:"tan"},ATAN:{method:"atan"},ATAN2:{method:"atan2"},COT:{method:"ctg"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(114);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.CountUniquePlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var CountUniquePlugin=function(_FunctionPlugin){_inherits(CountUniquePlugin,_FunctionPlugin);var _super=_createSuper(CountUniquePlugin);function CountUniquePlugin(){_classCallCheck(this,CountUniquePlugin);return _super.apply(this,arguments)}_createClass(CountUniquePlugin,[{key:"countunique",value:function countunique(ast,formulaAddress){if(ast.args.length===0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var valuesSet=new Set;var errorsSet=new Set;var _iterator=_createForOfIteratorHelper(this.iterateOverScalarValues(ast.args,formulaAddress)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var scalarValue=_step.value;if(scalarValue instanceof _Cell.CellError){errorsSet.add(scalarValue.type)}else if(scalarValue!==""){valuesSet.add(scalarValue)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return valuesSet.size+errorsSet.size}}]);return CountUniquePlugin}(_FunctionPlugin2.FunctionPlugin);exports.CountUniquePlugin=CountUniquePlugin;CountUniquePlugin.implementedFunctions={COUNTUNIQUE:{method:"countunique"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.SumprodPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var SumprodPlugin=function(_FunctionPlugin){_inherits(SumprodPlugin,_FunctionPlugin);var _super=_createSuper(SumprodPlugin);function SumprodPlugin(){_classCallCheck(this,SumprodPlugin);return _super.apply(this,arguments)}_createClass(SumprodPlugin,[{key:"sumprod",value:function sumprod(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var _ast$args=_slicedToArray(ast.args,2),left=_ast$args[0],right=_ast$args[1];var leftArgValue=(0,_ArithmeticHelper.coerceToRange)(this.evaluateAst(left,formulaAddress));var rightArgValue=(0,_ArithmeticHelper.coerceToRange)(this.evaluateAst(right,formulaAddress));if(leftArgValue.numberOfElements()!==rightArgValue.numberOfElements()){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return this.reduceSumprod(leftArgValue,rightArgValue)}},{key:"reduceSumprod",value:function reduceSumprod(left,right){var result=0;var lit=left.valuesFromTopLeftCorner();var rit=right.valuesFromTopLeftCorner();var l,r;while(l=lit.next(),r=rit.next(),!l.done&&!r.done){if(l.value instanceof _Cell.CellError){return l.value}else if(r.value instanceof _Cell.CellError){return r.value}else{var lval=this.coerceScalarToNumberOrError(l.value);var rval=this.coerceScalarToNumberOrError(r.value);if(typeof lval==="number"&&typeof rval==="number"){result+=lval*rval}}}return result}}]);return SumprodPlugin}(_FunctionPlugin2.FunctionPlugin);exports.SumprodPlugin=SumprodPlugin;SumprodPlugin.implementedFunctions={SUMPRODUCT:{method:"sumprod"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(163);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.MatrixPlugin=void 0;var _Cell=__webpack_require__(106);var _Matrix=__webpack_require__(189);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var MatrixPlugin=function(_FunctionPlugin){_inherits(MatrixPlugin,_FunctionPlugin);var _super=_createSuper(MatrixPlugin);function MatrixPlugin(){_classCallCheck(this,MatrixPlugin);return _super.apply(this,arguments)}_createClass(MatrixPlugin,[{key:"mmult",value:function mmult(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var _ast$args=_slicedToArray(ast.args,2),left=_ast$args[0],right=_ast$args[1];var leftMatrix=(0,_ArithmeticHelper.coerceToRangeNumbersOrError)(this.evaluateAst(left,formulaAddress));var rightMatrix=(0,_ArithmeticHelper.coerceToRangeNumbersOrError)(this.evaluateAst(right,formulaAddress));if(leftMatrix instanceof _Cell.CellError){return leftMatrix}else if(rightMatrix instanceof _Cell.CellError){return rightMatrix}else if(leftMatrix===null||rightMatrix===null){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var outputSize=(0,_Matrix.matrixSizeForMultiplication)(leftMatrix.size,rightMatrix.size);var gpu=this.interpreter.getGpuInstance();var kernel=gpu.createKernel((function(a,b,width){var sum=0;for(var i=0;i<width;++i){sum+=a[this.thread.y][i]*b[i][this.thread.x]}return sum})).setPrecision("unsigned").setOutput([outputSize.width,outputSize.height]);return _InterpreterValue.SimpleRangeValue.onlyNumbersDataWithoutRange(kernel(leftMatrix.rawNumbers(),rightMatrix.rawNumbers(),leftMatrix.width()),outputSize)}},{key:"maxpool",value:function maxpool(ast,formulaAddress){var _ast$args2=_slicedToArray(ast.args,2),rangeArg=_ast$args2[0],sizeArg=_ast$args2[1];var rangeMatrix=(0,_ArithmeticHelper.coerceToRangeNumbersOrError)(this.evaluateAst(rangeArg,formulaAddress));var windowSize=sizeArg.value;var stride=windowSize;if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}if(ast.args.length===3){var strideArg=ast.args[2];if(strideArg.type===_parser.AstNodeType.NUMBER){stride=strideArg.value}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}if(rangeMatrix instanceof _Cell.CellError){return rangeMatrix}else if(rangeMatrix===null){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var outputSize=(0,_Matrix.matrixSizeForPoolFunction)(rangeMatrix.size,windowSize,stride);var gpu=this.interpreter.getGpuInstance();var kernel=gpu.createKernel((function(a,windowSize,stride){var leftCornerX=this.thread.x*stride;var leftCornerY=this.thread.y*stride;var currentMax=a[leftCornerY][leftCornerX];for(var i=0;i<windowSize;i++){for(var j=0;j<windowSize;j++){currentMax=Math.max(currentMax,a[leftCornerY+i][leftCornerX+j])}}return currentMax})).setPrecision("unsigned").setOutput([outputSize.width,outputSize.height]);return _InterpreterValue.SimpleRangeValue.onlyNumbersDataWithoutRange(kernel(rangeMatrix.rawNumbers(),windowSize,stride),outputSize)}},{key:"medianpool",value:function medianpool(ast,formulaAddress){var _ast$args3=_slicedToArray(ast.args,2),rangeArg=_ast$args3[0],sizeArg=_ast$args3[1];if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var rangeMatrix=(0,_ArithmeticHelper.coerceToRangeNumbersOrError)(this.evaluateAst(rangeArg,formulaAddress));var windowSize=sizeArg.value;var stride=windowSize;if(ast.args.length===3){var strideArg=ast.args[2];if(strideArg.type===_parser.AstNodeType.NUMBER){stride=strideArg.value}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}if(rangeMatrix instanceof _Cell.CellError){return rangeMatrix}else if(rangeMatrix===null){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var outputSize=(0,_Matrix.matrixSizeForPoolFunction)(rangeMatrix.size,windowSize,stride);var gpu=this.interpreter.getGpuInstance();var kernel=gpu.createKernel((function(a,windowSize,stride){var leftCornerX=this.thread.x*stride;var leftCornerY=this.thread.y*stride;var currentMax=a[leftCornerY][leftCornerX];for(var i=0;i<windowSize;i++){for(var j=0;j<windowSize;j++){currentMax=Math.max(currentMax,a[leftCornerY+i][leftCornerX+j])}}var currentMin=a[leftCornerY][leftCornerX];for(var i2=0;i2<windowSize;i2++){for(var j2=0;j2<windowSize;j2++){currentMin=Math.min(currentMin,a[leftCornerY+i2][leftCornerX+j2])}}var numberOfElements=windowSize*windowSize;var leftEnd=currentMin;var rightEnd=currentMax;var result=42;for(var iter=0;iter<32;iter++){var medianGuess=(leftEnd+rightEnd)/2;var medianGuessCount=0;for(var i3=0;i3<windowSize;i3++){for(var j3=0;j3<windowSize;j3++){if(a[leftCornerY+i3][leftCornerX+j3]>medianGuess){medianGuessCount++}}}if(windowSize%2===0){if(medianGuessCount===numberOfElements/2){result=medianGuess;break}else if(medianGuessCount>numberOfElements/2){leftEnd=medianGuess}else{rightEnd=medianGuess}}else{if(medianGuessCount===(numberOfElements-1)/2){result=medianGuess;break}else if(medianGuessCount>(numberOfElements-1)/2){leftEnd=medianGuess}else{rightEnd=medianGuess}}}return result})).setPrecision("unsigned").setOutput([outputSize.width,outputSize.height]);return _InterpreterValue.SimpleRangeValue.onlyNumbersDataWithoutRange(kernel(rangeMatrix.rawNumbers(),windowSize,stride),outputSize)}},{key:"transpose",value:function transpose(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=(0,_ArithmeticHelper.coerceToRangeNumbersOrError)(this.evaluateAst(ast.args[0],formulaAddress));if(value instanceof _Cell.CellError){return value}else if(value===null){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var input=value.rawNumbers();var inputSize=value.size;var result=[];for(var i=0;i<inputSize.width;++i){result[i]=[];for(var j=0;j<inputSize.height;++j){result[i][j]=input[j][i]}}return _InterpreterValue.SimpleRangeValue.onlyNumbersDataWithoutRange(result,(0,_Matrix.matrixSizeForTranspose)(inputSize))}}]);return MatrixPlugin}(_FunctionPlugin2.FunctionPlugin);exports.MatrixPlugin=MatrixPlugin;MatrixPlugin.implementedFunctions={MMULT:{method:"mmult"},TRANSPOSE:{method:"transpose"},MAXPOOL:{method:"maxpool"},MEDIANPOOL:{method:"medianpool"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.ExpPlugin=void 0;var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var ExpPlugin=function(_FunctionPlugin){_inherits(ExpPlugin,_FunctionPlugin);var _super=_createSuper(ExpPlugin);function ExpPlugin(){_classCallCheck(this,ExpPlugin);return _super.apply(this,arguments)}_createClass(ExpPlugin,[{key:"exp",value:function exp(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){return Math.exp(arg)}))}}]);return ExpPlugin}(_FunctionPlugin2.FunctionPlugin);exports.ExpPlugin=ExpPlugin;ExpPlugin.implementedFunctions={EXP:{method:"exp"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.AbsPlugin=void 0;var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var AbsPlugin=function(_FunctionPlugin){_inherits(AbsPlugin,_FunctionPlugin);var _super=_createSuper(AbsPlugin);function AbsPlugin(){_classCallCheck(this,AbsPlugin);return _super.apply(this,arguments)}_createClass(AbsPlugin,[{key:"abs",value:function abs(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){return Math.abs(arg)}))}}]);return AbsPlugin}(_FunctionPlugin2.FunctionPlugin);exports.AbsPlugin=AbsPlugin;AbsPlugin.implementedFunctions={ABS:{method:"abs"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.DegreesPlugin=void 0;var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var DegreesPlugin=function(_FunctionPlugin){_inherits(DegreesPlugin,_FunctionPlugin);var _super=_createSuper(DegreesPlugin);function DegreesPlugin(){_classCallCheck(this,DegreesPlugin);return _super.apply(this,arguments)}_createClass(DegreesPlugin,[{key:"degrees",value:function degrees(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){return arg*(180/Math.PI)}))}}]);return DegreesPlugin}(_FunctionPlugin2.FunctionPlugin);exports.DegreesPlugin=DegreesPlugin;DegreesPlugin.implementedFunctions={DEGREES:{method:"degrees"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.RadiansPlugin=void 0;var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var RadiansPlugin=function(_FunctionPlugin){_inherits(RadiansPlugin,_FunctionPlugin);var _super=_createSuper(RadiansPlugin);function RadiansPlugin(){_classCallCheck(this,RadiansPlugin);return _super.apply(this,arguments)}_createClass(RadiansPlugin,[{key:"radians",value:function radians(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){return arg*(Math.PI/180)}))}}]);return RadiansPlugin}(_FunctionPlugin2.FunctionPlugin);exports.RadiansPlugin=RadiansPlugin;RadiansPlugin.implementedFunctions={RADIANS:{method:"radians"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.RandomPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var RandomPlugin=function(_FunctionPlugin){_inherits(RandomPlugin,_FunctionPlugin);var _super=_createSuper(RandomPlugin);function RandomPlugin(){_classCallCheck(this,RandomPlugin);return _super.apply(this,arguments)}_createClass(RandomPlugin,[{key:"rand",value:function rand(ast,formulaAddress){if(ast.args.length!==0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}return Math.random()}}]);return RandomPlugin}(_FunctionPlugin2.FunctionPlugin);exports.RandomPlugin=RandomPlugin;RandomPlugin.implementedFunctions={RAND:{method:"rand",isVolatile:true}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(241);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.VlookupPlugin=void 0;var _AbsoluteCellRange=__webpack_require__(132);var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _statistics=__webpack_require__(176);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var VlookupPlugin=function(_FunctionPlugin){_inherits(VlookupPlugin,_FunctionPlugin);var _super=_createSuper(VlookupPlugin);function VlookupPlugin(){_classCallCheck(this,VlookupPlugin);return _super.apply(this,arguments)}_createClass(VlookupPlugin,[{key:"vlookup",value:function vlookup(ast,formulaAddress){if(ast.args.length<3||ast.args.length>4){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var key=this.evaluateAst(ast.args[0],formulaAddress);if(typeof key!=="string"&&typeof key!=="number"&&typeof key!=="boolean"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var rangeArg=ast.args[1];if(rangeArg.type!==_parser.AstNodeType.CELL_RANGE){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var index=this.evaluateAst(ast.args[2],formulaAddress);if(typeof index!=="number"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var sorted=true;if(ast.args.length===4){var computedSorted=this.evaluateAst(ast.args[3],formulaAddress);if(typeof computedSorted==="boolean"){sorted=computedSorted}else{return new _Cell.CellError(_Cell.ErrorType.VALUE)}}var range=_AbsoluteCellRange.AbsoluteCellRange.fromCellRange(rangeArg,formulaAddress);if(index>range.width()){return new _Cell.CellError(_Cell.ErrorType.REF)}return this.doVlookup(key,range,index-1,sorted)}},{key:"match",value:function match(ast,formulaAddress){if(ast.args.length<2||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}var key=this.evaluateAst(ast.args[0],formulaAddress);if(typeof key!=="string"&&typeof key!=="number"&&typeof key!=="boolean"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var rangeArg=ast.args[1];if(rangeArg.type!==_parser.AstNodeType.CELL_RANGE){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var sorted=1;if(ast.args.length===3){sorted=this.evaluateAst(ast.args[2],formulaAddress);if(typeof sorted!=="number"){return new _Cell.CellError(_Cell.ErrorType.VALUE)}}var searchedRange=_AbsoluteCellRange.AbsoluteCellRange.fromCellRange(rangeArg,formulaAddress);if(searchedRange.width()===1){var rowIndex=this.columnSearch.find(key,searchedRange,sorted!==0);if(rowIndex===-1){return new _Cell.CellError(_Cell.ErrorType.NA)}return rowIndex-searchedRange.start.row+1}else{var columnIndex=this.searchInRange(key,searchedRange,false);if(columnIndex===-1){return new _Cell.CellError(_Cell.ErrorType.NA)}return columnIndex-searchedRange.start.row+1}}},{key:"searchInRange",value:function searchInRange(key,range,sorted){if(!sorted&&typeof key==="string"&&this.interpreter.arithmeticHelper.requiresRegex(key)){return this.columnSearch.advancedFind(this.interpreter.arithmeticHelper.eqMatcherFunction(key),range)}else{return this.columnSearch.find(key,range,sorted)}}},{key:"doVlookup",value:function doVlookup(key,range,index,sorted){this.dependencyGraph.stats.start(_statistics.StatType.VLOOKUP);var searchedRange=_AbsoluteCellRange.AbsoluteCellRange.spanFrom(range.start,1,range.height());var rowIndex=this.searchInRange(key,searchedRange,sorted);this.dependencyGraph.stats.end(_statistics.StatType.VLOOKUP);if(rowIndex===-1){return new _Cell.CellError(_Cell.ErrorType.NA)}var address=(0,_Cell.simpleCellAddress)(range.sheet,range.start.col+index,rowIndex);return this.dependencyGraph.getCellValue(address)}}]);return VlookupPlugin}(_FunctionPlugin2.FunctionPlugin);exports.VlookupPlugin=VlookupPlugin;VlookupPlugin.implementedFunctions={VLOOKUP:{method:"vlookup"},MATCH:{method:"match"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.IsEvenPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var IsEvenPlugin=function(_FunctionPlugin){_inherits(IsEvenPlugin,_FunctionPlugin);var _super=_createSuper(IsEvenPlugin);function IsEvenPlugin(){_classCallCheck(this,IsEvenPlugin);return _super.apply(this,arguments)}_createClass(IsEvenPlugin,[{key:"iseven",value:function iseven(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedValue=this.coerceScalarToNumberOrError(arg);if(coercedValue instanceof _Cell.CellError){return coercedValue}else{return coercedValue%2===0}}}]);return IsEvenPlugin}(_FunctionPlugin2.FunctionPlugin);exports.IsEvenPlugin=IsEvenPlugin;IsEvenPlugin.implementedFunctions={ISEVEN:{method:"iseven"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.IsOddPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var IsOddPlugin=function(_FunctionPlugin){_inherits(IsOddPlugin,_FunctionPlugin);var _super=_createSuper(IsOddPlugin);function IsOddPlugin(){_classCallCheck(this,IsOddPlugin);return _super.apply(this,arguments)}_createClass(IsOddPlugin,[{key:"isodd",value:function isodd(ast,formulaAddress){if(ast.args.length!=1){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedValue=this.coerceScalarToNumberOrError(arg);if(coercedValue instanceof _Cell.CellError){return coercedValue}else{return coercedValue%2===1}}}]);return IsOddPlugin}(_FunctionPlugin2.FunctionPlugin);exports.IsOddPlugin=IsOddPlugin;IsOddPlugin.implementedFunctions={ISODD:{method:"isodd"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.findNextOddNumber=findNextOddNumber;exports.findNextEvenNumber=findNextEvenNumber;exports.RoundingPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function findNextOddNumber(arg){var ceiled=Math.ceil(arg);return ceiled%2===1?ceiled:ceiled+1}function findNextEvenNumber(arg){var ceiled=Math.ceil(arg);return ceiled%2===0?ceiled:ceiled+1}var RoundingPlugin=function(_FunctionPlugin){_inherits(RoundingPlugin,_FunctionPlugin);var _super=_createSuper(RoundingPlugin);function RoundingPlugin(){_classCallCheck(this,RoundingPlugin);return _super.apply(this,arguments)}_createClass(RoundingPlugin,[{key:"roundup",value:function roundup(ast,formulaAddress){return this.commonArgumentsHandling2(ast,formulaAddress,(function(numberToRound,places){var placesMultiplier=Math.pow(10,places);if(numberToRound<0){return-Math.ceil(-numberToRound*placesMultiplier)/placesMultiplier}else{return Math.ceil(numberToRound*placesMultiplier)/placesMultiplier}}))}},{key:"rounddown",value:function rounddown(ast,formulaAddress){return this.commonArgumentsHandling2(ast,formulaAddress,(function(numberToRound,places){var placesMultiplier=Math.pow(10,places);if(numberToRound<0){return-Math.floor(-numberToRound*placesMultiplier)/placesMultiplier}else{return Math.floor(numberToRound*placesMultiplier)/placesMultiplier}}))}},{key:"round",value:function round(ast,formulaAddress){return this.commonArgumentsHandling2(ast,formulaAddress,(function(numberToRound,places){var placesMultiplier=Math.pow(10,places);if(numberToRound<0){return-Math.round(-numberToRound*placesMultiplier)/placesMultiplier}else{return Math.round(numberToRound*placesMultiplier)/placesMultiplier}}))}},{key:"trunc",value:function trunc(ast,formulaAddress){return this.rounddown(ast,formulaAddress)}},{key:"intFunc",value:function intFunc(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedNumberToRound){if(coercedNumberToRound<0){return-Math.floor(-coercedNumberToRound)}else{return Math.floor(coercedNumberToRound)}}))}},{key:"even",value:function even(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedNumberToRound){if(coercedNumberToRound<0){return-findNextEvenNumber(-coercedNumberToRound)}else{return findNextEvenNumber(coercedNumberToRound)}}))}},{key:"odd",value:function odd(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(coercedNumberToRound){if(coercedNumberToRound<0){return-findNextOddNumber(-coercedNumberToRound)}else{return findNextOddNumber(coercedNumberToRound)}}))}},{key:"ceiling",value:function ceiling(ast,formulaAddress){if(ast.args.length<1||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.getNumericArgument(ast,formulaAddress,0);if(value instanceof _Cell.CellError){return value}var significance=1;if(ast.args.length>=2){significance=this.getNumericArgument(ast,formulaAddress,1);if(significance instanceof _Cell.CellError){return significance}}var mode=0;if(ast.args.length===3){mode=this.getNumericArgument(ast,formulaAddress,2);if(mode instanceof _Cell.CellError){return mode}}if(significance===0||value===0){return 0}if(value>0!=significance>0&&ast.args.length>1){return new _Cell.CellError(_Cell.ErrorType.NUM)}if(mode===0){significance=Math.abs(significance)}return Math.ceil(value/significance)*significance}},{key:"commonArgumentsHandling2",value:function commonArgumentsHandling2(ast,formulaAddress,roundingFunction){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var numberToRound=this.evaluateAst(ast.args[0],formulaAddress);if(numberToRound instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedPlaces;if(ast.args[1]){var places=this.evaluateAst(ast.args[1],formulaAddress);if(places instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}coercedPlaces=this.coerceScalarToNumberOrError(places)}else{coercedPlaces=0}var coercedNumberToRound=this.coerceScalarToNumberOrError(numberToRound);if(coercedNumberToRound instanceof _Cell.CellError){return coercedNumberToRound}else if(coercedPlaces instanceof _Cell.CellError){return coercedPlaces}else{return roundingFunction(coercedNumberToRound,coercedPlaces)}}}]);return RoundingPlugin}(_FunctionPlugin2.FunctionPlugin);exports.RoundingPlugin=RoundingPlugin;RoundingPlugin.implementedFunctions={ROUNDUP:{method:"roundup"},ROUNDDOWN:{method:"rounddown"},ROUND:{method:"round"},TRUNC:{method:"trunc"},INT:{method:"intFunc"},EVEN:{method:"even"},ODD:{method:"odd"},CEILING:{method:"ceiling"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(142);__webpack_require__(144);__webpack_require__(96);__webpack_require__(98);__webpack_require__(100);__webpack_require__(104);exports.__esModule=true;exports.RadixConversionPlugin=void 0;var _Cell=__webpack_require__(106);var _format=__webpack_require__(249);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var NUMBER_OF_BITS=10;var DECIMAL_NUMBER_OF_BITS=255;var MIN_BASE=2;var MAX_BASE=36;var ALPHABET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";var RadixConversionPlugin=function(_FunctionPlugin){_inherits(RadixConversionPlugin,_FunctionPlugin);var _super=_createSuper(RadixConversionPlugin);function RadixConversionPlugin(){_classCallCheck(this,RadixConversionPlugin);return _super.apply(this,arguments)}_createClass(RadixConversionPlugin,[{key:"dec2bin",value:function dec2bin(ast,formulaAddress){return this.dec2base(ast,formulaAddress,2)}},{key:"dec2oct",value:function dec2oct(ast,formulaAddress){return this.dec2base(ast,formulaAddress,8)}},{key:"dec2hex",value:function dec2hex(ast,formulaAddress){return this.dec2base(ast,formulaAddress,16)}},{key:"bin2dec",value:function bin2dec(ast,formulaAddress){if(ast.args.length!==1){return new _Cell.CellError(_Cell.ErrorType.NA)}var binaryWithSign=this.getFirstArgumentAsNumberInBase(ast,formulaAddress,2,NUMBER_OF_BITS);if(binaryWithSign instanceof _Cell.CellError){return binaryWithSign}return twoComplementToDecimal(binaryWithSign)}},{key:"bin2oct",value:function bin2oct(ast,formulaAddress){return this.bin2base(ast,formulaAddress,8)}},{key:"bin2hex",value:function bin2hex(ast,formulaAddress){return this.bin2base(ast,formulaAddress,16)}},{key:"base",value:function base(ast,formulaAddress){if(ast.args.length<2||ast.args.length>3){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=this.getNumericArgument(ast,formulaAddress,0);if(value instanceof _Cell.CellError){return value}var base=this.getNumericArgument(ast,formulaAddress,1,MIN_BASE,MAX_BASE);if(base instanceof _Cell.CellError){return base}var padding;if(ast.args.length===3){padding=this.getNumericArgument(ast,formulaAddress,2,0,DECIMAL_NUMBER_OF_BITS);if(padding instanceof _Cell.CellError){return padding}}if(value<0){return new _Cell.CellError(_Cell.ErrorType.NUM)}return decimalToBaseWithMinimumPadding(value,base,padding)}},{key:"decimal",value:function decimal(ast,formulaAddress){if(ast.args.length!==2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var base=this.getNumericArgument(ast,formulaAddress,1,MIN_BASE,MAX_BASE);if(base instanceof _Cell.CellError){return base}var input=this.getFirstArgumentAsNumberInBase(ast,formulaAddress,base,DECIMAL_NUMBER_OF_BITS);if(input instanceof _Cell.CellError){return input}return parseInt(input,base)}},{key:"bin2base",value:function bin2base(ast,formulaAddress,base){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var binaryWithSign=this.getFirstArgumentAsNumberInBase(ast,formulaAddress,2,NUMBER_OF_BITS);if(binaryWithSign instanceof _Cell.CellError){return binaryWithSign}var places;if(ast.args.length===2){places=this.getNumericArgument(ast,formulaAddress,1,1,10);if(places instanceof _Cell.CellError){return places}}var decimal=twoComplementToDecimal(binaryWithSign);return decimalToBaseWithExactPadding(decimal,base,places)}},{key:"dec2base",value:function dec2base(ast,formulaAddress,base){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var places;if(ast.args.length===2){places=this.getNumericArgument(ast,formulaAddress,1,1,10);if(places instanceof _Cell.CellError){return places}}var min=-Math.pow(base,NUMBER_OF_BITS)/2;var max=-min-1;var value=this.getNumericArgument(ast,formulaAddress,0,min,max);if(value instanceof _Cell.CellError){return value}return decimalToBaseWithExactPadding(value,base,places)}},{key:"getFirstArgumentAsNumberInBase",value:function getFirstArgumentAsNumberInBase(ast,formulaAddress,base,maxLength){var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var value=(0,_ArithmeticHelper.coerceScalarToString)(arg);if(typeof value==="string"){var baseAlphabet=ALPHABET.substr(0,base);var regex=new RegExp("^[".concat(baseAlphabet,"]+$"));if(value.length>maxLength||!regex.test(value)){return new _Cell.CellError(_Cell.ErrorType.NUM)}}return value}}]);return RadixConversionPlugin}(_FunctionPlugin2.FunctionPlugin);exports.RadixConversionPlugin=RadixConversionPlugin;RadixConversionPlugin.implementedFunctions={DEC2BIN:{method:"dec2bin"},DEC2OCT:{method:"dec2oct"},DEC2HEX:{method:"dec2hex"},BIN2DEC:{method:"bin2dec"},BIN2OCT:{method:"bin2oct"},BIN2HEX:{method:"bin2hex"},DECIMAL:{method:"decimal"},BASE:{method:"base"}};function decimalToBaseWithExactPadding(value,base,places){var result=decimalToRadixComplement(value,base);if(places===undefined||value<0){return result}else if(result.length>places){return new _Cell.CellError(_Cell.ErrorType.NUM)}else{return(0,_format.padLeft)(result,places)}}function decimalToBaseWithMinimumPadding(value,base,places){var result=decimalToRadixComplement(value,base);if(places!==undefined&&places>result.length){return(0,_format.padLeft)(result,places)}else{return result}}function decimalToRadixComplement(value,base){var offset=value<0?Math.pow(base,NUMBER_OF_BITS):0;return(value+offset).toString(base).toUpperCase()}function twoComplementToDecimal(value){var offset=value.length==NUMBER_OF_BITS&&value.startsWith("1")?Math.pow(2,NUMBER_OF_BITS):0;return parseInt(value,2)-offset}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(210);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.LogarithmPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _InterpreterValue=__webpack_require__(203);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var LogarithmPlugin=function(_FunctionPlugin){_inherits(LogarithmPlugin,_FunctionPlugin);var _super=_createSuper(LogarithmPlugin);function LogarithmPlugin(){_classCallCheck(this,LogarithmPlugin);return _super.apply(this,arguments)}_createClass(LogarithmPlugin,[{key:"log10",value:function log10(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){if(arg>0){return Math.log10(arg)}else{return new _Cell.CellError(_Cell.ErrorType.NUM)}}))}},{key:"log",value:function log(ast,formulaAddress){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var arg=this.evaluateAst(ast.args[0],formulaAddress);if(arg instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}var coercedLogarithmicBase;if(ast.args[1]){var logarithmicBase=this.evaluateAst(ast.args[1],formulaAddress);if(logarithmicBase instanceof _InterpreterValue.SimpleRangeValue){return new _Cell.CellError(_Cell.ErrorType.VALUE)}coercedLogarithmicBase=this.coerceScalarToNumberOrError(logarithmicBase)}else{coercedLogarithmicBase=10}var coercedArg=this.coerceScalarToNumberOrError(arg);if(coercedArg instanceof _Cell.CellError){return coercedArg}else if(coercedLogarithmicBase instanceof _Cell.CellError){return coercedLogarithmicBase}else{if(coercedArg>0&&coercedLogarithmicBase>0){return Math.log(coercedArg)/Math.log(coercedLogarithmicBase)}else{return new _Cell.CellError(_Cell.ErrorType.NUM)}}}},{key:"ln",value:function ln(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){if(arg>0){return Math.log(arg)}else{return new _Cell.CellError(_Cell.ErrorType.NUM)}}))}}]);return LogarithmPlugin}(_FunctionPlugin2.FunctionPlugin);exports.LogarithmPlugin=LogarithmPlugin;LogarithmPlugin.implementedFunctions={LOG10:{method:"log10"},LOG:{method:"log"},LN:{method:"ln"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(133);__webpack_require__(166);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.BitwiseLogicOperationsPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var BitwiseLogicOperationsPlugin=function(_FunctionPlugin){_inherits(BitwiseLogicOperationsPlugin,_FunctionPlugin);var _super=_createSuper(BitwiseLogicOperationsPlugin);function BitwiseLogicOperationsPlugin(){_classCallCheck(this,BitwiseLogicOperationsPlugin);return _super.apply(this,arguments)}_createClass(BitwiseLogicOperationsPlugin,[{key:"bitand",value:function bitand(ast,formulaAddress){return this.templateWithTwoPositiveIntegerArguments(ast,formulaAddress,(function(left,right){return left&right}))}},{key:"bitor",value:function bitor(ast,formulaAddress){return this.templateWithTwoPositiveIntegerArguments(ast,formulaAddress,(function(left,right){return left|right}))}},{key:"bitxor",value:function bitxor(ast,formulaAddress){return this.templateWithTwoPositiveIntegerArguments(ast,formulaAddress,(function(left,right){return left^right}))}},{key:"templateWithTwoPositiveIntegerArguments",value:function templateWithTwoPositiveIntegerArguments(ast,formulaAddress,fn){var validationResult=this.validateTwoNumericArguments(ast,formulaAddress);if(validationResult instanceof _Cell.CellError){return validationResult}var _validationResult=_slicedToArray(validationResult,2),coercedLeft=_validationResult[0],coercedRight=_validationResult[1];if(coercedLeft<0||coercedRight<0||!Number.isInteger(coercedLeft)||!Number.isInteger(coercedRight)){return new _Cell.CellError(_Cell.ErrorType.NUM)}return fn(coercedLeft,coercedRight)}}]);return BitwiseLogicOperationsPlugin}(_FunctionPlugin2.FunctionPlugin);exports.BitwiseLogicOperationsPlugin=BitwiseLogicOperationsPlugin;BitwiseLogicOperationsPlugin.implementedFunctions={BITAND:{method:"bitand"},BITOR:{method:"bitor"},BITXOR:{method:"bitxor"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(133);__webpack_require__(166);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.BitShiftPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var MAX_48BIT_INTEGER=0xffffffffffff;var SHIFT_MIN_POSITIONS=-53;var SHIFT_MAX_POSITIONS=53;var BitShiftPlugin=function(_FunctionPlugin){_inherits(BitShiftPlugin,_FunctionPlugin);var _super=_createSuper(BitShiftPlugin);function BitShiftPlugin(){_classCallCheck(this,BitShiftPlugin);return _super.apply(this,arguments)}_createClass(BitShiftPlugin,[{key:"bitlshift",value:function bitlshift(ast,formulaAddress){return this.bitshiftTemplate(ast,formulaAddress,shiftLeft)}},{key:"bitrshift",value:function bitrshift(ast,formulaAddress){return this.bitshiftTemplate(ast,formulaAddress,shiftRight)}},{key:"bitshiftTemplate",value:function bitshiftTemplate(ast,formulaAddress,fn){var validationResult=this.validateTwoNumericArguments(ast,formulaAddress);if(validationResult instanceof _Cell.CellError){return validationResult}var _validationResult=_slicedToArray(validationResult,2),coercedValue=_validationResult[0],coercedPositions=_validationResult[1];if(coercedValue<0||!Number.isInteger(coercedValue)||!Number.isInteger(coercedPositions)){return new _Cell.CellError(_Cell.ErrorType.NUM)}if(coercedPositions<SHIFT_MIN_POSITIONS||coercedPositions>SHIFT_MAX_POSITIONS){return new _Cell.CellError(_Cell.ErrorType.NUM)}var result=fn(coercedValue,coercedPositions);if(result>MAX_48BIT_INTEGER){return new _Cell.CellError(_Cell.ErrorType.NUM)}else{return result}}}]);return BitShiftPlugin}(_FunctionPlugin2.FunctionPlugin);exports.BitShiftPlugin=BitShiftPlugin;BitShiftPlugin.implementedFunctions={BITLSHIFT:{method:"bitlshift"},BITRSHIFT:{method:"bitrshift"}};function shiftLeft(value,positions){if(positions<0){return shiftRight(value,-positions)}else{return value*Math.pow(2,positions)}}function shiftRight(value,positions){if(positions<0){return shiftLeft(value,-positions)}else{return Math.floor(value/Math.pow(2,positions))}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(133);__webpack_require__(136);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.PowerPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var PowerPlugin=function(_FunctionPlugin){_inherits(PowerPlugin,_FunctionPlugin);var _super=_createSuper(PowerPlugin);function PowerPlugin(){_classCallCheck(this,PowerPlugin);return _super.apply(this,arguments)}_createClass(PowerPlugin,[{key:"power",value:function power(ast,formulaAddress){var validationResult=this.validateTwoNumericArguments(ast,formulaAddress);if(validationResult instanceof _Cell.CellError){return validationResult}var _validationResult=_slicedToArray(validationResult,2),coercedBase=_validationResult[0],coercedExponent=_validationResult[1];if(coercedBase===0&&coercedExponent<0){return new _Cell.CellError(_Cell.ErrorType.NUM)}var value=Math.pow(coercedBase,coercedExponent);if(!Number.isFinite(value)){return new _Cell.CellError(_Cell.ErrorType.NUM)}else{return value}}}]);return PowerPlugin}(_FunctionPlugin2.FunctionPlugin);exports.PowerPlugin=PowerPlugin;PowerPlugin.implementedFunctions={POWER:{method:"power"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(250);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.MathConstantsPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var PI=parseFloat(Math.PI.toFixed(14));var E=parseFloat(Math.E.toFixed(14));var MathConstantsPlugin=function(_FunctionPlugin){_inherits(MathConstantsPlugin,_FunctionPlugin);var _super=_createSuper(MathConstantsPlugin);function MathConstantsPlugin(){_classCallCheck(this,MathConstantsPlugin);return _super.apply(this,arguments)}_createClass(MathConstantsPlugin,[{key:"pi",value:function pi(ast,formulaAddress){if(ast.args.length>0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}return PI}},{key:"e",value:function e(ast,formulaAddress){if(ast.args.length>0){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}return E}}]);return MathConstantsPlugin}(_FunctionPlugin2.FunctionPlugin);exports.MathConstantsPlugin=MathConstantsPlugin;MathConstantsPlugin.implementedFunctions={PI:{method:"pi"},E:{method:"e"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.SqrtPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var SqrtPlugin=function(_FunctionPlugin){_inherits(SqrtPlugin,_FunctionPlugin);var _super=_createSuper(SqrtPlugin);function SqrtPlugin(){_classCallCheck(this,SqrtPlugin);return _super.apply(this,arguments)}_createClass(SqrtPlugin,[{key:"sqrt",value:function sqrt(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(input){if(input<0){return new _Cell.CellError(_Cell.ErrorType.NUM)}else{return Math.sqrt(input)}}))}}]);return SqrtPlugin}(_FunctionPlugin2.FunctionPlugin);exports.SqrtPlugin=SqrtPlugin;SqrtPlugin.implementedFunctions={SQRT:{method:"sqrt"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(65);__webpack_require__(75);__webpack_require__(84);__webpack_require__(89);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.ModuloPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var ModuloPlugin=function(_FunctionPlugin){_inherits(ModuloPlugin,_FunctionPlugin);var _super=_createSuper(ModuloPlugin);function ModuloPlugin(){_classCallCheck(this,ModuloPlugin);return _super.apply(this,arguments)}_createClass(ModuloPlugin,[{key:"mod",value:function mod(ast,formulaAddress){var validationResult=this.validateTwoNumericArguments(ast,formulaAddress);if(validationResult instanceof _Cell.CellError){return validationResult}var _validationResult=_slicedToArray(validationResult,2),dividend=_validationResult[0],divisor=_validationResult[1];if(divisor===0){return new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}return dividend%divisor}}]);return ModuloPlugin}(_FunctionPlugin2.FunctionPlugin);exports.ModuloPlugin=ModuloPlugin;ModuloPlugin.implementedFunctions={MOD:{method:"mod"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.DeltaPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var DeltaPlugin=function(_FunctionPlugin){_inherits(DeltaPlugin,_FunctionPlugin);var _super=_createSuper(DeltaPlugin);function DeltaPlugin(){_classCallCheck(this,DeltaPlugin);return _super.apply(this,arguments)}_createClass(DeltaPlugin,[{key:"delta",value:function delta(ast,formulaAddress){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var left=this.getNumericArgument(ast,formulaAddress,0);if(left instanceof _Cell.CellError){return left}var right=0;if(ast.args.length===2){right=this.getNumericArgument(ast,formulaAddress,1);if(right instanceof _Cell.CellError){return right}}return left===right?1:0}}]);return DeltaPlugin}(_FunctionPlugin2.FunctionPlugin);exports.DeltaPlugin=DeltaPlugin;DeltaPlugin.implementedFunctions={DELTA:{method:"delta"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.CharPlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var CharPlugin=function(_FunctionPlugin){_inherits(CharPlugin,_FunctionPlugin);var _super=_createSuper(CharPlugin);function CharPlugin(){_classCallCheck(this,CharPlugin);return _super.apply(this,arguments)}_createClass(CharPlugin,[{key:"char",value:function char(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(value){if(value<1||value>255){return new _Cell.CellError(_Cell.ErrorType.NUM)}return String.fromCharCode(value)}))}}]);return CharPlugin}(_FunctionPlugin2.FunctionPlugin);exports.CharPlugin=CharPlugin;CharPlugin.implementedFunctions={CHAR:{method:"char"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.CodePlugin=void 0;var _Cell=__webpack_require__(106);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var CodePlugin=function(_FunctionPlugin){_inherits(CodePlugin,_FunctionPlugin);var _super=_createSuper(CodePlugin);function CodePlugin(){_classCallCheck(this,CodePlugin);return _super.apply(this,arguments)}_createClass(CodePlugin,[{key:"code",value:function code(ast,formulaAddress){return this.templateWithOneCoercedToStringArgument(ast,formulaAddress,(function(value){if(value.length===0){return new _Cell.CellError(_Cell.ErrorType.VALUE)}return value.charCodeAt(0)}))}}]);return CodePlugin}(_FunctionPlugin2.FunctionPlugin);exports.CodePlugin=CodePlugin;CodePlugin.implementedFunctions={CODE:{method:"code"}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(140);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.ErrorFunctionPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var ErrorFunctionPlugin=function(_FunctionPlugin){_inherits(ErrorFunctionPlugin,_FunctionPlugin);var _super=_createSuper(ErrorFunctionPlugin);function ErrorFunctionPlugin(){_classCallCheck(this,ErrorFunctionPlugin);return _super.apply(this,arguments)}_createClass(ErrorFunctionPlugin,[{key:"erf",value:function erf(ast,formulaAddress){if(ast.args.length<1||ast.args.length>2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var lowerBound=this.getNumericArgument(ast,formulaAddress,0);if(lowerBound instanceof _Cell.CellError){return lowerBound}if(ast.args.length===2){var upperBound=this.getNumericArgument(ast,formulaAddress,1);if(upperBound instanceof _Cell.CellError){return upperBound}return erf2(lowerBound,upperBound)}return _erf(lowerBound)}},{key:"erfc",value:function erfc(ast,formulaAddress){return this.templateWithOneCoercedToNumberArgument(ast,formulaAddress,(function(arg){return _erfc(arg)}))}}]);return ErrorFunctionPlugin}(_FunctionPlugin2.FunctionPlugin);exports.ErrorFunctionPlugin=ErrorFunctionPlugin;ErrorFunctionPlugin.implementedFunctions={ERF:{method:"erf"},ERFC:{method:"erfc"}};function _erf(x){if(x>=0){return erfApprox(x)}else{return-erfApprox(-x)}}function erfApprox(x){var polyExponent=16;var coefficients=[.0705230784,.0422820123,.0092705272,.0001520143,.0002765672,430638e-10];var poly=coefficients.reduce((function(acc,coefficient,index){return acc+coefficient*Math.pow(x,index+1)}),1);return 1-1/Math.pow(poly,polyExponent)}function erf2(lowerBound,upperBound){return _erf(upperBound)-_erf(lowerBound)}function _erfc(x){return 1-_erf(x)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(1);__webpack_require__(63);__webpack_require__(64);__webpack_require__(75);__webpack_require__(163);__webpack_require__(91);__webpack_require__(92);__webpack_require__(94);__webpack_require__(96);__webpack_require__(98);__webpack_require__(104);exports.__esModule=true;exports.CorrelPlugin=void 0;var _Cell=__webpack_require__(106);var _parser=__webpack_require__(138);var _ArithmeticHelper=__webpack_require__(217);var _FunctionPlugin2=__webpack_require__(272);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var CorrelPlugin=function(_FunctionPlugin){_inherits(CorrelPlugin,_FunctionPlugin);var _super=_createSuper(CorrelPlugin);function CorrelPlugin(){_classCallCheck(this,CorrelPlugin);return _super.apply(this,arguments)}_createClass(CorrelPlugin,[{key:"correl",value:function correl(ast,formulaAddress){if(ast.args.length!=2){return new _Cell.CellError(_Cell.ErrorType.NA)}if(ast.args.some((function(ast){return ast.type===_parser.AstNodeType.EMPTY}))){return new _Cell.CellError(_Cell.ErrorType.NUM)}var dataX=(0,_ArithmeticHelper.coerceToRange)(this.evaluateAst(ast.args[0],formulaAddress));var dataY=(0,_ArithmeticHelper.coerceToRange)(this.evaluateAst(ast.args[1],formulaAddress));if(dataX.numberOfElements()!==dataY.numberOfElements()){return new _Cell.CellError(_Cell.ErrorType.NA)}if(dataX.numberOfElements()<=1){return new _Cell.CellError(_Cell.ErrorType.DIV_BY_ZERO)}return this.computePearson(dataX,dataY)}},{key:"computePearson",value:function computePearson(dataX,dataY){var xit=dataX.valuesFromTopLeftCorner();var yit=dataY.valuesFromTopLeftCorner();var x,y;var count=0;var sumX=0;var sumY=0;var sumXsquares=0;var sumYsquares=0;var sumOfProducts=0;while(x=xit.next(),y=yit.next(),!x.done&&!y.done){var xval=x.value;var yval=y.value;if(xval instanceof _Cell.CellError){return xval}else if(yval instanceof _Cell.CellError){return yval}else if(typeof xval==="number"&&typeof yval==="number"){count++;sumX+=xval;sumY+=yval;sumXsquares+=xval*xval;sumYsquares+=yval*yval;sumOfProducts+=xval*yval}}return(count*sumOfProducts-sumX*sumY)/(Math.sqrt(count*sumXsquares-sumX*sumX)*Math.sqrt(count*sumYsquares-sumY*sumY))}}]);return CorrelPlugin}(_FunctionPlugin2.FunctionPlugin);exports.CorrelPlugin=CorrelPlugin;CorrelPlugin.implementedFunctions={CORREL:{method:"correl"}}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _FunctionPlugin=__webpack_require__(272);exports.FunctionPlugin=_FunctionPlugin.FunctionPlugin}])["default"]}));