/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/BuildEngineFactory.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}import{LazilyTransformingAstService}from"./LazilyTransformingAstService";import{CellContentParser}from"./CellContentParser";import{Exporter}from"./CellValue";import{buildColumnSearchStrategy}from"./ColumnSearch/ColumnSearchStrategy";import{Config}from"./Config";import{DateTimeHelper}from"./DateTimeHelper";import{CrudOperations}from"./CrudOperations";import{DependencyGraph}from"./DependencyGraph";import{Evaluator}from"./Evaluator";import{GraphBuilder}from"./GraphBuilder";import{UIElement}from"./i18n";import{NamedExpressions}from"./NamedExpressions";import{NumberLiteralHelper}from"./NumberLiteralHelper";import{buildLexerConfig,ParserWithCaching,Unparser}from"./parser";import{Serialization}from"./Serialization";import{EmptyStatistics,Statistics,StatType}from"./statistics";import{SheetSizeLimitExceededError}from"./errors";import{findBoundaries,validateAsSheet}from"./Sheet";import{FunctionRegistry}from"./interpreter/FunctionRegistry";export var BuildEngineFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"buildEngine",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.useStats?new Statistics:new EmptyStatistics;t.start(StatType.BUILD_ENGINE_TOTAL);var i=new NamedExpressions,n=new FunctionRegistry(e),a=new LazilyTransformingAstService(t),o=DependencyGraph.buildEmpty(a,e,n,i,t),l=buildColumnSearchStrategy(o,e,t),s=o.sheetMapping,u=o.addressMapping;for(var p in r)if(Object.prototype.hasOwnProperty.call(r,p)){var m=r[p];validateAsSheet(m);var f=findBoundaries(m);if(f.height>e.maxRows||f.width>e.maxColumns)throw new SheetSizeLimitExceededError;var d=s.addSheet(p);u.autoAddSheet(d,m,f)}var c=new ParserWithCaching(e,n,s.get),h=new Unparser(e,buildLexerConfig(e),s.fetchDisplayName,i),g=new DateTimeHelper(e),y=new NumberLiteralHelper(e),S=new CellContentParser(e,g,y),E=new CrudOperations(e,t,o,l,c,S,a,i);t.measure(StatType.GRAPH_BUILD,function(){new GraphBuilder(o,l,c,S,e,t).buildGraph(r)}),a.undoRedo=E.undoRedo,a.parser=c;var v=new Evaluator(o,l,e,t,g,y,n,i);v.run();var C=new Exporter(e,i),b=new Serialization(o,h,e,C);return t.end(StatType.BUILD_ENGINE_TOTAL),{config:e,stats:t,dependencyGraph:o,columnSearch:l,parser:c,unparser:h,cellContentParser:S,evaluator:v,lazilyTransformingAstService:a,crudOperations:E,exporter:C,namedExpressions:i,serialization:b,functionRegistry:n}}},{key:"buildFromSheets",value:function(e,r){var t=new Config(r);return this.buildEngine(t,e)}},{key:"buildFromSheet",value:function(e,r){var t=new Config(r),i=t.translationPackage.getUITranslation(UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(t,_defineProperty({},i,e))}},{key:"buildEmpty",value:function(e){return this.buildEngine(new Config(e))}},{key:"rebuildWithConfig",value:function(e,r,t){return this.buildEngine(e,r,t)}}]),e}();
//# sourceMappingURL=/sm/be2ffa6abc04eb6b7b24403ab3a01c2c35953a843b128eec3520bc35fae93c3d.map