/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/interpreter/plugin/DatePlugin.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"core-js/modules/es.symbol";import"core-js/modules/es.symbol.description";import"core-js/modules/es.symbol.iterator";import"core-js/modules/es.array.iterator";import"core-js/modules/es.array.some";import"core-js/modules/es.math.trunc";import"core-js/modules/es.object.get-prototype-of";import"core-js/modules/es.object.to-string";import"core-js/modules/es.reflect.construct";import"core-js/modules/es.regexp.to-string";import"core-js/modules/es.string.iterator";import"core-js/modules/web.dom-collections.iterator";function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),r}function _inherits(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&_setPrototypeOf(r,e)}function _setPrototypeOf(r,e){return(_setPrototypeOf=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(r,e)}function _createSuper(r){var e=_isNativeReflectConstruct();return function(){var t,o=_getPrototypeOf(r);if(e){var n=_getPrototypeOf(this).constructor;t=Reflect.construct(o,arguments,n)}else t=o.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(r,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(r):e}function _assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}function _getPrototypeOf(r){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}import{CellError,ErrorType}from"../../Cell";import{endOfMonth,offsetMonth}from"../../DateTimeHelper";import{format}from"../../format/format";import{AstNodeType}from"../../parser";import{SimpleRangeValue}from"../InterpreterValue";import{FunctionPlugin}from"./FunctionPlugin";export var DatePlugin=function(r){_inherits(t,FunctionPlugin);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"date",value:function(r,e){if(3!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e),o=this.evaluateAst(r.args[1],e),n=this.evaluateAst(r.args[2],e);if(t instanceof SimpleRangeValue||o instanceof SimpleRangeValue||n instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var a=this.coerceScalarToNumberOrError(t),i=this.coerceScalarToNumberOrError(o),l=this.coerceScalarToNumberOrError(n);if(a instanceof CellError)return a;if(i instanceof CellError)return i;if(l instanceof CellError)return l;var s=Math.trunc(l),u=Math.trunc(i),c=Math.trunc(a);c<this.interpreter.dateHelper.getEpochYearZero()&&(c+=this.interpreter.dateHelper.getEpochYearZero());var f=Math.floor((u-1)/12),p={year:c+=f,month:u-=12*f,day:1};if(this.interpreter.dateHelper.isValidDate(p)){var m=this.interpreter.dateHelper.dateToNumber(p)+(s-1);if(this.interpreter.dateHelper.getWithinBounds(m))return m}return new CellError(ErrorType.VALUE)}},{key:"eomonth",value:function(r,e){if(2!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var o=this.coerceScalarToNumberOrError(t);if(o instanceof CellError)return o;var n=this.evaluateAst(r.args[1],e);if(n instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var a=this.coerceScalarToNumberOrError(n);if(a instanceof CellError)return a;var i=this.interpreter.dateHelper.numberToSimpleDate(o);return this.interpreter.dateHelper.dateToNumber(endOfMonth(offsetMonth(i,a)))}},{key:"day",value:function(r,e){if(1!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var o=this.coerceScalarToNumberOrError(t);return o instanceof CellError?o:this.interpreter.dateHelper.numberToSimpleDate(o).day}},{key:"days",value:function(r,e){if(2!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var o=this.coerceScalarToNumberOrError(t);if(o instanceof CellError)return o;var n=this.evaluateAst(r.args[1],e);if(n instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var a=this.coerceScalarToNumberOrError(n);return a instanceof CellError?a:o-a}},{key:"month",value:function(r,e){if(1!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var o=this.coerceScalarToNumberOrError(t);return o instanceof CellError?o:this.interpreter.dateHelper.numberToSimpleDate(o).month}},{key:"year",value:function(r,e){if(1!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var o=this.coerceScalarToNumberOrError(t);return o instanceof CellError?o:this.interpreter.dateHelper.numberToSimpleDate(o).year}},{key:"text",value:function(r,e){if(2!==r.args.length)return new CellError(ErrorType.NA);if(r.args.some(function(r){return r.type===AstNodeType.EMPTY}))return new CellError(ErrorType.NUM);var t=this.evaluateAst(r.args[0],e),o=this.evaluateAst(r.args[1],e);if(t instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);var n=this.coerceScalarToNumberOrError(t);return n instanceof CellError?n:"string"!=typeof o?new CellError(ErrorType.VALUE):format(n,o,this.config,this.interpreter.dateHelper)}}]),t}();DatePlugin.implementedFunctions={DATE:{method:"date"},MONTH:{method:"month"},YEAR:{method:"year"},TEXT:{method:"text"},EOMONTH:{method:"eomonth"},DAY:{method:"day"},DAYS:{method:"days"}};
//# sourceMappingURL=/sm/5a12ee3f55748b77ad663c38916386ee41fa371740f08214c4252b350f9a37c2.map