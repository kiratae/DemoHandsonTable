/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/interpreter/ArithmeticHelper.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"core-js/modules/es.array.includes";import"core-js/modules/es.number.constructor";import"core-js/modules/es.object.to-string";import"core-js/modules/es.regexp.constructor";import"core-js/modules/es.regexp.exec";import"core-js/modules/es.regexp.to-string";import"core-js/modules/es.string.replace";import"core-js/modules/es.string.trim";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}import{CellError,CellValueTypeOrd,EmptyValue,ErrorType,getCellValueType}from"../Cell";import{collatorFromConfig}from"../StringHelper";import{SimpleRangeValue}from"./InterpreterValue";export var ArithmeticHelper=function(){function e(r,t,n){var o=this;_classCallCheck(this,e),this.config=r,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.nonstrictadd=function(e,r){return e instanceof CellError?e:r instanceof CellError?r:"number"==typeof e?"number"==typeof r?o.addWithEpsilon(e,r):e:"number"==typeof r?r:0},this.collator=collatorFromConfig(r),this.actualEps=r.smartRounding?r.precisionEpsilon:0}return _createClass(e,[{key:"eqMatcherFunction",value:function(e){var r=this,t=this.buildRegex(e);return function(e){return"string"==typeof e&&t.test(r.normalizeString(e))}}},{key:"neqMatcherFunction",value:function(e){var r=this,t=this.buildRegex(e);return function(e){return"string"!=typeof e||!t.test(r.normalizeString(e))}}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var r=0;r<e.length;r++){var t=e.charAt(r);if(isWildcard(t)||this.config.useRegularExpressions&&needsEscape(t))return!0}return!1}},{key:"buildRegex",value:function(e){var r;e=this.normalizeString(e);var t=this.config.useWildcards,n=this.config.useRegularExpressions;if(n)try{RegExp(e)}catch(e){n=!1,t=!1}return r=n?escapeNoCharacters(e,this.config.caseSensitive):t?escapeNonWildcards(e,this.config.caseSensitive):escapeAllCharacters(e,this.config.caseSensitive),this.config.matchWholeCell?RegExp("^("+r+")$"):RegExp(r)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,r){if("string"==typeof e||"string"==typeof r){var t="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"==typeof r?this.dateTimeHelper.dateStringToDateNumber(r):r;if("number"==typeof t&&"number"==typeof n)return this.floatCmp(t,n)}return e===EmptyValue?e=coerceEmptyToValue(r):r===EmptyValue&&(r=coerceEmptyToValue(e)),"string"==typeof e&&"string"==typeof r?this.stringCmp(e,r):"boolean"==typeof e&&"boolean"==typeof r?numberCmp(coerceBooleanToNumber(e),coerceBooleanToNumber(r)):"number"==typeof e&&"number"==typeof r?this.floatCmp(e,r):e===EmptyValue&&r===EmptyValue?0:numberCmp(CellValueTypeOrd(getCellValueType(e)),CellValueTypeOrd(getCellValueType(r)))}},{key:"floatCmp",value:function(e,r){var t=1+this.actualEps;return r>=0&&e*t>=r&&e<=r*t?0:r<=0&&e*t<=r&&e>=r*t?0:e>r?1:-1}},{key:"stringCmp",value:function(e,r){return this.collator.compare(e,r)}},{key:"add",value:function(e,r){return e instanceof CellError?e:r instanceof CellError?r:this.addWithEpsilon(e,r)}},{key:"addWithEpsilon",value:function(e,r){var t=e+r;return Math.abs(t)<this.actualEps*Math.abs(e)?0:t}},{key:"subtract",value:function(e,r){if(e instanceof CellError)return e;if(r instanceof CellError)return r;var t=e-r;return Math.abs(t)<this.actualEps*Math.abs(e)?0:t}},{key:"coerceScalarToNumberOrError",value:function(e){var r;return e instanceof CellError?e:null!==(r=this.coerceToMaybeNumber(e))&&void 0!==r?r:new CellError(ErrorType.VALUE)}},{key:"coerceToMaybeNumber",value:function(e){var r;return null!==(r=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==r?r:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){if(e===EmptyValue)return 0;if("string"==typeof e&&this.numberLiteralsHelper.isNumber(e))return this.numberLiteralsHelper.numericStringToNumber(e);if(!("string"==typeof e&&e.length>0&&""===e.trim())){var r=Number(e);return isNaN(r)?void 0:r}}}]),e}();export function coerceToRange(e){return e instanceof SimpleRangeValue?e:SimpleRangeValue.fromScalar(e)}export function coerceToRangeNumbersOrError(e){return e instanceof SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof CellError?e:"number"==typeof e?SimpleRangeValue.fromScalar(e):null}export function coerceBooleanToNumber(e){return Number(e)}export function coerceEmptyToValue(e){return"string"==typeof e?"":"number"==typeof e?0:"boolean"!=typeof e&&EmptyValue}export function coerceScalarToBoolean(e){if(e instanceof SimpleRangeValue)return new CellError(ErrorType.VALUE);if(e instanceof CellError||"boolean"==typeof e)return e;if(e===EmptyValue)return!1;if("number"==typeof e)return 0!==e;var r=e.toUpperCase();return"TRUE"===r||"FALSE"!==r&&(""!==r&&null)}export function coerceScalarToString(e){return e instanceof CellError||"string"==typeof e?e:e===EmptyValue?"":"number"==typeof e?e.toString():e?"TRUE":"FALSE"}export function multiply(e,r){return e instanceof CellError?e:r instanceof CellError?r:e*r}export function power(e,r){return e instanceof CellError?e:r instanceof CellError?r:Math.pow(e,r)}export function divide(e,r){return e instanceof CellError?e:r instanceof CellError?r:0===r?new CellError(ErrorType.DIV_BY_ZERO):e/r}export function unaryminus(e){return e instanceof CellError?e:-e}export function percent(e){return e instanceof CellError?e:e/100}export function max(e,r){return e instanceof CellError?e:r instanceof CellError?r:"number"==typeof e?"number"==typeof r?Math.max(e,r):e:"number"==typeof r?r:Number.NEGATIVE_INFINITY}export function maxa(e,r){return e instanceof CellError?e:r instanceof CellError?r:("boolean"==typeof e&&(e=coerceBooleanToNumber(e)),"boolean"==typeof r&&(r=coerceBooleanToNumber(r)),"number"==typeof e?"number"==typeof r?Math.max(e,r):e:"number"==typeof r?r:Number.NEGATIVE_INFINITY)}export function min(e,r){return e instanceof CellError?e:r instanceof CellError?r:"number"==typeof e?"number"==typeof r?Math.min(e,r):e:"number"==typeof r?r:Number.POSITIVE_INFINITY}export function mina(e,r){return e instanceof CellError?e:r instanceof CellError?r:("boolean"==typeof e&&(e=coerceBooleanToNumber(e)),"boolean"==typeof r&&(r=coerceBooleanToNumber(r)),"number"==typeof e?"number"==typeof r?Math.min(e,r):e:"number"==typeof r?r:Number.POSITIVE_INFINITY)}export function numberCmp(e,r){return e>r?1:e<r?-1:0}export function isNumberOverflow(e){return isNaN(e)||e===1/0||e===-1/0}export function fixNegativeZero(e){return 0===e?0:e}function isWildcard(e){return["*","?"].includes(e)}var escapedCharacters=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function needsEscape(e){return escapedCharacters.includes(e)}function escapeNonWildcards(e,r){for(var t="",n=0;n<e.length;n++){var o=e.charAt(n);if("~"===o){if(n==e.length-1){t+="~";continue}var i=e.charAt(n+1);isWildcard(i)||needsEscape(i)?(t+="\\"+i,n++):(t+=i,n++)}else isWildcard(o)?t+="."+o:needsEscape(o)?t+="\\"+o:t+=r?o:o.toLowerCase()}return t}function escapeAllCharacters(e,r){for(var t="",n=0;n<e.length;n++){var o=e.charAt(n);isWildcard(o)||needsEscape(o)?t+="\\"+o:t+=r?o:o.toLowerCase()}return t}function escapeNoCharacters(e,r){for(var t="",n=0;n<e.length;n++){var o=e.charAt(n);isWildcard(o)||needsEscape(o)?t+=o:t+=r?o:o.toLowerCase()}return t}
//# sourceMappingURL=/sm/11277f308cfd24651882a1ce418c3930e5f0ef83fd01a01951988ff855a7454e.map