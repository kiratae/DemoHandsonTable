/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/ClipboardOperations.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"regenerator-runtime/runtime";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,r,i){return r&&_defineProperties(e.prototype,r),i&&_defineProperties(e,i),e}import{AbsoluteCellRange}from"./AbsoluteCellRange";import{invalidSimpleCellAddress,simpleCellAddress}from"./Cell";import{InvalidArgumentsError,SheetSizeLimitExceededError}from"./errors";var ClipboardOperationType;!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(ClipboardOperationType||(ClipboardOperationType={}));export var ClipboardCellType;!function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(ClipboardCellType||(ClipboardCellType={}));var Clipboard=function(){function e(r,i,t,a,o){_classCallCheck(this,e),this.sourceLeftCorner=r,this.width=i,this.height=t,this.type=a,this.content=o}return _createClass(e,[{key:"getContent",value:regeneratorRuntime.mark(function e(r){var i,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:i=0;case 5:if(!(i<this.height)){e.next=16;break}t=0;case 7:if(!(t<this.width)){e.next=13;break}return e.next=10,[simpleCellAddress(r.sheet,r.col+t,r.row+i),this.content[i][t]];case 10:++t,e.next=7;break;case 13:++i,e.next=5;break;case 16:case"end":return e.stop()}},e,this)})}]),e}();export var ClipboardOperations=function(){function e(r,i,t,a,o){_classCallCheck(this,e),this.dependencyGraph=r,this.operations=i,this.parser=t,this.lazilyTransformingAstService=a,this.config=o}return _createClass(e,[{key:"cut",value:function(e,r,i){this.clipboard=new Clipboard(e,r,i,ClipboardOperationType.CUT)}},{key:"copy",value:function(e,r,i){for(var t=[],a=0;a<i;++a){t[a]=[];for(var o=0;o<r;++o){var n=this.operations.getClipboardCell(simpleCellAddress(e.sheet,e.col+o,e.row+a));t[a].push(n)}}this.clipboard=new Clipboard(e,r,i,ClipboardOperationType.COPY,t)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if(invalidSimpleCellAddress(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new InvalidArgumentsError("a valid target address.");var r=AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(r))throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ClipboardOperationType.COPY}}]),e}();
//# sourceMappingURL=/sm/ba819247b6c01a137b2e286688399a1c371c57292126c833622659ac12f72df3.map