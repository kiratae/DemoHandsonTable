/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/DependencyGraph/MatrixVertex.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}import{AbsoluteCellRange}from"../AbsoluteCellRange";import{ErroredMatrix,Matrix,MatrixSize,NotComputedMatrix}from"../Matrix";import{ColumnsSpan,RowsSpan}from"../Span";export var MatrixVertex=function(){function e(t,r,i,s){_classCallCheck(this,e),this.cellAddress=t,this.formula=s||null,this.matrix=new NotComputedMatrix(new MatrixSize(r,i))}return _createClass(e,[{key:"setCellValue",value:function(e){this.matrix=e}},{key:"setErrorValue",value:function(e){this.matrix=new ErroredMatrix(e,this.matrix.size)}},{key:"getCellValue",value:function(){if(this.matrix instanceof NotComputedMatrix)throw Error("Matrix not computed yet.");return this.matrix}},{key:"getMatrixCellValue",value:function(e){var t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;return this.matrix.get(t,r)}},{key:"setMatrixCellValue",value:function(e,t){var r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.matrix instanceof Matrix&&this.matrix.set(r,i,t)}},{key:"getRange",value:function(){return AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getAddress",value:function(){return this.cellAddress}},{key:"setAddress",value:function(e){this.cellAddress=e}},{key:"getFormula",value:function(){return this.formula}},{key:"setFormula",value:function(e){this.formula=e}},{key:"isFormula",value:function(){return null!==this.formula}},{key:"isNumeric",value:function(){return null===this.formula}},{key:"spansThroughSheetRows",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}},{key:"addRows",value:function(e,t,r){this.matrix instanceof Matrix&&this.matrix.addRows(t-this.getAddress().row,r)}},{key:"addColumns",value:function(e,t,r){this.matrix instanceof Matrix&&this.matrix.addColumns(t-this.getAddress().col,r)}},{key:"removeRows",value:function(e){if(this.matrix instanceof Matrix){var t=this.rowsFromMatrix().intersect(e);this.matrix.removeRows(t.rowStart-this.getAddress().row,t.rowEnd-this.getAddress().row)}}},{key:"removeColumns",value:function(e){if(this.matrix instanceof Matrix){var t=this.columnsFromMatrix().intersect(e);this.matrix.removeColumns(t.columnStart-this.getAddress().col,t.columnEnd-this.getAddress().col)}}},{key:"isComputed",value:function(){return!(this.matrix instanceof NotComputedMatrix)}},{key:"columnsFromMatrix",value:function(){return ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromMatrix",value:function(){return RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"width",get:function(){return this.matrix.width()}},{key:"height",get:function(){return this.matrix.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}}],[{key:"fromRange",value:function(t,r){return new e(t.start,t.width(),t.height(),r)}}]),e}();
//# sourceMappingURL=/sm/6bd1d20d239a9cf1b467b15e3632c284419d70917a347796d3572254e17c5a04.map