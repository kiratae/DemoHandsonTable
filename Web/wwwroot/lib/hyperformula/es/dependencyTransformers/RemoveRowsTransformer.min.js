/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/dependencyTransformers/RemoveRowsTransformer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"core-js/modules/es.symbol";import"core-js/modules/es.symbol.description";import"core-js/modules/es.symbol.iterator";import"core-js/modules/es.array.iterator";import"core-js/modules/es.object.assign";import"core-js/modules/es.object.get-prototype-of";import"core-js/modules/es.object.to-string";import"core-js/modules/es.reflect.construct";import"core-js/modules/es.regexp.to-string";import"core-js/modules/es.string.iterator";import"core-js/modules/web.dom-collections.iterator";function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),r}function _inherits(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&_setPrototypeOf(r,e)}function _setPrototypeOf(r,e){return(_setPrototypeOf=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(r,e)}function _createSuper(r){var e=_isNativeReflectConstruct();return function(){var t,o=_getPrototypeOf(r);if(e){var s=_getPrototypeOf(this).constructor;t=Reflect.construct(o,arguments,s)}else t=o.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(r,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(r):e}function _assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}function _getPrototypeOf(r){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}import{absoluteSheetReference,ErrorType}from"../Cell";import{Transformer}from"./Transformer";export var RemoveRowsTransformer=function(r){_inherits(t,Transformer);var e=_createSuper(t);function t(r){var o;return _classCallCheck(this,t),(o=e.call(this)).rowsSpan=r,o}return _createClass(t,[{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(r,e){return r}},{key:"transformCellAddress",value:function(r,e){var t=absoluteSheetReference(r,e);if(this.rowsSpan.sheet!==e.sheet&&this.rowsSpan.sheet!==t)return!1;if(this.rowsSpan.sheet!==e.sheet&&this.rowsSpan.sheet===t){var o=r.toSimpleRowAddress(e);if(o.row<this.rowsSpan.rowStart)return!1;if(o.row>this.rowsSpan.rowEnd)return r.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===e.sheet&&this.rowsSpan.sheet!==t){if(r.isRowAbsolute())return!1;if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return r.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===e.sheet&&this.rowsSpan.sheet===t)if(r.isRowAbsolute()){if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return r.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var s=r.toSimpleRowAddress(e);if(s.row<this.rowsSpan.rowStart){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return r.shiftedByRows(this.rowsSpan.numberOfRows)}else if(s.row>this.rowsSpan.rowEnd){if(e.row<this.rowsSpan.rowStart)return r.shiftedByRows(-this.rowsSpan.numberOfRows);if(e.row>this.rowsSpan.rowEnd)return!1}}return ErrorType.REF}},{key:"transformCellRange",value:function(r,e,t){return this.transformRange(r,e,t)}},{key:"transformRowRange",value:function(r,e,t){return this.transformRange(r,e,t)}},{key:"transformColumnRange",value:function(r,e,t){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(r){return this.rowsSpan.sheet===r.sheet&&this.rowsSpan.rowStart<=r.row?Object.assign(Object.assign({},r),{row:r.row-this.rowsSpan.numberOfRows}):r}},{key:"transformRange",value:function(r,e,t){var o=absoluteSheetReference(r,t),s=r,n=e;if(this.rowsSpan.sheet===o){var i=r.toSimpleRowAddress(t),a=e.toSimpleRowAddress(t);if(this.rowsSpan.rowStart<=i.row&&this.rowsSpan.rowEnd>=a.row)return ErrorType.REF;i.row>=this.rowsSpan.rowStart&&i.row<=this.rowsSpan.rowEnd&&(s=r.shiftedByRows(this.rowsSpan.rowEnd-i.row+1)),a.row>=this.rowsSpan.rowStart&&a.row<=this.rowsSpan.rowEnd&&(n=e.shiftedByRows(-(a.row-this.rowsSpan.rowStart+1)))}var f=this.transformCellAddress(s,t),u=this.transformCellAddress(n,t);if(!1===f&&!1===u)return[s,n];if(f===ErrorType.REF||u===ErrorType.REF)throw Error("Cannot happen");return[f||s,u||n]}},{key:"sheet",get:function(){return this.rowsSpan.sheet}}]),t}();
//# sourceMappingURL=/sm/c368ccdd03bef545bb339b5c3278694c206f979b5daae8258493c431ceb20f9c.map