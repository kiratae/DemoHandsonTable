/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/parser/Unparser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"core-js/modules/es.array.concat";import"core-js/modules/es.array.join";import"core-js/modules/es.array.map";import"core-js/modules/es.object.to-string";import"core-js/modules/es.regexp.constructor";import"core-js/modules/es.regexp.exec";import"core-js/modules/es.regexp.to-string";import"core-js/modules/es.string.replace";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}import{ErrorType}from"../Cell";import{AstNodeType,imageWithWhitespace,RangeSheetReferenceType}from"./Ast";import{binaryOpTokenMap}from"./binaryOpTokenMap";import{additionalCharactersAllowedInQuotes}from"./LexerConfig";export var Unparser=function(){function e(t,a,r,s){_classCallCheck(this,e),this.config=t,this.lexerConfig=a,this.sheetMappingFn=r,this.namedExpressions=s}return _createClass(e,[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var a,r=this;switch(e.type){case AstNodeType.EMPTY:return imageWithWhitespace("",e.leadingWhitespace);case AstNodeType.NUMBER:return imageWithWhitespace(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case AstNodeType.STRING:return imageWithWhitespace('"'+e.value+'"',e.leadingWhitespace);case AstNodeType.FUNCTION_CALL:var s=e.args.map(function(e){return void 0!==e?r.unparseAst(e,t):""}).join(this.config.functionArgSeparator),i=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(i,e.leadingWhitespace);case AstNodeType.NAMED_EXPRESSION:var n=null===(a=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===a?void 0:a.displayName;return imageWithWhitespace(n||e.expressionName,e.leadingWhitespace);case AstNodeType.CELL_REFERENCE:var o;return o=null!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!"+e.reference.unparse(t):e.reference.unparse(t),imageWithWhitespace(o,e.leadingWhitespace);case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:return imageWithWhitespace(this.formatRange(e,t),e.leadingWhitespace);case AstNodeType.PLUS_UNARY_OP:var p=this.unparseAst(e.value,t);return imageWithWhitespace("+",e.leadingWhitespace)+p;case AstNodeType.MINUS_UNARY_OP:var c=this.unparseAst(e.value,t);return imageWithWhitespace("-",e.leadingWhitespace)+c;case AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+imageWithWhitespace("%",e.leadingWhitespace);case AstNodeType.ERROR:var h=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:ErrorType.ERROR);return imageWithWhitespace(h,e.leadingWhitespace);case AstNodeType.ERROR_WITH_RAW_INPUT:return imageWithWhitespace(e.rawInput,e.leadingWhitespace);case AstNodeType.PARENTHESIS:var u="("+this.unparseAst(e.expression,t)+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(u,e.leadingWhitespace);default:var l=this.unparseAst(e.left,t),m=this.unparseAst(e.right,t);return l+imageWithWhitespace(binaryOpTokenMap[e.type],e.leadingWhitespace)+m}}},{key:"unparseSheetName",value:function(e){var t=this.sheetMappingFn(e);return new RegExp(additionalCharactersAllowedInQuotes).exec(t)?"'".concat(t,"'"):t}},{key:"formatRange",value:function(e,t){var a="",r="";return null!==e.start.sheet&&e.sheetReferenceType!==RangeSheetReferenceType.RELATIVE&&(a=this.unparseSheetName(e.start.sheet)+"!"),null!==e.end.sheet&&e.sheetReferenceType===RangeSheetReferenceType.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!"),"".concat(a).concat(e.start.unparse(t),":").concat(r).concat(e.end.unparse(t))}}]),e}();export function formatNumber(e,t){return e.toString().replace(".",t)}
//# sourceMappingURL=/sm/7801956ada73a4e8ae12194f98a7b1128304fa488d6c90050dd9f4f3653a44e5.map