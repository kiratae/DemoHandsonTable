/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/hyperformula@0.1.3/es/CellContentParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"core-js/modules/es.array.slice";import"core-js/modules/es.string.ends-with";import"core-js/modules/es.string.starts-with";import"core-js/modules/es.string.trim";function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}import{CellError,ErrorType}from"./Cell";import{UnableToParseError}from"./errors";import{fixNegativeZero,isNumberOverflow}from"./interpreter/ArithmeticHelper";export var CellContent;!function(e){e.Number=function e(r){_classCallCheck(this,e),this.value=r,this.value=fixNegativeZero(this.value)};e.String=function e(r){_classCallCheck(this,e),this.value=r};e.Boolean=function e(r){_classCallCheck(this,e),this.value=r};var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=r;e.Formula=function e(r){_classCallCheck(this,e),this.formula=r};var t=function(){function e(r){_classCallCheck(this,e),this.formula=r}return _createClass(e,[{key:"formulaWithBraces",value:function(){return"{"+this.formula+"}"}}]),e}();e.MatrixFormula=t;e.Error=function e(r){_classCallCheck(this,e),this.value=new CellError(r)}}(CellContent||(CellContent={}));export function isFormula(e){return e.startsWith("=")}export function isBoolean(e){var r=e.toLowerCase();return"true"===r||"false"===r}export function isMatrix(e){return"string"==typeof e&&(e.length>1&&e.startsWith("{")&&e.endsWith("}"))}export function isError(e,r){var t=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(r,t)}export var CellContentParser=function(){function e(r,t,n){_classCallCheck(this,e),this.config=r,this.dateHelper=t,this.numberLiteralsHelper=n}return _createClass(e,[{key:"parse",value:function(e){if(null==e)return CellContent.Empty.getSingletonInstance();if("number"==typeof e)return isNumberOverflow(e)?new CellContent.Error(ErrorType.NUM):new CellContent.Number(e);if("boolean"==typeof e)return new CellContent.Boolean(e);if(e instanceof Date)return new CellContent.Number(this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}));if("string"==typeof e){if(isBoolean(e))return new CellContent.Boolean("true"===e.toLowerCase());if(isMatrix(e))return new CellContent.MatrixFormula(e.substr(1,e.length-2));if(isFormula(e))return new CellContent.Formula(e);if(isError(e,this.config.errorMapping))return new CellContent.Error(this.config.errorMapping[e.toUpperCase()]);var r=e.trim();if(this.numberLiteralsHelper.isNumber(r))return new CellContent.Number(this.numberLiteralsHelper.numericStringToNumber(r));var t=this.dateHelper.dateStringToDateNumber(r);return void 0!==t?new CellContent.Number(t):new CellContent.String(e.startsWith("'")?e.slice(1):e)}throw new UnableToParseError(e)}}]),e}();
//# sourceMappingURL=/sm/4f3ba6590d01e69c7a20c5a3873d2e7afc2e13a98f3de568f06fafff932c9b71.map